<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lino Galiana">
<meta name="dcterms.date" content="2025-01-15">
<meta name="description" content="Une partie essentielle du travail du data scientist est d’être en mesure de synthétiser une information dans des représentations graphiques percutantes. Ce chapitre permet de découvrir les enjeux de la représentation de données avec Python, l’écosystème pour faire ceci. Il ouvre également à la représentation interactive de données avec Plotly.">

<title>Construire des graphiques avec Python – Python for data science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/visualisation/maps.html" rel="next">
<link href="../../content/visualisation/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #e9f3fa;
      }
</style>
<script id="toggle-light-dark-elements" type="application/javascript">
// Extend Quarto theme toggling to allow elements to be displayed/hidden in light/dark themes

// Replicated from https://github.com/quarto-dev/quarto-cli/blob/84d4659/src/resources/formats/html/templates/quarto-html.ejs
const getColorSchemeSentinel = () => {
  const localAlternateSentinel = 'default';
  if (window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    return storageValue != null ? storageValue : localAlternateSentinel;
  } else {
    return localAlternateSentinel;
  }
};

// Function to toggle light and dark elements based on color scheme
const toggleColorSchemeElements = () => {
  const scheme = getColorSchemeSentinel();
  const lightElements = document.getElementsByClassName('only-light');
  const darkElements = document.getElementsByClassName('only-dark');

  for (var i = 0; i < lightElements.length; i++) {
    lightElements[i].style.display = scheme == 'default' ? 'block' : 'none';
  }
  for (var i = 0; i < darkElements.length; i++) {
    darkElements[i].style.display = scheme == 'default' ? 'none' : 'block';
  }
};

// Function to check if the user's browser prefers dark themes
const prefersDarkTheme = () => {
  if (window.matchMedia) {
    return window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return false;
};

document.addEventListener('readystatechange', function() {
  // Set the default color scheme based on browser preference
  if (document.readyState === 'interactive' && window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    if (storageValue == null && prefersDarkTheme()) {
      window.localStorage.setItem('quarto-color-scheme', 'alternate');
    }
  }
  // Add event listener for when the readyState is complete (and default toggler is set)
  if (document.readyState === 'complete') {
    // Toggle scheme once
    toggleColorSchemeElements();
    // Append our toggle function to the old one
    const oldToggle = window.quartoToggleColorScheme;
    window.quartoToggleColorScheme = () => {
      oldToggle();
      toggleColorSchemeElements();
    }
  }
});

</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Construire des graphiques avec Python – Python for data science">
<meta name="twitter:description" content="Une partie essentielle du travail du data scientist est d’être en mesure de synthétiser une information dans des représentations graphiques percutantes. Ce chapitre permet de découvrir les enjeux de la représentation de données avec Python, l’écosystème pour faire ceci. Il ouvre également à la représentation interactive de données avec Plotly.">
<meta name="twitter:image" content="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/drawing.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Python pour la data science">
<meta name="citation_author" content="Lino Galiana">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2025-01-15">
<meta name="citation_fulltext_html_url" content="https://pythonds.linogaliana.fr/">
<meta name="citation_doi" content="10.5281/zenodo.8229676">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Coding for economists;,citation_author=undefined Turrell;,citation_author=undefined contributors;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://aeturrell.github.io/coding-for-economists;">
<meta name="citation_reference" content="citation_title=The hugging face course, 2022;,citation_author=Hugging Face;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=https://huggingface.co/course;">
<meta name="citation_reference" content="citation_title=The signal and the noise: Why so many predictions fail-but some don’t;,citation_author=Nate Silver;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Efficient estimation of word representations in vector space;,citation_author=Tomas Mikolov;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=3781;,citation_journal_title=arXiv preprint arXiv:1301.3781;">
<meta name="citation_reference" content="citation_title=Attention is all you need;,citation_author=A Vaswani;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Advances in Neural Information Processing Systems;">
<meta name="citation_reference" content="citation_title=Tableau politique de la france de l’ouest sous la troisième république: 102 cartes et croquis, 1 carte hors texte;,citation_author=André Siegfried;,citation_publication_date=1913;,citation_cover_date=1913;,citation_year=1913;">
<meta name="citation_reference" content="citation_title=Statistical learning;,citation_author=Gareth James;,citation_author=Daniela Witten;,citation_author=Trevor Hastie;,citation_author=Robert Tibshirani;,citation_author=Jonathan Taylor;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_inbook_title=An introduction to statistical learning: With applications in python;">
<meta name="citation_reference" content="citation_title=Une histoire du conflit politique: Elections et inégalités sociales en france, 1789-2022;,citation_author=Thomas Piketty;,citation_author=Julia Cagé;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Interpretable machine learning: A guide for making black box models explainable;,citation_author=Molnar Christoph;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;">
<meta name="citation_reference" content="citation_title=A gentle introduction to conformal prediction and distribution-free uncertainty quantification;,citation_author=Anastasios N Angelopoulos;,citation_author=Stephen Bates;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_journal_title=arXiv preprint arXiv:2107.07511;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang Härdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Discovering statistics using r;,citation_author=A Field;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_publisher=Sage;">
<meta name="citation_reference" content="citation_title=psyTeachR Book Template;,citation_author=DeBruine Lisa;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://github.com/psyteachr/template/;">
<meta name="citation_reference" content="citation_title=The grammar of graphics;,citation_author=Leland Wilkinson;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Hands-on machine learning with scikit-learn, keras, and TensorFlow;,citation_author=Aurélien Géron;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang Härdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Random forests;,citation_author=Leo Breiman;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_volume=45;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Bagging predictors;,citation_author=Leo Breiman;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_volume=24;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=R for data science;,citation_author=Hadley Wickham;,citation_author=Mine Çetinkaya-Rundel;,citation_author=Garrett Grolemund;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Computational reproducibility of jupyter notebooks from biomedical publications;,citation_author=Sheeba Samuel;,citation_author=Daniel Mietchen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2308.07333;">
<meta name="citation_reference" content="citation_title=Python data science handbook: Essential tools for working with data;,citation_author=Jake VanderPlas;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;">
<meta name="citation_reference" content="citation_title=Machine learning methods that economists should know about;,citation_author=Susan Athey;,citation_author=Guido W Imbens;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=11;,citation_journal_title=Annual Review of Economics;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data an illustration with scanner data and crowd-sourced nutritional data;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=Proceedings of the 2022 &amp;amp;amp;quot;Journées de Méthodologie Statistiques&amp;quot;;">
<meta name="citation_reference" content="citation_title=Data visualization with python and JavaScript;,citation_author=Kyran Dale;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=Sémiologie graphique;,citation_author=Jacques Bertin;,citation_publication_date=1967;,citation_cover_date=1967;,citation_year=1967;">
<meta name="citation_reference" content="citation_title=La sémiologie graphique de jacques bertin a cinquante ans;,citation_author=Gilles Palsky;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Visions carto (en ligne);">
<meta name="citation_reference" content="citation_title=Fundamentals of data visualization: A primer on making informative and compelling figures;,citation_author=Claus O Wilke;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=How to train BERT with an academic budget;,citation_author=Peter Izsak;,citation_author=Moshe Berchansky;,citation_author=Omer Levy;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2104.07705;">
<meta name="citation_reference" content="citation_title=Python for data analysis: Data wrangling with pandas, NumPy, and IPython;,citation_author=Wes McKinney;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Residential segregation, daytime segregation and spatial frictions: An analysis from mobile phone data;,citation_author=Lino Galiana;,citation_author=François Sémécurbe;,citation_author=Benjamin Sakarovitch;,citation_author=Zbigniew Smoreda;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data: An illustration with scanner and crowd-sourced nutritional datasets;,citation_abstract=Food retailers’ scanner data provide unprecedented details on local consumption, provided that product identifiers allow a linkage with features of interest, such as nutritional information. In this paper, we enrich a large retailer dataset with nutritional information extracted from crowd-sourced and administrative nutritional datasets. To compensate for imperfect matching through the barcode, we develop a methodology to efficiently match short textual descriptions. After a preprocessing step to normalize short labels, we resort to fuzzy matching based on several tokenizers (including n-grams) by querying an ElasticSearch customized index and validate candidates echos as matches with a Levensthein edit-distance and an embedding-based similarity measure created from a siamese neural network model. The pipeline is composed of several steps successively relaxing constraints to find relevant matching candidates.;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1145/3524458.3547244;,citation_doi=10.1145/3524458.3547244;,citation_isbn=9781450392846;,citation_conference_title=Proceedings of the 2022 ACM conference on information technology for social good;,citation_conference=Association for Computing Machinery;,citation_series_title=GoodIT ’22;">
<meta name="citation_reference" content="citation_title=Guide de sémiologie cartographique;,citation_author=undefined Insee;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Energy and policy considerations for deep learning in NLP;,citation_author=Emma Strubell;,citation_author=Ananya Ganesh;,citation_author=Andrew McCallum;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://arxiv.org/abs/1906.02243;">
<meta name="citation_reference" content="citation_title=High-resolution image synthesis with latent diffusion models;,citation_author=Robin Rombach;,citation_author=Andreas Blattmann;,citation_author=Dominik Lorenz;,citation_author=Patrick Esser;,citation_author=Björn Ommer;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_conference_title=Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR);">
<meta name="citation_reference" content="citation_title=Apache arrow and the&amp;amp;amp;quot; 10 things i hate about pandas;,citation_author=Wes McKinney;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_volume=21;,citation_journal_title=Blog, September;">
<meta name="citation_reference" content="citation_title=Many researchers were not compliant with their published data sharing statement: Mixed-methods study;,citation_author=Mirko Gabelica;,citation_author=Ružica Bojčić;,citation_author=Livia Puljak;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_journal_title=Journal of Clinical Epidemiology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Credit scoring in the era of big data;,citation_author=Mikella Hurley;,citation_author=Julius Adebayo;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=18;,citation_journal_title=Yale JL &amp;amp;amp; Tech.;,citation_publisher=HeinOnline;">
<meta name="citation_reference" content="citation_title=Econometrics and machine learning;,citation_author=Arthur Charpentier;,citation_author=Emmanuel Flachaire;,citation_author=Antoine Ly;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=505;,citation_journal_title=Economie et Statistique;,citation_publisher=Persée-Portail des revues scientifiques en SHS;">
<meta name="citation_reference" content="citation_title=Machine learning: An applied econometric approach;,citation_author=Sendhil Mullainathan;,citation_author=Jann Spiess;,citation_publication_date=2017-05;,citation_cover_date=2017-05;,citation_year=2017;,citation_fulltext_html_url=https://www.aeaweb.org/articles?id=10.1257/jep.31.2.87;,citation_issue=2;,citation_doi=10.1257/jep.31.2.87;,citation_volume=31;,citation_journal_title=Journal of Economic Perspectives;">
<meta name="citation_reference" content="citation_title=Le problème du réalisme des hypothèses en économie politique;,citation_author=Pierre Salmon;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;">
<meta name="citation_reference" content="citation_title=The methodology of positive economics;,citation_author=Milton Friedman;,citation_publication_date=1953;,citation_cover_date=1953;,citation_year=1953;,citation_inbook_title=Essays in positive economics;">
<meta name="citation_reference" content="citation_title=L’empreinte carbone du numérique;,citation_author=undefined Arcep;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in ML-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2207.07048;,citation_doi=10.48550/ARXIV.2207.07048;,citation_publisher=arXiv;">
<meta name="citation_reference" content="citation_title=Growth in a time of debt;,citation_author=Carmen M Reinhart;,citation_author=Kenneth S Rogoff;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_issue=2;,citation_volume=100;,citation_journal_title=American economic review;,citation_publisher=American Economic Association;">
<meta name="citation_reference" content="citation_title=We do not know the population of every country in the world for the past two thousand years;,citation_author=Timothy W Guinnane;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=3;,citation_volume=83;,citation_journal_title=The Journal of Economic History;">
<meta name="citation_reference" content="citation_title=Artificial intelligence: A modern approach (4th edition);,citation_author=Stuart J. Russell;,citation_author=Peter Norvig;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=http://aima.cs.berkeley.edu/;,citation_isbn=9781292401133;">
<meta name="citation_reference" content="citation_title=Data scientist, the sexiest job of the 21st century;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century;,citation_issue=5;,citation_volume=90;,citation_journal_title=Harvard business review;">
<meta name="citation_reference" content="citation_title=Is data scientist still the sexiest job of the 21st century?;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=90;,citation_journal_title=Harvard Business Review;,citation_publisher=Harvard Business Publishing;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in machine-learning-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=9;,citation_volume=4;,citation_journal_title=Patterns;,citation_publisher=Elsevier;">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="../../content/getting-started/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/01_environment.html">
 <span class="dropdown-text">A functional Python environment for data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/02_data_analysis.html">
 <span class="dropdown-text">How to deal with a data set</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/03_revisions.html">
 <span class="dropdown-text">A few refresher exercises to get back in the saddle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wrangle" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wrangle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wrangle">    
        <li>
    <a class="dropdown-item" href="../../content/manipulation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/01_numpy.html">
 <span class="dropdown-text">Numpy, the foundation of data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_intro.html">
 <span class="dropdown-text">Introduction to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_suite.html">
 <span class="dropdown-text">Data wrangling with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/03_geopandas_intro.html">
 <span class="dropdown-text">Introduction to spatial data with Geopandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04a_webscraping_TP.html">
 <span class="dropdown-text">Web scraping with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04c_API_TP.html">
 <span class="dropdown-text">Retrieve data with APIs from Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04b_regex_TP.html">
 <span class="dropdown-text">Mastering regular expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-communicate" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Communicate</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-communicate">    
        <li>
    <a class="dropdown-item" href="../../content/visualisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/matplotlib.html">
 <span class="dropdown-text">Construire des graphiques avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/maps.html">
 <span class="dropdown-text">Introduction à la cartographie avec Python</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model">    
        <li>
    <a class="dropdown-item" href="../../content/modelisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/0_preprocessing.html">
 <span class="dropdown-text">Preprocessing before building machine learning models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/1_modelevaluation.html">
 <span class="dropdown-text">Evaluating model quality</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/3_regression.html">
 <span class="dropdown-text">An introduction to regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/4_featureselection.html">
 <span class="dropdown-text">Variable selection: an introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/5_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/6_pipeline.html">
 <span class="dropdown-text">Premier pas vers l’industrialisation avec les pipelines scikit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/7_mlapi.html">
 <span class="dropdown-text">Mettre à disposition un modèle par le biais d’une API</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nlp" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NLP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nlp">    
        <li>
    <a class="dropdown-item" href="../../content/NLP/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/01_intro.html">
 <span class="dropdown-text">Nettoyer et structurer l’information dans les données textuelles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/02_exoclean.html">
 <span class="dropdown-text">L’analyse fréquentiste par l’approche bag-of-words : intérêt et limites</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/03_embedding.html">
 <span class="dropdown-text">Les embeddings, où comment synthétiser l’information textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-depth" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-depth</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-depth">    
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/continuous_integration.html">
 <span class="dropdown-text">Intégration continue avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/s3.html">
 <span class="dropdown-text">Les nouveaux modes d’accès aux données : le format Parquet et les données sur le cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_approfondissement.html">
 <span class="dropdown-text">Approfondissement ElasticSearch pour des recherches de proximité géographique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_intro.html">
 <span class="dropdown-text">Introduction à ElasticSearch pour la recherche textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-git" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Git</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-git">    
        <li>
    <a class="dropdown-item" href="../../content/git/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/introgit.html">
 <span class="dropdown-text">Découvrir Git par la pratique: la gymnastique quotidienne</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/exogit.html">
 <span class="dropdown-text">Un cadavre exquis pour découvrir le travail collaboratif <code>Git</code></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-annexes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Annexes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-annexes">    
        <li>
    <a class="dropdown-item" href="../../content/annexes/evaluation.html">
 <span class="dropdown-text">Évaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/annexes/corrections.html">
 <span class="dropdown-text">Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://linogaliana.github.io/python-datascientist-slides/#/title-slide">
 <span class="dropdown-text">Slides de présentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/linogaliana/python-datascientist" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/visualisation/matplotlib.html">Construire des graphiques avec Python</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Construire des graphiques avec Python</h1>
                  <div>
        <div class="description">
          <p>Une partie essentielle du travail du <em>data scientist</em> est d’être en mesure de synthétiser une information dans des représentations graphiques percutantes. Ce chapitre permet de découvrir les enjeux de la représentation de données avec <code>Python</code>, l’écosystème pour faire ceci. Il ouvre également à la représentation interactive de données avec <code>Plotly</code>.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Visualisation</div>
                <div class="quarto-category">Exercice</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lino Galiana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2025-01-15</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/visualisation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/visualisation/matplotlib.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Construire des graphiques avec Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/visualisation/maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction à la cartographie avec Python</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#données" id="toc-données" class="nav-link active" data-scroll-target="#données"><span class="header-section-number">1</span> Données</a></li>
  <li><a href="#premières-productions-graphiques-avec-lapi-matplotlib-de-pandas" id="toc-premières-productions-graphiques-avec-lapi-matplotlib-de-pandas" class="nav-link" data-scroll-target="#premières-productions-graphiques-avec-lapi-matplotlib-de-pandas"><span class="header-section-number">2</span> Premières productions graphiques avec l’API <code>Matplotlib</code> de <code>Pandas</code></a>
  <ul class="collapse">
  <li><a href="#comprendre-en-quelques-mots-le-principe-de-matplotlib" id="toc-comprendre-en-quelques-mots-le-principe-de-matplotlib" class="nav-link" data-scroll-target="#comprendre-en-quelques-mots-le-principe-de-matplotlib"><span class="header-section-number">2.1</span> Comprendre, en quelques mots, le principe de <code>matplotlib</code></a></li>
  <li><a href="#découvrir-matplotlib-par-lintermédiaire-de-pandas" id="toc-découvrir-matplotlib-par-lintermédiaire-de-pandas" class="nav-link" data-scroll-target="#découvrir-matplotlib-par-lintermédiaire-de-pandas"><span class="header-section-number">2.2</span> Découvrir <code>matplotlib</code> par l’intermédiaire de <code>Pandas</code></a></li>
  </ul></li>
  <li><a href="#utiliser-directement-seaborn" id="toc-utiliser-directement-seaborn" class="nav-link" data-scroll-target="#utiliser-directement-seaborn"><span class="header-section-number">3</span> Utiliser directement <code>seaborn</code></a>
  <ul class="collapse">
  <li><a href="#comprendre-seaborn-en-quelques-lignes" id="toc-comprendre-seaborn-en-quelques-lignes" class="nav-link" data-scroll-target="#comprendre-seaborn-en-quelques-lignes"><span class="header-section-number">3.1</span> Comprendre <code>seaborn</code> en quelques lignes</a></li>
  <li><a href="#le-diagramme-en-barre-barplot" id="toc-le-diagramme-en-barre-barplot" class="nav-link" data-scroll-target="#le-diagramme-en-barre-barplot"><span class="header-section-number">3.2</span> Le diagramme en barre (<em>barplot</em>)</a></li>
  <li><a href="#un-exemple-dalternative-au-barplot-le-lollipop-chart" id="toc-un-exemple-dalternative-au-barplot-le-lollipop-chart" class="nav-link" data-scroll-target="#un-exemple-dalternative-au-barplot-le-lollipop-chart"><span class="header-section-number">3.3</span> Un exemple d’alternative au <em>barplot</em>, le <em>lollipop chart</em></a></li>
  </ul></li>
  <li><a href="#la-même-figure-avec-plotnine" id="toc-la-même-figure-avec-plotnine" class="nav-link" data-scroll-target="#la-même-figure-avec-plotnine"><span class="header-section-number">4</span> La même figure avec <code>plotnine</code></a></li>
  <li><a href="#premières-agrégations-temporelles" id="toc-premières-agrégations-temporelles" class="nav-link" data-scroll-target="#premières-agrégations-temporelles"><span class="header-section-number">5</span> Premières agrégations temporelles</a></li>
  <li><a href="#première-série-temporelle" id="toc-première-série-temporelle" class="nav-link" data-scroll-target="#première-série-temporelle"><span class="header-section-number">6</span> Première série temporelle</a></li>
  <li><a href="#des-graphiques-réactifs-grâce-aux-librairies-javascript" id="toc-des-graphiques-réactifs-grâce-aux-librairies-javascript" class="nav-link" data-scroll-target="#des-graphiques-réactifs-grâce-aux-librairies-javascript"><span class="header-section-number">7</span> Des graphiques réactifs grâce aux librairies <code>Javascript</code></a>
  <ul class="collapse">
  <li><a href="#lécosystème-disponible-depuis-python" id="toc-lécosystème-disponible-depuis-python" class="nav-link" data-scroll-target="#lécosystème-disponible-depuis-python"><span class="header-section-number">7.1</span> L’écosystème disponible depuis <code>Python</code></a>
  <ul class="collapse">
  <li><a href="#la-librairie-plotly" id="toc-la-librairie-plotly" class="nav-link" data-scroll-target="#la-librairie-plotly"><span class="header-section-number">7.1.1</span> La librairie <code>Plotly</code></a></li>
  </ul></li>
  <li><a href="#réplication-de-lexemple-précédent-avec-plotly" id="toc-réplication-de-lexemple-précédent-avec-plotly" class="nav-link" data-scroll-target="#réplication-de-lexemple-précédent-avec-plotly"><span class="header-section-number">7.2</span> Réplication de l’exemple précédent avec <code>Plotly</code></a></li>
  <li><a href="#la-librairie-altair" id="toc-la-librairie-altair" class="nav-link" data-scroll-target="#la-librairie-altair"><span class="header-section-number">7.3</span> La librairie <code>altair</code></a></li>
  <li><a href="#informations-additionnelles" id="toc-informations-additionnelles" class="nav-link" data-scroll-target="#informations-additionnelles">Informations additionnelles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/visualisation/matplotlib.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<a href="#" onclick="this.href = location.href.replace('/en/', '/');" class="button-cta">
<button class="btn"><i class="fa fa-language"></i> Passer à la version française 🇫🇷</button>
</a></p>
<div class="badge-container"><div class="badge-text">If you want to try the examples in this tutorial:</div><a href="https://github.com/linogaliana/python-datascientist-notebooks/blob/main/notebooks/en/visualisation/matplotlib.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/static/v1?logo=github&amp;label=&amp;message=View%20on%20GitHub&amp;color=181717" alt="View on GitHub"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/vscode-python?autoLaunch=true&amp;name=«matplotlib»&amp;init.personalInit=«https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-vscode.sh»&amp;init.personalInitArgs=«en/visualisation%20matplotlib%20correction»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue" alt="Onyxia"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/jupyter-python?autoLaunch=true&amp;name=«matplotlib»&amp;init.personalInit=«https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-jupyter.sh»&amp;init.personalInitArgs=«en/visualisation%20matplotlib%20correction»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange" alt="Onyxia"></a>
<a href="https://colab.research.google.com/github/linogaliana/python-datascientist-notebooks//en/blob/main//notebooks/en/visualisation/matplotlib.ipynb" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a><br></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Compétences à l’issue de ce chapitre
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Découvrir l’écosystème <a href="https://matplotlib.org/"><code>matplotlib</code></a> et
<a href="https://seaborn.pydata.org/"><code>seaborn</code></a> pour la construction de graphiques par enrichissement successif de couches.</li>
<li>Découvrir le récent écosystème <a href="https://plotnine.readthedocs.io/en/stable/index.html"><code>plotnine</code></a>.
qui est une implémentation en <code>Python</code> du <em>package</em> <code>R</code> <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a>
pour ce type de représentation et qui, grâce à sa grammaire des graphiques, offre une syntaxe puissante pour construire des visualisations de données.</li>
<li>Découvrir le principe des représentations interactives HTML (format <em>web</em>) grâce aux packages <a href="https://plotly.com/python/"><code>plotly</code></a> et <a href="https://altair-viz.github.io/"><code>altair</code></a>.</li>
<li>Apprendre les enjeux de la représentation graphique, les compromis nécessaires pour construire un message clair et les limites de certaines représentations classiques.</li>
</ul>
</div>
</div>
</div>
<p>La pratique de la <em>data visualisation</em> se fera, dans ce cours, en répliquant des graphiques qu’on peut trouver sur
la page de l’<em>open data</em> de la ville de Paris
<a href="https://opendata.paris.fr/explore/dataset/comptage-velo-donnees-compteurs/dataviz/?disjunctive.id_compteur&amp;disjunctive.nom_compteur&amp;disjunctive.id&amp;disjunctive.name">ici</a> ou en proposant des alternatives à ceux-ci sur les mêmes données.</p>
<p>L’objectif de ce chapitre n’est pas de faire un inventaire complet des graphiques pouvant être fait avec <code>Python</code>, ce serait long, assez insipide et peu pertinent car des sites le font déjà très bien à partir d’une grande variété d’exemple, notamment le site <a href="https://python-graph-gallery.com/">python-graph-gallery.com/</a>. L’objectif est plutôt d’illustrer, par la pratique, quelques enjeux liés à l’utilisation des principales librairies graphiques de <code>Python</code>.</p>
<p>On peut distinguer quelques grandes familles de représentations graphiques: les représentations de distributions propres à une variable, les représentations de relations entre plusieurs variables, les cartes qui permettent de représenter dans l’espace une ou plusieurs variables…</p>
<p>Ces familles se ramifient elles-mêmes en de multiples types de figures. Par exemple, selon la nature du phénomène, les représentations de relations peuvent prendre la forme d’une série temporelle (évolution d’une variable dans le temps), d’un nuage de point (corrélation entre deux variables), d’un diagramme en barre (pour souligner le rapport relatif entre les valeurs d’une variable en fonction d’une autre), etc.</p>
<p>Plutôt qu’un inventaire à la Prévert des types de visualisations possibles, ce chapitre et le suivant vont plutôt proposer quelques visualisations qui pourraient donner envie d’aller plus loin dans l’analyse avant la mise en oeuvre d’une forme de modélisation. Ce chapitre est consacré aux visualisations traditionnelles, le <a href="../../content/visualisation/maps.html">suivant</a> est dédié à la cartographie. Ces deux chapitres font partie d’un tout visant à offrir les premiers éléments pour synthétiser l’information présente dans un jeu de données.</p>
<p>Le pas suivant est d’approfondir le travail de communication et de synthèse par le biais de communications pouvant prendre des formes aussi diverses que des rapports, des publications scientifiques ou articles, des présentations, une application interactive, un site web ou des <em>notebooks</em> comme ceux proposés par ce cours. Le principe général est identique quelle que soit le <em>medium</em> utilisé et intéresse particulièrement les <em>data scientists</em> lorsqu’ils font appel à de l’exploitation intensive de données. Ce sera l’objet d’un chapitre futur de ce cours<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Être capable de construire des visualisations de données
intéressantes est une compétence nécessaire à tout
<em>data scientist</em> ou chercheur. Pour améliorer
la qualité de ces visualisations, il est recommandé
de suivre certains conseils donnés par des spécialistes
de la <em>dataviz</em> sur la sémiologie graphique.</p>
<p>Les bonnes visualisations de données, comme celles du <em>New York Times</em>,
reposent certes sur des outils adaptés (des librairies <code>JavaScript</code>)
mais aussi sur certaines règles de représentation qui permettent
de comprendre en quelques secondes le message d’une visualisation.</p>
<p>Ce <a href="https://blog.datawrapper.de/text-in-data-visualizations/">post de blog</a>
est une ressource qu’il est utile de consulter régulièrement.
Ce <a href="https://albert-rapp.de/posts/ggplot2-tips/10_recreating_swd_look/10_recreating_swd_look">post de blog d’Albert Rapp</a> montre bien comment construire graduellement une bonne visualisation
de données.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Si vous êtes intéressés par <code>R</code> <i class="fa-brands fa-python" aria-label="python"></i>,
une version très proche de ce TP est
disponible dans <a href="https://rgeo.linogaliana.fr/exercises/ggplot.html">ce cours d’introduction à <code>R</code> pour l’ENS Ulm</a>.</p>
</div>
</div>
</div>
<section id="données" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Données</h1>
<p>Ce chapitre s’appuie sur les données de comptage des passages de vélo dans les points de mesure parisiens diffusés sur le site de l’<em>open data</em> de la ville de Paris.</p>
<p>L’exploitation de l’historique récent a été grandement facilité par la diffusion des données au format <code>Parquet</code>, un format moderne plus pratique que le CSV. Pour en savoir plus sur ce format, vous pouvez consulter les ressources évoquées dans le paragraphe consacré à ce format dans le <a href="../../content/manipulation/02_pandas_suite.html">chapitre d’approfondissement</a>.</p>
<div id="8c96be91" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code pour importer les données à partir du format Parquet</summary>
<div class="sourceCode cell-code" id="8c96be91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8c96be91-1"><a href="#8c96be91-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="8c96be91-2"><a href="#8c96be91-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="8c96be91-3"><a href="#8c96be91-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="8c96be91-4"><a href="#8c96be91-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="8c96be91-5"><a href="#8c96be91-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="8c96be91-6"><a href="#8c96be91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-7"><a href="#8c96be91-7" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://opendata.paris.fr/api/explore/v2.1/catalog/datasets/comptage-velo-donnees-compteurs/exports/parquet?lang=fr&amp;timezone=Europe</span><span class="sc">%2F</span><span class="st">Paris"</span></span>
<span id="8c96be91-8"><a href="#8c96be91-8" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">"comptage_velo_donnees_compteurs.parquet"</span></span>
<span id="8c96be91-9"><a href="#8c96be91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-10"><a href="#8c96be91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-11"><a href="#8c96be91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># DOWNLOAD FILE --------------------------------</span></span>
<span id="8c96be91-12"><a href="#8c96be91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-13"><a href="#8c96be91-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the HTTP request and stream the download</span></span>
<span id="8c96be91-14"><a href="#8c96be91-14" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)</span>
<span id="8c96be91-15"><a href="#8c96be91-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-16"><a href="#8c96be91-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(filename):</span>
<span id="8c96be91-17"><a href="#8c96be91-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform the HTTP request and stream the download</span></span>
<span id="8c96be91-18"><a href="#8c96be91-18" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)</span>
<span id="8c96be91-19"><a href="#8c96be91-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-20"><a href="#8c96be91-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the request was successful</span></span>
<span id="8c96be91-21"><a href="#8c96be91-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="8c96be91-22"><a href="#8c96be91-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the total size of the file from the headers</span></span>
<span id="8c96be91-23"><a href="#8c96be91-23" aria-hidden="true" tabindex="-1"></a>        total_size <span class="op">=</span> <span class="bu">int</span>(response.headers.get(<span class="st">"content-length"</span>, <span class="dv">0</span>))</span>
<span id="8c96be91-24"><a href="#8c96be91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-25"><a href="#8c96be91-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Open the file in write-binary mode and use tqdm to show progress</span></span>
<span id="8c96be91-26"><a href="#8c96be91-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">"wb"</span>) <span class="im">as</span> <span class="bu">file</span>, tqdm(</span>
<span id="8c96be91-27"><a href="#8c96be91-27" aria-hidden="true" tabindex="-1"></a>            desc<span class="op">=</span>filename,</span>
<span id="8c96be91-28"><a href="#8c96be91-28" aria-hidden="true" tabindex="-1"></a>            total<span class="op">=</span>total_size,</span>
<span id="8c96be91-29"><a href="#8c96be91-29" aria-hidden="true" tabindex="-1"></a>            unit<span class="op">=</span><span class="st">"B"</span>,</span>
<span id="8c96be91-30"><a href="#8c96be91-30" aria-hidden="true" tabindex="-1"></a>            unit_scale<span class="op">=</span><span class="va">True</span>,</span>
<span id="8c96be91-31"><a href="#8c96be91-31" aria-hidden="true" tabindex="-1"></a>            unit_divisor<span class="op">=</span><span class="dv">1024</span>,</span>
<span id="8c96be91-32"><a href="#8c96be91-32" aria-hidden="true" tabindex="-1"></a>        ) <span class="im">as</span> bar:</span>
<span id="8c96be91-33"><a href="#8c96be91-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Write the file in chunks</span></span>
<span id="8c96be91-34"><a href="#8c96be91-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">1024</span>):</span>
<span id="8c96be91-35"><a href="#8c96be91-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> chunk:  <span class="co"># filter out keep-alive chunks</span></span>
<span id="8c96be91-36"><a href="#8c96be91-36" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">file</span>.write(chunk)</span>
<span id="8c96be91-37"><a href="#8c96be91-37" aria-hidden="true" tabindex="-1"></a>                    bar.update(<span class="bu">len</span>(chunk))</span>
<span id="8c96be91-38"><a href="#8c96be91-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="8c96be91-39"><a href="#8c96be91-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Failed to download the file. Status code: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="8c96be91-40"><a href="#8c96be91-40" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="8c96be91-41"><a href="#8c96be91-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"The file '</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">' already exists."</span>)</span>
<span id="8c96be91-42"><a href="#8c96be91-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-43"><a href="#8c96be91-43" aria-hidden="true" tabindex="-1"></a><span class="co"># READ FILE AND CONVERT TO PANDAS --------------------------</span></span>
<span id="8c96be91-44"><a href="#8c96be91-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-45"><a href="#8c96be91-45" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="8c96be91-46"><a href="#8c96be91-46" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT id_compteur, nom_compteur, id, sum_counts, date </span></span>
<span id="8c96be91-47"><a href="#8c96be91-47" aria-hidden="true" tabindex="-1"></a><span class="st">FROM read_parquet('comptage_velo_donnees_compteurs.parquet')</span></span>
<span id="8c96be91-48"><a href="#8c96be91-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="8c96be91-49"><a href="#8c96be91-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-50"><a href="#8c96be91-50" aria-hidden="true" tabindex="-1"></a><span class="co"># READ WITH DUCKDB AND CONVERT TO PANDAS</span></span>
<span id="8c96be91-51"><a href="#8c96be91-51" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> duckdb.sql(query).df()</span>
<span id="8c96be91-52"><a href="#8c96be91-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="8c96be91-53"><a href="#8c96be91-53" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The file 'comptage_velo_donnees_compteurs.parquet' already exists.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_compteur</th>
<th data-quarto-table-cell-role="th">nom_compteur</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">sum_counts</th>
<th data-quarto-table-cell-role="th">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100003098-101003098</td>
<td>106 avenue Denfert Rochereau NE-SO</td>
<td>100003098</td>
<td>7</td>
<td>2023-12-01 03:00:00+00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100003098-101003098</td>
<td>106 avenue Denfert Rochereau NE-SO</td>
<td>100003098</td>
<td>10</td>
<td>2023-12-01 04:00:00+00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100003098-101003098</td>
<td>106 avenue Denfert Rochereau NE-SO</td>
<td>100003098</td>
<td>9</td>
<td>2023-12-01 05:00:00+00:00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="premières-productions-graphiques-avec-lapi-matplotlib-de-pandas" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Premières productions graphiques avec l’API <code>Matplotlib</code> de <code>Pandas</code></h1>
<p>Chercher à produire une visualisation parfaite du premier coup est
illusoire. Il est beaucoup plus réaliste d’améliorer graduellement
une représentation graphique afin, petit à petit, de mettre en
avant les effets de structure dans un jeu de données.</p>
<p>Nous allons donc commencer par nous représenter la distribution
des passages aux principales stations de mesure.
Pour cela nous allons produire
rapidement un <em>barplot</em> puis l’améliorer graduellement.</p>
<p>Dans cette partie, nous allons ainsi
reproduire les deux premiers graphiques de la
<a href="https://opendata.paris.fr/explore/dataset/comptage-velo-donnees-compteurs/dataviz/?disjunctive.id_compteur&amp;disjunctive.nom_compteur&amp;disjunctive.id&amp;disjunctive.name">page d’analyse des données</a> :
<em>Les 10 compteurs avec la moyenne horaire la plus élevée</em> et <em>Les 10 compteurs ayant comptabilisé le plus de vélos</em>. Les valeurs chiffrées des graphiques peuvent être différentes de celles de la page en ligne, c’est normal, car nous ne travaillons pas systématiquement sur les données ayant la même fraicheur que celles en ligne.</p>
<p>Pour importer les librairies graphiques que nous utiliserons dans ce chapitre, il faut faire</p>
<div id="cc3d35d6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cc3d35d6"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="cc3d35d6-1"><a href="#cc3d35d6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cc3d35d6-2"><a href="#cc3d35d6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<a class="code-annotation-anchor" data-target-cell="cc3d35d6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="cc3d35d6-3" class="code-annotation-target"><a href="#cc3d35d6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="cc3d35d6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="cc3d35d6" data-code-lines="3" data-code-annotation="1">Importer des librairies sous la forme <code>from package import *</code> n’est pas une très bonne pratique. Néanmoins, pour un <em>package</em> comme <code>plotnine</code>, dont nous allons utiliser de nombreuses fonctions, ce serait un peu fastidieux d’importer les fonctions au cas par cas. De plus, cela permet de réutiliser presque tels quels les exemples de code de la librairie <code>R</code> <code>ggplot</code>, nombreux sur internet avec démonstrations visuelles. <code>from package import *</code> est l’équivalent <code>Python</code> de la pratique <code>library(package)</code> en <code>R</code>.</span>
</dd>
</dl>
</div>
</div>
<section id="comprendre-en-quelques-mots-le-principe-de-matplotlib" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="comprendre-en-quelques-mots-le-principe-de-matplotlib"><span class="header-section-number">2.1</span> Comprendre, en quelques mots, le principe de <code>matplotlib</code></h2>
<p><code>matplotlib</code> date du début des années 2000 et a émergé pour proposer une alternative en <code>Python</code> à la création de graphiques sous <code>Matlab</code>, un logiciel propriétaire de calcul numérique. <code>matplotlib</code> est donc une librairie assez ancienne, antérieure à l’émergence de <code>Python</code> dans l’écosystème du traitement de données. Cela s’en ressent sur la logique de construction de <code>matplotlib</code> qui n’est pas toujours intuitive lorsqu’on est familier de l’écosystème moderne de la <em>data science</em>. Heureusement, il existe de nombreuses librairies qui s’appuient sur <code>matplotlib</code> mais qui visent à founir une syntaxe plus familière aux <em>data scientists</em>.</p>
<p><code>matplotlib</code> propose principalement deux niveaux d’abstraction: la figure et les axes. La figure est, en quelques sortes, la “toile” globale qui contient un ou plusieurs axes dans lesquels s’inséreront des graphiques. Selon les cas, il faudra jouer avec les paramètres de figure ou d’axe, ce qui rend très flexible la construction d’un graphique mais peut également être déroutant car on ne sait jamais trop quel niveau d’abstraction il faut modifier pour mettre à jour sa figure<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Comme le montre la <a href="#fig-matplotlib" class="quarto-xref">Figure&nbsp;2.1</a>, tout les éléments d’une figure sont paramétrables.</p>
<div id="fig-matplotlib" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-matplotlib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://matplotlib.org/stable/_images/anatomy.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2.1: Comprendre l’architecture d’une figure matplotlib (Source: documentation officielle)"><img src="https://matplotlib.org/stable/_images/anatomy.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-matplotlib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Comprendre l’architecture d’une figure <code>matplotlib</code> (Source: <a href="https://matplotlib.org/stable/users/explain/quick_start.html">documentation officielle</a>)
</figcaption>
</figure>
</div>
<p>En pratique, il existe deux manières de créer et mettre à jour sa figure selon qu’on préfère passer par:</p>
<ul>
<li>l’approche explicite, héritière d’une logique de programmation orientée objet, où on crée des objets <code>Figure</code> et <code>Axes</code> et met à jour ceux-ci.</li>
<li>l’approche implicite, basée sur l’interface <code>pyplot</code> qui utilise une succession de fonctions pour mettre à jour les objets créés implicitement.</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="matplotlib-abstraction">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Approche explicite (approche orientée POO)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Approche implicite</a></li></ul>
<div class="tab-content" data-group="matplotlib-abstraction">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="625fde3d" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="625fde3d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="625fde3d-1"><a href="#625fde3d-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="625fde3d-2"><a href="#625fde3d-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="625fde3d-3"><a href="#625fde3d-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="625fde3d-4"><a href="#625fde3d-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">100</span>)  <span class="co"># Sample data.</span></span>
<span id="625fde3d-5"><a href="#625fde3d-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="625fde3d-6"><a href="#625fde3d-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that even in the OO-style, we use `.pyplot.figure` to create the Figure.</span></span>
<span id="625fde3d-7"><a href="#625fde3d-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>), layout<span class="op">=</span><span class="st">"constrained"</span>)</span>
<span id="625fde3d-8"><a href="#625fde3d-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, x, label<span class="op">=</span><span class="st">"linear"</span>)  <span class="co"># Plot some data on the Axes.</span></span>
<span id="625fde3d-9"><a href="#625fde3d-9" aria-hidden="true" tabindex="-1"></a>ax.plot(x, x<span class="op">**</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"quadratic"</span>)  <span class="co"># Plot more data on the Axes...</span></span>
<span id="625fde3d-10"><a href="#625fde3d-10" aria-hidden="true" tabindex="-1"></a>ax.plot(x, x<span class="op">**</span><span class="dv">3</span>, label<span class="op">=</span><span class="st">"cubic"</span>)  <span class="co"># ... and some more.</span></span>
<span id="625fde3d-11"><a href="#625fde3d-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"x label"</span>)  <span class="co"># Add an x-label to the Axes.</span></span>
<span id="625fde3d-12"><a href="#625fde3d-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"y label"</span>)  <span class="co"># Add a y-label to the Axes.</span></span>
<span id="625fde3d-13"><a href="#625fde3d-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Simple Plot"</span>)  <span class="co"># Add a title to the Axes.</span></span>
<span id="625fde3d-14"><a href="#625fde3d-14" aria-hidden="true" tabindex="-1"></a>ax.legend()  <span class="co"># Add a legend.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="matplotlib_files/figure-html/cell-4-output-1.png" width="491" height="270" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Source: <a href="https://matplotlib.org/stable/users/explain/quick_start.html">Documentation officielle de <code>matplotlib</code></a></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="d7fc0ae7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="d7fc0ae7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="d7fc0ae7-1"><a href="#d7fc0ae7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="d7fc0ae7-2"><a href="#d7fc0ae7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="d7fc0ae7-3"><a href="#d7fc0ae7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="d7fc0ae7-4"><a href="#d7fc0ae7-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">100</span>)  <span class="co"># Sample data.</span></span>
<span id="d7fc0ae7-5"><a href="#d7fc0ae7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="d7fc0ae7-6"><a href="#d7fc0ae7-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>), layout<span class="op">=</span><span class="st">"constrained"</span>)</span>
<span id="d7fc0ae7-7"><a href="#d7fc0ae7-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x, label<span class="op">=</span><span class="st">"linear"</span>)  <span class="co"># Plot some data on the (implicit) Axes.</span></span>
<span id="d7fc0ae7-8"><a href="#d7fc0ae7-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x<span class="op">**</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"quadratic"</span>)  <span class="co"># etc.</span></span>
<span id="d7fc0ae7-9"><a href="#d7fc0ae7-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x<span class="op">**</span><span class="dv">3</span>, label<span class="op">=</span><span class="st">"cubic"</span>)</span>
<span id="d7fc0ae7-10"><a href="#d7fc0ae7-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x label"</span>)</span>
<span id="d7fc0ae7-11"><a href="#d7fc0ae7-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"y label"</span>)</span>
<span id="d7fc0ae7-12"><a href="#d7fc0ae7-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Simple Plot"</span>)</span>
<span id="d7fc0ae7-13"><a href="#d7fc0ae7-13" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="matplotlib_files/figure-html/cell-5-output-1.png" width="491" height="270" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Source: <a href="https://matplotlib.org/stable/users/explain/quick_start.html">Documentation officielle de <code>matplotlib</code></a></p>
</div>
</div>
</div>
<p>Ces éléments constituent le minimum pour comprendre la logique de <code>matplotlib</code>. Pour être plus à l’aise avec ces concepts, la pratique répétée est indispensable.</p>
</section>
<section id="découvrir-matplotlib-par-lintermédiaire-de-pandas" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="découvrir-matplotlib-par-lintermédiaire-de-pandas"><span class="header-section-number">2.2</span> Découvrir <code>matplotlib</code> par l’intermédiaire de <code>Pandas</code></h2>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1: Create an Initial Plot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The data includes several dimensions that can be analyzed statistically. We’ll start by focusing on the volume of passage at various counting stations.</p>
<p>Since our goal is to summarize the information in our dataset, we first need to perform some <em>ad hoc</em> aggregations to create a readable plot.</p>
<ol type="1">
<li><p>Retain the ten stations with the highest average. To get an ordered plot from largest to smallest using <code>Pandas</code> plot methods, the data must be sorted from smallest to largest (yes, it’s odd but that’s how it works…). Sort the data accordingly.</p></li>
<li><p>Initially, without worrying about styling or aesthetics, create the structure of a <em>barplot</em> (bar chart) as seen on the
<a href="https://opendata.paris.fr/explore/dataset/comptage-velo-donnees-compteurs/dataviz/?disjunctive.id_compteur&amp;disjunctive.nom_compteur&amp;disjunctive.id&amp;disjunctive.name">data analysis page</a>.</p></li>
<li><p>To prepare for the second figure, retain only the 10 stations that recorded the highest total number of bicycles.</p></li>
<li><p>As in question 2, create a <em>barplot</em> to replicate figure 2 from the Paris open data portal.</p></li>
</ol>
</div>
</div>
</div>
<p>The top 10 stations from question 1 are those with the highest average bicycle traffic. These reordered data allow for creating a clear visualization highlighting the busiest stations.</p>
<div id="ce967089" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum_counts</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">nom_compteur</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">72 boulevard Voltaire NO-SE</td>
<td>157.567443</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27 quai de la Tournelle SE-NO</td>
<td>163.064454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Quai d'Orsay E-O</td>
<td>176.006612</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35 boulevard de Ménilmontant NO-SE</td>
<td>177.815658</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Totem 64 Rue de Rivoli Totem 64 Rue de Rivoli Vélos E-O</td>
<td>188.804384</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<details>
<summary>
<p>Figure 1, without any styling, displays the data in a basic <em>barplot</em>. While it conveys the essential information, it lacks aesthetic layout, harmonious colors, and clear annotations, which are necessary to improve readability and visual impact.</p>
</summary>
<div id="6fbdf1c7" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-9-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="matplotlib_files/figure-html/cell-9-output-1.png" width="945" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</details>
<div class="cell markdown">
<details>
<summary>
Figure 2 without styling:
</summary>
<div id="3d25d5bb" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="matplotlib_files/figure-html/cell-13-output-1.png" width="945" height="428" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</details>
</div>
<p>On commence à avoir quelque chose qui commence à transmettre
un message synthétique sur la nature des données.
On peut néanmoins remarquer plusieurs éléments problématiques
(par exemple les labels) mais
aussi des éléments ne correspondant pas (les titres des axes, etc.) ou
manquants (le nom du graphique…).</p>
<p>Comme les graphiques produits par <code>Pandas</code> suivent la logique très flexible de <code>matplotlib</code>, il est possible de les customiser. Cependant, cela demande généralement beaucoup de travail et la grammaire <code>matplotlib</code> n’est pas aussi normalisée que celle de <code>ggplot</code> en <code>R</code>.
Si on désire rester dans l’écosystème <code>matplotlib</code>, il est préférable de directement utiliser <code>seaborn</code>, qui offre quelques arguments prêts à l’emploi. Sinon on peut basculer sur l’écosystème <code>plotnine</code> qui offrira une syntaxe normalisée pour modifier les différents</p>
</section>
</section>
<section id="utiliser-directement-seaborn" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Utiliser directement <code>seaborn</code></h1>
<section id="comprendre-seaborn-en-quelques-lignes" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="comprendre-seaborn-en-quelques-lignes"><span class="header-section-number">3.1</span> Comprendre <code>seaborn</code> en quelques lignes</h2>
<p><code>seaborn</code> est une interface haut niveau au dessus de <code>matplotlib</code>. Ce package offre un ensemble de fonctionnalités pour créer des figures ou des axes <code>matplotlib</code> directement depuis une fonction admettant de nombreux arguments et, si besoin d’aller plus loin dans la customisation, d’utiliser les fonctionnalités de <code>matplotlib</code> pour mettre à jour la figure, que ce soit par le biais de l’approche implicite ou explicite décrites précédemment.</p>
<p>Comme pour <code>matplotlib</code>, <code>seaborn</code> permet de faire la même figure de multiples manières. <code>seaborn</code> hérite de la dualité axes-figures de <code>matplotlib</code> et il faudra souvent jouer avec un niveau ou l’autre. La principale caractéristique de <code>seaborn</code> est d’offrir quelques points d’entrées standardisés, par exemple <code>seaborn.relplot</code> ou <code>seaborn.catplot</code>, et une logique d’<em>inputs</em> basée sur le <code>DataFrame</code> là où <code>matplotlib</code> est structurée autour du <em>array</em> <code>Numpy</code>.</p>
<p>La figure comporte maintenant un message mais il est encore peu
lisible. Il y a plusieurs manières de faire un <em>barplot</em> en <code>seaborn</code>. Les deux principales
sont :</p>
<ul>
<li><code>sns.catplot</code> ;</li>
<li><code>sns.barplot</code>.</li>
</ul>
<p>On propose d’utiliser <code>sns.catplot</code> pour cet exercice. Il s’agit d’un point d’entrée assez fréquent pour faire des graphiques d’une variable discrétisée.</p>
</section>
<section id="le-diagramme-en-barre-barplot" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="le-diagramme-en-barre-barplot"><span class="header-section-number">3.2</span> Le diagramme en barre (<em>barplot</em>)</h2>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2: Reproduce the First Figure with Seaborn
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Reset the index of the dataframes <code>df1</code> and <code>df2</code> to have a column <em>‘Nom du compteur’</em>. Reorder the data in descending order to obtain a correctly ordered graph with <code>seaborn</code>.</p></li>
<li><p>Redo the previous graph using seaborn’s <code>catplot</code> function. To control the size of the graph, you can use the <code>height</code> and <code>aspect</code> arguments.</p></li>
<li><p>Add axis titles and the graph title for the first graph.</p></li>
<li><p>Try coloring the <code>x</code> axis in red. You can pre-define a style with <code>sns.set_style("ticks", {"xtick.color": "red"})</code>.</p></li>
</ol>
</div>
</div>
</div>
<p>A l’issue de la question 2, c’est-à-dire en utilisant
<code>seaborn</code> pour reproduire de manière minimale
un <em>barplot</em>, on obtient :</p>
<p>Après quelques réglages esthétiques, à l’issue des questions 3 et 4,
on obtient une figure proche de celle du portail <em>open data</em> parisien.</p>
<p>Les paramètres supplémentaires proposés à la question 4 permettent finalement d’obtenir la figure</p>
<p>On comprend ainsi que le boulevard de Sébastopol est le plus emprunté,
ce qui ne vous suprendra pas si vous faites du vélo à Paris.
Néanmoins, si vous n’êtes pas familiers avec la géographie parisienne,
cela sera peu informatif pour vous, vous allez avoir besoin d’une
représentation graphique supplémentaire: une carte ! Nous verrons
ceci lors d’un prochain chapitre.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 2bis : reproduire la figure “Les 10 compteurs ayant comptabilisé le plus de vélos”
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>En suivant l’approche graduelle de l’exercice 2,
refaire le graphique <em>Les 10 compteurs ayant comptabilisé le plus de vélos</em>
avec <code>seaborn</code></p>
</div>
</div>
</div>
</section>
<section id="un-exemple-dalternative-au-barplot-le-lollipop-chart" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="un-exemple-dalternative-au-barplot-le-lollipop-chart"><span class="header-section-number">3.3</span> Un exemple d’alternative au <em>barplot</em>, le <em>lollipop chart</em></h2>
<p>Les diagrammes en batons (<em>barplot</em>) sont extrêmement communs, sans doute à cause de l’héritage d’Excel où ces graphiques sont faisables en deux clics. Néanmoins, en ce qui concerne le message à transmettre, ils sont loin d’être parfaits. Par exemple, les barres prennent beaucoup d’espace visuel
ce qui peut brouiller le message à transmettre sur le rapport entre les observations.</p>
<p>Sur le plan sémiologique, c’est à dire sur le plan de l’efficacité du message à transmettre,
les <em>lollipop charts</em> sont préférables : ils
transmettent la même information mais avec moins de signes visuels pouvant brouiller sa compréhension.</p>
<p>Les <em>lollipop chart</em> ne sont pas parfaits non plus mais sont un peu plus efficaces pour transmettre le message. Pour en savoir plus sur les alternatives au <em>barplot</em>, la conférence d’Eric Mauvière pour le réseau des <em>data scientists</em> de la statistique publique, dont le message principal est <em>“Désempilez vos figures”</em> mérite le détour (<a href="https://ssphub.netlify.app/talk/2024-02-29-mauviere/">disponible sur le site ssphub.netlify.app/</a>)</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3 (optional): Reproduce Figure 2 with a lollipop chart
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Following the gradual approach of Exercise 2,
redo the graph <em>The 10 counters that have recorded the most bikes</em>.</p>
<p>💡 Don’t hesitate to consult <a href="https://python-graph-gallery.com/">python-graph-gallery.com/</a> or ask <code>ChatGPT</code> for help.</p>
</div>
</div>
</div>
<div id="ac368cf6" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>Text(0, 0.5, 'La somme des vélos comptabilisés sur la période sélectionnée')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-20-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="matplotlib_files/figure-html/cell-20-output-2.png" width="946" height="450" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="la-même-figure-avec-plotnine" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> La même figure avec <code>plotnine</code></h1>
<p><code>plotnine</code> est le nouveau venu dans l’écosystème de la visualisation en <code>Python</code>. Cette librairie est développée par <code>Posit</code>, l’entreprise à l’origine de l’éditeur <code>RStudio</code> et de l’écosystème du <em>tidyverse</em> si central dans le langage <code>R</code>. Cette librairie vise à importer la logique de <code>ggplot</code> en <code>Python</code> c’est à dire une grammaire des graphiques normalisée, lisible et flexible héritère de <span class="citation" data-cites="wilkinson2012grammar">Wilkinson (<a href="#ref-wilkinson2012grammar" role="doc-biblioref">2012</a>)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/elmo.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="L’état d’esprit des habitués de ggplot2 quand ils découvrent plotnine"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/elmo.jpg" class="img-fluid figure-img" alt="L’état d’esprit des habitués de ggplot2 quand ils découvrent plotnine"></a></p>
<figcaption>L’état d’esprit des habitués de <code>ggplot2</code>
quand ils découvrent <code>plotnine</code></figcaption>
</figure>
</div>
<p>Dans cette approche, un graphique est vu comme une succession de couches qui, une fois superposées, donneront la figure suivante. En soi, ce principe n’est pas différent de celui de <code>matplotlib</code>. Néanmoins, la grammaire utilisée par <code>plotnine</code> est beaucoup plus intuitive et normalisée ce qui offrira beaucoup plus d’autonomie pour modifier sa figure.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://psyteachr.github.io/data-skills-v2/images/corsi/layers.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="La logique de ggplot (et plotnine) par @Lisa_psyTeachR_Book_Template_2021, image elle-même empruntée à @field2012discovering"><img src="https://psyteachr.github.io/data-skills-v2/images/corsi/layers.png" class="img-fluid figure-img" alt="La logique de ggplot (et plotnine) par Lisa (2021), image elle-même empruntée à Field (2012)"></a></p>
<figcaption>La logique de <code>ggplot</code> (et <code>plotnine</code>) par <span class="citation" data-cites="Lisa_psyTeachR_Book_Template_2021">Lisa (<a href="#ref-Lisa_psyTeachR_Book_Template_2021" role="doc-biblioref">2021</a>)</span>, image elle-même empruntée à <span class="citation" data-cites="field2012discovering">Field (<a href="#ref-field2012discovering" role="doc-biblioref">2012</a>)</span></figcaption>
</figure>
</div>
<p>Avec <code>plotnine</code>, il n’y a plus de point d’entrée dual figure-axe. Comme l’illustrent les slides ci-dessous, :</p>
<ol type="1">
<li>On initialise une figure</li>
<li>On met à jour les couches (<em>layers</em>), un niveau d’abstraction très général concernant aussi bien les données représentées que les échelles des axes ou la couleur</li>
<li>A la fin, on peut jouer sur l’esthétique en modifiant les labels des axes, de la légende, les titres, etc.</li>
</ol>
<div class="cell markdown">
<p>Dérouler les <em>slides</em> ci-dessous ou <a href="../../slides/ggplot.qmd">cliquer ici</a>
pour afficher les slides en plein écran.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><iframe class="sourceCode yaml code-with-copy" src="https://rgeo.linogaliana.fr/slides/ggplot.html#/ggplot2"></iframe></div>
</div>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4: Reproduce the First Figure with plotnine
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This is the same exercise as Exercise 2. The objective is to create this figure with <code>plotnine</code>.</p>
</div>
</div>
</div>
<div id="6c500698" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-21-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="matplotlib_files/figure-html/cell-21-output-1.png" width="640" height="480" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="premières-agrégations-temporelles" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Premières agrégations temporelles</h1>
<p>On va maintenant se concentrer sur la dimension temporelle de notre
jeu de données à travers deux approches :</p>
<ul>
<li>Un diagramme en barre synthétisant l’information de notre jeu de données
de manière mensuelle ;</li>
<li>Des séries instructives sur la dynamique temporelle. Cela sera l’objet de la prochaine partie.</li>
</ul>
<p>Avant cela, nous allons enrichir ces données pour bénéficier d’un historique plus long, permettant notamment d’avoir la période Covid dans nos données, ce qui présente un intérêt du fait de la dynamique particulière du trafic dans cette période (arrêt brutal, reprise très forte…).</p>
<div id="99063f3a" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Voir le code pour bénéficier d’un historique plus long de données</summary>
<div class="sourceCode cell-code" id="99063f3a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="99063f3a-1"><a href="#99063f3a-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="99063f3a-2"><a href="#99063f3a-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="99063f3a-3"><a href="#99063f3a-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="99063f3a-4"><a href="#99063f3a-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="99063f3a-5"><a href="#99063f3a-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="99063f3a-6"><a href="#99063f3a-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="99063f3a-7"><a href="#99063f3a-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="99063f3a-8"><a href="#99063f3a-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-9"><a href="#99063f3a-9" aria-hidden="true" tabindex="-1"></a>list_useful_columns <span class="op">=</span> [</span>
<span id="99063f3a-10"><a href="#99063f3a-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Identifiant du compteur"</span>,</span>
<span id="99063f3a-11"><a href="#99063f3a-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nom du compteur"</span>,</span>
<span id="99063f3a-12"><a href="#99063f3a-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Identifiant du site de comptage"</span>,</span>
<span id="99063f3a-13"><a href="#99063f3a-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nom du site de comptage"</span>,</span>
<span id="99063f3a-14"><a href="#99063f3a-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Comptage horaire"</span>,</span>
<span id="99063f3a-15"><a href="#99063f3a-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Date et heure de comptage"</span>,</span>
<span id="99063f3a-16"><a href="#99063f3a-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="99063f3a-17"><a href="#99063f3a-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-18"><a href="#99063f3a-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-19"><a href="#99063f3a-19" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERIC FUNCTION TO RETRIEVE DATA -------------------------</span></span>
<span id="99063f3a-20"><a href="#99063f3a-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-21"><a href="#99063f3a-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-22"><a href="#99063f3a-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_unzip_and_read(</span>
<span id="99063f3a-23"><a href="#99063f3a-23" aria-hidden="true" tabindex="-1"></a>    url, extract_to<span class="op">=</span><span class="st">"."</span>, list_useful_columns<span class="op">=</span>list_useful_columns</span>
<span id="99063f3a-24"><a href="#99063f3a-24" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="99063f3a-25"><a href="#99063f3a-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="99063f3a-26"><a href="#99063f3a-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Downloads a zip file from the specified URL, extracts its contents, and reads the CSV file based on the filename pattern in the URL.</span></span>
<span id="99063f3a-27"><a href="#99063f3a-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-28"><a href="#99063f3a-28" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="99063f3a-29"><a href="#99063f3a-29" aria-hidden="true" tabindex="-1"></a><span class="co">    - url (str): The URL of the zip file to download.</span></span>
<span id="99063f3a-30"><a href="#99063f3a-30" aria-hidden="true" tabindex="-1"></a><span class="co">    - extract_to (str): The directory where the contents of the zip file should be extracted.</span></span>
<span id="99063f3a-31"><a href="#99063f3a-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-32"><a href="#99063f3a-32" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="99063f3a-33"><a href="#99063f3a-33" aria-hidden="true" tabindex="-1"></a><span class="co">    - df (DataFrame): The loaded pandas DataFrame from the extracted CSV file.</span></span>
<span id="99063f3a-34"><a href="#99063f3a-34" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="99063f3a-35"><a href="#99063f3a-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="99063f3a-36"><a href="#99063f3a-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the file pattern from the URL (filename without the extension)</span></span>
<span id="99063f3a-37"><a href="#99063f3a-37" aria-hidden="true" tabindex="-1"></a>        file_pattern <span class="op">=</span> url.split(<span class="st">"/"</span>)[<span class="op">-</span><span class="dv">1</span>].replace(<span class="st">"_zip/"</span>, <span class="st">""</span>)</span>
<span id="99063f3a-38"><a href="#99063f3a-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-39"><a href="#99063f3a-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send a GET request to the specified URL to download the file</span></span>
<span id="99063f3a-40"><a href="#99063f3a-40" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(url)</span>
<span id="99063f3a-41"><a href="#99063f3a-41" aria-hidden="true" tabindex="-1"></a>        response.raise_for_status()  <span class="co"># Ensure we get a successful response</span></span>
<span id="99063f3a-42"><a href="#99063f3a-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-43"><a href="#99063f3a-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a ZipFile object from the downloaded bytes</span></span>
<span id="99063f3a-44"><a href="#99063f3a-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> zipfile.ZipFile(io.BytesIO(response.content)) <span class="im">as</span> z:</span>
<span id="99063f3a-45"><a href="#99063f3a-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extract all the contents to the specified directory</span></span>
<span id="99063f3a-46"><a href="#99063f3a-46" aria-hidden="true" tabindex="-1"></a>            z.extractall(path<span class="op">=</span>extract_to)</span>
<span id="99063f3a-47"><a href="#99063f3a-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Extracted all files to </span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(extract_to)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="99063f3a-48"><a href="#99063f3a-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-49"><a href="#99063f3a-49" aria-hidden="true" tabindex="-1"></a>        dir_extract_to <span class="op">=</span> Path(extract_to)</span>
<span id="99063f3a-50"><a href="#99063f3a-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dir_extract_to = Path(f"./{file_pattern}/")</span></span>
<span id="99063f3a-51"><a href="#99063f3a-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-52"><a href="#99063f3a-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Look for the file matching the pattern</span></span>
<span id="99063f3a-53"><a href="#99063f3a-53" aria-hidden="true" tabindex="-1"></a>        csv_filename <span class="op">=</span> [f.name <span class="cf">for</span> f <span class="kw">in</span> dir_extract_to.iterdir() <span class="cf">if</span> f.suffix <span class="op">==</span> <span class="st">".csv"</span>]</span>
<span id="99063f3a-54"><a href="#99063f3a-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-55"><a href="#99063f3a-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> csv_filename:</span>
<span id="99063f3a-56"><a href="#99063f3a-56" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"No file matching pattern '</span><span class="sc">{</span>file_pattern<span class="sc">}</span><span class="ss">' found."</span>)</span>
<span id="99063f3a-57"><a href="#99063f3a-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="99063f3a-58"><a href="#99063f3a-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-59"><a href="#99063f3a-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Read the first matching CSV file into a pandas DataFrame</span></span>
<span id="99063f3a-60"><a href="#99063f3a-60" aria-hidden="true" tabindex="-1"></a>        csv_path <span class="op">=</span> os.path.join(dir_extract_to.name, csv_filename[<span class="dv">0</span>])</span>
<span id="99063f3a-61"><a href="#99063f3a-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Reading file: </span><span class="sc">{</span>csv_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="99063f3a-62"><a href="#99063f3a-62" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(csv_path, sep<span class="op">=</span><span class="st">";"</span>)</span>
<span id="99063f3a-63"><a href="#99063f3a-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-64"><a href="#99063f3a-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CONVERT TO GEOPANDAS</span></span>
<span id="99063f3a-65"><a href="#99063f3a-65" aria-hidden="true" tabindex="-1"></a>        df[[<span class="st">"latitude"</span>, <span class="st">"longitude"</span>]] <span class="op">=</span> df[<span class="st">"Coordonnées géographiques"</span>].<span class="bu">str</span>.split(</span>
<span id="99063f3a-66"><a href="#99063f3a-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">","</span>, expand<span class="op">=</span><span class="va">True</span></span>
<span id="99063f3a-67"><a href="#99063f3a-67" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="99063f3a-68"><a href="#99063f3a-68" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"latitude"</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">"latitude"</span>])</span>
<span id="99063f3a-69"><a href="#99063f3a-69" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"longitude"</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">"longitude"</span>])</span>
<span id="99063f3a-70"><a href="#99063f3a-70" aria-hidden="true" tabindex="-1"></a>        gdf <span class="op">=</span> gpd.GeoDataFrame(</span>
<span id="99063f3a-71"><a href="#99063f3a-71" aria-hidden="true" tabindex="-1"></a>            df, geometry<span class="op">=</span>gpd.points_from_xy(df.longitude, df.latitude)</span>
<span id="99063f3a-72"><a href="#99063f3a-72" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="99063f3a-73"><a href="#99063f3a-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-74"><a href="#99063f3a-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CONVERT TO TIMESTAMP</span></span>
<span id="99063f3a-75"><a href="#99063f3a-75" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Date et heure de comptage"</span>] <span class="op">=</span> (</span>
<span id="99063f3a-76"><a href="#99063f3a-76" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">"Date et heure de comptage"</span>]</span>
<span id="99063f3a-77"><a href="#99063f3a-77" aria-hidden="true" tabindex="-1"></a>            .astype(<span class="bu">str</span>)</span>
<span id="99063f3a-78"><a href="#99063f3a-78" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">str</span>.replace(<span class="vs">r"\+.*"</span>, <span class="st">""</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="99063f3a-79"><a href="#99063f3a-79" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="99063f3a-80"><a href="#99063f3a-80" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"Date et heure de comptage"</span>] <span class="op">=</span> pd.to_datetime(</span>
<span id="99063f3a-81"><a href="#99063f3a-81" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">"Date et heure de comptage"</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S"</span>, errors<span class="op">=</span><span class="st">"coerce"</span></span>
<span id="99063f3a-82"><a href="#99063f3a-82" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="99063f3a-83"><a href="#99063f3a-83" aria-hidden="true" tabindex="-1"></a>        gdf <span class="op">=</span> df.loc[:, list_useful_columns]</span>
<span id="99063f3a-84"><a href="#99063f3a-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> gdf</span>
<span id="99063f3a-85"><a href="#99063f3a-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-86"><a href="#99063f3a-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> requests.exceptions.RequestException <span class="im">as</span> e:</span>
<span id="99063f3a-87"><a href="#99063f3a-87" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error: The downloaded file has not been found: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="99063f3a-88"><a href="#99063f3a-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="99063f3a-89"><a href="#99063f3a-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> zipfile.BadZipFile <span class="im">as</span> e:</span>
<span id="99063f3a-90"><a href="#99063f3a-90" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error: The downloaded file is not a valid zip file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="99063f3a-91"><a href="#99063f3a-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="99063f3a-92"><a href="#99063f3a-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="99063f3a-93"><a href="#99063f3a-93" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"An error occurred: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="99063f3a-94"><a href="#99063f3a-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="99063f3a-95"><a href="#99063f3a-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-96"><a href="#99063f3a-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-97"><a href="#99063f3a-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_historical_bike_data(year):</span>
<span id="99063f3a-98"><a href="#99063f3a-98" aria-hidden="true" tabindex="-1"></a>    dataset <span class="op">=</span> <span class="st">"comptage_velo_donnees_compteurs"</span></span>
<span id="99063f3a-99"><a href="#99063f3a-99" aria-hidden="true" tabindex="-1"></a>    url_comptage <span class="op">=</span> <span class="ss">f"https://opendata.paris.fr/api/datasets/1.0/comptage-velo-historique-donnees-compteurs/attachments/</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss">_csv_zip/"</span></span>
<span id="99063f3a-100"><a href="#99063f3a-100" aria-hidden="true" tabindex="-1"></a>    df_comptage <span class="op">=</span> download_unzip_and_read(</span>
<span id="99063f3a-101"><a href="#99063f3a-101" aria-hidden="true" tabindex="-1"></a>        url_comptage, extract_to<span class="op">=</span><span class="ss">f"./extracted_files_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">"</span></span>
<span id="99063f3a-102"><a href="#99063f3a-102" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="99063f3a-103"><a href="#99063f3a-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df_comptage <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="99063f3a-104"><a href="#99063f3a-104" aria-hidden="true" tabindex="-1"></a>        url_comptage_alternative <span class="op">=</span> url_comptage.replace(<span class="st">"_csv_zip"</span>, <span class="st">"_zip"</span>)</span>
<span id="99063f3a-105"><a href="#99063f3a-105" aria-hidden="true" tabindex="-1"></a>        df_comptage <span class="op">=</span> download_unzip_and_read(</span>
<span id="99063f3a-106"><a href="#99063f3a-106" aria-hidden="true" tabindex="-1"></a>            url_comptage_alternative, extract_to<span class="op">=</span><span class="ss">f"./extracted_files_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">"</span></span>
<span id="99063f3a-107"><a href="#99063f3a-107" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="99063f3a-108"><a href="#99063f3a-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_comptage</span>
<span id="99063f3a-109"><a href="#99063f3a-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-110"><a href="#99063f3a-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-111"><a href="#99063f3a-111" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORT HISTORICAL DATA -----------------------------</span></span>
<span id="99063f3a-112"><a href="#99063f3a-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-113"><a href="#99063f3a-113" aria-hidden="true" tabindex="-1"></a>historical_bike_data <span class="op">=</span> pd.concat(</span>
<span id="99063f3a-114"><a href="#99063f3a-114" aria-hidden="true" tabindex="-1"></a>    [read_historical_bike_data(year) <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2018</span>, <span class="dv">2024</span>)]</span>
<span id="99063f3a-115"><a href="#99063f3a-115" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="99063f3a-116"><a href="#99063f3a-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-117"><a href="#99063f3a-117" aria-hidden="true" tabindex="-1"></a>rename_columns_dict <span class="op">=</span> {</span>
<span id="99063f3a-118"><a href="#99063f3a-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Identifiant du compteur"</span>: <span class="st">"id_compteur"</span>,</span>
<span id="99063f3a-119"><a href="#99063f3a-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nom du compteur"</span>: <span class="st">"nom_compteur"</span>,</span>
<span id="99063f3a-120"><a href="#99063f3a-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Identifiant du site de comptage"</span>: <span class="st">"id"</span>,</span>
<span id="99063f3a-121"><a href="#99063f3a-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nom du site de comptage"</span>: <span class="st">"nom_site"</span>,</span>
<span id="99063f3a-122"><a href="#99063f3a-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Comptage horaire"</span>: <span class="st">"sum_counts"</span>,</span>
<span id="99063f3a-123"><a href="#99063f3a-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Date et heure de comptage"</span>: <span class="st">"date"</span>,</span>
<span id="99063f3a-124"><a href="#99063f3a-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="99063f3a-125"><a href="#99063f3a-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-126"><a href="#99063f3a-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-127"><a href="#99063f3a-127" aria-hidden="true" tabindex="-1"></a>historical_bike_data <span class="op">=</span> historical_bike_data.rename(columns<span class="op">=</span>rename_columns_dict)</span>
<span id="99063f3a-128"><a href="#99063f3a-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-129"><a href="#99063f3a-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-130"><a href="#99063f3a-130" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORT LATEST MONTHS ----------------</span></span>
<span id="99063f3a-131"><a href="#99063f3a-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-132"><a href="#99063f3a-132" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="99063f3a-133"><a href="#99063f3a-133" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="99063f3a-134"><a href="#99063f3a-134" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="99063f3a-135"><a href="#99063f3a-135" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="99063f3a-136"><a href="#99063f3a-136" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="99063f3a-137"><a href="#99063f3a-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-138"><a href="#99063f3a-138" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://opendata.paris.fr/api/explore/v2.1/catalog/datasets/comptage-velo-donnees-compteurs/exports/parquet?lang=fr&amp;timezone=Europe</span><span class="sc">%2F</span><span class="st">Paris"</span></span>
<span id="99063f3a-139"><a href="#99063f3a-139" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">"comptage_velo_donnees_compteurs.parquet"</span></span>
<span id="99063f3a-140"><a href="#99063f3a-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-141"><a href="#99063f3a-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-142"><a href="#99063f3a-142" aria-hidden="true" tabindex="-1"></a><span class="co"># DOWNLOAD FILE --------------------------------</span></span>
<span id="99063f3a-143"><a href="#99063f3a-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-144"><a href="#99063f3a-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the HTTP request and stream the download</span></span>
<span id="99063f3a-145"><a href="#99063f3a-145" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)</span>
<span id="99063f3a-146"><a href="#99063f3a-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-147"><a href="#99063f3a-147" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(filename):</span>
<span id="99063f3a-148"><a href="#99063f3a-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform the HTTP request and stream the download</span></span>
<span id="99063f3a-149"><a href="#99063f3a-149" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)</span>
<span id="99063f3a-150"><a href="#99063f3a-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-151"><a href="#99063f3a-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the request was successful</span></span>
<span id="99063f3a-152"><a href="#99063f3a-152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="99063f3a-153"><a href="#99063f3a-153" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the total size of the file from the headers</span></span>
<span id="99063f3a-154"><a href="#99063f3a-154" aria-hidden="true" tabindex="-1"></a>        total_size <span class="op">=</span> <span class="bu">int</span>(response.headers.get(<span class="st">"content-length"</span>, <span class="dv">0</span>))</span>
<span id="99063f3a-155"><a href="#99063f3a-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-156"><a href="#99063f3a-156" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Open the file in write-binary mode and use tqdm to show progress</span></span>
<span id="99063f3a-157"><a href="#99063f3a-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">"wb"</span>) <span class="im">as</span> <span class="bu">file</span>, tqdm(</span>
<span id="99063f3a-158"><a href="#99063f3a-158" aria-hidden="true" tabindex="-1"></a>            desc<span class="op">=</span>filename,</span>
<span id="99063f3a-159"><a href="#99063f3a-159" aria-hidden="true" tabindex="-1"></a>            total<span class="op">=</span>total_size,</span>
<span id="99063f3a-160"><a href="#99063f3a-160" aria-hidden="true" tabindex="-1"></a>            unit<span class="op">=</span><span class="st">"B"</span>,</span>
<span id="99063f3a-161"><a href="#99063f3a-161" aria-hidden="true" tabindex="-1"></a>            unit_scale<span class="op">=</span><span class="va">True</span>,</span>
<span id="99063f3a-162"><a href="#99063f3a-162" aria-hidden="true" tabindex="-1"></a>            unit_divisor<span class="op">=</span><span class="dv">1024</span>,</span>
<span id="99063f3a-163"><a href="#99063f3a-163" aria-hidden="true" tabindex="-1"></a>        ) <span class="im">as</span> bar:</span>
<span id="99063f3a-164"><a href="#99063f3a-164" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Write the file in chunks</span></span>
<span id="99063f3a-165"><a href="#99063f3a-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">1024</span>):</span>
<span id="99063f3a-166"><a href="#99063f3a-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> chunk:  <span class="co"># filter out keep-alive chunks</span></span>
<span id="99063f3a-167"><a href="#99063f3a-167" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">file</span>.write(chunk)</span>
<span id="99063f3a-168"><a href="#99063f3a-168" aria-hidden="true" tabindex="-1"></a>                    bar.update(<span class="bu">len</span>(chunk))</span>
<span id="99063f3a-169"><a href="#99063f3a-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="99063f3a-170"><a href="#99063f3a-170" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Failed to download the file. Status code: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="99063f3a-171"><a href="#99063f3a-171" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="99063f3a-172"><a href="#99063f3a-172" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"The file '</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">' already exists."</span>)</span>
<span id="99063f3a-173"><a href="#99063f3a-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-174"><a href="#99063f3a-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-175"><a href="#99063f3a-175" aria-hidden="true" tabindex="-1"></a><span class="co"># READ FILE AND CONVERT TO PANDAS</span></span>
<span id="99063f3a-176"><a href="#99063f3a-176" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="99063f3a-177"><a href="#99063f3a-177" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT id_compteur, nom_compteur, id, sum_counts, date </span></span>
<span id="99063f3a-178"><a href="#99063f3a-178" aria-hidden="true" tabindex="-1"></a><span class="st">FROM read_parquet('comptage_velo_donnees_compteurs.parquet')</span></span>
<span id="99063f3a-179"><a href="#99063f3a-179" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="99063f3a-180"><a href="#99063f3a-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-181"><a href="#99063f3a-181" aria-hidden="true" tabindex="-1"></a><span class="co"># READ WITH DUCKDB AND CONVERT TO PANDAS</span></span>
<span id="99063f3a-182"><a href="#99063f3a-182" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> duckdb.sql(query).df()</span>
<span id="99063f3a-183"><a href="#99063f3a-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-184"><a href="#99063f3a-184" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>)</span>
<span id="99063f3a-185"><a href="#99063f3a-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-186"><a href="#99063f3a-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-187"><a href="#99063f3a-187" aria-hidden="true" tabindex="-1"></a><span class="co"># PUT THEM TOGETHER ----------------------------</span></span>
<span id="99063f3a-188"><a href="#99063f3a-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-189"><a href="#99063f3a-189" aria-hidden="true" tabindex="-1"></a>historical_bike_data[<span class="st">"date"</span>] <span class="op">=</span> historical_bike_data[<span class="st">"date"</span>].dt.tz_localize(<span class="va">None</span>)</span>
<span id="99063f3a-190"><a href="#99063f3a-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-191"><a href="#99063f3a-191" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"date"</span>] <span class="op">=</span> df[<span class="st">"date"</span>].dt.tz_localize(<span class="va">None</span>)</span>
<span id="99063f3a-192"><a href="#99063f3a-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-193"><a href="#99063f3a-193" aria-hidden="true" tabindex="-1"></a>historical_bike_data <span class="op">=</span> historical_bike_data.loc[</span>
<span id="99063f3a-194"><a href="#99063f3a-194" aria-hidden="true" tabindex="-1"></a>    historical_bike_data[<span class="st">"date"</span>] <span class="op">&lt;</span> df[<span class="st">"date"</span>].<span class="bu">min</span>()</span>
<span id="99063f3a-195"><a href="#99063f3a-195" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="99063f3a-196"><a href="#99063f3a-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="99063f3a-197"><a href="#99063f3a-197" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([historical_bike_data, df])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Pour commencer, reproduisons la troisième figure qui est, encore une fois,
un <em>barplot</em>. Ici, sur le plan sémiologique, ce n’est pas justifier d’utiliser un <em>barplot</em>, une simple série suffirait à fournir une information similaire.</p>
<p>La première question du prochain exerice implique une première rencontre avec
une donnée temporelle à travers une opération assez classique en séries
temporelles : changer le format d’une date pour pouvoir faire une agrégation
à un pas de temps plus large.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 5: Monthly Counts Barplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Create a <code>month</code> variable whose format follows, for example, the <code>2019-08</code> scheme using the correct option of the <code>dt.to_period</code> method.</p></li>
<li><p>Apply the previous tips to gradually build and improve a graph to obtain a figure similar to the 3rd production on the Parisian <em>open data</em> page. Create this figure first from early 2022 and then over the entire period of our history.</p></li>
<li><p>Optional Question: Represent the same information in the form of a <em>lollipop</em>.</p></li>
</ol>
</div>
</div>
</div>
<div id="44df93af" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2022-01</td>
<td>29.489743</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2022-02</td>
<td>34.567832</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>La figure avec les données depuis début 2022 aura cet aspect si elle a été construite avec <code>plotnine</code>:</p>
<div id="b54b696c" class="cell" data-execution_count="25">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-26-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="matplotlib_files/figure-html/cell-26-output-1.png" width="640" height="480" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Avec <code>seaborn</code>, elle ressemblera plutôt à ceci:</p>
<div id="d6afa875" class="cell" data-execution_count="26">
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Text(0.5, 1.0, 'Moyenne mensuelle des comptages vélos')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-27-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="matplotlib_files/figure-html/cell-27-output-2.png" width="1928" height="489" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Si vous préférez représenter cela sous forme de <em>lollipop</em><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>:</p>
<div id="558e1f37" class="cell" data-execution_count="27">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/mapping/evaluation.py:223</span>, in <span class="ansi-cyan-fg">evaluate</span><span class="ansi-blue-fg">(aesthetics, data, env)</span>
<span class="ansi-green-fg ansi-bold">    222</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 223</span>     new_val <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">env</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">eval</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">inner_namespace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    224</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> e:

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/mapping/_env.py:69</span>, in <span class="ansi-cyan-fg">Environment.eval</span><span class="ansi-blue-fg">(self, expr, inner_namespace)</span>
<span class="ansi-green-fg ansi-bold">     68</span> code <span style="color:rgb(98,98,98)">=</span> _compile_eval(expr)
<span class="ansi-green-fg">---&gt; 69</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">eval</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">     70</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">code</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">{</span><span class="ansi-yellow-bg">}</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">StackedLookup</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">inner_namespace</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">+</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">namespaces</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     71</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">&lt;string-expression&gt;:1</span>

<span class="ansi-red-fg">NameError</span>: name 'value' is not defined

The above exception was the direct cause of the following exception:

<span class="ansi-red-fg">PlotnineError</span>                             Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/IPython/core/formatters.py:925</span>, in <span class="ansi-cyan-fg">IPythonDisplayFormatter.__call__</span><span class="ansi-blue-fg">(self, obj)</span>
<span class="ansi-green-fg ansi-bold">    923</span> method <span style="color:rgb(98,98,98)">=</span> get_real_method(obj, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>print_method)
<span class="ansi-green-fg ansi-bold">    924</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> method <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">--&gt; 925</span>     <span class="ansi-yellow-bg">method</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    926</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="font-weight:bold;color:rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:141</span>, in <span class="ansi-cyan-fg">ggplot._ipython_display_</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    134</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">_ipython_display_</span>(<span style="color:rgb(0,135,0)">self</span>):
<span class="ansi-green-fg ansi-bold">    135</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    136</span> <span style="font-style:italic;color:rgb(175,0,0)">    Display plot in the output of the cell</span>
<span class="ansi-green-fg ansi-bold">    137</span> 
<span class="ansi-green-fg ansi-bold">    138</span> <span style="font-style:italic;color:rgb(175,0,0)">    This method will always be called when a ggplot object is the</span>
<span class="ansi-green-fg ansi-bold">    139</span> <span style="font-style:italic;color:rgb(175,0,0)">    last in the cell.</span>
<span class="ansi-green-fg ansi-bold">    140</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 141</span>     <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_display</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:175</span>, in <span class="ansi-cyan-fg">ggplot._display</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    172</span>     save_format <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">png</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    174</span> buf <span style="color:rgb(98,98,98)">=</span> BytesIO()
<span class="ansi-green-fg">--&gt; 175</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">save</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">buf</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">save_format</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">verbose</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">False</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    176</span> display_func <span style="color:rgb(98,98,98)">=</span> get_display_function(<span style="color:rgb(0,135,0)">format</span>)
<span class="ansi-green-fg ansi-bold">    177</span> display_func(buf<span style="color:rgb(98,98,98)">.</span>getvalue())

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:663</span>, in <span class="ansi-cyan-fg">ggplot.save</span><span class="ansi-blue-fg">(self, filename, format, path, width, height, units, dpi, limitsize, verbose, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    615</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">save</span>(
<span class="ansi-green-fg ansi-bold">    616</span>     <span style="color:rgb(0,135,0)">self</span>,
<span class="ansi-green-fg ansi-bold">    617</span>     filename: Optional[<span style="color:rgb(0,135,0)">str</span> <span style="color:rgb(98,98,98)">|</span> Path <span style="color:rgb(98,98,98)">|</span> BytesIO] <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    626</span>     <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs: Any,
<span class="ansi-green-fg ansi-bold">    627</span> ):
<span class="ansi-green-fg ansi-bold">    628</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    629</span> <span style="font-style:italic;color:rgb(175,0,0)">    Save a ggplot object as an image file</span>
<span class="ansi-green-fg ansi-bold">    630</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    661</span> <span style="font-style:italic;color:rgb(175,0,0)">        Additional arguments to pass to matplotlib `savefig()`.</span>
<span class="ansi-green-fg ansi-bold">    662</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 663</span>     sv <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">save_helper</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    664</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">filename</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    665</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    666</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">path</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    667</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">width</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">width</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    668</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">height</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">height</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    669</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">units</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">units</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    670</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">dpi</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">dpi</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    671</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">limitsize</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">limitsize</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    672</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">verbose</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">verbose</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    673</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    674</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    676</span>     <span style="font-weight:bold;color:rgb(0,135,0)">with</span> plot_context(<span style="color:rgb(0,135,0)">self</span>)<span style="color:rgb(98,98,98)">.</span>rc_context:
<span class="ansi-green-fg ansi-bold">    677</span>         sv<span style="color:rgb(98,98,98)">.</span>figure<span style="color:rgb(98,98,98)">.</span>savefig(<span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>sv<span style="color:rgb(98,98,98)">.</span>kwargs)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:612</span>, in <span class="ansi-cyan-fg">ggplot.save_helper</span><span class="ansi-blue-fg">(self, filename, format, path, width, height, units, dpi, limitsize, verbose, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    609</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> dpi <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">    610</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>theme <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>theme <span style="color:rgb(98,98,98)">+</span> theme(dpi<span style="color:rgb(98,98,98)">=</span>dpi)
<span class="ansi-green-fg">--&gt; 612</span> figure <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">draw</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">show</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">False</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    613</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> mpl_save_view(figure, fig_kwargs)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:272</span>, in <span class="ansi-cyan-fg">ggplot.draw</span><span class="ansi-blue-fg">(self, show)</span>
<span class="ansi-green-fg ansi-bold">    270</span> <span style="color:rgb(0,135,0)">self</span> <span style="color:rgb(98,98,98)">=</span> deepcopy(<span style="color:rgb(0,135,0)">self</span>)
<span class="ansi-green-fg ansi-bold">    271</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> plot_context(<span style="color:rgb(0,135,0)">self</span>, show<span style="color:rgb(98,98,98)">=</span>show):
<span class="ansi-green-fg">--&gt; 272</span>     <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_build</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    274</span>     <span style="font-style:italic;color:rgb(95,135,135)"># setup</span>
<span class="ansi-green-fg ansi-bold">    275</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>figure, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>axs <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>facet<span style="color:rgb(98,98,98)">.</span>setup(<span style="color:rgb(0,135,0)">self</span>)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:362</span>, in <span class="ansi-cyan-fg">ggplot._build</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    358</span> layout<span style="color:rgb(98,98,98)">.</span>setup(layers, <span style="color:rgb(0,135,0)">self</span>)
<span class="ansi-green-fg ansi-bold">    360</span> <span style="font-style:italic;color:rgb(95,135,135)"># Compute aesthetics to produce data with generalised</span>
<span class="ansi-green-fg ansi-bold">    361</span> <span style="font-style:italic;color:rgb(95,135,135)"># variable names</span>
<span class="ansi-green-fg">--&gt; 362</span> <span class="ansi-yellow-bg">layers</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">compute_aesthetics</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    364</span> <span style="font-style:italic;color:rgb(95,135,135)"># Transform data using all scales</span>
<span class="ansi-green-fg ansi-bold">    365</span> layers<span style="color:rgb(98,98,98)">.</span>transform(scales)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/layer.py:457</span>, in <span class="ansi-cyan-fg">Layers.compute_aesthetics</span><span class="ansi-blue-fg">(self, plot)</span>
<span class="ansi-green-fg ansi-bold">    455</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">compute_aesthetics</span>(<span style="color:rgb(0,135,0)">self</span>, plot: ggplot):
<span class="ansi-green-fg ansi-bold">    456</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> l <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">self</span>:
<span class="ansi-green-fg">--&gt; 457</span>         <span class="ansi-yellow-bg">l</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">compute_aesthetics</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">plot</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/layer.py:260</span>, in <span class="ansi-cyan-fg">layer.compute_aesthetics</span><span class="ansi-blue-fg">(self, plot)</span>
<span class="ansi-green-fg ansi-bold">    253</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">compute_aesthetics</span>(<span style="color:rgb(0,135,0)">self</span>, plot: ggplot):
<span class="ansi-green-fg ansi-bold">    254</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    255</span> <span style="font-style:italic;color:rgb(175,0,0)">    Return a dataframe where the columns match the aesthetic mappings</span>
<span class="ansi-green-fg ansi-bold">    256</span> 
<span class="ansi-green-fg ansi-bold">    257</span> <span style="font-style:italic;color:rgb(175,0,0)">    Transformations like 'factor(cyl)' and other</span>
<span class="ansi-green-fg ansi-bold">    258</span> <span style="font-style:italic;color:rgb(175,0,0)">    expression evaluation are  made in here</span>
<span class="ansi-green-fg ansi-bold">    259</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 260</span>     evaled <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">evaluate</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">mapping</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_starting</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">plot</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">environment</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    261</span>     evaled_aes <span style="color:rgb(98,98,98)">=</span> aes(<span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>{<span style="color:rgb(0,135,0)">str</span>(col): col <span style="font-weight:bold;color:rgb(0,135,0)">for</span> col <span style="font-weight:bold;color:rgb(175,0,255)">in</span> evaled})
<span class="ansi-green-fg ansi-bold">    262</span>     plot<span style="color:rgb(98,98,98)">.</span>scales<span style="color:rgb(98,98,98)">.</span>add_defaults(evaled, evaled_aes)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/mapping/evaluation.py:226</span>, in <span class="ansi-cyan-fg">evaluate</span><span class="ansi-blue-fg">(aesthetics, data, env)</span>
<span class="ansi-green-fg ansi-bold">    224</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg ansi-bold">    225</span>     msg <span style="color:rgb(98,98,98)">=</span> _TPL_EVAL_FAIL<span style="color:rgb(98,98,98)">.</span>format(ae, col, <span style="color:rgb(0,135,0)">str</span>(e))
<span class="ansi-green-fg">--&gt; 226</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> PlotnineError(msg) <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">e</span>
<span class="ansi-green-fg ansi-bold">    228</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg ansi-bold">    229</span>     evaled[ae] <span style="color:rgb(98,98,98)">=</span> new_val

<span class="ansi-red-fg">PlotnineError</span>: "Could not evaluate the 'y' mapping: 'value' (original error: name 'value' is not defined)"</pre>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.12/site-packages/IPython/lib/pretty.py:787: FutureWarning: Using repr(plot) to draw and show the plot figure is deprecated and will be removed in a future version. Use plot.show().</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/mapping/evaluation.py:223</span>, in <span class="ansi-cyan-fg">evaluate</span><span class="ansi-blue-fg">(aesthetics, data, env)</span>
<span class="ansi-green-fg ansi-bold">    222</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 223</span>     new_val <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">env</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">eval</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">inner_namespace</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    224</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> e:

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/mapping/_env.py:69</span>, in <span class="ansi-cyan-fg">Environment.eval</span><span class="ansi-blue-fg">(self, expr, inner_namespace)</span>
<span class="ansi-green-fg ansi-bold">     68</span> code <span style="color:rgb(98,98,98)">=</span> _compile_eval(expr)
<span class="ansi-green-fg">---&gt; 69</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">eval</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">     70</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">code</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">{</span><span class="ansi-yellow-bg">}</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">StackedLookup</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">inner_namespace</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">+</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">namespaces</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     71</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">&lt;string-expression&gt;:1</span>

<span class="ansi-red-fg">NameError</span>: name 'value' is not defined

The above exception was the direct cause of the following exception:

<span class="ansi-red-fg">PlotnineError</span>                             Traceback (most recent call last)
File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/IPython/core/formatters.py:711</span>, in <span class="ansi-cyan-fg">PlainTextFormatter.__call__</span><span class="ansi-blue-fg">(self, obj)</span>
<span class="ansi-green-fg ansi-bold">    704</span> stream <span style="color:rgb(98,98,98)">=</span> StringIO()
<span class="ansi-green-fg ansi-bold">    705</span> printer <span style="color:rgb(98,98,98)">=</span> pretty<span style="color:rgb(98,98,98)">.</span>RepresentationPrinter(stream, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>verbose,
<span class="ansi-green-fg ansi-bold">    706</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>max_width, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>newline,
<span class="ansi-green-fg ansi-bold">    707</span>     max_seq_length<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>max_seq_length,
<span class="ansi-green-fg ansi-bold">    708</span>     singleton_pprinters<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>singleton_printers,
<span class="ansi-green-fg ansi-bold">    709</span>     type_pprinters<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>type_printers,
<span class="ansi-green-fg ansi-bold">    710</span>     deferred_pprinters<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>deferred_printers)
<span class="ansi-green-fg">--&gt; 711</span> <span class="ansi-yellow-bg">printer</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">pretty</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">obj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    712</span> printer<span style="color:rgb(98,98,98)">.</span>flush()
<span class="ansi-green-fg ansi-bold">    713</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> stream<span style="color:rgb(98,98,98)">.</span>getvalue()

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/IPython/lib/pretty.py:419</span>, in <span class="ansi-cyan-fg">RepresentationPrinter.pretty</span><span class="ansi-blue-fg">(self, obj)</span>
<span class="ansi-green-fg ansi-bold">    408</span>                         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> meth(obj, <span style="color:rgb(0,135,0)">self</span>, cycle)
<span class="ansi-green-fg ansi-bold">    409</span>                 <span style="font-weight:bold;color:rgb(0,135,0)">if</span> (
<span class="ansi-green-fg ansi-bold">    410</span>                     <span style="color:rgb(0,135,0)">cls</span> <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="color:rgb(0,135,0)">object</span>
<span class="ansi-green-fg ansi-bold">    411</span>                     <span style="font-style:italic;color:rgb(95,135,135)"># check if cls defines __repr__</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    417</span>                     <span style="font-weight:bold;color:rgb(175,0,255)">and</span> <span style="color:rgb(0,135,0)">callable</span>(_safe_getattr(<span style="color:rgb(0,135,0)">cls</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">__repr__</span><span style="color:rgb(175,0,0)">"</span>, <span style="font-weight:bold;color:rgb(0,135,0)">None</span>))
<span class="ansi-green-fg ansi-bold">    418</span>                 ):
<span class="ansi-green-fg">--&gt; 419</span>                     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">_repr_pprint</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">obj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cycle</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    421</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> _default_pprint(obj, <span style="color:rgb(0,135,0)">self</span>, cycle)
<span class="ansi-green-fg ansi-bold">    422</span> <span style="font-weight:bold;color:rgb(0,135,0)">finally</span>:

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/IPython/lib/pretty.py:787</span>, in <span class="ansi-cyan-fg">_repr_pprint</span><span class="ansi-blue-fg">(obj, p, cycle)</span>
<span class="ansi-green-fg ansi-bold">    785</span> <span style="font-style:italic;color:rgb(175,0,0)">"""A pprint that just redirects to the normal repr function."""</span>
<span class="ansi-green-fg ansi-bold">    786</span> <span style="font-style:italic;color:rgb(95,135,135)"># Find newlines and replace them with p.break_()</span>
<span class="ansi-green-fg">--&gt; 787</span> output <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">repr</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">obj</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    788</span> lines <span style="color:rgb(98,98,98)">=</span> output<span style="color:rgb(98,98,98)">.</span>splitlines()
<span class="ansi-green-fg ansi-bold">    789</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> p<span style="color:rgb(98,98,98)">.</span>group():

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:131</span>, in <span class="ansi-cyan-fg">ggplot.__repr__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    125</span> msg <span style="color:rgb(98,98,98)">=</span> (
<span class="ansi-green-fg ansi-bold">    126</span>     <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Using repr(plot) to draw and show the plot figure is </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    127</span>     <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">deprecated and will be removed in a future version. </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    128</span>     <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Use plot.show().</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    129</span> )
<span class="ansi-green-fg ansi-bold">    130</span> warn(msg, category<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(215,95,95)">FutureWarning</span>, stacklevel<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">2</span>)
<span class="ansi-green-fg">--&gt; 131</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">show</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    132</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">&lt;Figure Size: (</span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>W<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)"> x </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>H<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">)&gt;</span><span style="color:rgb(175,0,0)">"</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:150</span>, in <span class="ansi-cyan-fg">ggplot.show</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    143</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">show</span>(<span style="color:rgb(0,135,0)">self</span>):
<span class="ansi-green-fg ansi-bold">    144</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    145</span> <span style="font-style:italic;color:rgb(175,0,0)">    Show plot using the matplotlib backend set by the user</span>
<span class="ansi-green-fg ansi-bold">    146</span> 
<span class="ansi-green-fg ansi-bold">    147</span> <span style="font-style:italic;color:rgb(175,0,0)">    Users should prefer this method instead of printing or repring</span>
<span class="ansi-green-fg ansi-bold">    148</span> <span style="font-style:italic;color:rgb(175,0,0)">    the object.</span>
<span class="ansi-green-fg ansi-bold">    149</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 150</span>     <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_display</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> is_inline_backend() <span style="font-weight:bold;color:rgb(0,135,0)">else</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>draw(show<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:175</span>, in <span class="ansi-cyan-fg">ggplot._display</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    172</span>     save_format <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">png</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    174</span> buf <span style="color:rgb(98,98,98)">=</span> BytesIO()
<span class="ansi-green-fg">--&gt; 175</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">save</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">buf</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">save_format</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">verbose</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">False</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    176</span> display_func <span style="color:rgb(98,98,98)">=</span> get_display_function(<span style="color:rgb(0,135,0)">format</span>)
<span class="ansi-green-fg ansi-bold">    177</span> display_func(buf<span style="color:rgb(98,98,98)">.</span>getvalue())

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:663</span>, in <span class="ansi-cyan-fg">ggplot.save</span><span class="ansi-blue-fg">(self, filename, format, path, width, height, units, dpi, limitsize, verbose, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    615</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">save</span>(
<span class="ansi-green-fg ansi-bold">    616</span>     <span style="color:rgb(0,135,0)">self</span>,
<span class="ansi-green-fg ansi-bold">    617</span>     filename: Optional[<span style="color:rgb(0,135,0)">str</span> <span style="color:rgb(98,98,98)">|</span> Path <span style="color:rgb(98,98,98)">|</span> BytesIO] <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    626</span>     <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs: Any,
<span class="ansi-green-fg ansi-bold">    627</span> ):
<span class="ansi-green-fg ansi-bold">    628</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    629</span> <span style="font-style:italic;color:rgb(175,0,0)">    Save a ggplot object as an image file</span>
<span class="ansi-green-fg ansi-bold">    630</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    661</span> <span style="font-style:italic;color:rgb(175,0,0)">        Additional arguments to pass to matplotlib `savefig()`.</span>
<span class="ansi-green-fg ansi-bold">    662</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 663</span>     sv <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">save_helper</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    664</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">filename</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    665</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">format</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    666</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">path</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    667</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">width</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">width</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    668</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">height</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">height</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    669</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">units</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">units</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    670</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">dpi</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">dpi</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    671</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">limitsize</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">limitsize</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    672</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">verbose</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">verbose</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    673</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    674</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    676</span>     <span style="font-weight:bold;color:rgb(0,135,0)">with</span> plot_context(<span style="color:rgb(0,135,0)">self</span>)<span style="color:rgb(98,98,98)">.</span>rc_context:
<span class="ansi-green-fg ansi-bold">    677</span>         sv<span style="color:rgb(98,98,98)">.</span>figure<span style="color:rgb(98,98,98)">.</span>savefig(<span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>sv<span style="color:rgb(98,98,98)">.</span>kwargs)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:612</span>, in <span class="ansi-cyan-fg">ggplot.save_helper</span><span class="ansi-blue-fg">(self, filename, format, path, width, height, units, dpi, limitsize, verbose, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    609</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> dpi <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">    610</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>theme <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>theme <span style="color:rgb(98,98,98)">+</span> theme(dpi<span style="color:rgb(98,98,98)">=</span>dpi)
<span class="ansi-green-fg">--&gt; 612</span> figure <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">draw</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">show</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">False</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    613</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> mpl_save_view(figure, fig_kwargs)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:272</span>, in <span class="ansi-cyan-fg">ggplot.draw</span><span class="ansi-blue-fg">(self, show)</span>
<span class="ansi-green-fg ansi-bold">    270</span> <span style="color:rgb(0,135,0)">self</span> <span style="color:rgb(98,98,98)">=</span> deepcopy(<span style="color:rgb(0,135,0)">self</span>)
<span class="ansi-green-fg ansi-bold">    271</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> plot_context(<span style="color:rgb(0,135,0)">self</span>, show<span style="color:rgb(98,98,98)">=</span>show):
<span class="ansi-green-fg">--&gt; 272</span>     <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_build</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    274</span>     <span style="font-style:italic;color:rgb(95,135,135)"># setup</span>
<span class="ansi-green-fg ansi-bold">    275</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>figure, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>axs <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>facet<span style="color:rgb(98,98,98)">.</span>setup(<span style="color:rgb(0,135,0)">self</span>)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/ggplot.py:362</span>, in <span class="ansi-cyan-fg">ggplot._build</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    358</span> layout<span style="color:rgb(98,98,98)">.</span>setup(layers, <span style="color:rgb(0,135,0)">self</span>)
<span class="ansi-green-fg ansi-bold">    360</span> <span style="font-style:italic;color:rgb(95,135,135)"># Compute aesthetics to produce data with generalised</span>
<span class="ansi-green-fg ansi-bold">    361</span> <span style="font-style:italic;color:rgb(95,135,135)"># variable names</span>
<span class="ansi-green-fg">--&gt; 362</span> <span class="ansi-yellow-bg">layers</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">compute_aesthetics</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    364</span> <span style="font-style:italic;color:rgb(95,135,135)"># Transform data using all scales</span>
<span class="ansi-green-fg ansi-bold">    365</span> layers<span style="color:rgb(98,98,98)">.</span>transform(scales)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/layer.py:457</span>, in <span class="ansi-cyan-fg">Layers.compute_aesthetics</span><span class="ansi-blue-fg">(self, plot)</span>
<span class="ansi-green-fg ansi-bold">    455</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">compute_aesthetics</span>(<span style="color:rgb(0,135,0)">self</span>, plot: ggplot):
<span class="ansi-green-fg ansi-bold">    456</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> l <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">self</span>:
<span class="ansi-green-fg">--&gt; 457</span>         <span class="ansi-yellow-bg">l</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">compute_aesthetics</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">plot</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/layer.py:260</span>, in <span class="ansi-cyan-fg">layer.compute_aesthetics</span><span class="ansi-blue-fg">(self, plot)</span>
<span class="ansi-green-fg ansi-bold">    253</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">compute_aesthetics</span>(<span style="color:rgb(0,135,0)">self</span>, plot: ggplot):
<span class="ansi-green-fg ansi-bold">    254</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    255</span> <span style="font-style:italic;color:rgb(175,0,0)">    Return a dataframe where the columns match the aesthetic mappings</span>
<span class="ansi-green-fg ansi-bold">    256</span> 
<span class="ansi-green-fg ansi-bold">    257</span> <span style="font-style:italic;color:rgb(175,0,0)">    Transformations like 'factor(cyl)' and other</span>
<span class="ansi-green-fg ansi-bold">    258</span> <span style="font-style:italic;color:rgb(175,0,0)">    expression evaluation are  made in here</span>
<span class="ansi-green-fg ansi-bold">    259</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg">--&gt; 260</span>     evaled <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">evaluate</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">mapping</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_starting</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">plot</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">environment</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    261</span>     evaled_aes <span style="color:rgb(98,98,98)">=</span> aes(<span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>{<span style="color:rgb(0,135,0)">str</span>(col): col <span style="font-weight:bold;color:rgb(0,135,0)">for</span> col <span style="font-weight:bold;color:rgb(175,0,255)">in</span> evaled})
<span class="ansi-green-fg ansi-bold">    262</span>     plot<span style="color:rgb(98,98,98)">.</span>scales<span style="color:rgb(98,98,98)">.</span>add_defaults(evaled, evaled_aes)

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/plotnine/mapping/evaluation.py:226</span>, in <span class="ansi-cyan-fg">evaluate</span><span class="ansi-blue-fg">(aesthetics, data, env)</span>
<span class="ansi-green-fg ansi-bold">    224</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg ansi-bold">    225</span>     msg <span style="color:rgb(98,98,98)">=</span> _TPL_EVAL_FAIL<span style="color:rgb(98,98,98)">.</span>format(ae, col, <span style="color:rgb(0,135,0)">str</span>(e))
<span class="ansi-green-fg">--&gt; 226</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> PlotnineError(msg) <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">e</span>
<span class="ansi-green-fg ansi-bold">    228</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg ansi-bold">    229</span>     evaled[ae] <span style="color:rgb(98,98,98)">=</span> new_val

<span class="ansi-red-fg">PlotnineError</span>: "Could not evaluate the 'y' mapping: 'value' (original error: name 'value' is not defined)"</pre>
</div>
</div>
</div>
<p>Enfin, sur l’ensemble de la période, la série prendra plutôt cette forme:</p>
<div id="7c495cca" class="cell" data-execution_count="28">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-29-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="matplotlib_files/figure-html/cell-29-output-1.png" width="640" height="480" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="première-série-temporelle" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Première série temporelle</h1>
<p>Il est plus commun de représenter les données ayant une dimension temporelle
sous la forme de série
que de barres empilées.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 5: barplot des comptages mensuels
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Créer une variable <code>day</code> qui transforme l’horodatage en format journalier
du type <code>2021-05-01</code> avec <code>dt.day</code>.</li>
<li>Reproduire la figure de la page d’<em>open data</em></li>
</ol>
</div>
</div>
</div>
<div id="1d289e27" class="cell" data-execution_count="30">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="matplotlib_files/figure-html/cell-31-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="matplotlib_files/figure-html/cell-31-output-1.png" width="640" height="480" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="des-graphiques-réactifs-grâce-aux-librairies-javascript" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Des graphiques réactifs grâce aux librairies <code>Javascript</code></h1>
<section id="lécosystème-disponible-depuis-python" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="lécosystème-disponible-depuis-python"><span class="header-section-number">7.1</span> L’écosystème disponible depuis <code>Python</code></h2>
<p>L’inconvénient des figures figées construites avec <code>matplotlib</code> ou <code>plotnine</code> est que celles-ci ne permettent
pas d’interaction avec le lecteur. Toute l’information doit donc être
contenue dans la figure ce qui peut la rendre difficile à lire.
Si la figure est bien faite, avec différents niveaux d’information, cela
peut bien fonctionner.</p>
<p>Il est néanmoins plus simple, grâce aux technologies <em>web</em>, de proposer des
visualisations à plusieurs niveaux. Un premier niveau d’information, celui du
coup d’oeil, peut suffire à assimiler les principaux messages de la
visualisation. Ensuite, un comportement plus volontaire de recherche
d’information secondaire peut permettre d’en savoir plus. Les visualisations
réactives, qui sont maintenant la norme dans le monde de la <em>dataviz</em>,
permettent ce type d’approche : le lecteur d’une visualisation peut passer
sa souris à la recherche d’information complémentaire (par exemple les
valeurs exactes) ou cliquer pour faire apparaître des informations complémentaires
sur la visualisation ou autour.</p>
<p>Ces visualisations reposent sur le même triptyque que l’ensemble de l’écosystème
<em>web</em> : <code>HTML</code>, <code>CSS</code> et <code>JavaScript</code>. Les utilisateurs de <code>Python</code>
ne vont jamais manipuler directement ces langages, qui demandent une
certaine expertise, mais vont utiliser des librairies au niveau de <code>R</code> qui génèreront automatiquement tout le code <code>HTML</code>, <code>CSS</code> et <code>JavaScript</code>
permettant de créer la figure.</p>
<p>Il existe plusieurs écosystèmes <code>Javascript</code> mis à disposition des développeurs.euses par le biais de <code>Python</code>. Les deux principales librairies sont <a href="https://plotly.com/python/"><code>Plotly</code></a>, associée à l’écosystème <code>Javascript</code> du même nom, et <a href="https://altair-viz.github.io/"><code>Altair</code></a>, associée à l’écosystème <code>Vega</code> et <code>Altair</code> en <code>Javascript</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. Pour permettre aux pythonistes de découvrir la librairie <code>Javascript</code> émergente <a href="https://observablehq.com/plot/"><code>Observable Plot</code></a>, l’ingénieur de recherche français Julien Barnier a développé <a href="https://juba.github.io/pyobsplot/"><code>pyobsplot</code></a> une librairie <code>Python</code> permettant d’utiliser cet écosystème depuis <code>Python</code>.</p>
<p>L’interactivité ne doit pas juste être un gadget n’apportant pas de lisibilité supplémentaire, voire la détériorant. Il est rare de pouvoir se contenter de la figure produite sans avoir à fournir un travail supplémentaire pour la rendre efficace.</p>
<section id="la-librairie-plotly" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="la-librairie-plotly"><span class="header-section-number">7.1.1</span> La librairie <code>Plotly</code></h3>
<p>Le package <code>Plotly</code> est une surcouche à la librairie <code>Javascript</code>
<code>Plotly.js</code> qui permet de créer et manipuler des objets graphiques de manière
très flexible afin de produire des objets réactifs sans avoir à recourir
à Javascript.</p>
<p>Le point d’entrée recommandé est le module <code>plotly.express</code>
(<a href="https://plotly.com/python/plotly-express/">documentation ici</a>) qui offre une approche intuitive pour construire des graphiques pouvant être modifiés <em>a posteriori</em> si besoin (par exemple pour <em>customiser</em> les axes).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualiser les figures produites par Plotly
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Dans un <em>notebook</em> <code>Jupyter</code> classique, les lignes suivantes de code permettent d’afficher le résultat d’une commande <code>Plotly</code> sous un bloc de code :</p>
<p>Pour <code>JupyterLab</code>, l’extension <code>jupyterlab-plotly</code> s’avère nécessaire:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>jupyter labextension install jupyterlab<span class="op">-</span>plotly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="réplication-de-lexemple-précédent-avec-plotly" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="réplication-de-lexemple-précédent-avec-plotly"><span class="header-section-number">7.2</span> Réplication de l’exemple précédent avec <code>Plotly</code></h2>
<p>Les modules suivants seront nécessaires pour construire des graphiques
avec <code>plotly</code>:</p>
<div id="c9d9d225" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="c9d9d225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c9d9d225-1"><a href="#c9d9d225-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly</span>
<span id="c9d9d225-2"><a href="#c9d9d225-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 7: un barplot avec Plotly
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>L’objectif est de reconstuire le premier diagramme en barre rouge avec <code>Plotly</code>.</p>
<ol type="1">
<li>Réalisez le graphique en utilisant la fonction adéquate avec <code>plotly.express</code> et…
<ul>
<li>Ne pas prendre le
thème par défaut mais un à fond blanc, pour avoir un résultat ressemblant
à celui proposé sur le site de l’<em>open-data</em>.</li>
<li>Pour la couleur rouge,
vous pouvez utiliser l’argument <code>color_discrete_sequence</code>.</li>
<li>Ne pas oublier de nommer les axes</li>
<li>Pensez à la couleur du texte de l’axe inférieur</li>
</ul></li>
<li>Tester un autre thème, à fond sombre. Pour les couleurs, faire un
groupe stockant les trois plus fortes valeurs puis les autres.</li>
</ol>
</div>
</div>
</div>
<p>La première question permet de construire le graphique suivant :</p>
<div id="c807af6d" class="cell" data-execution_count="36">
<div class="cell-output cell-output-display">
<div>                            <div id="0e65dfe8-a577-4660-bcfc-5a92ae93ab84" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0e65dfe8-a577-4660-bcfc-5a92ae93ab84")) {                    Plotly.newPlot(                        "0e65dfe8-a577-4660-bcfc-5a92ae93ab84",                        [{"alignmentgroup":"True","hovertemplate":"sum_counts=%{x}\u003cbr\u003enom_compteur=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"red","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"h","showlegend":false,"textposition":"auto","x":[157.56744281464765,163.06445429495628,176.00661241098678,177.81565836298932,188.8043836180284,215.555058464667,217.11621759023893,228.54538897475527,232.88154550076257,324.2450476889215],"xaxis":"x","y":["72 boulevard Voltaire NO-SE","27 quai de la Tournelle SE-NO","Quai d'Orsay E-O","35 boulevard de Ménilmontant NO-SE","Totem 64 Rue de Rivoli Totem 64 Rue de Rivoli Vélos E-O","89 boulevard de Magenta NO-SE","102 boulevard de Magenta SE-NO","Totem 64 Rue de Rivoli Totem 64 Rue de Rivoli Vélos O-E","Totem 73 boulevard de Sébastopol N-S","Totem 73 boulevard de Sébastopol S-N"],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Moyenne du comptage par heure sur la période sélectionnée","font":{"color":"red"}}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"nom_compteur"}},"legend":{"tracegroupgap":0},"barmode":"relative","title":{"text":"Les 10 compteurs avec la moyenne horaire la plus élevée"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('0e65dfe8-a577-4660-bcfc-5a92ae93ab84');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Alors qu’avec le thème sombre (question 2), on obtient :</p>
<div id="8dd7e49f" class="cell" data-execution_count="37">
<div class="cell-output cell-output-display">
<div>                            <div id="6efef170-4f83-44cf-a0fb-2ea2f8b2ce66" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6efef170-4f83-44cf-a0fb-2ea2f8b2ce66")) {                    Plotly.newPlot(                        "6efef170-4f83-44cf-a0fb-2ea2f8b2ce66",                        [{"alignmentgroup":"True","hovertemplate":"top=False\u003cbr\u003esum_counts=%{x}\u003cbr\u003enom_compteur=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"False","marker":{"color":"red","pattern":{"shape":""}},"name":"False","offsetgroup":"False","orientation":"h","showlegend":true,"textposition":"auto","x":[157.56744281464765,163.06445429495628,176.00661241098678,177.81565836298932],"xaxis":"x","y":["72 boulevard Voltaire NO-SE","27 quai de la Tournelle SE-NO","Quai d'Orsay E-O","35 boulevard de Ménilmontant NO-SE"],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"top=True\u003cbr\u003esum_counts=%{x}\u003cbr\u003enom_compteur=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"True","marker":{"color":"green","pattern":{"shape":""}},"name":"True","offsetgroup":"True","orientation":"h","showlegend":true,"textposition":"auto","x":[188.8043836180284,215.555058464667,217.11621759023893,228.54538897475527,232.88154550076257,324.2450476889215],"xaxis":"x","y":["Totem 64 Rue de Rivoli Totem 64 Rue de Rivoli Vélos E-O","89 boulevard de Magenta NO-SE","102 boulevard de Magenta SE-NO","Totem 64 Rue de Rivoli Totem 64 Rue de Rivoli Vélos O-E","Totem 73 boulevard de Sébastopol N-S","Totem 73 boulevard de Sébastopol S-N"],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Moyenne du comptage par heure sur la période sélectionnée"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"nom_compteur"}},"legend":{"title":{"text":"top"},"tracegroupgap":0},"barmode":"relative","title":{"text":"Les 10 compteurs avec la moyenne horaire la plus élevée"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6efef170-4f83-44cf-a0fb-2ea2f8b2ce66');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="la-librairie-altair" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="la-librairie-altair"><span class="header-section-number">7.3</span> La librairie <code>altair</code></h2>
<p>Pour cet exemple, nous allons reconstruire notre figure précédente</p>
<p>Comme <code>ggplot</code>/<code>plotnine</code>, <code>Vega</code> est un écosystème graphique visant à proposer une implémentation de la grammaire des graphiques de <span class="citation" data-cites="wilkinson2012grammar">Wilkinson (<a href="#ref-wilkinson2012grammar" role="doc-biblioref">2012</a>)</span>. La syntaxe de <code>Vega</code> est donc basée sur un principe déclaratif: on déclare une construction par couches et transformations de données progressives.</p>
<p>A l’origine, <code>Vega</code> est basée sur une syntaxe JSON, d’où son lien fort avec <code>Javascript</code>. Néanmoins, il existe une API Python qui permet de faire ce type de figures interactives nativement en Python. Pour comprendre la logique de construction d’un code <code>altair</code>, voici comment répliquer la figure précédente avec:</p>
<div id="71ea1028" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Voir l’architecture d’une figure altair</summary>
<div class="sourceCode cell-code" id="71ea1028"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="71ea1028-1"><a href="#71ea1028-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="71ea1028-2"><a href="#71ea1028-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="71ea1028-3"><a href="#71ea1028-3" aria-hidden="true" tabindex="-1"></a>color_scale <span class="op">=</span> alt.Scale(domain<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>], <span class="bu">range</span><span class="op">=</span>[<span class="st">"green"</span>, <span class="st">"red"</span>])</span>
<span id="71ea1028-4"><a href="#71ea1028-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="71ea1028-5"><a href="#71ea1028-5" aria-hidden="true" tabindex="-1"></a>fig2 <span class="op">=</span> (</span>
<span id="71ea1028-6"><a href="#71ea1028-6" aria-hidden="true" tabindex="-1"></a>    alt.Chart(df1)</span>
<a class="code-annotation-anchor" data-target-cell="71ea1028" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="71ea1028-7" class="code-annotation-target"><a href="#71ea1028-7" aria-hidden="true" tabindex="-1"></a>    .mark_bar()</span>
<a class="code-annotation-anchor" data-target-cell="71ea1028" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="71ea1028-8" class="code-annotation-target"><a href="#71ea1028-8" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="71ea1028-9"><a href="#71ea1028-9" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(</span>
<span id="71ea1028-10"><a href="#71ea1028-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"average(sum_counts):Q"</span>,</span>
<span id="71ea1028-11"><a href="#71ea1028-11" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"Moyenne du comptage par heure sur la période sélectionnée"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="71ea1028" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="71ea1028-12" class="code-annotation-target"><a href="#71ea1028-12" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="71ea1028-13"><a href="#71ea1028-13" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">"nom_compteur:N"</span>, sort<span class="op">=</span><span class="st">"-x"</span>, title<span class="op">=</span><span class="st">""</span>),</span>
<span id="71ea1028-14"><a href="#71ea1028-14" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>alt.Color(<span class="st">"top:N"</span>, scale<span class="op">=</span>color_scale, legend<span class="op">=</span>alt.Legend(title<span class="op">=</span><span class="st">"Top"</span>)),</span>
<span id="71ea1028-15"><a href="#71ea1028-15" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[</span>
<span id="71ea1028-16"><a href="#71ea1028-16" aria-hidden="true" tabindex="-1"></a>            alt.Tooltip(<span class="st">"nom_compteur:N"</span>, title<span class="op">=</span><span class="st">"Nom du compteur"</span>),</span>
<span id="71ea1028-17"><a href="#71ea1028-17" aria-hidden="true" tabindex="-1"></a>            alt.Tooltip(<span class="st">"sum_counts:Q"</span>, title<span class="op">=</span><span class="st">"Moyenne horaire"</span>),</span>
<a class="code-annotation-anchor" data-target-cell="71ea1028" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="71ea1028-18" class="code-annotation-target"><a href="#71ea1028-18" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="71ea1028-19"><a href="#71ea1028-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<a class="code-annotation-anchor" data-target-cell="71ea1028" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="71ea1028-20" class="code-annotation-target"><a href="#71ea1028-20" aria-hidden="true" tabindex="-1"></a>    .properties(title<span class="op">=</span><span class="st">"Les 10 compteurs avec la moyenne horaire la plus élevée"</span>)</span>
<span id="71ea1028-21"><a href="#71ea1028-21" aria-hidden="true" tabindex="-1"></a>    .configure_view(strokeOpacity<span class="op">=</span><span class="dv">0</span>)</span>
<span id="71ea1028-22"><a href="#71ea1028-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="71ea1028-23"><a href="#71ea1028-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="71ea1028-24"><a href="#71ea1028-24" aria-hidden="true" tabindex="-1"></a>fig2.interactive()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="71ea1028" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="71ea1028" data-code-lines="7" data-code-annotation="1">On déclare d’abord le <em>dataframe</em> qui sera utilisé, comme nous le faisions avec <code>ggplot(df)</code> avec <code>plotnine</code>. Puis le type de figure désirée (ici un diagramme en barre, <code>mark_bar</code> dans la grammaire d’<code>altair</code>)</span>
</dd>
<dt data-target-cell="71ea1028" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="71ea1028" data-code-lines="8" data-code-annotation="2">On définit notre couche principale avec <code>encode</code>. Celle-ci peut accepter simplement des noms de colonnes ou des constructeurs plus complexes, comme ici</span>
</dd>
<dt data-target-cell="71ea1028" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="71ea1028" data-code-lines="12" data-code-annotation="3">On définit un constructeur pour notre axe des <em>x</em>, à la fois pour gérer l’échelle des valeurs mais aussi les paramètres de celle-ci (labels, etc.). Ici, on définit l’axe des <em>x</em> comme une valeur continue (<code>:Q</code>), moyenne de <code>sum_counts</code> pour chaque valeur de <span class="math inline">\(y\)</span>. Cette moyenne n’est pas indispensable, on aurait pu se contenter d’écrire <code>sum_counts:Q</code> voire même <code>sum_counts</code> mais c’est pour illustrer la gestion des transformations de données dans <code>altair</code></span>
</dd>
<dt data-target-cell="71ea1028" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="71ea1028" data-code-lines="18" data-code-annotation="4">Le <em>tooltip</em> nous permet de gérer l’interactivité de notre figure.</span>
</dd>
<dt data-target-cell="71ea1028" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="71ea1028" data-code-lines="20" data-code-annotation="5">Les propriétés viennent à la fin de notre déclaration pour finaliser la figure</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">

<style>
  #altair-viz-8513f66e315d4ae6b0c9a5fd4680c95f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-8513f66e315d4ae6b0c9a5fd4680c95f.vega-embed details,
  #altair-viz-8513f66e315d4ae6b0c9a5fd4680c95f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-8513f66e315d4ae6b0c9a5fd4680c95f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8513f66e315d4ae6b0c9a5fd4680c95f") {
      outputDiv = document.getElementById("altair-viz-8513f66e315d4ae6b0c9a5fd4680c95f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "strokeOpacity": 0}}, "data": {"name": "data-290064ad0d2ae2980ac65b11f0b62793"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "top", "legend": {"title": "Top"}, "scale": {"domain": [true, false], "range": ["green", "red"]}, "type": "nominal"}, "tooltip": [{"field": "nom_compteur", "title": "Nom du compteur", "type": "nominal"}, {"field": "sum_counts", "title": "Moyenne horaire", "type": "quantitative"}], "x": {"aggregate": "average", "field": "sum_counts", "title": "Moyenne du comptage par heure sur la p\u00e9riode s\u00e9lectionn\u00e9e", "type": "quantitative"}, "y": {"field": "nom_compteur", "sort": "-x", "title": "", "type": "nominal"}}, "params": [{"name": "param_1", "select": {"type": "interval", "encodings": ["x", "y"]}, "bind": "scales"}], "title": "Les 10 compteurs avec la moyenne horaire la plus \u00e9lev\u00e9e", "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-290064ad0d2ae2980ac65b11f0b62793": [{"sum_counts": 123.41342540398347}, {"sum_counts": 123.67445704839537}, {"sum_counts": 124.4298186702485}, {"sum_counts": 130.01337145740476}, {"sum_counts": 136.60111014920813}, {"sum_counts": 159.37041599301975}, {"sum_counts": 172.36271612486837}, {"sum_counts": 182.80759363776295}, {"sum_counts": 188.8043836180284}, {"sum_counts": 228.54538897475527}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="informations-additionnelles" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="informations-additionnelles">Informations additionnelles</h2>
<details>
<summary>
<p><i class="fa-brands fa-python" aria-label="python"></i> environment files have been tested on.</p>
</summary>
<p>Latest built version: 2025-01-15</p>
<p>Python version used:</p>
<div id="b0bb7662" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>'3.12.6 | packaged by conda-forge | (main, Sep 30 2024, 18:08:52) [GCC 13.3.0]'</code></pre>
</div>
</div>
<div class="git-details">
<div class="pip-freeze">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">affine</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiobotocore</td>
<td style="text-align: left;">2.15.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiohappyeyeballs</td>
<td style="text-align: left;">2.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiohttp</td>
<td style="text-align: left;">3.10.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aioitertools</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiosignal</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alembic</td>
<td style="text-align: left;">1.13.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">altair</td>
<td style="text-align: left;">5.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aniso8601</td>
<td style="text-align: left;">9.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">annotated-types</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">anyio</td>
<td style="text-align: left;">4.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">appdirs</td>
<td style="text-align: left;">1.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">archspec</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attrs</td>
<td style="text-align: left;">24.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">babel</td>
<td style="text-align: left;">2.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bcrypt</td>
<td style="text-align: left;">4.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">beautifulsoup4</td>
<td style="text-align: left;">4.12.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">black</td>
<td style="text-align: left;">24.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blinker</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blis</td>
<td style="text-align: left;">0.7.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">bokeh</td>
<td style="text-align: left;">3.5.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">boltons</td>
<td style="text-align: left;">24.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">boto3</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">botocore</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">branca</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brotli</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cachetools</td>
<td style="text-align: left;">5.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cartiflette</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cartopy</td>
<td style="text-align: left;">0.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">catalogue</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cattrs</td>
<td style="text-align: left;">24.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">certifi</td>
<td style="text-align: left;">2024.8.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cffi</td>
<td style="text-align: left;">1.17.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chromedriver-autoinstaller</td>
<td style="text-align: left;">0.6.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">click</td>
<td style="text-align: left;">8.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">click-plugins</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cligj</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloudpathlib</td>
<td style="text-align: left;">0.20.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">colorama</td>
<td style="text-align: left;">0.4.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">comm</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">commonmark</td>
<td style="text-align: left;">0.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda</td>
<td style="text-align: left;">24.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda-libmamba-solver</td>
<td style="text-align: left;">24.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda-package-handling</td>
<td style="text-align: left;">2.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda_package_streaming</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">confection</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contextily</td>
<td style="text-align: left;">1.6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">contourpy</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cryptography</td>
<td style="text-align: left;">43.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cycler</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cymem</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">cytoolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dask</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">dask-expr</td>
<td style="text-align: left;">1.1.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">databricks-sdk</td>
<td style="text-align: left;">0.33.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dataclasses-json</td>
<td style="text-align: left;">0.6.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">debugpy</td>
<td style="text-align: left;">1.8.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">decorator</td>
<td style="text-align: left;">5.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Deprecated</td>
<td style="text-align: left;">1.2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">diskcache</td>
<td style="text-align: left;">5.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distributed</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">distro</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">docker</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">duckdb</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">en-core-web-sm</td>
<td style="text-align: left;">3.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">entrypoints</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">et_xmlfile</td>
<td style="text-align: left;">2.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">exceptiongroup</td>
<td style="text-align: left;">1.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">executing</td>
<td style="text-align: left;">2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fastexcel</td>
<td style="text-align: left;">0.11.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fastjsonschema</td>
<td style="text-align: left;">2.21.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fiona</td>
<td style="text-align: left;">1.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flask</td>
<td style="text-align: left;">3.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">folium</td>
<td style="text-align: left;">0.17.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fontawesomefree</td>
<td style="text-align: left;">6.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fonttools</td>
<td style="text-align: left;">4.54.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fr-core-news-sm</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">frozendict</td>
<td style="text-align: left;">2.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frozenlist</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geographiclib</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopandas</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geoplot</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopy</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gitdb</td>
<td style="text-align: left;">4.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GitPython</td>
<td style="text-align: left;">3.1.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">google-auth</td>
<td style="text-align: left;">2.35.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphene</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphql-core</td>
<td style="text-align: left;">3.2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphql-relay</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphviz</td>
<td style="text-align: left;">0.20.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">great-tables</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">greenlet</td>
<td style="text-align: left;">3.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">gunicorn</td>
<td style="text-align: left;">22.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">h11</td>
<td style="text-align: left;">0.14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">h2</td>
<td style="text-align: left;">4.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hpack</td>
<td style="text-align: left;">4.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">0.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">httpcore</td>
<td style="text-align: left;">1.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">httpx</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">httpx-sse</td>
<td style="text-align: left;">0.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">hyperframe</td>
<td style="text-align: left;">6.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">idna</td>
<td style="text-align: left;">3.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">imageio</td>
<td style="text-align: left;">2.36.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">importlib_metadata</td>
<td style="text-align: left;">8.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">importlib_resources</td>
<td style="text-align: left;">6.4.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inflate64</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ipykernel</td>
<td style="text-align: left;">6.29.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipython</td>
<td style="text-align: left;">8.28.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">itsdangerous</td>
<td style="text-align: left;">2.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jedi</td>
<td style="text-align: left;">0.19.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jinja2</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jmespath</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">joblib</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonpatch</td>
<td style="text-align: left;">1.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonpointer</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonschema</td>
<td style="text-align: left;">4.23.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonschema-specifications</td>
<td style="text-align: left;">2024.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter-cache</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter_client</td>
<td style="text-align: left;">8.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter_core</td>
<td style="text-align: left;">5.7.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">kaleido</td>
<td style="text-align: left;">0.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kiwisolver</td>
<td style="text-align: left;">1.4.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">langchain</td>
<td style="text-align: left;">0.3.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langchain-community</td>
<td style="text-align: left;">0.3.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">langchain-core</td>
<td style="text-align: left;">0.3.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langchain-text-splitters</td>
<td style="text-align: left;">0.3.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">langcodes</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langsmith</td>
<td style="text-align: left;">0.1.147</td>
</tr>
<tr class="even">
<td style="text-align: left;">language_data</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lazy_loader</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">libmambapy</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">locket</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">loguru</td>
<td style="text-align: left;">0.7.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;">5.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lz4</td>
<td style="text-align: left;">4.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">1.3.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">mamba</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mapclassify</td>
<td style="text-align: left;">2.8.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">marisa-trie</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Markdown</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">markdown-it-py</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MarkupSafe</td>
<td style="text-align: left;">2.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">marshmallow</td>
<td style="text-align: left;">3.25.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">matplotlib</td>
<td style="text-align: left;">3.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">matplotlib-inline</td>
<td style="text-align: left;">0.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mdurl</td>
<td style="text-align: left;">0.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">menuinst</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mercantile</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mizani</td>
<td style="text-align: left;">0.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mlflow</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mlflow-skinny</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">msgpack</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">multidict</td>
<td style="text-align: left;">6.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">multivolumefile</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">munkres</td>
<td style="text-align: left;">1.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">murmurhash</td>
<td style="text-align: left;">1.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">mypy-extensions</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">narwhals</td>
<td style="text-align: left;">1.22.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbclient</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nbformat</td>
<td style="text-align: left;">5.10.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">nest_asyncio</td>
<td style="text-align: left;">1.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">networkx</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">nltk</td>
<td style="text-align: left;">3.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numpy</td>
<td style="text-align: left;">1.26.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">opencv-python-headless</td>
<td style="text-align: left;">4.10.0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">openpyxl</td>
<td style="text-align: left;">3.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-api</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">opentelemetry-sdk</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-semantic-conventions</td>
<td style="text-align: left;">0.37b0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">orjson</td>
<td style="text-align: left;">3.10.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome</td>
<td style="text-align: left;">1.3.0.post0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OWSLib</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">packaging</td>
<td style="text-align: left;">24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pandas</td>
<td style="text-align: left;">2.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">paramiko</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parso</td>
<td style="text-align: left;">0.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">partd</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pathspec</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">patsy</td>
<td style="text-align: left;">0.5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pebble</td>
<td style="text-align: left;">5.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pexpect</td>
<td style="text-align: left;">4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pickleshare</td>
<td style="text-align: left;">0.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pillow</td>
<td style="text-align: left;">10.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pip</td>
<td style="text-align: left;">24.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">platformdirs</td>
<td style="text-align: left;">4.3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">5.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotnine</td>
<td style="text-align: left;">0.13.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pluggy</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">polars</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">preshed</td>
<td style="text-align: left;">3.0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">prometheus_client</td>
<td style="text-align: left;">0.21.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prometheus_flask_exporter</td>
<td style="text-align: left;">0.23.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">prompt_toolkit</td>
<td style="text-align: left;">3.0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">protobuf</td>
<td style="text-align: left;">4.25.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">psutil</td>
<td style="text-align: left;">6.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ptyprocess</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pure_eval</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">py7zr</td>
<td style="text-align: left;">0.20.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyarrow</td>
<td style="text-align: left;">17.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyarrow-hotfix</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyasn1</td>
<td style="text-align: left;">0.6.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyasn1_modules</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pybcj</td>
<td style="text-align: left;">1.0.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycosat</td>
<td style="text-align: left;">0.6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycparser</td>
<td style="text-align: left;">2.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycryptodomex</td>
<td style="text-align: left;">3.21.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic</td>
<td style="text-align: left;">2.10.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pydantic_core</td>
<td style="text-align: left;">2.27.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic-settings</td>
<td style="text-align: left;">2.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pygments</td>
<td style="text-align: left;">2.18.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyNaCl</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pynsee</td>
<td style="text-align: left;">0.1.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyogrio</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyOpenSSL</td>
<td style="text-align: left;">24.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyparsing</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyppmd</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyproj</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyshp</td>
<td style="text-align: left;">2.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PySocks</td>
<td style="text-align: left;">1.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-dateutil</td>
<td style="text-align: left;">2.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-dotenv</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-magic</td>
<td style="text-align: left;">0.4.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">pytz</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyu2f</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pywaffle</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PyYAML</td>
<td style="text-align: left;">6.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyzmq</td>
<td style="text-align: left;">26.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyzstd</td>
<td style="text-align: left;">0.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">querystring_parser</td>
<td style="text-align: left;">1.2.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rasterio</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">referencing</td>
<td style="text-align: left;">0.35.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">regex</td>
<td style="text-align: left;">2024.9.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests</td>
<td style="text-align: left;">2.32.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests-cache</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests-toolbelt</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">retrying</td>
<td style="text-align: left;">1.3.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">rich</td>
<td style="text-align: left;">13.9.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rpds-py</td>
<td style="text-align: left;">0.22.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsa</td>
<td style="text-align: left;">4.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rtree</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruamel.yaml</td>
<td style="text-align: left;">0.18.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ruamel.yaml.clib</td>
<td style="text-align: left;">0.2.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">s3fs</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s3transfer</td>
<td style="text-align: left;">0.10.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">scikit-image</td>
<td style="text-align: left;">0.24.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scikit-learn</td>
<td style="text-align: left;">1.5.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">scipy</td>
<td style="text-align: left;">1.13.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">seaborn</td>
<td style="text-align: left;">0.13.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">selenium</td>
<td style="text-align: left;">4.27.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setuptools</td>
<td style="text-align: left;">74.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">shapely</td>
<td style="text-align: left;">2.0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shellingham</td>
<td style="text-align: left;">1.5.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">six</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smart-open</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">smmap</td>
<td style="text-align: left;">5.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sniffio</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">sortedcontainers</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">soupsieve</td>
<td style="text-align: left;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy</td>
<td style="text-align: left;">3.7.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy-legacy</td>
<td style="text-align: left;">3.0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy-loggers</td>
<td style="text-align: left;">1.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SQLAlchemy</td>
<td style="text-align: left;">2.0.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">sqlparse</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">srsly</td>
<td style="text-align: left;">2.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">stack-data</td>
<td style="text-align: left;">0.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">statsmodels</td>
<td style="text-align: left;">0.14.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">tabulate</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tblib</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tenacity</td>
<td style="text-align: left;">9.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">texttable</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">thinc</td>
<td style="text-align: left;">8.2.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">threadpoolctl</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tifffile</td>
<td style="text-align: left;">2025.1.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">toolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">topojson</td>
<td style="text-align: left;">1.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tornado</td>
<td style="text-align: left;">6.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">tqdm</td>
<td style="text-align: left;">4.66.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">traitlets</td>
<td style="text-align: left;">5.14.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">trio</td>
<td style="text-align: left;">0.28.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trio-websocket</td>
<td style="text-align: left;">0.11.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">truststore</td>
<td style="text-align: left;">0.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typer</td>
<td style="text-align: left;">0.15.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">typing_extensions</td>
<td style="text-align: left;">4.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typing-inspect</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tzdata</td>
<td style="text-align: left;">2024.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unidecode</td>
<td style="text-align: left;">1.3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">url-normalize</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urllib3</td>
<td style="text-align: left;">1.26.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">wasabi</td>
<td style="text-align: left;">1.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">weasel</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">webdriver-manager</td>
<td style="text-align: left;">4.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">websocket-client</td>
<td style="text-align: left;">1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Werkzeug</td>
<td style="text-align: left;">3.0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">wheel</td>
<td style="text-align: left;">0.44.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wordcloud</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wsproto</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">xgboost</td>
<td style="text-align: left;">2.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xlrd</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">xyzservices</td>
<td style="text-align: left;">2024.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yarl</td>
<td style="text-align: left;">1.13.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellowbrick</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zict</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zipp</td>
<td style="text-align: left;">3.20.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zstandard</td>
<td style="text-align: left;">0.23.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<details>
<summary>
<p>View file history <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></p>
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="632" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 631;"><span id="cb7-632"><a href="#cb7-632" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Ce fichier a été modifié __</span><span class="sc">${</span>table_commit<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">__ fois depuis sa création le </span><span class="sc">${</span>creation_string<span class="sc">}</span><span class="vs"> (dernière modification le </span><span class="sc">${</span>last_modification_string<span class="sc">}</span><span class="vs">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="639" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 638;"><span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a>creation <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a>last_modification <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb8-644"><a href="#cb8-644" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb8-645"><a href="#cb8-645" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-646"><a href="#cb8-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-647"><a href="#cb8-647" aria-hidden="true" tabindex="-1"></a>creation_string <span class="op">=</span> creation<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb8-648"><a href="#cb8-648" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb8-649"><a href="#cb8-649" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb8-650"><a href="#cb8-650" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb8-651"><a href="#cb8-651" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-652"><a href="#cb8-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-653"><a href="#cb8-653" aria-hidden="true" tabindex="-1"></a>last_modification_string <span class="op">=</span> last_modification<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb8-654"><a href="#cb8-654" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb8-655"><a href="#cb8-655" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb8-656"><a href="#cb8-656" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb8-657"><a href="#cb8-657" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="663" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 662;"><span id="cb9-663"><a href="#cb9-663" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_table<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="668" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 667;"><span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_plot<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<table class="commit-table" border="1">
<thead>
<tr>
<th>
SHA
</th>
<th>
Date
</th>
<th>
Author
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/e66fee0">e66fee0</a>
</td>
<td>
2024-12-23 15:12:18
</td>
<td>
Lino Galiana
</td>
<td>
Fix errors in generated notebooks (#583)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/cbe6459">cbe6459</a>
</td>
<td>
2024-11-12 07:24:15
</td>
<td>
lgaliana
</td>
<td>
Revoir quelques abstracts
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/9cf2bde">9cf2bde</a>
</td>
<td>
2024-10-18 15:49:47
</td>
<td>
lgaliana
</td>
<td>
Reconstruction complète du chapitre de cartographie
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c9a3f96">c9a3f96</a>
</td>
<td>
2024-09-24 15:18:59
</td>
<td>
Lino Galiana
</td>
<td>
Finir la reprise du chapitre matplotlib (#555)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/46f038a">46f038a</a>
</td>
<td>
2024-09-23 15:28:36
</td>
<td>
Lino Galiana
</td>
<td>
Mise à jour du premier chapitre sur les figures (#553)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/59f5803">59f5803</a>
</td>
<td>
2024-09-22 16:41:46
</td>
<td>
Lino Galiana
</td>
<td>
Update bike count source data for visualisation tutorial (#552)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/06d003a">06d003a</a>
</td>
<td>
2024-04-23 10:09:22
</td>
<td>
Lino Galiana
</td>
<td>
Continue la restructuration des sous-parties (#492)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/005d89b">005d89b</a>
</td>
<td>
2023-12-20 17:23:04
</td>
<td>
Lino Galiana
</td>
<td>
Finalise l’affichage des statistiques Git (#478)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3fba612">3fba612</a>
</td>
<td>
2023-12-17 18:16:42
</td>
<td>
Lino Galiana
</td>
<td>
Remove some badges from python (#476)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/cf91965">cf91965</a>
</td>
<td>
2023-12-02 13:15:18
</td>
<td>
linogaliana
</td>
<td>
href in dataviz chapter
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/1f23de2">1f23de2</a>
</td>
<td>
2023-12-01 17:25:36
</td>
<td>
Lino Galiana
</td>
<td>
Stockage des images sur S3 (#466)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/09654c7">09654c7</a>
</td>
<td>
2023-11-14 15:16:44
</td>
<td>
Antoine Palazzolo
</td>
<td>
Suggestions Git &amp; Visualisation (#449)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/889a71b">889a71b</a>
</td>
<td>
2023-11-10 11:40:51
</td>
<td>
Antoine Palazzolo
</td>
<td>
Modification TP 3 (#443)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/df01f01">df01f01</a>
</td>
<td>
2023-10-10 15:55:04
</td>
<td>
Lino Galiana
</td>
<td>
Menus automatisés (#432)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a771183">a771183</a>
</td>
<td>
2023-10-09 11:27:45
</td>
<td>
Antoine Palazzolo
</td>
<td>
Relecture TD2 par Antoine (#418)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/154f09e">154f09e</a>
</td>
<td>
2023-09-26 14:59:11
</td>
<td>
Antoine Palazzolo
</td>
<td>
Des typos corrigées par Antoine (#411)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/057dae1">057dae1</a>
</td>
<td>
2023-09-20 16:28:46
</td>
<td>
Lino Galiana
</td>
<td>
Chapitre visualisation (#406)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/1d0780c">1d0780c</a>
</td>
<td>
2023-09-18 14:49:59
</td>
<td>
Lino Galiana
</td>
<td>
Problème rendu chapitre matplotlib (#405)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a8f90c2">a8f90c2</a>
</td>
<td>
2023-08-28 09:26:12
</td>
<td>
Lino Galiana
</td>
<td>
Update featured paths (#396)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3bdf3b0">3bdf3b0</a>
</td>
<td>
2023-08-25 11:23:02
</td>
<td>
Lino Galiana
</td>
<td>
Simplification de la structure 🤓 (#393)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/78ea2cb">78ea2cb</a>
</td>
<td>
2023-07-20 20:27:31
</td>
<td>
Lino Galiana
</td>
<td>
Change titles levels (#381)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/8df7cb2">8df7cb2</a>
</td>
<td>
2023-07-20 17:16:03
</td>
<td>
linogaliana
</td>
<td>
Change link
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f0c583c">f0c583c</a>
</td>
<td>
2023-07-07 14:12:22
</td>
<td>
Lino Galiana
</td>
<td>
Images viz (#371)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f21a24d">f21a24d</a>
</td>
<td>
2023-07-02 10:58:15
</td>
<td>
Lino Galiana
</td>
<td>
Pipeline Quarto &amp; Pages 🚀 (#365)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f2e8922">f2e8922</a>
</td>
<td>
2023-06-12 14:54:20
</td>
<td>
Lino Galiana
</td>
<td>
Remove spoiler shortcode (#364)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2dc82e7">2dc82e7</a>
</td>
<td>
2022-10-18 22:46:47
</td>
<td>
Lino Galiana
</td>
<td>
Relec Kim (visualisation + API) (#302)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/03babc6">03babc6</a>
</td>
<td>
2022-10-03 16:53:47
</td>
<td>
Lino Galiana
</td>
<td>
Parler des règles de la dataviz (#291)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/89c10c3">89c10c3</a>
</td>
<td>
2022-08-25 08:30:22
</td>
<td>
Lino Galiana
</td>
<td>
Adaptation du shortcode spoiler en notebook (#257)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/494a85a">494a85a</a>
</td>
<td>
2022-08-05 14:49:56
</td>
<td>
Lino Galiana
</td>
<td>
Images featured ✨ (#252)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/d201e3c">d201e3c</a>
</td>
<td>
2022-08-03 15:50:34
</td>
<td>
Lino Galiana
</td>
<td>
Pimp la homepage ✨ (#249)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2812ef4">2812ef4</a>
</td>
<td>
2022-07-07 15:58:58
</td>
<td>
Lino Galiana
</td>
<td>
Petite viz sympa des prenoms (#242)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a4e2426">a4e2426</a>
</td>
<td>
2022-06-16 19:34:18
</td>
<td>
Lino Galiana
</td>
<td>
Improve style (#238)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/02ed1e2">02ed1e2</a>
</td>
<td>
2022-06-09 19:06:05
</td>
<td>
Lino Galiana
</td>
<td>
Règle problème plotly (#235)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/299cff3">299cff3</a>
</td>
<td>
2022-06-08 13:19:03
</td>
<td>
Lino Galiana
</td>
<td>
Problème code JS suite (#233)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/5698e30">5698e30</a>
</td>
<td>
2022-06-03 18:28:37
</td>
<td>
Lino Galiana
</td>
<td>
Finalise widget (#232)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/7b9f27b">7b9f27b</a>
</td>
<td>
2022-06-03 17:05:15
</td>
<td>
Lino Galiana
</td>
<td>
Essaie régler les problèmes widgets JS (#231)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/12965ba">12965ba</a>
</td>
<td>
2022-05-25 15:53:27
</td>
<td>
Lino Galiana
</td>
<td>
:launch: Bascule vers quarto (#226)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/9c71d6e">9c71d6e</a>
</td>
<td>
2022-03-08 10:34:26
</td>
<td>
Lino Galiana
</td>
<td>
Plus d’éléments sur S3 (#218)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4f67528">4f67528</a>
</td>
<td>
2021-12-12 08:37:21
</td>
<td>
Lino Galiana
</td>
<td>
Improve website appareance (#194)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/66a5276">66a5276</a>
</td>
<td>
2021-11-23 16:13:20
</td>
<td>
Lino Galiana
</td>
<td>
Relecture partie visualisation (#181)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2a8809f">2a8809f</a>
</td>
<td>
2021-10-27 12:05:34
</td>
<td>
Lino Galiana
</td>
<td>
Simplification des hooks pour gagner en flexibilité et clarté (#166)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2f4d390">2f4d390</a>
</td>
<td>
2021-09-02 15:12:29
</td>
<td>
Lino Galiana
</td>
<td>
Utilise un shortcode github (#131)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2e4d586">2e4d586</a>
</td>
<td>
2021-09-02 12:03:39
</td>
<td>
Lino Galiana
</td>
<td>
Simplify badges generation (#130)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/80877d2">80877d2</a>
</td>
<td>
2021-06-28 11:34:24
</td>
<td>
Lino Galiana
</td>
<td>
Ajout d’un exercice de NLP à partir openfood database (#98)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/6729a72">6729a72</a>
</td>
<td>
2021-06-22 18:07:05
</td>
<td>
Lino Galiana
</td>
<td>
Mise à jour badge onyxia (#115)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4cdb759">4cdb759</a>
</td>
<td>
2021-05-12 10:37:23
</td>
<td>
Lino Galiana
</td>
<td>
:sparkles: :star2: Nouveau thème hugo :snake: :fire: (#105)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/7f9f97b">7f9f97b</a>
</td>
<td>
2021-04-30 21:44:04
</td>
<td>
Lino Galiana
</td>
<td>
🐳 + 🐍 New workflow (docker 🐳) and new dataset for modelization (2020 🇺🇸 elections) (#99)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/0a0d034">0a0d034</a>
</td>
<td>
2021-03-26 20:16:22
</td>
<td>
Lino Galiana
</td>
<td>
Ajout d’une section sur S3 (#97)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a5b7c99">a5b7c99</a>
</td>
<td>
2020-10-05 15:07:09
</td>
<td>
Lino Galiana
</td>
<td>
Donne lien vers données compteurs
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/18be8f4">18be8f4</a>
</td>
<td>
2020-10-01 17:08:53
</td>
<td>
Lino Galiana
</td>
<td>
Intégration de box inspirées du thème pydata sphinx (#58)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/5ac3cbe">5ac3cbe</a>
</td>
<td>
2020-09-28 18:59:24
</td>
<td>
Lino Galiana
</td>
<td>
Continue la partie graphiques (#54)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/94f39ec">94f39ec</a>
</td>
<td>
2020-09-24 21:25:32
</td>
<td>
Lino Galiana
</td>
<td>
quelques mots sur vizu
</td>
</tr>
</tbody>
</table>
</details>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="679" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 678;"><span id="cb11-679"><a href="#cb11-679" aria-hidden="true" tabindex="-1"></a>git_history_table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb11-680"><a href="#cb11-680" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">,</span></span>
<span id="cb11-681"><a href="#cb11-681" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb11-682"><a href="#cb11-682" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb11-683"><a href="#cb11-683" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SHA</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`[</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>github_repo<span class="sc">}</span><span class="vs">/commit/</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb11-684"><a href="#cb11-684" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Description</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">replacePullRequestPattern</span>(x<span class="op">,</span> github_repo)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb11-685"><a href="#cb11-685" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*Date: x =&gt; x.toLocaleString("fr", {</span></span>
<span id="cb11-686"><a href="#cb11-686" aria-hidden="true" tabindex="-1"></a><span class="co">        "month": "numeric",</span></span>
<span id="cb11-687"><a href="#cb11-687" aria-hidden="true" tabindex="-1"></a><span class="co">        "day": "numeric",</span></span>
<span id="cb11-688"><a href="#cb11-688" aria-hidden="true" tabindex="-1"></a><span class="co">        "year": "numeric"</span></span>
<span id="cb11-689"><a href="#cb11-689" aria-hidden="true" tabindex="-1"></a><span class="co">        })</span></span>
<span id="cb11-690"><a href="#cb11-690" aria-hidden="true" tabindex="-1"></a><span class="co">      */</span></span>
<span id="cb11-691"><a href="#cb11-691" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-692"><a href="#cb11-692" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-693"><a href="#cb11-693" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="699" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 698;"><span id="cb12-699"><a href="#cb12-699" aria-hidden="true" tabindex="-1"></a>git_history_plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb12-700"><a href="#cb12-700" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb12-701"><a href="#cb12-701" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"royalblue"</span>})<span class="op">,</span></span>
<span id="cb12-702"><a href="#cb12-702" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb12-703"><a href="#cb12-703" aria-hidden="true" tabindex="-1"></a>          table_commit<span class="op">,</span></span>
<span id="cb12-704"><a href="#cb12-704" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">pointerX</span>({<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>}))<span class="op">,</span></span>
<span id="cb12-705"><a href="#cb12-705" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(table_commit<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"royalblue"</span>})</span>
<span id="cb12-706"><a href="#cb12-706" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb12-707"><a href="#cb12-707" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="713" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 712;"><span id="cb13-713"><a href="#cb13-713" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">replacePullRequestPattern</span>(inputString<span class="op">,</span> githubRepo) {</span>
<span id="cb13-714"><a href="#cb13-714" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use a regular expression to match the pattern #digit</span></span>
<span id="cb13-715"><a href="#cb13-715" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> pattern <span class="op">=</span> <span class="ss">/#</span><span class="sc">(\d+)</span><span class="ss">/g</span><span class="op">;</span></span>
<span id="cb13-716"><a href="#cb13-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-717"><a href="#cb13-717" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Replace the pattern with ${github_repo}/pull/#digit</span></span>
<span id="cb13-718"><a href="#cb13-718" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> replacedString <span class="op">=</span> inputString<span class="op">.</span><span class="fu">replace</span>(pattern<span class="op">,</span> <span class="st">'[#$1]('</span> <span class="op">+</span> githubRepo <span class="op">+</span> <span class="st">'/pull/$1)'</span>)<span class="op">;</span></span>
<span id="cb13-719"><a href="#cb13-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-720"><a href="#cb13-720" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replacedString<span class="op">;</span></span>
<span id="cb13-721"><a href="#cb13-721" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="727" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 726;"><span id="cb14-727"><a href="#cb14-727" aria-hidden="true" tabindex="-1"></a>github_repo <span class="op">=</span> <span class="st">"https://github.com/linogaliana/python-datascientist"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="732" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 731;"><span id="cb15-732"><a href="#cb15-732" aria-hidden="true" tabindex="-1"></a>table_commit <span class="op">=</span> {</span>
<span id="cb15-733"><a href="#cb15-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-734"><a href="#cb15-734" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the HTML table by its class name</span></span>
<span id="cb15-735"><a href="#cb15-735" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb15-736"><a href="#cb15-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-737"><a href="#cb15-737" aria-hidden="true" tabindex="-1"></a><span class="co">// Check if the table exists</span></span>
<span id="cb15-738"><a href="#cb15-738" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (table) {</span>
<span id="cb15-739"><a href="#cb15-739" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialize an array to store the table data</span></span>
<span id="cb15-740"><a href="#cb15-740" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dataArray <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb15-741"><a href="#cb15-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-742"><a href="#cb15-742" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract headers from the first row</span></span>
<span id="cb15-743"><a href="#cb15-743" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> headers <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb15-744"><a href="#cb15-744" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb15-745"><a href="#cb15-745" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">.</span><span class="fu">push</span>(table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span>[i]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>())<span class="op">;</span></span>
<span id="cb15-746"><a href="#cb15-746" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-747"><a href="#cb15-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-748"><a href="#cb15-748" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Iterate through the rows, starting from the second row</span></span>
<span id="cb15-749"><a href="#cb15-749" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb15-750"><a href="#cb15-750" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> row <span class="op">=</span> table<span class="op">.</span><span class="at">rows</span>[i]<span class="op">;</span></span>
<span id="cb15-751"><a href="#cb15-751" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> rowData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb15-752"><a href="#cb15-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-753"><a href="#cb15-753" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Iterate through the cells in the row</span></span>
<span id="cb15-754"><a href="#cb15-754" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> row<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb15-755"><a href="#cb15-755" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Use headers as keys and cell content as values</span></span>
<span id="cb15-756"><a href="#cb15-756" aria-hidden="true" tabindex="-1"></a>            rowData[headers[j]] <span class="op">=</span> row<span class="op">.</span><span class="at">cells</span>[j]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb15-757"><a href="#cb15-757" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-758"><a href="#cb15-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-759"><a href="#cb15-759" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Push the rowData object to the dataArray</span></span>
<span id="cb15-760"><a href="#cb15-760" aria-hidden="true" tabindex="-1"></a>        dataArray<span class="op">.</span><span class="fu">push</span>(rowData)<span class="op">;</span></span>
<span id="cb15-761"><a href="#cb15-761" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-762"><a href="#cb15-762" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-763"><a href="#cb15-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-764"><a href="#cb15-764" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataArray</span>
<span id="cb15-765"><a href="#cb15-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-766"><a href="#cb15-766" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="772" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 771;"><span id="cb16-772"><a href="#cb16-772" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the element with class 'git-details'</span></span>
<span id="cb16-773"><a href="#cb16-773" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-774"><a href="#cb16-774" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> gitDetails <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb16-775"><a href="#cb16-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-776"><a href="#cb16-776" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Check if the element exists</span></span>
<span id="cb16-777"><a href="#cb16-777" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (gitDetails) {</span>
<span id="cb16-778"><a href="#cb16-778" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Hide the element</span></span>
<span id="cb16-779"><a href="#cb16-779" aria-hidden="true" tabindex="-1"></a>      gitDetails<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb16-780"><a href="#cb16-780" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-781"><a href="#cb16-781" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="787" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 786;"><span id="cb17-787"><a href="#cb17-787" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.12/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>



</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-field2012discovering" class="csl-entry" role="listitem">
Field, A. 2012. <span>“Discovering Statistics Using r.”</span> Sage.
</div>
<div id="ref-Lisa_psyTeachR_Book_Template_2021" class="csl-entry" role="listitem">
Lisa, DeBruine. 2021. <span>“<span class="nocase">psyTeachR Book Template</span>.”</span> <a href="https://github.com/psyteachr/template/">https://github.com/psyteachr/template/</a>.
</div>
<div id="ref-wilkinson2012grammar" class="csl-entry" role="listitem">
Wilkinson, Leland. 2012. <em>The Grammar of Graphics</em>. Springer.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Ce chapitre sera construit autour de l’écosystème <a href="https://quarto.org/"><code>Quarto</code></a>. En attendant ce chapitre, vous pouvez consulter la documentation exemplaire de cet écosystème et pratiquer, ce sera le meilleur moyen de découvrir.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Heureusement, comme il existe un énorme corpus de code en ligne utilisant <code>matplotlib</code>, les assistants de code comme <code>ChatGPT</code> ou <code>Github Copilot</code> sont précieux pour construire un graphique à partir d’instructions.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>J’ai retiré la couleur sur l’axe des ordonnées qui, je trouve,
apporte peu à la figure voire dégrade la compréhension du message.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Le nom de ces librairies est inspiré de la constellation du triangle d’été dont Véga et Altair sont deux membres.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@book{galiana2023,
  author = {Galiana, Lino},
  title = {Python Pour La Data Science},
  date = {2023},
  url = {https://pythonds.linogaliana.fr/},
  doi = {10.5281/zenodo.8229676},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-galiana2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Galiana, Lino. 2023. <em>Python Pour La Data Science</em>. <a href="https://doi.org/10.5281/zenodo.8229676">https://doi.org/10.5281/zenodo.8229676</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYENlIGZpY2hpZXIgYSDDqXTDqSBtb2RpZmnDqSBfXyR7dGFibGVfY29tbWl0Lmxlbmd0aH1fXyBmb2lzIGRlcHVpcyBzYSBjcsOpYXRpb24gbGUgJHtjcmVhdGlvbl9zdHJpbmd9IChkZXJuacOocmUgbW9kaWZpY2F0aW9uIGxlICR7bGFzdF9tb2RpZmljYXRpb25fc3RyaW5nfSlgXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjcmVhdGlvbiA9IGQzLm1pbihcbiAgdGFibGVfY29tbWl0Lm1hcChkID0+IG5ldyBEYXRlKGQuRGF0ZSkpXG4pXG5cbmxhc3RfbW9kaWZpY2F0aW9uID0gZDMubWF4KFxuICB0YWJsZV9jb21taXQubWFwKGQgPT4gbmV3IERhdGUoZC5EYXRlKSlcbilcblxuY3JlYXRpb25fc3RyaW5nID0gY3JlYXRpb24udG9Mb2NhbGVTdHJpbmcoXCJmclwiLCB7XG4gIFwiZGF5XCI6IFwibnVtZXJpY1wiLFxuICBcIm1vbnRoXCI6IFwibG9uZ1wiLFxuICBcInllYXJcIjogXCJudW1lcmljXCJcbn0pXG5cbmxhc3RfbW9kaWZpY2F0aW9uX3N0cmluZyA9IGxhc3RfbW9kaWZpY2F0aW9uLnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgXCJtb250aFwiOiBcImxvbmdcIixcbiAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG59KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodG1sYDxkaXY+JHtnaXRfaGlzdG9yeV90YWJsZX08L2Rpdj5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodG1sYDxkaXY+JHtnaXRfaGlzdG9yeV9wbG90fTwvZGl2PmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdpdF9oaXN0b3J5X3RhYmxlID0gSW5wdXRzLnRhYmxlKFxuICB0YWJsZV9jb21taXQsXG4gIHtcbiAgICBmb3JtYXQ6IHtcbiAgICAgIFNIQTogeCA9PiBtZGBbJHt4fV0oJHtnaXRodWJfcmVwb30vY29tbWl0LyR7eH0pYCxcbiAgICAgIERlc2NyaXB0aW9uOiB4ID0+IG1kYCR7cmVwbGFjZVB1bGxSZXF1ZXN0UGF0dGVybih4LCBnaXRodWJfcmVwbyl9YCxcbiAgICAgIC8qRGF0ZTogeCA9PiB4LnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICAgICAgICBcIm1vbnRoXCI6IFwibnVtZXJpY1wiLFxuICAgICAgICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgICAgICAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG4gICAgICAgIH0pXG4gICAgICAqL1xuICAgIH1cbiAgfVxuKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2l0X2hpc3RvcnlfcGxvdCA9IFBsb3QucGxvdCh7XG4gIG1hcmtzOiBbXG4gICAgUGxvdC5ydWxlWShbMF0sIHtzdHJva2U6IFwicm95YWxibHVlXCJ9KSxcbiAgICBQbG90LmRvdChcbiAgICAgICAgICB0YWJsZV9jb21taXQsXG4gICAgICAgICAgUGxvdC5wb2ludGVyWCh7eDogKGQpID0+IG5ldyBEYXRlKGQuZGF0ZSksIHk6IDAsIHN0cm9rZTogXCJyZWRcIn0pKSxcbiAgICBQbG90LmRvdCh0YWJsZV9jb21taXQsIHt4OiAoZCkgPT4gbmV3IERhdGUoZC5EYXRlKSwgeTogMCwgZmlsbDogXCJyb3lhbGJsdWVcIn0pXG4gIF1cbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiByZXBsYWNlUHVsbFJlcXVlc3RQYXR0ZXJuKGlucHV0U3RyaW5nLCBnaXRodWJSZXBvKSB7XG4gICAgLy8gVXNlIGEgcmVndWxhciBleHByZXNzaW9uIHRvIG1hdGNoIHRoZSBwYXR0ZXJuICNkaWdpdFxuICAgIHZhciBwYXR0ZXJuID0gLyMoXFxkKykvZztcblxuICAgIC8vIFJlcGxhY2UgdGhlIHBhdHRlcm4gd2l0aCAke2dpdGh1Yl9yZXBvfS9wdWxsLyNkaWdpdFxuICAgIHZhciByZXBsYWNlZFN0cmluZyA9IGlucHV0U3RyaW5nLnJlcGxhY2UocGF0dGVybiwgJ1sjJDFdKCcgKyBnaXRodWJSZXBvICsgJy9wdWxsLyQxKScpO1xuXG4gICAgcmV0dXJuIHJlcGxhY2VkU3RyaW5nO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2l0aHViX3JlcG8gPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9saW5vZ2FsaWFuYS9weXRob24tZGF0YXNjaWVudGlzdFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0YWJsZV9jb21taXQgPSB7XG5cbi8vIEdldCB0aGUgSFRNTCB0YWJsZSBieSBpdHMgY2xhc3MgbmFtZVxudmFyIHRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1pdC10YWJsZScpO1xuXG4vLyBDaGVjayBpZiB0aGUgdGFibGUgZXhpc3RzXG5pZiAodGFibGUpIHtcbiAgICAvLyBJbml0aWFsaXplIGFuIGFycmF5IHRvIHN0b3JlIHRoZSB0YWJsZSBkYXRhXG4gICAgdmFyIGRhdGFBcnJheSA9IFtdO1xuXG4gICAgLy8gRXh0cmFjdCBoZWFkZXJzIGZyb20gdGhlIGZpcnN0IHJvd1xuICAgIHZhciBoZWFkZXJzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5yb3dzWzBdLmNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGhlYWRlcnMucHVzaCh0YWJsZS5yb3dzWzBdLmNlbGxzW2ldLnRleHRDb250ZW50LnRyaW0oKSk7XG4gICAgfVxuXG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSByb3dzLCBzdGFydGluZyBmcm9tIHRoZSBzZWNvbmQgcm93XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0YWJsZS5yb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciByb3cgPSB0YWJsZS5yb3dzW2ldO1xuICAgICAgICB2YXIgcm93RGF0YSA9IHt9O1xuXG4gICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgY2VsbHMgaW4gdGhlIHJvd1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJvdy5jZWxscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgLy8gVXNlIGhlYWRlcnMgYXMga2V5cyBhbmQgY2VsbCBjb250ZW50IGFzIHZhbHVlc1xuICAgICAgICAgICAgcm93RGF0YVtoZWFkZXJzW2pdXSA9IHJvdy5jZWxsc1tqXS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQdXNoIHRoZSByb3dEYXRhIG9iamVjdCB0byB0aGUgZGF0YUFycmF5XG4gICAgICAgIGRhdGFBcnJheS5wdXNoKHJvd0RhdGEpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBkYXRhQXJyYXlcblxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gR2V0IHRoZSBlbGVtZW50IHdpdGggY2xhc3MgJ2dpdC1kZXRhaWxzJ1xue1xuICB2YXIgZ2l0RGV0YWlscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21taXQtdGFibGUnKTtcblxuICAvLyBDaGVjayBpZiB0aGUgZWxlbWVudCBleGlzdHNcbiAgaWYgKGdpdERldGFpbHMpIHtcbiAgICAgIC8vIEhpZGUgdGhlIGVsZW1lbnRcbiAgICAgIGdpdERldGFpbHMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlBsb3QgPSByZXF1aXJlKCdAb2JzZXJ2YWJsZWhxL3Bsb3RAMC42LjEyL2Rpc3QvcGxvdC51bWQubWluLmpzJylcbiJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../content/visualisation";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pythonds\.linogaliana\.fr");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="linogaliana/python-datascientist" data-repo-id="MDEwOlJlcG9zaXRvcnkyODAxNjE2Nzc=" data-category="General" data-category-id="DIC_kwDOELLtjc4B-5TX" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/visualisation/index.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/visualisation/maps.html" class="pagination-link" aria-label="Introduction à la cartographie avec Python">
        <span class="nav-page-text">Introduction à la cartographie avec Python</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Python pour la <em>data science</em>, Lino Galiana.<br>
Licence <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i><br>
Code source disponible sur <a href="https://github.com/linogaliana/python-datascientist"><code>Github</code></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/visualisation/matplotlib.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Site construit avec <i class="fa-brands fa-python" aria-label="python"></i> et <a href="https://quarto.org/"><code>Quarto</code></a><br>
Inspiration pour la mise en forme du site <a href="https://www.andreashandel.com">ici</a><br>
<a href="https://github.com/linogaliana/python-datascientist">Code source disponible sur <i class="fa-brands fa-github" aria-label="github"></i> <code>GitHub</code></a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","selector":".lightbox","loop":false,"descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>