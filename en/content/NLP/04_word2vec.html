<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lino Galiana">
<meta name="dcterms.date" content="2024-10-11">
<meta name="description" content="Pour pouvoir utiliser des donn√©es textuelles dans des algorithmes de machine learning, il faut les vectoriser, c‚Äôest √† dire transformer le texte en donn√©es num√©riques. Dans ce TP, nous allons comparer diff√©rentes m√©thodes de vectorisation, √† travers une t√¢che de pr√©diction : peut-on pr√©dire un auteur litt√©raire √† partir d‚Äôextraits de ses textes ? Parmi ces m√©thodes, on va notamment explorer le mod√®le Word2Vec, qui permet d‚Äôexploiter les structures latentes d‚Äôun texte en construisant des word embeddings (plongements de mots).">

<title>Python for data science - M√©thodes de vectorisation : comptages et word embeddings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/NLP/05_exo_supp.html" rel="next">
<link href="../../content/NLP/03_lda.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #e9f3fa;
      }
</style>
<script id="toggle-light-dark-elements" type="application/javascript">
// Extend Quarto theme toggling to allow elements to be displayed/hidden in light/dark themes

// Replicated from https://github.com/quarto-dev/quarto-cli/blob/84d4659/src/resources/formats/html/templates/quarto-html.ejs
const getColorSchemeSentinel = () => {
  const localAlternateSentinel = 'default';
  if (window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    return storageValue != null ? storageValue : localAlternateSentinel;
  } else {
    return localAlternateSentinel;
  }
};

// Function to toggle light and dark elements based on color scheme
const toggleColorSchemeElements = () => {
  const scheme = getColorSchemeSentinel();
  const lightElements = document.getElementsByClassName('only-light');
  const darkElements = document.getElementsByClassName('only-dark');

  for (var i = 0; i < lightElements.length; i++) {
    lightElements[i].style.display = scheme == 'default' ? 'block' : 'none';
  }
  for (var i = 0; i < darkElements.length; i++) {
    darkElements[i].style.display = scheme == 'default' ? 'none' : 'block';
  }
};

// Function to check if the user's browser prefers dark themes
const prefersDarkTheme = () => {
  if (window.matchMedia) {
    return window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return false;
};

document.addEventListener('readystatechange', function() {
  // Set the default color scheme based on browser preference
  if (document.readyState === 'interactive' && window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    if (storageValue == null && prefersDarkTheme()) {
      window.localStorage.setItem('quarto-color-scheme', 'alternate');
    }
  }
  // Add event listener for when the readyState is complete (and default toggler is set)
  if (document.readyState === 'complete') {
    // Toggle scheme once
    toggleColorSchemeElements();
    // Append our toggle function to the old one
    const oldToggle = window.quartoToggleColorScheme;
    window.quartoToggleColorScheme = () => {
      oldToggle();
      toggleColorSchemeElements();
    }
  }
});

</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Python for data science - M√©thodes de vectorisation : comptages et word embeddings">
<meta name="twitter:description" content="Pour pouvoir utiliser des donn√©es textuelles dans des algorithmes
de machine learning, il faut les vectoriser, c‚Äôest √† dire transformer
le texte en donn√©es num√©riques. Dans ce TP, nous allons comparer
diff√©rentes m√©thodes de vectorisation, √† travers une t√¢che de pr√©diction :
peut-on pr√©dire un auteur litt√©raire √† partir d‚Äôextraits de ses textes ?
Parmi ces m√©thodes, on va notamment explorer le mod√®le Word2Vec, qui
permet d‚Äôexploiter les structures latentes d‚Äôun texte en construisant
des word embeddings (plongements de mots).">
<meta name="twitter:image" content="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/word_embedding.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Python pour la data science">
<meta name="citation_author" content="Lino Galiana">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2024-10-11">
<meta name="citation_fulltext_html_url" content="https://pythonds.linogaliana.fr/">
<meta name="citation_doi" content="10.5281/zenodo.8229676">
<meta name="citation_language" content="en">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="../../content/getting-started/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/01_environment.html">
 <span class="dropdown-text">A functional Python environment for data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/02_data_analysis.html">
 <span class="dropdown-text">How to deal with a data set</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/03_revisions.html">
 <span class="dropdown-text">A few refresher exercises to get back in the saddle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wrangle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wrangle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wrangle">    
        <li>
    <a class="dropdown-item" href="../../content/manipulation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/01_numpy.html">
 <span class="dropdown-text">Numpy, the foundation of data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_intro.html">
 <span class="dropdown-text">Introduction to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_suite.html">
 <span class="dropdown-text">Data wrangling with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/03_geopandas_intro.html">
 <span class="dropdown-text">Introduction to spatial data with Geopandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04a_webscraping_TP.html">
 <span class="dropdown-text">Web scraping with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04c_API_TP.html">
 <span class="dropdown-text">Retrieve data with APIs from Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04b_regex_TP.html">
 <span class="dropdown-text">Mastering regular expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-communicate" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Communicate</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-communicate">    
        <li>
    <a class="dropdown-item" href="../../content/visualisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/matplotlib.html">
 <span class="dropdown-text">De beaux graphiques avec python : mise en pratique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/maps.html">
 <span class="dropdown-text">De belles cartes avec python : mise en pratique</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model">    
        <li>
    <a class="dropdown-item" href="../../content/modelisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/0_preprocessing.html">
 <span class="dropdown-text">Pr√©paration des donn√©es pour construire un mod√®le</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/1_modelevaluation.html">
 <span class="dropdown-text">Evaluer la qualit√© d‚Äôun mod√®le</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/2_SVM.html">
 <span class="dropdown-text">Classification: premier mod√®le avec les SVM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/3_regression.html">
 <span class="dropdown-text">R√©gression : une introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/4_featureselection.html">
 <span class="dropdown-text">S√©lection de variables : une introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/5_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/6_pipeline.html">
 <span class="dropdown-text">Premier pas vers l‚Äôindustrialisation avec les pipelines scikit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/7_mlapi.html">
 <span class="dropdown-text">Mettre √† disposition un mod√®le par le biais d‚Äôune API</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nlp" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NLP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nlp">    
        <li>
    <a class="dropdown-item" href="../../content/NLP/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/01_intro.html">
 <span class="dropdown-text">Nettoyer et structurer l‚Äôinformation dans les donn√©es textuelles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/02_exoclean.html">
 <span class="dropdown-text">L‚Äôanalyse fr√©quentiste par l‚Äôapproche bag-of-words : int√©r√™t et limites</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/03_lda.html">
 <span class="dropdown-text">Latent Dirichlet Allocation (LDA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/04_word2vec.html">
 <span class="dropdown-text">M√©thodes de vectorisation : comptages et word embeddings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/05_exo_supp.html">
 <span class="dropdown-text">Exercices suppl√©mentaires</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-depth" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-depth</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-depth">    
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/continuous_integration.html">
 <span class="dropdown-text">Int√©gration continue avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/s3.html">
 <span class="dropdown-text">Les nouveaux modes d‚Äôacc√®s aux donn√©es : le format parquet et les donn√©es sur le cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_approfondissement.html">
 <span class="dropdown-text">Approfondissement ElasticSearch pour des recherches de proximit√© g√©ographique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_intro.html">
 <span class="dropdown-text">Introduction √† ElasticSearch pour la recherche textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-git" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Git</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-git">    
        <li>
    <a class="dropdown-item" href="../../content/git/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/introgit.html">
 <span class="dropdown-text">D√©couvrir Git par la pratique: la gymnastique quotidienne</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/exogit.html">
 <span class="dropdown-text">Un cadavre exquis pour d√©couvrir le travail collaboratif <code>Git</code></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-annexes" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Annexes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-annexes">    
        <li>
    <a class="dropdown-item" href="../../content/annexes/evaluation.html">
 <span class="dropdown-text">Evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/annexes/corrections.html">
 <span class="dropdown-text">Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://linogaliana.github.io/python-datascientist-slides/#/title-slide">
 <span class="dropdown-text">Slides de pr√©sentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/linogaliana/python-datascientist" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/NLP/04_word2vec.html">M√©thodes de vectorisation : comptages et word embeddings</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">M√©thodes de vectorisation : comptages et word embeddings</h1>
                  <div>
        <div class="description">
          <p>Pour pouvoir utiliser des donn√©es textuelles dans des algorithmes
          de <em>machine learning</em>, il faut les vectoriser, c‚Äôest √† dire transformer
          le texte en donn√©es num√©riques. Dans ce TP, nous allons comparer
          diff√©rentes m√©thodes de vectorisation, √† travers une t√¢che de pr√©diction :
          <em>peut-on pr√©dire un auteur litt√©raire √† partir d‚Äôextraits de ses textes ?</em>
          Parmi ces m√©thodes, on va notamment explorer le mod√®le <code>Word2Vec</code>, qui
          permet d‚Äôexploiter les structures latentes d‚Äôun texte en construisant
          des <em>word embeddings</em> (plongements de mots).</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Tutoriel</div>
                <div class="quarto-category">NLP</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lino Galiana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2024-10-11</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nettoyer et structurer l‚Äôinformation dans les donn√©es textuelles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/02_exoclean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L‚Äôanalyse fr√©quentiste par l‚Äôapproche bag-of-words : int√©r√™t et limites</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/03_lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Dirichlet Allocation (LDA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/04_word2vec.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">M√©thodes de vectorisation : comptages et word embeddings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/05_exo_supp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices suppl√©mentaires</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#packages-√†-installer" id="toc-packages-√†-installer" class="nav-link active" data-scroll-target="#packages-√†-installer"><span class="header-section-number">1</span> Packages √† installer</a></li>
  <li><a href="#nettoyage-des-donn√©es" id="toc-nettoyage-des-donn√©es" class="nav-link" data-scroll-target="#nettoyage-des-donn√©es"><span class="header-section-number">2</span> Nettoyage des donn√©es</a>
  <ul class="collapse">
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing"><span class="header-section-number">2.1</span> Preprocessing</a></li>
  <li><a href="#encodage-de-la-variable-√†-pr√©dire" id="toc-encodage-de-la-variable-√†-pr√©dire" class="nav-link" data-scroll-target="#encodage-de-la-variable-√†-pr√©dire"><span class="header-section-number">2.2</span> Encodage de la variable √† pr√©dire</a></li>
  <li><a href="#construction-des-bases-dentra√Ænement-et-de-test" id="toc-construction-des-bases-dentra√Ænement-et-de-test" class="nav-link" data-scroll-target="#construction-des-bases-dentra√Ænement-et-de-test"><span class="header-section-number">2.3</span> Construction des bases d‚Äôentra√Ænement et de test</a></li>
  </ul></li>
  <li><a href="#statistiques-exploratoires" id="toc-statistiques-exploratoires" class="nav-link" data-scroll-target="#statistiques-exploratoires"><span class="header-section-number">3</span> Statistiques exploratoires</a>
  <ul class="collapse">
  <li><a href="#r√©partition-des-labels" id="toc-r√©partition-des-labels" class="nav-link" data-scroll-target="#r√©partition-des-labels"><span class="header-section-number">3.1</span> R√©partition des labels</a></li>
  <li><a href="#mots-les-plus-fr√©quemment-utilis√©s-par-chaque-auteur" id="toc-mots-les-plus-fr√©quemment-utilis√©s-par-chaque-auteur" class="nav-link" data-scroll-target="#mots-les-plus-fr√©quemment-utilis√©s-par-chaque-auteur"><span class="header-section-number">3.2</span> Mots les plus fr√©quemment utilis√©s par chaque auteur</a></li>
  </ul></li>
  <li><a href="#pr√©diction-sur-le-set-dentra√Ænement" id="toc-pr√©diction-sur-le-set-dentra√Ænement" class="nav-link" data-scroll-target="#pr√©diction-sur-le-set-dentra√Ænement"><span class="header-section-number">4</span> Pr√©diction sur le set d‚Äôentra√Ænement</a>
  <ul class="collapse">
  <li><a href="#d√©marche" id="toc-d√©marche" class="nav-link" data-scroll-target="#d√©marche"><span class="header-section-number">4.1</span> D√©marche</a></li>
  <li><a href="#pipeline-de-pr√©diction" id="toc-pipeline-de-pr√©diction" class="nav-link" data-scroll-target="#pipeline-de-pr√©diction"><span class="header-section-number">4.2</span> Pipeline de pr√©diction</a></li>
  </ul></li>
  <li><a href="#approche-bag-of-words" id="toc-approche-bag-of-words" class="nav-link" data-scroll-target="#approche-bag-of-words"><span class="header-section-number">5</span> Approche <em>bag-of-words</em></a></li>
  <li><a href="#tf-idf" id="toc-tf-idf" class="nav-link" data-scroll-target="#tf-idf"><span class="header-section-number">6</span> TF-IDF</a></li>
  <li><a href="#word2vec-avec-averaging" id="toc-word2vec-avec-averaging" class="nav-link" data-scroll-target="#word2vec-avec-averaging"><span class="header-section-number">7</span> Word2vec avec averaging</a></li>
  <li><a href="#word2vec-pr√©-entra√Æn√©-averaging" id="toc-word2vec-pr√©-entra√Æn√©-averaging" class="nav-link" data-scroll-target="#word2vec-pr√©-entra√Æn√©-averaging"><span class="header-section-number">8</span> Word2vec pr√©-entra√Æn√© + averaging</a></li>
  <li><a href="#contextual-embeddings" id="toc-contextual-embeddings" class="nav-link" data-scroll-target="#contextual-embeddings"><span class="header-section-number">9</span> Contextual embeddings</a></li>
  <li><a href="#aller-plus-loin" id="toc-aller-plus-loin" class="nav-link" data-scroll-target="#aller-plus-loin"><span class="header-section-number">10</span> Aller plus loin</a>
  <ul class="collapse">
  <li><a href="#informations-additionnelles" id="toc-informations-additionnelles" class="nav-link" data-scroll-target="#informations-additionnelles">Informations additionnelles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/NLP/04_word2vec.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<a href="#" onclick="this.href = location.href.replace('/en/', '/');" class="button-cta">
<button class="btn"><i class="fa fa-language"></i> Passer √† la version fran√ßaise üá´üá∑</button>
</a></p>
<div class="cell markdown">
<p class="badges">
<a href="https://github.com/linogaliana/python-datascientist-notebooks/blob/main/notebooks/NLP/04_word2vec.ipynb" class="github"><i class="fab fa-github"></i></a>
<a href="https://downgit.github.io/#/home?url=https://github.com/linogaliana/python-datascientist-notebooks/blob/main/notebooks/NLP/04_word2vec.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Download-Notebook-important?logo=Jupyter" alt="Download"></a>
<a href="https://nbviewer.jupyter.org/github/linogaliana/python-datascientist-notebooksblob/main/notebooks/NLP/04_word2vec.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/Visualize-nbviewer-blue?logo=Jupyter" alt="nbviewer"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/jupyter-pytorch?autoLaunch=true&amp;onyxia.friendlyName=%C2%AB04_word2vec%C2%BB&amp;init.personalInit=%C2%ABhttps%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmaster%2Fsspcloud%2Finit-jupyter.sh%C2%BB&amp;init.personalInitArgs=%C2%ABNLP%2004_word2vec%C2%BB" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange" alt="Onyxia"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/vscode-pytorch?autoLaunch=true&amp;onyxia.friendlyName=%C2%AB04_word2vec%C2%BB&amp;init.personalInit=%C2%ABhttps%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmaster%2Fsspcloud%2Finit-vscode.sh%C2%BB&amp;init.personalInitArgs=%C2%ABNLP%2004_word2vec%C2%BB" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue" alt="Onyxia"></a><br>
<a href="https://colab.research.google.com/github/linogaliana/python-datascientist-notebooks/blob/main/notebooks/NLP/04_word2vec.ipynb" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a>
<a href="https://github.dev/linogaliana/python-datascientist-notebooks/notebooks/NLP/04_word2vec.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/static/v1?logo=visualstudiocode&amp;label=&amp;message=Open%20in%20Visual%20Studio%20Code&amp;labelColor=2c2c32&amp;color=007acc&amp;logoColor=007acc" alt="githubdev"></a>
</p>
<p></p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Ce chapitre va √©voluer prochainement.</p>
</div>
</div>
</div>
<p>Cette page approfondit certains aspects pr√©sent√©s dans la
<a href="../../content/NLP/02_exoclean.html">partie introductive</a>. Apr√®s avoir travaill√© sur le
<em>Comte de Monte Cristo</em>, on va continuer notre exploration de la litt√©rature
avec cette fois des auteurs anglophones :</p>
<ul>
<li>Edgar Allan Poe, (EAP) ;</li>
<li>HP Lovecraft (HPL) ;</li>
<li>Mary Wollstonecraft Shelley (MWS).</li>
</ul>
<p>Les donn√©es sont disponibles sur un CSV mis √† disposition sur <a href="https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/blob/master/data/spooky.csv"><code>Github</code></a>. L‚ÄôURL pour les r√©cup√©rer directement est
<a href="https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/raw/master/data/spooky.csv" class="uri">https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/raw/master/data/spooky.csv</a>.</p>
<p>Le but va √™tre dans un premier temps de regarder dans le d√©tail les termes les plus fr√©quents utilis√©s par les auteurs et de les repr√©senter graphiquement, puis on va ensuite essayer de pr√©dire quel texte correspond √† quel auteur √† partir de diff√©rents mod√®les de vectorisation, notamment les <em>word embeddings</em>.</p>
<p>Ce chapitre s‚Äôinspire de plusieurs ressources disponibles en ligne:</p>
<ul>
<li>Un <a href="https://www.kaggle.com/enerrio/scary-nlp-with-spacy-and-keras">premier <em>notebook</em> sur <code>Kaggle</code></a>
et un <a href="https://www.kaggle.com/meiyizi/spooky-nlp-and-topic-modelling-tutorial/notebook">deuxi√®me</a> ;</li>
<li>Un <a href="https://github.com/GU4243-ADS/spring2018-project1-ginnyqg">d√©p√¥t <code>Github</code></a> ;</li>
</ul>
<section id="packages-√†-installer" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Packages √† installer</h1>
<p>Comme dans la <a href="../../content/NLP/02_exoclean.html">partie pr√©c√©dente</a>, il faut t√©l√©charger des librairies
sp√©cialis√©ees pour le NLP, ainsi que certaines de leurs d√©pendances.</p>
<div id="ddfe1a99" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="ddfe1a99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ddfe1a99-1"><a href="#ddfe1a99-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install scipy<span class="op">==</span><span class="fl">1.12</span> gensim sentence_transformers pandas matplotlib seaborn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ensuite, comme nous allons utiliser la librairie <code>SpaCy</code> avec un corpus de textes
en Anglais, il convient de t√©l√©charger le mod√®le NLP pour l‚ÄôAnglais. Pour cela,
on peut se r√©f√©rer √† <a href="https://spacy.io/usage/models">la documentation de <code>SpaCy</code></a>,
extr√™mement bien faite.</p>
<div id="935e3ff2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="935e3ff2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="935e3ff2-1"><a href="#935e3ff2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m spacy download en_core_web_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2357ccc8" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="2357ccc8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="2357ccc8-1"><a href="#2357ccc8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="2357ccc8-2"><a href="#2357ccc8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="2357ccc8-3"><a href="#2357ccc8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="2357ccc8-4"><a href="#2357ccc8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="2357ccc8-5"><a href="#2357ccc8-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="2357ccc8-6"><a href="#2357ccc8-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="2357ccc8-7"><a href="#2357ccc8-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gensim</span>
<span id="2357ccc8-8"><a href="#2357ccc8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="2357ccc8-9"><a href="#2357ccc8-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="2357ccc8-10"><a href="#2357ccc8-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="2357ccc8-11"><a href="#2357ccc8-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="2357ccc8-12"><a href="#2357ccc8-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="2357ccc8-13"><a href="#2357ccc8-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> LinearSVC</span>
<span id="2357ccc8-14"><a href="#2357ccc8-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer, TfidfVectorizer</span>
<span id="2357ccc8-15"><a href="#2357ccc8-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV, cross_val_score</span>
<span id="2357ccc8-16"><a href="#2357ccc8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="2357ccc8-17"><a href="#2357ccc8-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models.word2vec <span class="im">import</span> Word2Vec</span>
<span id="2357ccc8-18"><a href="#2357ccc8-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gensim.downloader</span>
<span id="2357ccc8-19"><a href="#2357ccc8-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="nettoyage-des-donn√©es" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Nettoyage des donn√©es</h1>
<p>Nous allons ainsi √† nouveau utiliser le jeu de donn√©es <code>spooky</code> :</p>
<div id="12b14de7" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="12b14de7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="12b14de7-1"><a href="#12b14de7-1" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/raw/master/data/spooky.csv"</span></span>
<span id="12b14de7-2"><a href="#12b14de7-2" aria-hidden="true" tabindex="-1"></a>spooky_df <span class="op">=</span> pd.read_csv(data_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le jeu de donn√©es met ainsi en regard un auteur avec une phrase qu‚Äôil a √©crite :</p>
<div id="90367855" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="90367855"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="90367855-1"><a href="#90367855-1" aria-hidden="true" tabindex="-1"></a>spooky_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="preprocessing" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="preprocessing"><span class="header-section-number">2.1</span> Preprocessing</h2>
<p>En NLP, la premi√®re √©tape est souvent celle du <em>preprocessing</em>, qui inclut notamment les √©tapes de tokenization et de nettoyage du texte. Comme celles-ci ont √©t√© vues en d√©tail dans le pr√©c√©dent chapitre, on se contentera ici d‚Äôun <em>preprocessing</em> minimaliste : suppression de la ponctuation et des <em>stop words</em> (pour la visualisation et les m√©thodes de vectorisation bas√©es sur des comptages).</p>
<p>Jusqu‚Äô√† pr√©sent, nous avons utilis√© principalement <code>nltk</code> pour le
<em>preprocessing</em> de donn√©es textuelles. Cette fois, nous proposons
d‚Äôutiliser la librairie <code>spaCy</code> qui permet de mieux automatiser sous forme de
<em>pipelines</em> de <em>preprocessing</em>.</p>
<p>Pour initialiser le processus de nettoyage,
on va utiliser le corpus <code>en_core_web_sm</code> (voir plus
haut pour l‚Äôinstallation de ce corpus):</p>
<div id="65402c5b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="65402c5b"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="65402c5b-1"><a href="#65402c5b-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="65402c5b-2"><a href="#65402c5b-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="65402c5b-3"><a href="#65402c5b-3" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On va utiliser un <code>pipe</code> <code>spacy</code> qui permet d‚Äôautomatiser, et de parall√©liser,
un certain nombre d‚Äôop√©rations. Les <em>pipes</em> sont l‚Äô√©quivalent, en NLP, de
nos <em>pipelines</em> <code>scikit</code> ou des <em>pipes</em> <code>pandas</code>. Il s‚Äôagit donc d‚Äôun outil
tr√®s appropri√© pour industrialiser un certain nombre d‚Äôop√©rations de
<em>preprocessing</em> :</p>
<div id="5f4e22fe" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="5f4e22fe"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5f4e22fe-1"><a href="#5f4e22fe-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_docs(texts, remove_stopwords<span class="op">=</span><span class="va">False</span>, n_process<span class="op">=</span><span class="dv">4</span>):</span>
<span id="5f4e22fe-2"><a href="#5f4e22fe-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="5f4e22fe-3"><a href="#5f4e22fe-3" aria-hidden="true" tabindex="-1"></a>    docs <span class="op">=</span> nlp.pipe(</span>
<span id="5f4e22fe-4"><a href="#5f4e22fe-4" aria-hidden="true" tabindex="-1"></a>        texts, n_process<span class="op">=</span>n_process, disable<span class="op">=</span>[<span class="st">"parser"</span>, <span class="st">"ner"</span>, <span class="st">"lemmatizer"</span>, <span class="st">"textcat"</span>]</span>
<span id="5f4e22fe-5"><a href="#5f4e22fe-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="5f4e22fe-6"><a href="#5f4e22fe-6" aria-hidden="true" tabindex="-1"></a>    stopwords <span class="op">=</span> nlp.Defaults.stop_words</span>
<span id="5f4e22fe-7"><a href="#5f4e22fe-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="5f4e22fe-8"><a href="#5f4e22fe-8" aria-hidden="true" tabindex="-1"></a>    docs_cleaned <span class="op">=</span> []</span>
<span id="5f4e22fe-9"><a href="#5f4e22fe-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> doc <span class="kw">in</span> docs:</span>
<span id="5f4e22fe-10"><a href="#5f4e22fe-10" aria-hidden="true" tabindex="-1"></a>        tokens <span class="op">=</span> [tok.text.lower().strip() <span class="cf">for</span> tok <span class="kw">in</span> doc <span class="cf">if</span> <span class="kw">not</span> tok.is_punct]</span>
<span id="5f4e22fe-11"><a href="#5f4e22fe-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> remove_stopwords:</span>
<span id="5f4e22fe-12"><a href="#5f4e22fe-12" aria-hidden="true" tabindex="-1"></a>            tokens <span class="op">=</span> [tok <span class="cf">for</span> tok <span class="kw">in</span> tokens <span class="cf">if</span> tok <span class="kw">not</span> <span class="kw">in</span> stopwords]</span>
<span id="5f4e22fe-13"><a href="#5f4e22fe-13" aria-hidden="true" tabindex="-1"></a>        doc_clean <span class="op">=</span> <span class="st">" "</span>.join(tokens)</span>
<span id="5f4e22fe-14"><a href="#5f4e22fe-14" aria-hidden="true" tabindex="-1"></a>        docs_cleaned.append(doc_clean)</span>
<span id="5f4e22fe-15"><a href="#5f4e22fe-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="5f4e22fe-16"><a href="#5f4e22fe-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> docs_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On applique la fonction <code>clean_docs</code> √† notre colonne <code>pandas</code>.
Les <code>pandas.Series</code> √©tant it√©rables, elles se comportent comme des listes et
fonctionnent ainsi tr√®s bien avec notre <code>pipe</code> <code>spacy</code>.</p>
<div id="4fc5c5a8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="4fc5c5a8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="4fc5c5a8-1"><a href="#4fc5c5a8-1" aria-hidden="true" tabindex="-1"></a>spooky_df[<span class="st">"text_clean"</span>] <span class="op">=</span> clean_docs(spooky_df[<span class="st">"text"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="025d0bfd" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="025d0bfd"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="025d0bfd-1"><a href="#025d0bfd-1" aria-hidden="true" tabindex="-1"></a>spooky_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="encodage-de-la-variable-√†-pr√©dire" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="encodage-de-la-variable-√†-pr√©dire"><span class="header-section-number">2.2</span> Encodage de la variable √† pr√©dire</h2>
<p>On r√©alise un simple encodage de la variable √† pr√©dire :
il y a trois cat√©gories (auteurs), repr√©sent√©es par des entiers 0, 1 et 2.</p>
<p>Pour cela, on utilise le <code>LabelEncoder</code> de <code>scikit</code> d√©j√† pr√©sent√©
dans la <a href="#preprocessing">partie mod√©lisation</a>. On va utiliser la m√©thode
<code>fit_transform</code> qui permet, en un tour de main, d‚Äôappliquer √† la fois
l‚Äôentra√Ænement (<code>fit</code>), √† savoir la cr√©ation d‚Äôune correspondance entre valeurs
num√©riques et <em>labels</em>, et l‚Äôappliquer (<code>transform</code>) √† la m√™me colonne.</p>
<div id="c0574f61" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="c0574f61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c0574f61-1"><a href="#c0574f61-1" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="c0574f61-2"><a href="#c0574f61-2" aria-hidden="true" tabindex="-1"></a>spooky_df[<span class="st">"author_encoded"</span>] <span class="op">=</span> le.fit_transform(spooky_df[<span class="st">"author"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut v√©rifier les classes de notre <code>LabelEncoder</code> :</p>
<div id="68af0f01" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="68af0f01"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="68af0f01-1"><a href="#68af0f01-1" aria-hidden="true" tabindex="-1"></a>le.classes_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="construction-des-bases-dentra√Ænement-et-de-test" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="construction-des-bases-dentra√Ænement-et-de-test"><span class="header-section-number">2.3</span> Construction des bases d‚Äôentra√Ænement et de test</h2>
<p>On met de c√¥t√© un √©chantillon de test (20 %) avant toute analyse (m√™me descriptive).
Cela permettra d‚Äô√©valuer nos diff√©rents mod√®les toute √† la fin de mani√®re tr√®s rigoureuse,
puisque ces donn√©es n‚Äôauront jamais utilis√©es pendant l‚Äôentra√Ænement.</p>
<div id="21cfd669" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="21cfd669"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="21cfd669-1"><a href="#21cfd669-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> spooky_df[<span class="st">"author_encoded"</span>]</span>
<span id="21cfd669-2"><a href="#21cfd669-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> spooky_df[<span class="st">"text_clean"</span>]</span>
<span id="21cfd669-3"><a href="#21cfd669-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="21cfd669-4"><a href="#21cfd669-4" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, stratify<span class="op">=</span>y, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="21cfd669-5"><a href="#21cfd669-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notre √©chantillon initial n‚Äôest pas √©quilibr√© (<em>balanced</em>) : on retrouve plus d‚Äôoeuvres de
certains auteurs que d‚Äôautres. Afin d‚Äôobtenir un mod√®le qui soit √©valu√© au mieux, nous allons donc stratifier notre √©chantillon de mani√®re √† obtenir une r√©partition similaire d‚Äôauteurs dans nos
ensembles d‚Äôentra√Ænement et de test.</p>
<p>Aper√ßu du premier √©l√©ment de <code>X_train</code> :</p>
<div id="5c8dfa26" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="5c8dfa26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5c8dfa26-1"><a href="#5c8dfa26-1" aria-hidden="true" tabindex="-1"></a>X_train[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut aussi v√©rifier qu‚Äôon est capable de retrouver
la correspondance entre nos auteurs initiaux avec
la m√©thode <code>inverse_transform</code> :</p>
<div id="e14d95ff" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="e14d95ff"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e14d95ff-1"><a href="#e14d95ff-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train[<span class="dv">0</span>], le.inverse_transform([y_train[<span class="dv">0</span>]])[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="statistiques-exploratoires" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Statistiques exploratoires</h1>
<section id="r√©partition-des-labels" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="r√©partition-des-labels"><span class="header-section-number">3.1</span> R√©partition des labels</h2>
<p>Refaisons un graphique que nous avons d√©j√† produit pr√©c√©demment pour voir
la r√©partition de notre corpus entre auteurs :</p>
<div id="a3cfc52d" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="a3cfc52d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a3cfc52d-1"><a href="#a3cfc52d-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.Series(le.inverse_transform(y_train)).value_counts().plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="a3cfc52d-2"><a href="#a3cfc52d-2" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On observe une petite asym√©trie : les passages des livres d‚ÄôEdgar Allen Poe sont plus nombreux que ceux des autres auteurs dans notre corpus d‚Äôentra√Ænement, ce qui peut √™tre probl√©matique dans le cadre d‚Äôune t√¢che de classification.
L‚Äô√©cart n‚Äôest pas dramatique, mais on essaiera d‚Äôen tenir compte dans l‚Äôanalyse en choisissant une m√©trique d‚Äô√©valuation pertinente.</p>
</section>
<section id="mots-les-plus-fr√©quemment-utilis√©s-par-chaque-auteur" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="mots-les-plus-fr√©quemment-utilis√©s-par-chaque-auteur"><span class="header-section-number">3.2</span> Mots les plus fr√©quemment utilis√©s par chaque auteur</h2>
<p>On va supprimer les <em>stop words</em> pour r√©duire le bruit dans notre jeu
de donn√©es.</p>
<div id="fc85a94a" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="fc85a94a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fc85a94a-1"><a href="#fc85a94a-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression des stop words</span></span>
<span id="fc85a94a-2"><a href="#fc85a94a-2" aria-hidden="true" tabindex="-1"></a>X_train_no_sw <span class="op">=</span> clean_docs(X_train, remove_stopwords<span class="op">=</span><span class="va">True</span>)</span>
<span id="fc85a94a-3"><a href="#fc85a94a-3" aria-hidden="true" tabindex="-1"></a>X_train_no_sw <span class="op">=</span> np.array(X_train_no_sw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour visualiser rapidement nos corpus, on peut utiliser la technique des
nuages de mots d√©j√† vue √† plusieurs reprises.</p>
<p>Vous pouvez essayer de faire vous-m√™me les nuages ci-dessous
ou cliquer sur la ligne ci-dessous pour afficher le code ayant
g√©n√©r√© les figures :</p>
<div class="cell markdown">
<details><summary><code>Cliquer pour afficher le code</code> üëá</summary>
<div id="4fd511a8" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_top_words(initials, ax, n_words<span class="op">=</span><span class="dv">20</span>):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul des mots les plus fr√©quemment utilis√©s par l'auteur</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    texts <span class="op">=</span> X_train_no_sw[le.inverse_transform(y_train) <span class="op">==</span> initials]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    all_tokens <span class="op">=</span> <span class="st">" "</span>.join(texts).split()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> Counter(all_tokens)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    top_words <span class="op">=</span> [word[<span class="dv">0</span>] <span class="cf">for</span> word <span class="kw">in</span> counts.most_common(n_words)]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    top_words_counts <span class="op">=</span> [word[<span class="dv">1</span>] <span class="cf">for</span> word <span class="kw">in</span> counts.most_common(n_words)]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Repr√©sentation sous forme de barplot</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> sns.barplot(ax<span class="op">=</span>ax, x<span class="op">=</span>top_words, y<span class="op">=</span>top_words_counts)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"Most Common Words used by </span><span class="sc">{</span>initials_to_author[initials]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a3231f1a" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>initials_to_author <span class="op">=</span> {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"EAP"</span>: <span class="st">"Edgar Allen Poe"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"HPL"</span>: <span class="st">"H.P. Lovecraft"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MWS"</span>: <span class="st">"Mary Wollstonecraft Shelley"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plot_top_words(<span class="st">"EAP"</span>, ax<span class="op">=</span>axs[<span class="dv">0</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>plot_top_words(<span class="st">"HPL"</span>, ax<span class="op">=</span>axs[<span class="dv">1</span>])</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>plot_top_words(<span class="st">"MWS"</span>, ax<span class="op">=</span>axs[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
</div>
<p>Beaucoup de mots se retrouvent tr√®s utilis√©s par les trois auteurs.
Il y a cependant des diff√©rences notables : le mot <em>‚Äúlife‚Äù</em>
est le plus employ√© par MWS, alors qu‚Äôil n‚Äôappara√Æt pas dans les deux autres tops.
De m√™me, le mot <em>‚Äúold‚Äù</em> est le plus utilis√© par HPL
l√† o√π les deux autres ne l‚Äôutilisent pas de mani√®re surrepr√©sent√©e.</p>
<p>Il semble donc qu‚Äôil y ait des particularit√©s propres √† chacun des auteurs
en termes de vocabulaire,
ce qui laisse penser qu‚Äôil est envisageable de pr√©dire les auteurs √† partir
de leurs textes dans une certaine mesure.</p>
</section>
</section>
<section id="pr√©diction-sur-le-set-dentra√Ænement" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Pr√©diction sur le set d‚Äôentra√Ænement</h1>
<p>Nous allons √† pr√©sent v√©rifier cette conjecture en comparant
plusieurs mod√®les de vectorisation,
<em>i.e.</em> de transformation du texte en objets num√©riques
pour que l‚Äôinformation contenue soit exploitable dans un mod√®le de classification.</p>
<section id="d√©marche" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="d√©marche"><span class="header-section-number">4.1</span> D√©marche</h2>
<p>Comme nous nous int√©ressons plus √† l‚Äôeffet de la vectorisation qu‚Äô√† la t√¢che de classification en elle-m√™me,
nous allons utiliser un algorithme de classification simple (un SVM lin√©aire), avec des param√®tres non fine-tun√©s (c‚Äôest-√†-dire des param√®tres pas n√©cessairement choisis pour √™tre les meilleurs de tous).</p>
<div id="20b491e4" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="20b491e4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="20b491e4-1"><a href="#20b491e4-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LinearSVC(max_iter<span class="op">=</span><span class="dv">10000</span>, C<span class="op">=</span><span class="fl">0.1</span>, dual<span class="op">=</span><span class="st">"auto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ce mod√®le est connu pour √™tre tr√®s performant sur les t√¢ches de classification de texte, et nous fournira donc un bon mod√®le de r√©f√©rence (<em>baseline</em>). Cela nous permettra √©galement de comparer de mani√®re objective l‚Äôimpact des m√©thodes de vectorisation sur la performance finale.</p>
<p>Pour les deux premi√®res m√©thodes de vectorisation
(bas√©es sur des fr√©quences et fr√©quences relatives des mots),
on va simplement normaliser les donn√©es d‚Äôentr√©e, ce qui va permettre au SVM de converger plus rapidement, ces mod√®les √©tant sensibles aux diff√©rences d‚Äô√©chelle dans les donn√©es.</p>
<p>On va √©galement <em>fine-tuner</em> via <em>grid-search</em>
certains hyperparam√®tres li√©s √† ces m√©thodes de vectorisation :</p>
<ul>
<li>on teste diff√©rents <em>ranges</em> de <code>n-grams</code> (unigrammes et unigrammes + bigrammes)</li>
<li>on teste avec et sans <em>stop-words</em></li>
</ul>
<p>Afin d‚Äô√©viter le surapprentissage,
on va √©valuer les diff√©rents mod√®les via validation crois√©e, calcul√©e sur 4 blocs.</p>
<p>On r√©cup√®re √† la fin le meilleur mod√®le selon une m√©trique sp√©cifi√©e.
On choisit le <code>score F1</code>,
moyenne harmonique de la pr√©cision et du rappel,
qui donne un poids √©quilibr√© aux deux m√©triques, tout en p√©nalisant fortement le cas o√π l‚Äôune des deux est faible.
Pr√©cis√©ment, on retient le <code>score F1 *micro-averaged*</code> :
les contributions des diff√©rentes classes √† pr√©dire sont agr√©g√©es,
puis on calcule le <code>score F1</code> sur ces donn√©es agr√©g√©es.
L‚Äôavantage de ce choix est qu‚Äôil permet de tenir compte des diff√©rences
de fr√©quences des diff√©rentes classes.</p>
</section>
<section id="pipeline-de-pr√©diction" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="pipeline-de-pr√©diction"><span class="header-section-number">4.2</span> Pipeline de pr√©diction</h2>
<p>On va utiliser un <em>pipeline</em> <code>scikit</code> ce qui va nous permettre d‚Äôavoir
un code tr√®s concis pour effectuer cet ensemble de t√¢ches coh√©rentes.
De plus, cela va nous assurer de g√©rer de mani√®re coh√©rente nos diff√©rentes
transformations (cf.&nbsp;<a href="#pipelines">partie sur les pipelines</a>)</p>
<p>Pour se faciliter la vie, on d√©finit une fonction <code>fit_vectorizers</code> qui
int√®gre dans un <em>pipeline</em> g√©n√©rique une m√©thode d‚Äôestimation <code>scikit</code>
et fait de la validation crois√©e en cherchant le meilleur mod√®le
(en excluant/incluant les <em>stop words</em> et avec unigrammes/bigrammes)</p>
<div id="b79be3b2" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="b79be3b2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b79be3b2-1"><a href="#b79be3b2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit_vectorizers(vectorizer):</span>
<span id="b79be3b2-2"><a href="#b79be3b2-2" aria-hidden="true" tabindex="-1"></a>    pipeline <span class="op">=</span> Pipeline(</span>
<span id="b79be3b2-3"><a href="#b79be3b2-3" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="b79be3b2-4"><a href="#b79be3b2-4" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"vect"</span>, vectorizer()),</span>
<span id="b79be3b2-5"><a href="#b79be3b2-5" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"scaling"</span>, StandardScaler(with_mean<span class="op">=</span><span class="va">False</span>)),</span>
<span id="b79be3b2-6"><a href="#b79be3b2-6" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"clf"</span>, clf),</span>
<span id="b79be3b2-7"><a href="#b79be3b2-7" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="b79be3b2-8"><a href="#b79be3b2-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="b79be3b2-9"><a href="#b79be3b2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="b79be3b2-10"><a href="#b79be3b2-10" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> {</span>
<span id="b79be3b2-11"><a href="#b79be3b2-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"vect__ngram_range"</span>: ((<span class="dv">1</span>, <span class="dv">1</span>), (<span class="dv">1</span>, <span class="dv">2</span>)),  <span class="co"># unigrams or bigrams</span></span>
<span id="b79be3b2-12"><a href="#b79be3b2-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"vect__stop_words"</span>: (<span class="st">"english"</span>, <span class="va">None</span>),</span>
<span id="b79be3b2-13"><a href="#b79be3b2-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="b79be3b2-14"><a href="#b79be3b2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="b79be3b2-15"><a href="#b79be3b2-15" aria-hidden="true" tabindex="-1"></a>    grid_search <span class="op">=</span> GridSearchCV(</span>
<span id="b79be3b2-16"><a href="#b79be3b2-16" aria-hidden="true" tabindex="-1"></a>        pipeline, parameters, scoring<span class="op">=</span><span class="st">"f1_micro"</span>, cv<span class="op">=</span><span class="dv">4</span>, n_jobs<span class="op">=</span><span class="dv">4</span>, verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="b79be3b2-17"><a href="#b79be3b2-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="b79be3b2-18"><a href="#b79be3b2-18" aria-hidden="true" tabindex="-1"></a>    grid_search.fit(X_train, y_train)</span>
<span id="b79be3b2-19"><a href="#b79be3b2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="b79be3b2-20"><a href="#b79be3b2-20" aria-hidden="true" tabindex="-1"></a>    best_parameters <span class="op">=</span> grid_search.best_estimator_.get_params()</span>
<span id="b79be3b2-21"><a href="#b79be3b2-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> param_name <span class="kw">in</span> <span class="bu">sorted</span>(parameters.keys()):</span>
<span id="b79be3b2-22"><a href="#b79be3b2-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\t</span><span class="sc">%s</span><span class="st">: </span><span class="sc">%r</span><span class="st">"</span> <span class="op">%</span> (param_name, best_parameters[param_name]))</span>
<span id="b79be3b2-23"><a href="#b79be3b2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="b79be3b2-24"><a href="#b79be3b2-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"CV scores </span><span class="sc">{</span>grid_search<span class="sc">.</span>cv_results_[<span class="st">'mean_test_score'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="b79be3b2-25"><a href="#b79be3b2-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mean F1 </span><span class="sc">{</span>np<span class="sc">.</span>mean(grid_search.cv_results_[<span class="st">'mean_test_score'</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="b79be3b2-26"><a href="#b79be3b2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="b79be3b2-27"><a href="#b79be3b2-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid_search</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="approche-bag-of-words" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Approche <em>bag-of-words</em></h1>
<p>On commence par une approche <strong>‚Äúbag-of-words‚Äù</strong>,
i.e.&nbsp;qui revient simplement √† repr√©senter chaque document par un vecteur
qui compte le nombre d‚Äôapparitions de chaque mot du vocabulaire dans le document.</p>
<p>Illustrons d‚Äôabord le principe √† l‚Äôaide d‚Äôun exemple simple.</p>
<div id="ee6c5982" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="ee6c5982"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ee6c5982-1"><a href="#ee6c5982-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="op">=</span> [</span>
<span id="ee6c5982-2"><a href="#ee6c5982-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Un premier document √† propos des chats."</span>,</span>
<span id="ee6c5982-3"><a href="#ee6c5982-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Un second document qui parle des chiens."</span>,</span>
<span id="ee6c5982-4"><a href="#ee6c5982-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="ee6c5982-5"><a href="#ee6c5982-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="ee6c5982-6"><a href="#ee6c5982-6" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer()</span>
<span id="ee6c5982-7"><a href="#ee6c5982-7" aria-hidden="true" tabindex="-1"></a>vectorizer.fit(corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L‚Äôobjet <code>vectorizer</code> a √©t√© ‚Äúentra√Æn√©‚Äù (<em>fit</em>) sur notre corpus d‚Äôexemple contenant deux documents. Il a notamment appris le vocabulaire complet du corpus, dont on peut afficher l‚Äôordre.</p>
<div id="526e256e" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="526e256e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="526e256e-1"><a href="#526e256e-1" aria-hidden="true" tabindex="-1"></a>vectorizer.get_feature_names_out()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L‚Äôobjet <code>vectorizer</code> entra√Æn√© peut maintenant vectoriser le corpus initial, selon l‚Äôordre du vocabulaire affich√© ci-dessus.</p>
<div id="9a0e15df" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="9a0e15df"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="9a0e15df-1"><a href="#9a0e15df-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> vectorizer.transform(corpus)</span>
<span id="9a0e15df-2"><a href="#9a0e15df-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quel score <code>F1</code> obtient-on finalement avec cette m√©thode de vectorisation sur notre probl√®me de classification d‚Äôauteurs ?</p>
<div id="99a4d640" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="99a4d640"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="99a4d640-1"><a href="#99a4d640-1" aria-hidden="true" tabindex="-1"></a>cv_bow <span class="op">=</span> fit_vectorizers(CountVectorizer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tf-idf" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> TF-IDF</h1>
<p>On s‚Äôint√©resse ensuite √† l‚Äôapproche <strong>TF-IDF</strong>,
qui permet de tenir compte des fr√©quences <em>relatives</em> des mots.</p>
<p>Ainsi, pour un mot donn√©, on va multiplier la fr√©quence d‚Äôapparition du mot dans le document (calcul√© comme dans la m√©thode pr√©c√©dente) par un terme qui p√©nalise une fr√©quence √©lev√©e du mot dans le corpus. L‚Äôimage ci-dessous, emprunt√©e √† Chris Albon, illustre cette mesure:</p>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/tfidf.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/tfidf.png" class="img-fluid"></a></p>
<p><em>Source: <a href="https://towardsdatascience.com/tf-term-frequency-idf-inverse-document-frequency-from-scratch-in-python-6c2b61b78558">Towards Data Science</a></em></p>
<p>La vectorisation <code>TF-IDF</code> permet donc de limiter l‚Äôinfluence des <em>stop-words</em>
et donc de donner plus de poids aux mots les plus salients d‚Äôun document.
Illustrons cela √† nouveau avec notre corpus d‚Äôexemple de deux documents.</p>
<div id="346013ac" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="346013ac"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="346013ac-1"><a href="#346013ac-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="op">=</span> [</span>
<span id="346013ac-2"><a href="#346013ac-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Un premier document √† propos des chats."</span>,</span>
<span id="346013ac-3"><a href="#346013ac-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Un second document qui parle des chiens."</span>,</span>
<span id="346013ac-4"><a href="#346013ac-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="346013ac-5"><a href="#346013ac-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="346013ac-6"><a href="#346013ac-6" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> TfidfVectorizer()</span>
<span id="346013ac-7"><a href="#346013ac-7" aria-hidden="true" tabindex="-1"></a>vectorizer.fit(corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L√† encore, le vectoriseur a ‚Äúappris‚Äù le vocabulaire du corpus.</p>
<div id="0799451d" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="0799451d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="0799451d-1"><a href="#0799451d-1" aria-hidden="true" tabindex="-1"></a>vectorizer.get_feature_names_out()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et peut √™tre utilis√© pour calculer les scores TF-IDF de chacun des termes des documents.</p>
<div id="7c968ee3" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="7c968ee3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="7c968ee3-1"><a href="#7c968ee3-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> vectorizer.transform(corpus)</span>
<span id="7c968ee3-2"><a href="#7c968ee3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On remarque que ‚Äúchats‚Äù et ‚Äúchiens‚Äù poss√®dent les scores les plus √©lev√©s, ce sont bien les termes les plus distinctifs. A l‚Äôinverse, les termes qui reviennent dans les deux documents (‚Äúun‚Äù, ‚Äúdocument‚Äù, ‚Äúdes‚Äù) ont un score inf√©rieur, car ils sont beaucoup pr√©sents dans le corpus relativement.</p>
<p>Quel score <code>F1</code> obtient-on avec cette m√©thode de vectorisation sur notre probl√®me de classification d‚Äôauteurs ?</p>
<div id="f64cd3c5" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="f64cd3c5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="f64cd3c5-1"><a href="#f64cd3c5-1" aria-hidden="true" tabindex="-1"></a>cv_tfidf <span class="op">=</span> fit_vectorizers(TfidfVectorizer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On observe clairement que la performance de classification est bien sup√©rieure,
ce qui montre la pertinence de cette technique.</p>
</section>
<section id="word2vec-avec-averaging" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Word2vec avec averaging</h1>
<p>On va maintenant explorer les techniques de vectorisation bas√©es sur les
<em>embeddings</em> de mots, et notamment la plus populaire : <code>Word2Vec</code>.</p>
<p>L‚Äôid√©e derri√®re est simple, mais a r√©volutionn√© le NLP :
au lieu de repr√©senter les documents par des
vecteurs <em>sparse</em> de tr√®s grande dimension (la taille du vocabulaire)
comme on l‚Äôa fait jusqu‚Äô√† pr√©sent,
on va les repr√©senter par des vecteurs <em>dense</em> (continus)
de dimension r√©duite (en g√©n√©ral, autour de 100-300).</p>
<p>Chacune de ces dimensions va repr√©senter un facteur latent,
c‚Äôest √† dire une variable inobserv√©e,
de la m√™me mani√®re que les composantes principales produites par une ACP.</p>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/w2v_vecto.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/w2v_vecto.png" class="img-fluid"></a></p>
<p><em>Source: <a href="https://medium.com/@zafaralibagh6/simple-tutorial-on-word-embedding-and-word2vec-43d477624b6d">Medium</a></em></p>
<p><strong>Pourquoi est-ce int√©ressant ?</strong>
Pour de nombreuses raisons, mais pour r√©sumer :
cela permet de beaucoup mieux capturer la similarit√© s√©mantique entre les documents.</p>
<p>Par exemple, un humain sait qu‚Äôun document contenant le mot <em>‚ÄúRoi‚Äù</em>
et un autre document contenant le mot <em>‚ÄúReine‚Äù</em> ont beaucoup de chance
d‚Äôaborder des sujets semblables.</p>
<p>Pourtant, une vectorisation de type comptage ou TF-IDF
ne permet pas de saisir cette similarit√© :
le calcul d‚Äôune mesure de similarit√© (norme euclidienne ou similarit√© cosinus)
entre les deux vecteurs ne prendra en compte la similarit√© des deux concepts, puisque les mots utilis√©s sont diff√©rents.</p>
<p>A l‚Äôinverse, un mod√®le <code>word2vec</code> bien entra√Æn√© va capter
qu‚Äôil existe un facteur latent de type <em>‚Äúroyaut√©‚Äù</em>,
et la similarit√© entre les vecteurs associ√©s aux deux mots sera forte.</p>
<p>La magie va m√™me plus loin : le mod√®le captera aussi qu‚Äôil existe un
facteur latent de type <em>‚Äúgenre‚Äù</em>,
et va permettre de construire un espace s√©mantique dans lequel les
relations arithm√©tiques entre vecteurs ont du sens ;
par exemple :
<span class="math display">\[\text{king} - \text{man} + \text{woman} ‚âà \text{queen}\]</span></p>
<p><strong>Comment ces mod√®les sont-ils entra√Æn√©s ?</strong>
Via une t√¢che de pr√©diction r√©solue par un r√©seau de neurones simple.</p>
<p>L‚Äôid√©e fondamentale est que la signification d‚Äôun mot se comprend
en regardant les mots qui apparaissent fr√©quemment dans son voisinage.</p>
<p>Pour un mot donn√©, on va donc essayer de pr√©dire les mots
qui apparaissent dans une fen√™tre autour du mot cible.</p>
<p>En r√©p√©tant cette t√¢che de nombreuses fois et sur un corpus suffisamment vari√©,
on obtient finalement des <em>embeddings</em> pour chaque mot du vocabulaire,
qui pr√©sentent les propri√©t√©s discut√©es pr√©c√©demment.</p>
<div id="fa91c3bb" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="fa91c3bb"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fa91c3bb-1"><a href="#fa91c3bb-1" aria-hidden="true" tabindex="-1"></a>X_train_tokens <span class="op">=</span> [text.split() <span class="cf">for</span> text <span class="kw">in</span> X_train]</span>
<span id="fa91c3bb-2"><a href="#fa91c3bb-2" aria-hidden="true" tabindex="-1"></a>w2v_model <span class="op">=</span> Word2Vec(X_train_tokens, vector_size<span class="op">=</span><span class="dv">200</span>, window<span class="op">=</span><span class="dv">5</span>, min_count<span class="op">=</span><span class="dv">1</span>, workers<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="78957cb4" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="78957cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="78957cb4-1"><a href="#78957cb4-1" aria-hidden="true" tabindex="-1"></a>w2v_model.wv.most_similar(<span class="st">"mother"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On voit que les mots les plus similaires √† <em>‚Äúmother‚Äù</em>
sont souvent des mots li√©s √† la famille, mais pas toujours.</p>
<p>C‚Äôest li√© √† la taille tr√®s restreinte du corpus sur lequel on entra√Æne le mod√®le,
qui ne permet pas de r√©aliser des associations toujours pertinentes.</p>
<p>L‚Äô<em>embedding</em> (la repr√©sentation vectorielle) de chaque document correspond √† la moyenne des <em>word-embeddings</em> des mots qui le composent :</p>
<div id="0d766d4d" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="0d766d4d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="0d766d4d-1"><a href="#0d766d4d-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_mean_vector(w2v_vectors, words):</span>
<span id="0d766d4d-2"><a href="#0d766d4d-2" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> words <span class="cf">if</span> word <span class="kw">in</span> w2v_vectors]</span>
<span id="0d766d4d-3"><a href="#0d766d4d-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> words:</span>
<span id="0d766d4d-4"><a href="#0d766d4d-4" aria-hidden="true" tabindex="-1"></a>        avg_vector <span class="op">=</span> np.mean(w2v_vectors[words], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="0d766d4d-5"><a href="#0d766d4d-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="0d766d4d-6"><a href="#0d766d4d-6" aria-hidden="true" tabindex="-1"></a>        avg_vector <span class="op">=</span> np.zeros_like(w2v_vectors[<span class="st">"hi"</span>])</span>
<span id="0d766d4d-7"><a href="#0d766d4d-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> avg_vector</span>
<span id="0d766d4d-8"><a href="#0d766d4d-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="0d766d4d-9"><a href="#0d766d4d-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="0d766d4d-10"><a href="#0d766d4d-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit_w2v_avg(w2v_vectors):</span>
<span id="0d766d4d-11"><a href="#0d766d4d-11" aria-hidden="true" tabindex="-1"></a>    X_train_vectors <span class="op">=</span> np.array(</span>
<span id="0d766d4d-12"><a href="#0d766d4d-12" aria-hidden="true" tabindex="-1"></a>        [get_mean_vector(w2v_vectors, words) <span class="cf">for</span> words <span class="kw">in</span> X_train_tokens]</span>
<span id="0d766d4d-13"><a href="#0d766d4d-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="0d766d4d-14"><a href="#0d766d4d-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="0d766d4d-15"><a href="#0d766d4d-15" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> cross_val_score(</span>
<span id="0d766d4d-16"><a href="#0d766d4d-16" aria-hidden="true" tabindex="-1"></a>        clf, X_train_vectors, y_train, cv<span class="op">=</span><span class="dv">4</span>, scoring<span class="op">=</span><span class="st">"f1_micro"</span>, n_jobs<span class="op">=</span><span class="dv">4</span></span>
<span id="0d766d4d-17"><a href="#0d766d4d-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="0d766d4d-18"><a href="#0d766d4d-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="0d766d4d-19"><a href="#0d766d4d-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"CV scores </span><span class="sc">{</span>scores<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="0d766d4d-20"><a href="#0d766d4d-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mean F1 </span><span class="sc">{</span>np<span class="sc">.</span>mean(scores)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="0d766d4d-21"><a href="#0d766d4d-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ae538ff1" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="ae538ff1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ae538ff1-1"><a href="#ae538ff1-1" aria-hidden="true" tabindex="-1"></a>cv_w2vec <span class="op">=</span> fit_w2v_avg(w2v_model.wv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La performance chute fortement ;
la faute √† la taille tr√®s restreinte du corpus, comme annonc√© pr√©c√©demment.</p>
</section>
<section id="word2vec-pr√©-entra√Æn√©-averaging" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Word2vec pr√©-entra√Æn√© + averaging</h1>
<p>Quand on travaille avec des corpus de taille restreinte,
c‚Äôest g√©n√©ralement une mauvaise id√©e d‚Äôentra√Æner son propre mod√®le <code>word2vec</code>.</p>
<p>Heureusement, des mod√®les pr√©-entra√Æn√©s sur de tr√®s gros corpus sont disponibles.
Ils permettent de r√©aliser du <em>transfer learning</em>,
c‚Äôest-√†-dire de b√©n√©ficier de la performance d‚Äôun mod√®le qui a √©t√© entra√Æn√© sur une autre t√¢che ou bien sur un autre corpus.</p>
<p>L‚Äôun des mod√®les les plus connus pour d√©marrer est le <code>glove_model</code> de
<code>Gensim</code> (Glove pour <em>Global Vectors for Word Representation</em>)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<blockquote class="blockquote">
<p>GloVe is an unsupervised learning algorithm for obtaining vector representations for words. Training is performed on aggregated global word-word co-occurrence statistics from a corpus, and the resulting representations showcase interesting linear substructures of the word vector space.</p>
<p><em>Source</em> : https://nlp.stanford.edu/projects/glove/</p>
</blockquote>
<p>On peut le charger directement gr√¢ce √† l‚Äôinstruction suivante :</p>
<div id="09daf622" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="09daf622"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="09daf622-1"><a href="#09daf622-1" aria-hidden="true" tabindex="-1"></a>glove_model <span class="op">=</span> gensim.downloader.load(<span class="st">"glove-wiki-gigaword-200"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Par exemple, la repr√©sentation vectorielle de roi est l‚Äôobjet
multidimensionnel suivant :</p>
<div id="8bb24ddc" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="8bb24ddc"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8bb24ddc-1"><a href="#8bb24ddc-1" aria-hidden="true" tabindex="-1"></a>glove_model[<span class="st">"king"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comme elle est peu intelligible, on va plut√¥t rechercher les termes les
plus similaires. Par exemple,</p>
<div id="02fbf0f2" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="02fbf0f2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="02fbf0f2-1"><a href="#02fbf0f2-1" aria-hidden="true" tabindex="-1"></a>glove_model.most_similar(<span class="st">"mother"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut retrouver notre formule pr√©c√©dente</p>
<p><span class="math display">\[\text{king} - \text{man} + \text{woman} ‚âà \text{queen}\]</span>
dans ce plongement de mots:</p>
<div id="17cec38d" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="17cec38d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="17cec38d-1"><a href="#17cec38d-1" aria-hidden="true" tabindex="-1"></a>glove_model.most_similar(positive<span class="op">=</span>[<span class="st">"king"</span>, <span class="st">"woman"</span>], negative<span class="op">=</span>[<span class="st">"man"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous pouvez vous r√©f√©rer √† <a href="https://jalammar.github.io/illustrated-word2vec/">ce tutoriel</a>
pour en d√©couvrir plus sur <code>Word2Vec</code>.</p>
<p>Faisons notre apprentissage par transfert :</p>
<div id="fca561fd" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="fca561fd"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fca561fd-1"><a href="#fca561fd-1" aria-hidden="true" tabindex="-1"></a>cv_w2vec_transfert <span class="op">=</span> fit_w2v_avg(glove_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La performance remonte substantiellement.
Cela √©tant, on ne parvient pas √† faire mieux que les approches basiques,
on arrive √† peine aux performances de la vectorisation par comptage.</p>
<p>En effet, pour rappel, les performances sont les suivantes :</p>
<div id="f38b709d" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="f38b709d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="f38b709d-1"><a href="#f38b709d-1" aria-hidden="true" tabindex="-1"></a>perfs <span class="op">=</span> pd.DataFrame(</span>
<span id="f38b709d-2"><a href="#f38b709d-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="f38b709d-3"><a href="#f38b709d-3" aria-hidden="true" tabindex="-1"></a>        np.mean(cv_bow.cv_results_[<span class="st">"mean_test_score"</span>]),</span>
<span id="f38b709d-4"><a href="#f38b709d-4" aria-hidden="true" tabindex="-1"></a>        np.mean(cv_tfidf.cv_results_[<span class="st">"mean_test_score"</span>]),</span>
<span id="f38b709d-5"><a href="#f38b709d-5" aria-hidden="true" tabindex="-1"></a>        np.mean(cv_w2vec),</span>
<span id="f38b709d-6"><a href="#f38b709d-6" aria-hidden="true" tabindex="-1"></a>        np.mean(cv_w2vec_transfert),</span>
<span id="f38b709d-7"><a href="#f38b709d-7" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="f38b709d-8"><a href="#f38b709d-8" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[</span>
<span id="f38b709d-9"><a href="#f38b709d-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Bag-of-Words"</span>,</span>
<span id="f38b709d-10"><a href="#f38b709d-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"TF-IDF"</span>,</span>
<span id="f38b709d-11"><a href="#f38b709d-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Word2Vec non pr√©-entra√Æn√©"</span>,</span>
<span id="f38b709d-12"><a href="#f38b709d-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Word2Vec pr√©-entra√Æn√©"</span>,</span>
<span id="f38b709d-13"><a href="#f38b709d-13" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="f38b709d-14"><a href="#f38b709d-14" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"Mean F1 score"</span>],</span>
<span id="f38b709d-15"><a href="#f38b709d-15" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">"Mean F1 score"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="f38b709d-16"><a href="#f38b709d-16" aria-hidden="true" tabindex="-1"></a>perfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les performences limit√©es du mod√®le <em>Word2Vec</em> sont cette fois certainement dues √† la mani√®re dont
les <em>word-embeddings</em> sont exploit√©s : ils sont moyenn√©s pour d√©crire chaque document.</p>
<p>Cela a plusieurs limites :</p>
<ul>
<li>on ne tient pas compte de l‚Äôordre et donc du contexte des mots</li>
<li>lorsque les documents sont longs, la moyennisation peut cr√©er
des repr√©sentation bruit√©es.</li>
</ul>
</section>
<section id="contextual-embeddings" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Contextual embeddings</h1>
<p>Les <em>embeddings</em> contextuels visent √† pallier les limites des <em>embeddings</em>
traditionnels √©voqu√©es pr√©c√©demment.</p>
<p>Cette fois, les mots n‚Äôont plus de repr√©sentation vectorielle fixe,
celle-ci est calcul√©e dynamiquement en fonction des mots du voisinage, et ainsi de suite.
Cela permet de tenir compte de la structure des phrases
et de tenir compte du fait que le sens d‚Äôun mot est fortement d√©pendant des mots
qui l‚Äôentourent.
Par exemple, dans les expressions ‚Äúle pr√©sident Macron‚Äù et ‚Äúle camembert Pr√©sident‚Äù le mot pr√©sident n‚Äôa pas du tout le m√™me r√¥le.</p>
<p>Ces <em>embeddings</em> sont produits par des architectures tr√®s complexes,
de type Transformer (<code>BERT</code>, etc.).</p>
<p><em>TODO: approfondir le sujet</em></p>
<div id="ee56162e" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="ee56162e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ee56162e-1"><a href="#ee56162e-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SentenceTransformer(<span class="st">"all-mpnet-base-v2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Verdict : on fait tr√®s l√©g√®rement mieux que la vectorisation TF-IDF.
On voit donc l‚Äôimportance de tenir compte du contexte.</p>
<p><strong>Mais pourquoi, avec une m√©thode tr√®s compliqu√©e, ne parvenons-nous pas √† battre une m√©thode toute simple ?</strong></p>
<p>On peut avancer plusieurs raisons :</p>
<ul>
<li>le <code>TF-IDF</code> est un mod√®le simple, mais toujours tr√®s performant
(on parle de <em>‚Äútough-to-beat baseline‚Äù</em>).</li>
<li>la classification d‚Äôauteurs est une t√¢che tr√®s particuli√®re et tr√®s ardue,
qui ne fait pas justice aux <em>embeddings</em>. Comme on l‚Äôa dit pr√©c√©demment, ces derniers se r√©v√®lent particuli√®rement pertinents lorsqu‚Äôil est question de similarit√© s√©mantique entre des textes (<em>clustering</em>, etc.).</li>
</ul>
<p>Dans le cas de notre t√¢che de classification, il est probable que
certains mots (noms de personnage, noms de lieux) soient suffisants pour classifier de mani√®re pertinente,
ce que ne permettent pas de capter les <em>embeddings</em> qui accordent √† tous les mots la m√™me importance.</p>
</section>
<section id="aller-plus-loin" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Aller plus loin</h1>
<ul>
<li>Nous avons entra√Æn√© diff√©rents mod√®les sur l‚Äô√©chantillon d‚Äôentra√Ænement par validation crois√©e, mais nous n‚Äôavons toujours pas utilis√© l‚Äô√©chantillon test que nous avons mis de c√¥t√© au d√©but. R√©aliser la pr√©diction sur les donn√©es de test, et v√©rifier si l‚Äôon obtient le m√™me classement des m√©thodes de vectorisation.</li>
<li>Faire un <em>vrai</em> split train/test : faire l‚Äôentra√Ænement avec des textes de certains auteurs, et faire la pr√©diction avec des textes d‚Äôauteurs diff√©rents. Cela permettrait de neutraliser la pr√©sence de noms de lieux, de personnages, etc.</li>
<li>Comparer avec d‚Äôautres algorithmes de classification qu‚Äôun SVM</li>
<li>(Avanc√©) : fine-tuner le mod√®le d‚Äôembeddings contextuels sur la t√¢che de classification</li>
</ul>
<section id="informations-additionnelles" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="informations-additionnelles">Informations additionnelles</h2>
<details>
<summary>
<p><i class="fa-brands fa-python" aria-label="python"></i> environment files have been tested on.</p>
</summary>
<p>Python version used:</p>
<div class="git-details">
<div class="pip-freeze">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">affine</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiobotocore</td>
<td style="text-align: left;">2.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiohttp</td>
<td style="text-align: left;">3.9.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aioitertools</td>
<td style="text-align: left;">0.11.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiosignal</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">alembic</td>
<td style="text-align: left;">1.13.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">altair</td>
<td style="text-align: left;">5.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">aniso8601</td>
<td style="text-align: left;">9.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annotated-types</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">appdirs</td>
<td style="text-align: left;">1.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">archspec</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">astroid</td>
<td style="text-align: left;">3.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">attrs</td>
<td style="text-align: left;">23.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">babel</td>
<td style="text-align: left;">2.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bcrypt</td>
<td style="text-align: left;">4.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beautifulsoup4</td>
<td style="text-align: left;">4.12.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">black</td>
<td style="text-align: left;">24.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blinker</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blis</td>
<td style="text-align: left;">0.7.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bokeh</td>
<td style="text-align: left;">3.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">boltons</td>
<td style="text-align: left;">23.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">boto3</td>
<td style="text-align: left;">1.34.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">botocore</td>
<td style="text-align: left;">1.34.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">branca</td>
<td style="text-align: left;">0.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brotli</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cachetools</td>
<td style="text-align: left;">5.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cartiflette</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cartopy</td>
<td style="text-align: left;">0.24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">catalogue</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">cattrs</td>
<td style="text-align: left;">24.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">certifi</td>
<td style="text-align: left;">2024.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cffi</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">chromedriver-autoinstaller</td>
<td style="text-align: left;">0.6.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">click</td>
<td style="text-align: left;">8.1.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">click-plugins</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cligj</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloudpathlib</td>
<td style="text-align: left;">0.19.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">colorama</td>
<td style="text-align: left;">0.4.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comm</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">commonmark</td>
<td style="text-align: left;">0.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda</td>
<td style="text-align: left;">24.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda-libmamba-solver</td>
<td style="text-align: left;">24.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda-package-handling</td>
<td style="text-align: left;">2.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda_package_streaming</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">confection</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">contextily</td>
<td style="text-align: left;">1.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contourpy</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cryptography</td>
<td style="text-align: left;">42.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cycler</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cymem</td>
<td style="text-align: left;">2.0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cytoolz</td>
<td style="text-align: left;">0.12.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">dask</td>
<td style="text-align: left;">2024.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dask-expr</td>
<td style="text-align: left;">1.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">debugpy</td>
<td style="text-align: left;">1.8.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">decorator</td>
<td style="text-align: left;">5.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">dill</td>
<td style="text-align: left;">0.3.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">diskcache</td>
<td style="text-align: left;">5.6.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">distributed</td>
<td style="text-align: left;">2024.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distro</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">docker</td>
<td style="text-align: left;">7.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">duckdb</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">en-core-web-sm</td>
<td style="text-align: left;">3.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">entrypoints</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">et-xmlfile</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exceptiongroup</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">executing</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fastexcel</td>
<td style="text-align: left;">0.11.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">fastjsonschema</td>
<td style="text-align: left;">2.19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fiona</td>
<td style="text-align: left;">1.9.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">flake8</td>
<td style="text-align: left;">7.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flask</td>
<td style="text-align: left;">3.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">folium</td>
<td style="text-align: left;">0.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fontawesomefree</td>
<td style="text-align: left;">6.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fonttools</td>
<td style="text-align: left;">4.51.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fr-core-news-sm</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">frozenlist</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">funcy</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDAL</td>
<td style="text-align: left;">3.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">gensim</td>
<td style="text-align: left;">4.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geographiclib</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopandas</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geoplot</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopy</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gitdb</td>
<td style="text-align: left;">4.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GitPython</td>
<td style="text-align: left;">3.1.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">google-auth</td>
<td style="text-align: left;">2.29.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphene</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphql-core</td>
<td style="text-align: left;">3.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphql-relay</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphviz</td>
<td style="text-align: left;">0.20.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">great-tables</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">greenlet</td>
<td style="text-align: left;">3.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">gunicorn</td>
<td style="text-align: left;">21.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">h11</td>
<td style="text-align: left;">0.14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">0.5.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hvac</td>
<td style="text-align: left;">2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">idna</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">imageio</td>
<td style="text-align: left;">2.35.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">importlib_metadata</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">importlib_resources</td>
<td style="text-align: left;">6.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">inflate64</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipykernel</td>
<td style="text-align: left;">6.29.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">ipython</td>
<td style="text-align: left;">8.22.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipywidgets</td>
<td style="text-align: left;">8.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">isort</td>
<td style="text-align: left;">5.13.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">itsdangerous</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">jedi</td>
<td style="text-align: left;">0.19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jinja2</td>
<td style="text-align: left;">3.1.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">jmespath</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">joblib</td>
<td style="text-align: left;">1.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonpatch</td>
<td style="text-align: left;">1.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonpointer</td>
<td style="text-align: left;">2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonschema</td>
<td style="text-align: left;">4.21.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonschema-specifications</td>
<td style="text-align: left;">2023.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter-cache</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter_client</td>
<td style="text-align: left;">8.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter_core</td>
<td style="text-align: left;">5.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyterlab_widgets</td>
<td style="text-align: left;">3.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">kaleido</td>
<td style="text-align: left;">0.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kiwisolver</td>
<td style="text-align: left;">1.4.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">kubernetes</td>
<td style="text-align: left;">29.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langcodes</td>
<td style="text-align: left;">3.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">language_data</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lazy_loader</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">libmambapy</td>
<td style="text-align: left;">1.5.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">llvmlite</td>
<td style="text-align: left;">0.42.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">locket</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;">5.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lz4</td>
<td style="text-align: left;">4.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">1.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mamba</td>
<td style="text-align: left;">1.5.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mapclassify</td>
<td style="text-align: left;">2.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">marisa-trie</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Markdown</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">markdown-it-py</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MarkupSafe</td>
<td style="text-align: left;">2.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">matplotlib</td>
<td style="text-align: left;">3.8.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">matplotlib-inline</td>
<td style="text-align: left;">0.1.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">mccabe</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mdurl</td>
<td style="text-align: left;">0.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">menuinst</td>
<td style="text-align: left;">2.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mercantile</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mizani</td>
<td style="text-align: left;">0.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mlflow</td>
<td style="text-align: left;">2.11.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">mlflow-skinny</td>
<td style="text-align: left;">2.11.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">msgpack</td>
<td style="text-align: left;">1.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">multidict</td>
<td style="text-align: left;">6.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">multivolumefile</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">munkres</td>
<td style="text-align: left;">1.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">murmurhash</td>
<td style="text-align: left;">1.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">mypy</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mypy-extensions</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">narwhals</td>
<td style="text-align: left;">1.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nbclient</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbformat</td>
<td style="text-align: left;">5.10.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nest_asyncio</td>
<td style="text-align: left;">1.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">networkx</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nltk</td>
<td style="text-align: left;">3.8.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numba</td>
<td style="text-align: left;">0.59.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numexpr</td>
<td style="text-align: left;">2.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numpy</td>
<td style="text-align: left;">1.26.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">oauthlib</td>
<td style="text-align: left;">3.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">opencv-python-headless</td>
<td style="text-align: left;">4.9.0.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">openpyxl</td>
<td style="text-align: left;">3.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome</td>
<td style="text-align: left;">1.3.0.post0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OWSLib</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">packaging</td>
<td style="text-align: left;">23.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pandas</td>
<td style="text-align: left;">2.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">paramiko</td>
<td style="text-align: left;">3.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parso</td>
<td style="text-align: left;">0.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">partd</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pathspec</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">patsy</td>
<td style="text-align: left;">0.5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pebble</td>
<td style="text-align: left;">5.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">pexpect</td>
<td style="text-align: left;">4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pickleshare</td>
<td style="text-align: left;">0.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pillow</td>
<td style="text-align: left;">10.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pip</td>
<td style="text-align: left;">24.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pkgutil_resolve_name</td>
<td style="text-align: left;">1.3.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">platformdirs</td>
<td style="text-align: left;">4.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">5.19.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotnine</td>
<td style="text-align: left;">0.13.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pluggy</td>
<td style="text-align: left;">1.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polars</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">preshed</td>
<td style="text-align: left;">3.0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prometheus_client</td>
<td style="text-align: left;">0.20.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">prometheus-flask-exporter</td>
<td style="text-align: left;">0.23.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prompt-toolkit</td>
<td style="text-align: left;">3.0.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">protobuf</td>
<td style="text-align: left;">4.25.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">psutil</td>
<td style="text-align: left;">5.9.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">ptyprocess</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pure-eval</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">py7zr</td>
<td style="text-align: left;">0.20.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyarrow</td>
<td style="text-align: left;">17.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyarrow-hotfix</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyasn1</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyasn1-modules</td>
<td style="text-align: left;">0.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pybcj</td>
<td style="text-align: left;">1.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycodestyle</td>
<td style="text-align: left;">2.11.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycosat</td>
<td style="text-align: left;">0.6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycparser</td>
<td style="text-align: left;">2.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycryptodomex</td>
<td style="text-align: left;">3.21.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic</td>
<td style="text-align: left;">2.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pydantic_core</td>
<td style="text-align: left;">2.23.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyflakes</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pygments</td>
<td style="text-align: left;">2.17.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyJWT</td>
<td style="text-align: left;">2.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyLDAvis</td>
<td style="text-align: left;">3.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pylint</td>
<td style="text-align: left;">3.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PyNaCl</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pynsee</td>
<td style="text-align: left;">0.1.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyogrio</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyOpenSSL</td>
<td style="text-align: left;">24.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyparsing</td>
<td style="text-align: left;">3.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyppmd</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyproj</td>
<td style="text-align: left;">3.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyshp</td>
<td style="text-align: left;">2.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PySocks</td>
<td style="text-align: left;">1.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-dateutil</td>
<td style="text-align: left;">2.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-dotenv</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-magic</td>
<td style="text-align: left;">0.4.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pytz</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyu2f</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pywaffle</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyYAML</td>
<td style="text-align: left;">6.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyzmq</td>
<td style="text-align: left;">25.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyzstd</td>
<td style="text-align: left;">0.16.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">querystring-parser</td>
<td style="text-align: left;">1.2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">rasterio</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">referencing</td>
<td style="text-align: left;">0.34.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">regex</td>
<td style="text-align: left;">2023.12.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests</td>
<td style="text-align: left;">2.31.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests-cache</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests-oauthlib</td>
<td style="text-align: left;">2.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">retrying</td>
<td style="text-align: left;">1.3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rich</td>
<td style="text-align: left;">13.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">rpds-py</td>
<td style="text-align: left;">0.18.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rsa</td>
<td style="text-align: left;">4.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rtree</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ruamel.yaml</td>
<td style="text-align: left;">0.18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruamel.yaml.clib</td>
<td style="text-align: left;">0.2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s3fs</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">s3transfer</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scikit-image</td>
<td style="text-align: left;">0.24.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">scikit-learn</td>
<td style="text-align: left;">1.4.1.post1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scipy</td>
<td style="text-align: left;">1.13.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">seaborn</td>
<td style="text-align: left;">0.13.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">selenium</td>
<td style="text-align: left;">4.25.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">setuptools</td>
<td style="text-align: left;">69.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shapely</td>
<td style="text-align: left;">2.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">shellingham</td>
<td style="text-align: left;">1.5.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">six</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">smart_open</td>
<td style="text-align: left;">7.0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smmap</td>
<td style="text-align: left;">5.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sniffio</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sortedcontainers</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">soupsieve</td>
<td style="text-align: left;">2.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy</td>
<td style="text-align: left;">3.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy-legacy</td>
<td style="text-align: left;">3.0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy-loggers</td>
<td style="text-align: left;">1.0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">SQLAlchemy</td>
<td style="text-align: left;">2.0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sqlparse</td>
<td style="text-align: left;">0.4.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">srsly</td>
<td style="text-align: left;">2.4.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stack-data</td>
<td style="text-align: left;">0.6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">statsmodels</td>
<td style="text-align: left;">0.14.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tabulate</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tblib</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenacity</td>
<td style="text-align: left;">8.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">texttable</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">thinc</td>
<td style="text-align: left;">8.2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">threadpoolctl</td>
<td style="text-align: left;">3.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tifffile</td>
<td style="text-align: left;">2024.9.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">tomli</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tomlkit</td>
<td style="text-align: left;">0.12.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">toolz</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">topojson</td>
<td style="text-align: left;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">tornado</td>
<td style="text-align: left;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tqdm</td>
<td style="text-align: left;">4.66.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">traitlets</td>
<td style="text-align: left;">5.14.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trio</td>
<td style="text-align: left;">0.26.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">trio-websocket</td>
<td style="text-align: left;">0.11.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">truststore</td>
<td style="text-align: left;">0.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">typer</td>
<td style="text-align: left;">0.12.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typing_extensions</td>
<td style="text-align: left;">4.11.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tzdata</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unidecode</td>
<td style="text-align: left;">1.3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">url-normalize</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urllib3</td>
<td style="text-align: left;">1.26.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">wasabi</td>
<td style="text-align: left;">1.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">weasel</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">webdriver-manager</td>
<td style="text-align: left;">4.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">websocket-client</td>
<td style="text-align: left;">1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Werkzeug</td>
<td style="text-align: left;">3.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">wheel</td>
<td style="text-align: left;">0.43.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widgetsnbextension</td>
<td style="text-align: left;">4.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">wordcloud</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">wsproto</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xgboost</td>
<td style="text-align: left;">2.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">xlrd</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xyzservices</td>
<td style="text-align: left;">2024.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">yarl</td>
<td style="text-align: left;">1.9.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellowbrick</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">zict</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zipp</td>
<td style="text-align: left;">3.17.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zstandard</td>
<td style="text-align: left;">0.22.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div></details>
<details>
<summary>
<p>View file history <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></p>
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="823" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 822;"><span id="cb3-823"><a href="#cb3-823" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Ce fichier a √©t√© modifi√© __</span><span class="sc">${</span>table_commit<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">__ fois depuis sa cr√©ation le </span><span class="sc">${</span>creation_string<span class="sc">}</span><span class="vs"> (derni√®re modification le </span><span class="sc">${</span>last_modification_string<span class="sc">}</span><span class="vs">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="830" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 829;"><span id="cb4-830"><a href="#cb4-830" aria-hidden="true" tabindex="-1"></a>creation <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb4-831"><a href="#cb4-831" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb4-832"><a href="#cb4-832" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-833"><a href="#cb4-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-834"><a href="#cb4-834" aria-hidden="true" tabindex="-1"></a>last_modification <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb4-835"><a href="#cb4-835" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb4-836"><a href="#cb4-836" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-837"><a href="#cb4-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-838"><a href="#cb4-838" aria-hidden="true" tabindex="-1"></a>creation_string <span class="op">=</span> creation<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb4-839"><a href="#cb4-839" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb4-840"><a href="#cb4-840" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb4-841"><a href="#cb4-841" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb4-842"><a href="#cb4-842" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-843"><a href="#cb4-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-844"><a href="#cb4-844" aria-hidden="true" tabindex="-1"></a>last_modification_string <span class="op">=</span> last_modification<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb4-845"><a href="#cb4-845" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb4-846"><a href="#cb4-846" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb4-847"><a href="#cb4-847" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb4-848"><a href="#cb4-848" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="854" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 853;"><span id="cb5-854"><a href="#cb5-854" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_table<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="859" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 858;"><span id="cb6-859"><a href="#cb6-859" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_plot<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<table class="commit-table" border="1">
<thead>
<tr>
<th>
SHA
</th>
<th>
Date
</th>
<th>
Author
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c641de0">c641de0</a>
</td>
<td>
2024-08-22 11:37:13
</td>
<td>
Lino Galiana
</td>
<td>
A series of fix for notebooks that were bugging (#545)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c5a9fb7">c5a9fb7</a>
</td>
<td>
2024-07-22 09:56:18
</td>
<td>
Julien PRAMIL
</td>
<td>
Fix bug in LDA chapter (#525)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c9f9f8a">c9f9f8a</a>
</td>
<td>
2024-04-24 15:09:35
</td>
<td>
Lino Galiana
</td>
<td>
Dark mode and CSS improvements (#494)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/06d003a">06d003a</a>
</td>
<td>
2024-04-23 10:09:22
</td>
<td>
Lino Galiana
</td>
<td>
Continue la restructuration des sous-parties (#492)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/005d89b">005d89b</a>
</td>
<td>
2023-12-20 17:23:04
</td>
<td>
Lino Galiana
</td>
<td>
Finalise l‚Äôaffichage des statistiques Git (#478)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3437373">3437373</a>
</td>
<td>
2023-12-16 20:11:06
</td>
<td>
Lino Galiana
</td>
<td>
Am√©liore l‚Äôexercice sur le LASSO (#473)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4cd44f3">4cd44f3</a>
</td>
<td>
2023-12-11 17:37:50
</td>
<td>
Antoine Palazzolo
</td>
<td>
Relecture NLP (#474)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/deaafb6">deaafb6</a>
</td>
<td>
2023-12-11 13:44:34
</td>
<td>
Thomas Faria
</td>
<td>
Relecture Thomas partie NLP (#472)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/1f23de2">1f23de2</a>
</td>
<td>
2023-12-01 17:25:36
</td>
<td>
Lino Galiana
</td>
<td>
Stockage des images sur S3 (#466)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/6855667">6855667</a>
</td>
<td>
2023-11-29 10:21:01
</td>
<td>
Romain Avouac
</td>
<td>
Corrections tp vectorisation + improve badge creation (#465)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/69cf52b">69cf52b</a>
</td>
<td>
2023-11-21 16:12:37
</td>
<td>
Antoine Palazzolo
</td>
<td>
[On-going] Suggestions chapitres mod√©lisation (#452)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/652009d">652009d</a>
</td>
<td>
2023-10-09 13:56:34
</td>
<td>
Lino Galiana
</td>
<td>
Finalise le cleaning (#430)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a771183">a771183</a>
</td>
<td>
2023-10-09 11:27:45
</td>
<td>
Antoine Palazzolo
</td>
<td>
Relecture TD2 par Antoine (#418)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/154f09e">154f09e</a>
</td>
<td>
2023-09-26 14:59:11
</td>
<td>
Antoine Palazzolo
</td>
<td>
Des typos corrig√©es par Antoine (#411)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/9a4e226">9a4e226</a>
</td>
<td>
2023-08-28 17:11:52
</td>
<td>
Lino Galiana
</td>
<td>
Action to check URL still exist (#399)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3bdf3b0">3bdf3b0</a>
</td>
<td>
2023-08-25 11:23:02
</td>
<td>
Lino Galiana
</td>
<td>
Simplification de la structure ü§ì (#393)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/78ea2cb">78ea2cb</a>
</td>
<td>
2023-07-20 20:27:31
</td>
<td>
Lino Galiana
</td>
<td>
Change titles levels (#381)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/29ff3f5">29ff3f5</a>
</td>
<td>
2023-07-07 14:17:53
</td>
<td>
linogaliana
</td>
<td>
description everywhere
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f21a24d">f21a24d</a>
</td>
<td>
2023-07-02 10:58:15
</td>
<td>
Lino Galiana
</td>
<td>
Pipeline Quarto &amp; Pages üöÄ (#365)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/b395985">b395985</a>
</td>
<td>
2023-02-13 17:29:36
</td>
<td>
Lino Galiana
</td>
<td>
Retire shortcode spoiler (#352)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f10815b">f10815b</a>
</td>
<td>
2022-08-25 16:00:03
</td>
<td>
Lino Galiana
</td>
<td>
Notebooks should now look more beautiful (#260)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/d201e3c">d201e3c</a>
</td>
<td>
2022-08-03 15:50:34
</td>
<td>
Lino Galiana
</td>
<td>
Pimp la homepage ‚ú® (#249)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/12965ba">12965ba</a>
</td>
<td>
2022-05-25 15:53:27
</td>
<td>
Lino Galiana
</td>
<td>
:launch: Bascule vers quarto (#226)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/9c71d6e">9c71d6e</a>
</td>
<td>
2022-03-08 10:34:26
</td>
<td>
Lino Galiana
</td>
<td>
Plus d‚Äô√©l√©ments sur S3 (#218)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/7058752">7058752</a>
</td>
<td>
2022-03-04 15:35:17
</td>
<td>
Lino Galiana
</td>
<td>
Relecture Word2Vec (#216)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/ce1f2b5">ce1f2b5</a>
</td>
<td>
2022-02-16 13:54:27
</td>
<td>
Lino Galiana
</td>
<td>
spacy corpus pre-downloaded
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/66e2837">66e2837</a>
</td>
<td>
2021-12-24 16:54:45
</td>
<td>
Lino Galiana
</td>
<td>
Fix a few typos in the new pipeline tutorial (#208)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/8ab1956">8ab1956</a>
</td>
<td>
2021-12-23 21:07:30
</td>
<td>
Romain Avouac
</td>
<td>
TP vectorization prediction authors (#206)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/09b60a1">09b60a1</a>
</td>
<td>
2021-12-21 19:58:58
</td>
<td>
Lino Galiana
</td>
<td>
Relecture suite du NLP (#205)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/495599d">495599d</a>
</td>
<td>
2021-12-19 18:33:05
</td>
<td>
Lino Galiana
</td>
<td>
Des √©l√©ments suppl√©mentaires dans la partie NLP (#202)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2a8809f">2a8809f</a>
</td>
<td>
2021-10-27 12:05:34
</td>
<td>
Lino Galiana
</td>
<td>
Simplification des hooks pour gagner en flexibilit√© et clart√© (#166)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2e4d586">2e4d586</a>
</td>
<td>
2021-09-02 12:03:39
</td>
<td>
Lino Galiana
</td>
<td>
Simplify badges generation (#130)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4cdb759">4cdb759</a>
</td>
<td>
2021-05-12 10:37:23
</td>
<td>
Lino Galiana
</td>
<td>
:sparkles: :star2: Nouveau th√®me hugo :snake: :fire: (#105)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/7f9f97b">7f9f97b</a>
</td>
<td>
2021-04-30 21:44:04
</td>
<td>
Lino Galiana
</td>
<td>
üê≥ + üêç New workflow (docker üê≥) and new dataset for modelization (2020 üá∫üá∏ elections) (#99)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/d164635">d164635</a>
</td>
<td>
2020-12-08 16:22:00
</td>
<td>
Lino Galiana
</td>
<td>
:books: Premi√®re partie NLP (#87)
</td>
</tr>
</tbody>
</table>
</details>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="870" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 869;"><span id="cb7-870"><a href="#cb7-870" aria-hidden="true" tabindex="-1"></a>git_history_table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb7-871"><a href="#cb7-871" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">,</span></span>
<span id="cb7-872"><a href="#cb7-872" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb7-873"><a href="#cb7-873" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb7-874"><a href="#cb7-874" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SHA</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`[</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>github_repo<span class="sc">}</span><span class="vs">/commit/</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb7-875"><a href="#cb7-875" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Description</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">replacePullRequestPattern</span>(x<span class="op">,</span> github_repo)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb7-876"><a href="#cb7-876" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*Date: x =&gt; x.toLocaleString("fr", {</span></span>
<span id="cb7-877"><a href="#cb7-877" aria-hidden="true" tabindex="-1"></a><span class="co">        "month": "numeric",</span></span>
<span id="cb7-878"><a href="#cb7-878" aria-hidden="true" tabindex="-1"></a><span class="co">        "day": "numeric",</span></span>
<span id="cb7-879"><a href="#cb7-879" aria-hidden="true" tabindex="-1"></a><span class="co">        "year": "numeric"</span></span>
<span id="cb7-880"><a href="#cb7-880" aria-hidden="true" tabindex="-1"></a><span class="co">        })</span></span>
<span id="cb7-881"><a href="#cb7-881" aria-hidden="true" tabindex="-1"></a><span class="co">      */</span></span>
<span id="cb7-882"><a href="#cb7-882" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-883"><a href="#cb7-883" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-884"><a href="#cb7-884" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="890" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 889;"><span id="cb8-890"><a href="#cb8-890" aria-hidden="true" tabindex="-1"></a>git_history_plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb8-891"><a href="#cb8-891" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb8-892"><a href="#cb8-892" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"royalblue"</span>})<span class="op">,</span></span>
<span id="cb8-893"><a href="#cb8-893" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb8-894"><a href="#cb8-894" aria-hidden="true" tabindex="-1"></a>          table_commit<span class="op">,</span></span>
<span id="cb8-895"><a href="#cb8-895" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">pointerX</span>({<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>}))<span class="op">,</span></span>
<span id="cb8-896"><a href="#cb8-896" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(table_commit<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"royalblue"</span>})</span>
<span id="cb8-897"><a href="#cb8-897" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb8-898"><a href="#cb8-898" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="904" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 903;"><span id="cb9-904"><a href="#cb9-904" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">replacePullRequestPattern</span>(inputString<span class="op">,</span> githubRepo) {</span>
<span id="cb9-905"><a href="#cb9-905" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use a regular expression to match the pattern #digit</span></span>
<span id="cb9-906"><a href="#cb9-906" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> pattern <span class="op">=</span> <span class="ss">/#</span><span class="sc">(\d+)</span><span class="ss">/g</span><span class="op">;</span></span>
<span id="cb9-907"><a href="#cb9-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-908"><a href="#cb9-908" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Replace the pattern with ${github_repo}/pull/#digit</span></span>
<span id="cb9-909"><a href="#cb9-909" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> replacedString <span class="op">=</span> inputString<span class="op">.</span><span class="fu">replace</span>(pattern<span class="op">,</span> <span class="st">'[#$1]('</span> <span class="op">+</span> githubRepo <span class="op">+</span> <span class="st">'/pull/$1)'</span>)<span class="op">;</span></span>
<span id="cb9-910"><a href="#cb9-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-911"><a href="#cb9-911" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replacedString<span class="op">;</span></span>
<span id="cb9-912"><a href="#cb9-912" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="918" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 917;"><span id="cb10-918"><a href="#cb10-918" aria-hidden="true" tabindex="-1"></a>github_repo <span class="op">=</span> <span class="st">"https://github.com/linogaliana/python-datascientist"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="923" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 922;"><span id="cb11-923"><a href="#cb11-923" aria-hidden="true" tabindex="-1"></a>table_commit <span class="op">=</span> {</span>
<span id="cb11-924"><a href="#cb11-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-925"><a href="#cb11-925" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the HTML table by its class name</span></span>
<span id="cb11-926"><a href="#cb11-926" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb11-927"><a href="#cb11-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-928"><a href="#cb11-928" aria-hidden="true" tabindex="-1"></a><span class="co">// Check if the table exists</span></span>
<span id="cb11-929"><a href="#cb11-929" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (table) {</span>
<span id="cb11-930"><a href="#cb11-930" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialize an array to store the table data</span></span>
<span id="cb11-931"><a href="#cb11-931" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dataArray <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-932"><a href="#cb11-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-933"><a href="#cb11-933" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract headers from the first row</span></span>
<span id="cb11-934"><a href="#cb11-934" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> headers <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-935"><a href="#cb11-935" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb11-936"><a href="#cb11-936" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">.</span><span class="fu">push</span>(table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span>[i]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>())<span class="op">;</span></span>
<span id="cb11-937"><a href="#cb11-937" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-938"><a href="#cb11-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-939"><a href="#cb11-939" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Iterate through the rows, starting from the second row</span></span>
<span id="cb11-940"><a href="#cb11-940" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb11-941"><a href="#cb11-941" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> row <span class="op">=</span> table<span class="op">.</span><span class="at">rows</span>[i]<span class="op">;</span></span>
<span id="cb11-942"><a href="#cb11-942" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> rowData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb11-943"><a href="#cb11-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-944"><a href="#cb11-944" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Iterate through the cells in the row</span></span>
<span id="cb11-945"><a href="#cb11-945" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> row<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb11-946"><a href="#cb11-946" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Use headers as keys and cell content as values</span></span>
<span id="cb11-947"><a href="#cb11-947" aria-hidden="true" tabindex="-1"></a>            rowData[headers[j]] <span class="op">=</span> row<span class="op">.</span><span class="at">cells</span>[j]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb11-948"><a href="#cb11-948" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-949"><a href="#cb11-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-950"><a href="#cb11-950" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Push the rowData object to the dataArray</span></span>
<span id="cb11-951"><a href="#cb11-951" aria-hidden="true" tabindex="-1"></a>        dataArray<span class="op">.</span><span class="fu">push</span>(rowData)<span class="op">;</span></span>
<span id="cb11-952"><a href="#cb11-952" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-953"><a href="#cb11-953" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-954"><a href="#cb11-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-955"><a href="#cb11-955" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataArray</span>
<span id="cb11-956"><a href="#cb11-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-957"><a href="#cb11-957" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="963" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 962;"><span id="cb12-963"><a href="#cb12-963" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the element with class 'git-details'</span></span>
<span id="cb12-964"><a href="#cb12-964" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-965"><a href="#cb12-965" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> gitDetails <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb12-966"><a href="#cb12-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-967"><a href="#cb12-967" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Check if the element exists</span></span>
<span id="cb12-968"><a href="#cb12-968" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (gitDetails) {</span>
<span id="cb12-969"><a href="#cb12-969" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Hide the element</span></span>
<span id="cb12-970"><a href="#cb12-970" aria-hidden="true" tabindex="-1"></a>      gitDetails<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb12-971"><a href="#cb12-971" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-972"><a href="#cb12-972" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="978" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 977;"><span id="cb13-978"><a href="#cb13-978" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.12/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Jeffrey Pennington, Richard Socher, and Christopher D. Manning. 2014. <em>GloVe: Global Vectors for Word Representation</em>.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@book{galiana2023,
  author = {Galiana, Lino},
  title = {Python Pour La Data Science},
  date = {2023},
  url = {https://pythonds.linogaliana.fr/},
  doi = {10.5281/zenodo.8229676},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-galiana2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Galiana, Lino. 2023. <em>Python Pour La Data Science</em>. <a href="https://doi.org/10.5281/zenodo.8229676">https://doi.org/10.5281/zenodo.8229676</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../content/NLP";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pythonds\.linogaliana\.fr");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="linogaliana/python-datascientist" data-repo-id="MDEwOlJlcG9zaXRvcnkyODAxNjE2Nzc=" data-category="General" data-category-id="DIC_kwDOELLtjc4B-5TX" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/NLP/03_lda.html" class="pagination-link" aria-label="Latent Dirichlet Allocation (LDA)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Latent Dirichlet Allocation (LDA)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/NLP/05_exo_supp.html" class="pagination-link" aria-label="Exercices suppl√©mentaires">
        <span class="nav-page-text">Exercices suppl√©mentaires</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Python pour la <em>data science</em>, Lino Galiana.<br>
Licence <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i><br>
Code source disponible sur <a href="https://github.com/linogaliana/python-datascientist"><code>Github</code></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/NLP/04_word2vec.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Site construit avec <i class="fa-brands fa-python" aria-label="python"></i> et <a href="https://quarto.org/"><code>Quarto</code></a><br>
Inspiration pour la mise en forme du site <a href="https://www.andreashandel.com">ici</a><br>
<a href="https://github.com/linogaliana/python-datascientist">Code source disponible sur <i class="fa-brands fa-github" aria-label="github"></i> <code>GitHub</code></a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"loop":false,"closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>