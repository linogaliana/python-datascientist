<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lino Galiana">
<meta name="dcterms.date" content="2024-12-26">
<meta name="description" content="Pour pouvoir utiliser des donn√©es textuelles dans des algorithmes de machine learning, il faut les vectoriser, c‚Äôest √† dire transformer le texte en donn√©es num√©riques. Dans ce TP, nous allons comparer diff√©rentes m√©thodes de vectorisation, √† travers une t√¢che de pr√©diction : peut-on pr√©dire un auteur litt√©raire √† partir d‚Äôextraits de ses textes ? Parmi ces m√©thodes, on va notamment explorer le mod√®le Word2Vec, qui permet d‚Äôexploiter les structures latentes d‚Äôun texte en construisant des word embeddings (plongements de mots).">

<title>Les embeddings, o√π comment synth√©tiser l‚Äôinformation textuelle ‚Äì Python for data science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/NLP/02_exoclean.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #e9f3fa;
      }
</style>
<script id="toggle-light-dark-elements" type="application/javascript">
// Extend Quarto theme toggling to allow elements to be displayed/hidden in light/dark themes

// Replicated from https://github.com/quarto-dev/quarto-cli/blob/84d4659/src/resources/formats/html/templates/quarto-html.ejs
const getColorSchemeSentinel = () => {
  const localAlternateSentinel = 'default';
  if (window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    return storageValue != null ? storageValue : localAlternateSentinel;
  } else {
    return localAlternateSentinel;
  }
};

// Function to toggle light and dark elements based on color scheme
const toggleColorSchemeElements = () => {
  const scheme = getColorSchemeSentinel();
  const lightElements = document.getElementsByClassName('only-light');
  const darkElements = document.getElementsByClassName('only-dark');

  for (var i = 0; i < lightElements.length; i++) {
    lightElements[i].style.display = scheme == 'default' ? 'block' : 'none';
  }
  for (var i = 0; i < darkElements.length; i++) {
    darkElements[i].style.display = scheme == 'default' ? 'none' : 'block';
  }
};

// Function to check if the user's browser prefers dark themes
const prefersDarkTheme = () => {
  if (window.matchMedia) {
    return window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return false;
};

document.addEventListener('readystatechange', function() {
  // Set the default color scheme based on browser preference
  if (document.readyState === 'interactive' && window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    if (storageValue == null && prefersDarkTheme()) {
      window.localStorage.setItem('quarto-color-scheme', 'alternate');
    }
  }
  // Add event listener for when the readyState is complete (and default toggler is set)
  if (document.readyState === 'complete') {
    // Toggle scheme once
    toggleColorSchemeElements();
    // Append our toggle function to the old one
    const oldToggle = window.quartoToggleColorScheme;
    window.quartoToggleColorScheme = () => {
      oldToggle();
      toggleColorSchemeElements();
    }
  }
});

</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Les embeddings, o√π comment synth√©tiser l‚Äôinformation textuelle ‚Äì Python for data science">
<meta name="twitter:description" content="Pour pouvoir utiliser des donn√©es textuelles dans des algorithmes
de machine learning, il faut les vectoriser, c‚Äôest √† dire transformer
le texte en donn√©es num√©riques. Dans ce TP, nous allons comparer
diff√©rentes m√©thodes de vectorisation, √† travers une t√¢che de pr√©diction :
peut-on pr√©dire un auteur litt√©raire √† partir d‚Äôextraits de ses textes ?
Parmi ces m√©thodes, on va notamment explorer le mod√®le Word2Vec, qui
permet d‚Äôexploiter les structures latentes d‚Äôun texte en construisant
des word embeddings (plongements de mots).">
<meta name="twitter:image" content="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/librarian.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Python pour la data science">
<meta name="citation_author" content="Lino Galiana">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2024-12-26">
<meta name="citation_fulltext_html_url" content="https://pythonds.linogaliana.fr/">
<meta name="citation_doi" content="10.5281/zenodo.8229676">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Coding for economists;,citation_author=undefined Turrell;,citation_author=undefined contributors;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://aeturrell.github.io/coding-for-economists;">
<meta name="citation_reference" content="citation_title=The hugging face course, 2022;,citation_author=Hugging Face;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=https://huggingface.co/course;">
<meta name="citation_reference" content="citation_title=The signal and the noise: Why so many predictions fail-but some don‚Äôt;,citation_author=Nate Silver;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Efficient estimation of word representations in vector space;,citation_author=Tomas Mikolov;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=3781;,citation_journal_title=arXiv preprint arXiv:1301.3781;">
<meta name="citation_reference" content="citation_title=Attention is all you need;,citation_author=A Vaswani;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Advances in Neural Information Processing Systems;">
<meta name="citation_reference" content="citation_title=Tableau politique de la france de l‚Äôouest sous la troisi√®me r√©publique: 102 cartes et croquis, 1 carte hors texte;,citation_author=Andr√© Siegfried;,citation_publication_date=1913;,citation_cover_date=1913;,citation_year=1913;">
<meta name="citation_reference" content="citation_title=Statistical learning;,citation_author=Gareth James;,citation_author=Daniela Witten;,citation_author=Trevor Hastie;,citation_author=Robert Tibshirani;,citation_author=Jonathan Taylor;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_inbook_title=An introduction to statistical learning: With applications in python;">
<meta name="citation_reference" content="citation_title=Une histoire du conflit politique: Elections et in√©galit√©s sociales en france, 1789-2022;,citation_author=Thomas Piketty;,citation_author=Julia Cag√©;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Interpretable machine learning: A guide for making black box models explainable;,citation_author=Molnar Christoph;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;">
<meta name="citation_reference" content="citation_title=A gentle introduction to conformal prediction and distribution-free uncertainty quantification;,citation_author=Anastasios N Angelopoulos;,citation_author=Stephen Bates;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_journal_title=arXiv preprint arXiv:2107.07511;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang H√§rdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Discovering statistics using r;,citation_author=A Field;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_publisher=Sage;">
<meta name="citation_reference" content="citation_title=psyTeachR Book Template;,citation_author=DeBruine Lisa;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://github.com/psyteachr/template/;">
<meta name="citation_reference" content="citation_title=The grammar of graphics;,citation_author=Leland Wilkinson;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Hands-on machine learning with scikit-learn, keras, and TensorFlow;,citation_author=Aur√©lien G√©ron;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang H√§rdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Random forests;,citation_author=Leo Breiman;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_volume=45;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Bagging predictors;,citation_author=Leo Breiman;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_volume=24;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=R for data science;,citation_author=Hadley Wickham;,citation_author=Mine √áetinkaya-Rundel;,citation_author=Garrett Grolemund;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Computational reproducibility of jupyter notebooks from biomedical publications;,citation_author=Sheeba Samuel;,citation_author=Daniel Mietchen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2308.07333;">
<meta name="citation_reference" content="citation_title=Python data science handbook: Essential tools for working with data;,citation_author=Jake VanderPlas;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;">
<meta name="citation_reference" content="citation_title=Machine learning methods that economists should know about;,citation_author=Susan Athey;,citation_author=Guido W Imbens;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=11;,citation_journal_title=Annual Review of Economics;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data an illustration with scanner data and crowd-sourced nutritional data;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=Proceedings of the 2022 &amp;amp;amp;quot;Journ√©es de M√©thodologie Statistiques&amp;quot;;">
<meta name="citation_reference" content="citation_title=Data visualization with python and JavaScript;,citation_author=Kyran Dale;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=S√©miologie graphique;,citation_author=Jacques Bertin;,citation_publication_date=1967;,citation_cover_date=1967;,citation_year=1967;">
<meta name="citation_reference" content="citation_title=La s√©miologie graphique de jacques bertin a cinquante ans;,citation_author=Gilles Palsky;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Visions carto (en ligne);">
<meta name="citation_reference" content="citation_title=Fundamentals of data visualization: A primer on making informative and compelling figures;,citation_author=Claus O Wilke;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=How to train BERT with an academic budget;,citation_author=Peter Izsak;,citation_author=Moshe Berchansky;,citation_author=Omer Levy;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2104.07705;">
<meta name="citation_reference" content="citation_title=Python for data analysis: Data wrangling with pandas, NumPy, and IPython;,citation_author=Wes McKinney;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Residential segregation, daytime segregation and spatial frictions: An analysis from mobile phone data;,citation_author=Lino Galiana;,citation_author=Fran√ßois S√©m√©curbe;,citation_author=Benjamin Sakarovitch;,citation_author=Zbigniew Smoreda;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data: An illustration with scanner and crowd-sourced nutritional datasets;,citation_abstract=Food retailers‚Äô scanner data provide unprecedented details on local consumption, provided that product identifiers allow a linkage with features of interest, such as nutritional information. In this paper, we enrich a large retailer dataset with nutritional information extracted from crowd-sourced and administrative nutritional datasets. To compensate for imperfect matching through the barcode, we develop a methodology to efficiently match short textual descriptions. After a preprocessing step to normalize short labels, we resort to fuzzy matching based on several tokenizers (including n-grams) by querying an ElasticSearch customized index and validate candidates echos as matches with a Levensthein edit-distance and an embedding-based similarity measure created from a siamese neural network model. The pipeline is composed of several steps successively relaxing constraints to find relevant matching candidates.;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1145/3524458.3547244;,citation_doi=10.1145/3524458.3547244;,citation_isbn=9781450392846;,citation_conference_title=Proceedings of the 2022 ACM conference on information technology for social good;,citation_conference=Association for Computing Machinery;,citation_series_title=GoodIT ‚Äô22;">
<meta name="citation_reference" content="citation_title=Guide de s√©miologie cartographique;,citation_author=undefined Insee;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Energy and policy considerations for deep learning in NLP;,citation_author=Emma Strubell;,citation_author=Ananya Ganesh;,citation_author=Andrew McCallum;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://arxiv.org/abs/1906.02243;">
<meta name="citation_reference" content="citation_title=High-resolution image synthesis with latent diffusion models;,citation_author=Robin Rombach;,citation_author=Andreas Blattmann;,citation_author=Dominik Lorenz;,citation_author=Patrick Esser;,citation_author=Bj√∂rn Ommer;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_conference_title=Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR);">
<meta name="citation_reference" content="citation_title=Apache arrow and the&amp;amp;amp;quot; 10 things i hate about pandas;,citation_author=Wes McKinney;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_volume=21;,citation_journal_title=Blog, September;">
<meta name="citation_reference" content="citation_title=Many researchers were not compliant with their published data sharing statement: Mixed-methods study;,citation_author=Mirko Gabelica;,citation_author=Ru≈æica Bojƒçiƒá;,citation_author=Livia Puljak;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_journal_title=Journal of Clinical Epidemiology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Credit scoring in the era of big data;,citation_author=Mikella Hurley;,citation_author=Julius Adebayo;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=18;,citation_journal_title=Yale JL &amp;amp;amp; Tech.;,citation_publisher=HeinOnline;">
<meta name="citation_reference" content="citation_title=Econometrics and machine learning;,citation_author=Arthur Charpentier;,citation_author=Emmanuel Flachaire;,citation_author=Antoine Ly;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=505;,citation_journal_title=Economie et Statistique;,citation_publisher=Pers√©e-Portail des revues scientifiques en SHS;">
<meta name="citation_reference" content="citation_title=Machine learning: An applied econometric approach;,citation_author=Sendhil Mullainathan;,citation_author=Jann Spiess;,citation_publication_date=2017-05;,citation_cover_date=2017-05;,citation_year=2017;,citation_fulltext_html_url=https://www.aeaweb.org/articles?id=10.1257/jep.31.2.87;,citation_issue=2;,citation_doi=10.1257/jep.31.2.87;,citation_volume=31;,citation_journal_title=Journal of Economic Perspectives;">
<meta name="citation_reference" content="citation_title=Le probl√®me du r√©alisme des hypoth√®ses en √©conomie politique;,citation_author=Pierre Salmon;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;">
<meta name="citation_reference" content="citation_title=The methodology of positive economics;,citation_author=Milton Friedman;,citation_publication_date=1953;,citation_cover_date=1953;,citation_year=1953;,citation_inbook_title=Essays in positive economics;">
<meta name="citation_reference" content="citation_title=L‚Äôempreinte carbone du num√©rique;,citation_author=undefined Arcep;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in ML-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2207.07048;,citation_doi=10.48550/ARXIV.2207.07048;,citation_publisher=arXiv;">
<meta name="citation_reference" content="citation_title=Growth in a time of debt;,citation_author=Carmen M Reinhart;,citation_author=Kenneth S Rogoff;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_issue=2;,citation_volume=100;,citation_journal_title=American economic review;,citation_publisher=American Economic Association;">
<meta name="citation_reference" content="citation_title=We do not know the population of every country in the world for the past two thousand years;,citation_author=Timothy W Guinnane;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=3;,citation_volume=83;,citation_journal_title=The Journal of Economic History;">
<meta name="citation_reference" content="citation_title=Artificial intelligence: A modern approach (4th edition);,citation_author=Stuart J. Russell;,citation_author=Peter Norvig;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=http://aima.cs.berkeley.edu/;,citation_isbn=9781292401133;">
<meta name="citation_reference" content="citation_title=Data scientist, the sexiest job of the 21st century;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century;,citation_issue=5;,citation_volume=90;,citation_journal_title=Harvard business review;">
<meta name="citation_reference" content="citation_title=Is data scientist still the sexiest job of the 21st century?;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=90;,citation_journal_title=Harvard Business Review;,citation_publisher=Harvard Business Publishing;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in machine-learning-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=9;,citation_volume=4;,citation_journal_title=Patterns;,citation_publisher=Elsevier;">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="../../content/getting-started/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/01_environment.html">
 <span class="dropdown-text">A functional Python environment for data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/02_data_analysis.html">
 <span class="dropdown-text">How to deal with a data set</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/03_revisions.html">
 <span class="dropdown-text">A few refresher exercises to get back in the saddle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wrangle" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wrangle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wrangle">    
        <li>
    <a class="dropdown-item" href="../../content/manipulation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/01_numpy.html">
 <span class="dropdown-text">Numpy, the foundation of data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_intro.html">
 <span class="dropdown-text">Introduction to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_suite.html">
 <span class="dropdown-text">Data wrangling with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/03_geopandas_intro.html">
 <span class="dropdown-text">Introduction to spatial data with Geopandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04a_webscraping_TP.html">
 <span class="dropdown-text">Web scraping with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04c_API_TP.html">
 <span class="dropdown-text">Retrieve data with APIs from Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04b_regex_TP.html">
 <span class="dropdown-text">Mastering regular expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-communicate" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Communicate</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-communicate">    
        <li>
    <a class="dropdown-item" href="../../content/visualisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/matplotlib.html">
 <span class="dropdown-text">Construire des graphiques avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/maps.html">
 <span class="dropdown-text">Introduction √† la cartographie avec Python</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model">    
        <li>
    <a class="dropdown-item" href="../../content/modelisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/0_preprocessing.html">
 <span class="dropdown-text">Preprocessing before building machine learning models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/1_modelevaluation.html">
 <span class="dropdown-text">Evaluating model quality</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/3_regression.html">
 <span class="dropdown-text">An introduction to regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/4_featureselection.html">
 <span class="dropdown-text">Variable selection: an introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/5_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/6_pipeline.html">
 <span class="dropdown-text">Premier pas vers l‚Äôindustrialisation avec les pipelines scikit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/7_mlapi.html">
 <span class="dropdown-text">Mettre √† disposition un mod√®le par le biais d‚Äôune API</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nlp" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NLP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nlp">    
        <li>
    <a class="dropdown-item" href="../../content/NLP/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/01_intro.html">
 <span class="dropdown-text">Nettoyer et structurer l‚Äôinformation dans les donn√©es textuelles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/02_exoclean.html">
 <span class="dropdown-text">L‚Äôanalyse fr√©quentiste par l‚Äôapproche bag-of-words : int√©r√™t et limites</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/03_embedding.html">
 <span class="dropdown-text">Les embeddings, o√π comment synth√©tiser l‚Äôinformation textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-depth" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-depth</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-depth">    
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/continuous_integration.html">
 <span class="dropdown-text">Int√©gration continue avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/s3.html">
 <span class="dropdown-text">Les nouveaux modes d‚Äôacc√®s aux donn√©es : le format Parquet et les donn√©es sur le cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_approfondissement.html">
 <span class="dropdown-text">Approfondissement ElasticSearch pour des recherches de proximit√© g√©ographique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_intro.html">
 <span class="dropdown-text">Introduction √† ElasticSearch pour la recherche textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-git" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Git</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-git">    
        <li>
    <a class="dropdown-item" href="../../content/git/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/introgit.html">
 <span class="dropdown-text">D√©couvrir Git par la pratique: la gymnastique quotidienne</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/exogit.html">
 <span class="dropdown-text">Un cadavre exquis pour d√©couvrir le travail collaboratif <code>Git</code></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-annexes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Annexes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-annexes">    
        <li>
    <a class="dropdown-item" href="../../content/annexes/evaluation.html">
 <span class="dropdown-text">Evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/annexes/corrections.html">
 <span class="dropdown-text">Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://linogaliana.github.io/python-datascientist-slides/#/title-slide">
 <span class="dropdown-text">Slides de pr√©sentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/linogaliana/python-datascientist" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/NLP/03_embedding.html">Les embeddings, o√π comment synth√©tiser l‚Äôinformation textuelle</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Les embeddings, o√π comment synth√©tiser l‚Äôinformation textuelle</h1>
                  <div>
        <div class="description">
          <p>Pour pouvoir utiliser des donn√©es textuelles dans des algorithmes
          de <em>machine learning</em>, il faut les vectoriser, c‚Äôest √† dire transformer
          le texte en donn√©es num√©riques. Dans ce TP, nous allons comparer
          diff√©rentes m√©thodes de vectorisation, √† travers une t√¢che de pr√©diction :
          <em>peut-on pr√©dire un auteur litt√©raire √† partir d‚Äôextraits de ses textes ?</em>
          Parmi ces m√©thodes, on va notamment explorer le mod√®le <code>Word2Vec</code>, qui
          permet d‚Äôexploiter les structures latentes d‚Äôun texte en construisant
          des <em>word embeddings</em> (plongements de mots).</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lino Galiana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2024-12-26</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nettoyer et structurer l‚Äôinformation dans les donn√©es textuelles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/02_exoclean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L‚Äôanalyse fr√©quentiste par l‚Äôapproche bag-of-words : int√©r√™t et limites</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/NLP/03_embedding.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Les embeddings, o√π comment synth√©tiser l‚Äôinformation textuelle</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#donn√©es-utilis√©es" id="toc-donn√©es-utilis√©es" class="nav-link" data-scroll-target="#donn√©es-utilis√©es"><span class="header-section-number">1.1</span> Donn√©es utilis√©es</a></li>
  <li><a href="#packages-√†-installer" id="toc-packages-√†-installer" class="nav-link" data-scroll-target="#packages-√†-installer"><span class="header-section-number">1.2</span> Packages √† installer</a></li>
  </ul></li>
  <li><a href="#pr√©paration-des-donn√©es" id="toc-pr√©paration-des-donn√©es" class="nav-link" data-scroll-target="#pr√©paration-des-donn√©es"><span class="header-section-number">2</span> Pr√©paration des donn√©es</a>
  <ul class="collapse">
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing"><span class="header-section-number">2.1</span> Preprocessing</a></li>
  <li><a href="#encodage-de-la-variable-√†-pr√©dire" id="toc-encodage-de-la-variable-√†-pr√©dire" class="nav-link" data-scroll-target="#encodage-de-la-variable-√†-pr√©dire"><span class="header-section-number">2.2</span> Encodage de la variable √† pr√©dire</a></li>
  <li><a href="#construction-des-bases-dentra√Ænement-et-de-test" id="toc-construction-des-bases-dentra√Ænement-et-de-test" class="nav-link" data-scroll-target="#construction-des-bases-dentra√Ænement-et-de-test"><span class="header-section-number">2.3</span> Construction des bases d‚Äôentra√Ænement et de test</a></li>
  </ul></li>
  <li><a href="#vectorisation-par-lapproche-bag-of-words" id="toc-vectorisation-par-lapproche-bag-of-words" class="nav-link" data-scroll-target="#vectorisation-par-lapproche-bag-of-words"><span class="header-section-number">3</span> Vectorisation par l‚Äôapproche <em>bag of words</em></a>
  <ul class="collapse">
  <li><a href="#trouver-le-texte-le-plus-similaire" id="toc-trouver-le-texte-le-plus-similaire" class="nav-link" data-scroll-target="#trouver-le-texte-le-plus-similaire"><span class="header-section-number">3.1</span> Trouver le texte le plus similaire</a>
  <ul class="collapse">
  <li><a href="#avec-scikit-learn" id="toc-avec-scikit-learn" class="nav-link" data-scroll-target="#avec-scikit-learn"><span class="header-section-number">3.1.1</span> Avec <code>Scikit-Learn</code></a></li>
  <li><a href="#avec-langchain" id="toc-avec-langchain" class="nav-link" data-scroll-target="#avec-langchain"><span class="header-section-number">3.1.2</span> Avec <code>Langchain</code></a></li>
  </ul></li>
  <li><a href="#trouver-lauteur-le-plus-proche-une-introduction-au-classifieur-naif-bayes" id="toc-trouver-lauteur-le-plus-proche-une-introduction-au-classifieur-naif-bayes" class="nav-link" data-scroll-target="#trouver-lauteur-le-plus-proche-une-introduction-au-classifieur-naif-bayes"><span class="header-section-number">3.2</span> Trouver l‚Äôauteur le plus proche: une introduction au classifieur naif Bayes</a></li>
  </ul></li>
  <li><a href="#le-mod√®le-word2vec-une-repr√©sentation-plus-synth√©tique" id="toc-le-mod√®le-word2vec-une-repr√©sentation-plus-synth√©tique" class="nav-link" data-scroll-target="#le-mod√®le-word2vec-une-repr√©sentation-plus-synth√©tique"><span class="header-section-number">4</span> Le mod√®le Word2Vec, une repr√©sentation plus synth√©tique</a>
  <ul class="collapse">
  <li><a href="#vers-une-repr√©sentation-plus-synth√©tique-du-langage" id="toc-vers-une-repr√©sentation-plus-synth√©tique-du-langage" class="nav-link" data-scroll-target="#vers-une-repr√©sentation-plus-synth√©tique-du-langage"><span class="header-section-number">4.1</span> Vers une repr√©sentation plus synth√©tique du langage</a></li>
  <li><a href="#des-relations-s√©mantique-entre-les-termes" id="toc-des-relations-s√©mantique-entre-les-termes" class="nav-link" data-scroll-target="#des-relations-s√©mantique-entre-les-termes"><span class="header-section-number">4.2</span> Des relations s√©mantique entre les termes</a></li>
  <li><a href="#comment-ces-mod√®les-sont-ils-entra√Æn√©s" id="toc-comment-ces-mod√®les-sont-ils-entra√Æn√©s" class="nav-link" data-scroll-target="#comment-ces-mod√®les-sont-ils-entra√Æn√©s"><span class="header-section-number">4.3</span> Comment ces mod√®les sont-ils entra√Æn√©s ?</a></li>
  <li><a href="#mod√®les-li√©s" id="toc-mod√®les-li√©s" class="nav-link" data-scroll-target="#mod√®les-li√©s"><span class="header-section-number">4.4</span> Mod√®les li√©s</a></li>
  </ul></li>
  <li><a href="#les-transformers-une-repr√©sentation-plus-riche-du-langage" id="toc-les-transformers-une-repr√©sentation-plus-riche-du-langage" class="nav-link" data-scroll-target="#les-transformers-une-repr√©sentation-plus-riche-du-langage"><span class="header-section-number">5</span> Les <em>transformers</em>: une repr√©sentation plus riche du langage</a>
  <ul class="collapse">
  <li><a href="#informations-additionnelles" id="toc-informations-additionnelles" class="nav-link" data-scroll-target="#informations-additionnelles">Informations additionnelles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/NLP/03_embedding.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<a href="#" onclick="this.href = location.href.replace('/en/', '/');" class="button-cta">
<button class="btn"><i class="fa fa-language"></i> Passer √† la version fran√ßaise üá´üá∑</button>
</a></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Ce chapitre va √©voluer prochainement.</p>
</div>
</div>
</div>
<div class="badge-container"><div class="badge-text">If you want to try the examples in this tutorial:</div><a href="https://github.com/linogaliana/python-datascientist-notebooks/blob/main/notebooks/en/NLP/03_embedding.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/static/v1?logo=github&amp;label=&amp;message=View%20on%20GitHub&amp;color=181717" alt="View on GitHub"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/vscode-pytorch?autoLaunch=true&amp;name=¬´03_embedding¬ª&amp;init.personalInit=¬´https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-vscode.sh¬ª&amp;init.personalInitArgs=¬´en/NLP%2003_embedding%20correction¬ª" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue" alt="Onyxia"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/jupyter-pytorch?autoLaunch=true&amp;name=¬´03_embedding¬ª&amp;init.personalInit=¬´https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-jupyter.sh¬ª&amp;init.personalInitArgs=¬´en/NLP%2003_embedding%20correction¬ª" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange" alt="Onyxia"></a>
<a href="https://colab.research.google.com/github/linogaliana/python-datascientist-notebooks//en/blob/main//notebooks/en/NLP/03_embedding.ipynb" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a><br></div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Cette page approfondit certains aspects pr√©sent√©s dans la
<a href="../../content/NLP/02_exoclean.html">partie introductive</a>.
Nous allons avancer dans notre compr√©hension des enjeux du NLP gr√¢ce √† la
mod√©lisation du langage.</p>
<p>Nous partirons de la conclusion, √©voqu√©e √† la fin du pr√©c√©dent chapitre, que les approches fr√©quentistes pr√©sentent plusieurs
inconv√©nients : repr√©sentation du langage sur des r√©gularit√©s statistiques ind√©pendantes des proximit√©s entre des mots ou phrases, difficult√© √† prendre en compte le contexte.</p>
<p>L‚Äôobjectif de ce chapitre est d‚Äô√©voquer le premier point. Il s‚Äôagira d‚Äôune introduction au sujet des <em>embeddings</em>, ces repr√©sentations du langage qui sont au fondement des mod√®les de langage actuels utilis√©s par des outils entr√©s dans notre quotidien (<code>DeepL</code>, <code>ChatGPT</code>‚Ä¶).</p>
<section id="donn√©es-utilis√©es" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="donn√©es-utilis√©es"><span class="header-section-number">1.1</span> Donn√©es utilis√©es</h2>
<p>Nous allons continuer notre exploration de la litt√©rature
avec, √† nouveau, les trois auteurs anglophones :</p>
<ul>
<li>Edgar Allan Poe, (EAP) ;</li>
<li>HP Lovecraft (HPL) ;</li>
<li>Mary Wollstonecraft Shelley (MWS).</li>
</ul>
<p>Les donn√©es sont disponibles sur un CSV mis √† disposition sur <a href="https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/blob/master/data/spooky.csv"><code>Github</code></a>. L‚ÄôURL pour les r√©cup√©rer directement est
<a href="https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/raw/master/data/spooky.csv" class="uri">https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/raw/master/data/spooky.csv</a>.</p>
<p>Pour rentrer dans le sujet des <em>embeddings</em>, nous allons faire de la mod√©lisation du langage en essayant de pr√©dire les auteurs ayant √©crit tel ou tel texte. On parle de mod√®le de langage pour d√©signer la repr√©sentation d‚Äôun texte ou d‚Äôune langue sous la forme d‚Äôune distribution de probabilit√©s de termes (g√©n√©ralement les mots).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sources d‚Äôinspiration
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Ce chapitre s‚Äôinspire de plusieurs ressources disponibles en ligne:</p>
<ul>
<li>Un <a href="https://www.kaggle.com/enerrio/scary-nlp-with-spacy-and-keras">premier <em>notebook</em> sur <code>Kaggle</code></a>
et un <a href="https://www.kaggle.com/meiyizi/spooky-nlp-and-topic-modelling-tutorial/notebook">deuxi√®me</a> ;</li>
<li>Un <a href="https://github.com/GU4243-ADS/spring2018-project1-ginnyqg">d√©p√¥t <code>Github</code></a> ;</li>
</ul>
</div>
</div>
</div>
</section>
<section id="packages-√†-installer" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="packages-√†-installer"><span class="header-section-number">1.2</span> Packages √† installer</h2>
<p>Comme dans la <a href="../../content/NLP/02_exoclean.html">partie pr√©c√©dente</a>, il faut t√©l√©charger des librairies
sp√©cialis√©ees pour le NLP, ainsi que certaines de leurs d√©pendances. Ce TD utilisera plusieurs librairies dont certaines d√©pendent de <code>PyTorch</code> qui est une librairie volumineuse.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PyTorch sur le SSPCloud
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>La prochaine remarque ne concerne que les utilisateurs.trices du <code>SSPCloud</code>.</strong></p>
<p>Les services <code>Python</code> standards sur le <code>SSPCloud</code> (les services <code>vscode-python</code> et <code>jupyter-python</code>) ne proposent pas <code>PyTorch</code> pr√©install√©. Cette librairie est en effet assez volumineuse (de l‚Äôordre de 600Mo) et n√©cessite un certain nombre de configurations <em>ad hoc</em> pour fonctionner de mani√®re transparente quelle que soit la configuration logicielle derri√®re. Pour des raisons de frugalit√© √©cologique, cet environnement <em>boost√©</em> n‚Äôest pas propos√© par d√©faut. N√©anmoins, si besoin, un tel environnement o√π <code>Pytorch</code> est pr√© √† l‚Äôemploi est disponible.</p>
<p>Pour cela, il suffit de d√©marrer un service <code>vscode-pytorch</code> ou <code>jupyter-pytorch</code>. Si vous avez utilis√© l‚Äôun des boutons disponibles ci-dessus, c‚Äôest ce service standardis√© qui a automatiquement √©t√© mis √† disposition pour vous.</p>
</div>
</div>
</div>
<div id="1722cc88" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="1722cc88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="1722cc88-1"><a href="#1722cc88-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install numpy pandas spacy transformers scikit<span class="op">-</span>learn langchain_community</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ensuite, comme nous allons utiliser la librairie <code>SpaCy</code> avec un corpus de textes
en Anglais, il convient de t√©l√©charger le mod√®le NLP pour l‚ÄôAnglais. Pour cela,
on peut se r√©f√©rer √† <a href="https://spacy.io/usage/models">la documentation de <code>SpaCy</code></a>,
extr√™mement bien faite.</p>
<div id="50ed97fd" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="50ed97fd"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="50ed97fd-1"><a href="#50ed97fd-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m spacy download en_core_web_sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pr√©paration-des-donn√©es" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Pr√©paration des donn√©es</h1>
<p>Nous allons √† nouveau utiliser le jeu de donn√©es <code>spooky</code> :</p>
<div id="bc8c4219" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="bc8c4219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="bc8c4219-1"><a href="#bc8c4219-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="bc8c4219-2"><a href="#bc8c4219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="bc8c4219-3"><a href="#bc8c4219-3" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://github.com/GU4243-ADS/spring2018-project1-ginnyqg/raw/master/data/spooky.csv"</span></span>
<span id="bc8c4219-4"><a href="#bc8c4219-4" aria-hidden="true" tabindex="-1"></a>spooky_df <span class="op">=</span> pd.read_csv(data_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le jeu de donn√©es met ainsi en regard un auteur avec une phrase qu‚Äôil a √©crite :</p>
<div id="b37ef247" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="b37ef247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b37ef247-1"><a href="#b37ef247-1" aria-hidden="true" tabindex="-1"></a>spooky_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">author</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>id26305</td>
<td>This process, however, afforded me no means of...</td>
<td>EAP</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>id17569</td>
<td>It never once occurred to me that the fumbling...</td>
<td>HPL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>id11008</td>
<td>In his left hand was a gold snuff box, from wh...</td>
<td>EAP</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>id27763</td>
<td>How lovely is spring As we looked from Windsor...</td>
<td>MWS</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>id12958</td>
<td>Finding nothing else, not even gold, the Super...</td>
<td>HPL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="preprocessing" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="preprocessing"><span class="header-section-number">2.1</span> Preprocessing</h2>
<p>Comme nous l‚Äôavons √©voqu√© dans le chapitre pr√©c√©dent, la premi√®re √©tape de tout travail sur donn√©es textuelles est souvent celle du <em>preprocessing</em>, qui inclut notamment les √©tapes de tokenization et de nettoyage du texte.</p>
<p>On se contentera ici d‚Äôun <em>preprocessing</em> minimaliste : suppression de la ponctuation et des <em>stop words</em> (pour la visualisation et les m√©thodes de vectorisation bas√©es sur des comptages).</p>
<p>Pour initialiser le processus de nettoyage,
on va utiliser le corpus <code>en_core_web_sm</code> de <code>Spacy</code></p>
<div id="613d39c0" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="613d39c0"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="613d39c0-1"><a href="#613d39c0-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="613d39c0-2"><a href="#613d39c0-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="613d39c0-3"><a href="#613d39c0-3" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On va utiliser un <code>pipe</code> <code>spacy</code> qui permet d‚Äôautomatiser, et de parall√©liser,
un certain nombre d‚Äôop√©rations. Les <em>pipes</em> sont l‚Äô√©quivalent, en NLP, de
nos <em>pipelines</em> <code>scikit</code> ou des <em>pipes</em> <code>pandas</code>. Il s‚Äôagit donc d‚Äôun outil
tr√®s appropri√© pour industrialiser un certain nombre d‚Äôop√©rations de
<em>preprocessing</em> :</p>
<div id="d3776cfe" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Preprocessing de la base textuelle</summary>
<div class="sourceCode cell-code" id="d3776cfe"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="d3776cfe-1"><a href="#d3776cfe-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="d3776cfe-2"><a href="#d3776cfe-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="d3776cfe-3"><a href="#d3776cfe-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-4"><a href="#d3776cfe-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-5"><a href="#d3776cfe-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_docs(</span>
<span id="d3776cfe-6"><a href="#d3776cfe-6" aria-hidden="true" tabindex="-1"></a>    texts: List[<span class="bu">str</span>],</span>
<span id="d3776cfe-7"><a href="#d3776cfe-7" aria-hidden="true" tabindex="-1"></a>    remove_stopwords: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>,</span>
<span id="d3776cfe-8"><a href="#d3776cfe-8" aria-hidden="true" tabindex="-1"></a>    n_process: <span class="bu">int</span> <span class="op">=</span> <span class="dv">4</span>,</span>
<span id="d3776cfe-9"><a href="#d3776cfe-9" aria-hidden="true" tabindex="-1"></a>    remove_punctuation: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>,</span>
<span id="d3776cfe-10"><a href="#d3776cfe-10" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="d3776cfe-11"><a href="#d3776cfe-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="d3776cfe-12"><a href="#d3776cfe-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Cleans a list of text documents by tokenizing, optionally removing stopwords, and optionally removing punctuation.</span></span>
<span id="d3776cfe-13"><a href="#d3776cfe-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-14"><a href="#d3776cfe-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="d3776cfe-15"><a href="#d3776cfe-15" aria-hidden="true" tabindex="-1"></a><span class="co">        texts (List[str]): List of text documents to clean.</span></span>
<span id="d3776cfe-16"><a href="#d3776cfe-16" aria-hidden="true" tabindex="-1"></a><span class="co">        remove_stopwords (bool): Whether to remove stopwords. Default is False.</span></span>
<span id="d3776cfe-17"><a href="#d3776cfe-17" aria-hidden="true" tabindex="-1"></a><span class="co">        n_process (int): Number of processes to use for processing. Default is 4.</span></span>
<span id="d3776cfe-18"><a href="#d3776cfe-18" aria-hidden="true" tabindex="-1"></a><span class="co">        remove_punctuation (bool): Whether to remove punctuation. Default is True.</span></span>
<span id="d3776cfe-19"><a href="#d3776cfe-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-20"><a href="#d3776cfe-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="d3776cfe-21"><a href="#d3776cfe-21" aria-hidden="true" tabindex="-1"></a><span class="co">        List[str]: List of cleaned text documents.</span></span>
<span id="d3776cfe-22"><a href="#d3776cfe-22" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="d3776cfe-23"><a href="#d3776cfe-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load spacy's nlp model</span></span>
<span id="d3776cfe-24"><a href="#d3776cfe-24" aria-hidden="true" tabindex="-1"></a>    docs <span class="op">=</span> nlp.pipe(</span>
<span id="d3776cfe-25"><a href="#d3776cfe-25" aria-hidden="true" tabindex="-1"></a>        texts, n_process<span class="op">=</span>n_process, disable<span class="op">=</span>[<span class="st">"parser"</span>, <span class="st">"ner"</span>, <span class="st">"lemmatizer"</span>, <span class="st">"textcat"</span>]</span>
<span id="d3776cfe-26"><a href="#d3776cfe-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="d3776cfe-27"><a href="#d3776cfe-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-28"><a href="#d3776cfe-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pre-load stopwords for faster checking</span></span>
<span id="d3776cfe-29"><a href="#d3776cfe-29" aria-hidden="true" tabindex="-1"></a>    stopwords <span class="op">=</span> <span class="bu">set</span>(nlp.Defaults.stop_words)</span>
<span id="d3776cfe-30"><a href="#d3776cfe-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-31"><a href="#d3776cfe-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process documents</span></span>
<span id="d3776cfe-32"><a href="#d3776cfe-32" aria-hidden="true" tabindex="-1"></a>    docs_cleaned <span class="op">=</span> (</span>
<span id="d3776cfe-33"><a href="#d3776cfe-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>.join(</span>
<span id="d3776cfe-34"><a href="#d3776cfe-34" aria-hidden="true" tabindex="-1"></a>            tok.text.lower().strip()</span>
<span id="d3776cfe-35"><a href="#d3776cfe-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> tok <span class="kw">in</span> doc</span>
<span id="d3776cfe-36"><a href="#d3776cfe-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">not</span> remove_punctuation <span class="kw">or</span> <span class="kw">not</span> tok.is_punct)</span>
<span id="d3776cfe-37"><a href="#d3776cfe-37" aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> (<span class="kw">not</span> remove_stopwords <span class="kw">or</span> tok.text.lower() <span class="kw">not</span> <span class="kw">in</span> stopwords)</span>
<span id="d3776cfe-38"><a href="#d3776cfe-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="d3776cfe-39"><a href="#d3776cfe-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> doc <span class="kw">in</span> docs</span>
<span id="d3776cfe-40"><a href="#d3776cfe-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="d3776cfe-41"><a href="#d3776cfe-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="d3776cfe-42"><a href="#d3776cfe-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(docs_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>On applique la fonction <code>clean_docs</code> √† notre colonne <code>pandas</code>.
Les <code>pandas.Series</code> √©tant it√©rables, elles se comportent comme des listes et
fonctionnent ainsi tr√®s bien avec notre <code>pipe</code> <code>spacy</code>.</p>
<div id="0e0499df" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="0e0499df"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="0e0499df-1"><a href="#0e0499df-1" aria-hidden="true" tabindex="-1"></a>spooky_df[<span class="st">"text_clean"</span>] <span class="op">=</span> clean_docs(spooky_df[<span class="st">"text"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="28202c4c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="28202c4c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="28202c4c-1"><a href="#28202c4c-1" aria-hidden="true" tabindex="-1"></a>spooky_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">text_clean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>id26305</td>
<td>This process, however, afforded me no means of...</td>
<td>EAP</td>
<td>this process however afforded me no means of a...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>id17569</td>
<td>It never once occurred to me that the fumbling...</td>
<td>HPL</td>
<td>it never once occurred to me that the fumbling...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>id11008</td>
<td>In his left hand was a gold snuff box, from wh...</td>
<td>EAP</td>
<td>in his left hand was a gold snuff box from whi...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>id27763</td>
<td>How lovely is spring As we looked from Windsor...</td>
<td>MWS</td>
<td>how lovely is spring as we looked from windsor...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>id12958</td>
<td>Finding nothing else, not even gold, the Super...</td>
<td>HPL</td>
<td>finding nothing else not even gold the superin...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="encodage-de-la-variable-√†-pr√©dire" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="encodage-de-la-variable-√†-pr√©dire"><span class="header-section-number">2.2</span> Encodage de la variable √† pr√©dire</h2>
<p>On r√©alise un simple encodage de la variable √† pr√©dire :
il y a trois cat√©gories (auteurs), repr√©sent√©es par des entiers 0, 1 et 2.
Pour cela, on utilise le <code>LabelEncoder</code> de <code>Scikit</code> d√©j√† pr√©sent√©
dans la <a href="../../content/modelisation/0_preprocessing.html">partie mod√©lisation</a>. On va utiliser la m√©thode
<code>fit_transform</code> qui permet, en un tour de main, d‚Äôappliquer √† la fois
l‚Äôentra√Ænement (<code>fit</code>), √† savoir la cr√©ation d‚Äôune correspondance entre valeurs
num√©riques et <em>labels</em>, et l‚Äôappliquer (<code>transform</code>) √† la m√™me colonne.</p>
<p>On peut v√©rifier les classes de notre <code>LabelEncoder</code> :</p>
<div id="06860732" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array(['EAP', 'HPL', 'MWS'], dtype=object)</code></pre>
</div>
</div>
</section>
<section id="construction-des-bases-dentra√Ænement-et-de-test" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="construction-des-bases-dentra√Ænement-et-de-test"><span class="header-section-number">2.3</span> Construction des bases d‚Äôentra√Ænement et de test</h2>
<p>On met de c√¥t√© un √©chantillon de test (20 %) avant toute analyse (m√™me descriptive).
Cela permettra d‚Äô√©valuer nos diff√©rents mod√®les toute √† la fin de mani√®re tr√®s rigoureuse,
puisque ces donn√©es n‚Äôauront jamais utilis√©es pendant l‚Äôentra√Ænement.</p>
<p>Notre √©chantillon initial n‚Äôest pas √©quilibr√© (<em>balanced</em>) : on retrouve plus d‚Äôoeuvres de
certains auteurs que d‚Äôautres. Afin d‚Äôobtenir un mod√®le qui soit √©valu√© au mieux, nous allons donc stratifier notre √©chantillon de mani√®re √† obtenir une r√©partition similaire d‚Äôauteurs dans nos
ensembles d‚Äôentra√Ænement et de test.</p>
<div id="c3199646" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="c3199646"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c3199646-1"><a href="#c3199646-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="c3199646-2"><a href="#c3199646-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="c3199646-3"><a href="#c3199646-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> spooky_df[<span class="st">"author"</span>]</span>
<span id="c3199646-4"><a href="#c3199646-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> spooky_df[<span class="st">"text_clean"</span>]</span>
<span id="c3199646-5"><a href="#c3199646-5" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="c3199646-6"><a href="#c3199646-6" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, stratify<span class="op">=</span>y, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="c3199646-7"><a href="#c3199646-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aper√ßu du premier √©l√©ment de <code>X_train</code> :</p>
<div id="9b91cad2" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>'this process however afforded me no means of ascertaining the dimensions of my dungeon as i might make its circuit and return to the point whence i set out without being aware of the fact so perfectly uniform seemed the wall'</code></pre>
</div>
</div>
</section>
</section>
<section id="vectorisation-par-lapproche-bag-of-words" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Vectorisation par l‚Äôapproche <em>bag of words</em></h1>
<p>La repr√©sentation de nos textes sous forme de sac de mot permet de vectoriser notre corpus et ainsi d‚Äôavoir une repr√©sentation num√©rique de chaque texte. On peut √† partir de l√† effectuer plusieurs types de t√¢ches de mod√©lisation.</p>
<p>D√©finissons notre repr√©sentation vectorielle par TF-IDF gr√¢ce √† <code>Scikit</code>:</p>
<div id="39877794" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="39877794"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="39877794-1"><a href="#39877794-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="39877794-2"><a href="#39877794-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="39877794-3"><a href="#39877794-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="39877794-4"><a href="#39877794-4" aria-hidden="true" tabindex="-1"></a>pipeline_tfidf <span class="op">=</span> Pipeline(</span>
<span id="39877794-5"><a href="#39877794-5" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="39877794-6"><a href="#39877794-6" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"tfidf"</span>, TfidfVectorizer(max_features<span class="op">=</span><span class="dv">10000</span>)),</span>
<span id="39877794-7"><a href="#39877794-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="39877794-8"><a href="#39877794-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="39877794-9"><a href="#39877794-9" aria-hidden="true" tabindex="-1"></a>pipeline_tfidf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('tfidf', TfidfVectorizer(max_features=10000))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link ">i<span>Not fitted</span></span></label><div class="sk-toggleable__content "><pre>Pipeline(steps=[('tfidf', TfidfVectorizer(max_features=10000))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;TfidfVectorizer<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">?<span>Documentation for TfidfVectorizer</span></a></label><div class="sk-toggleable__content "><pre>TfidfVectorizer(max_features=10000)</pre></div> </div></div></div></div></div></div>
</div>
</div>
<p>Entra√Ænons d‚Äôores et d√©j√† notre mod√®le √† vectoriser le texte √† partir de la m√©thode TF-IDF. Pour le moment il n‚Äôest pas encore question de faire de l‚Äô√©valuation, faisons donc un entra√Ænement sur l‚Äôensemble de notre base et pas seulement sur <code>X_train</code>.</p>
<div id="70436aad" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="70436aad"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="70436aad-1"><a href="#70436aad-1" aria-hidden="true" tabindex="-1"></a>pipeline_tfidf.fit(spooky_df[<span class="st">"text_clean"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('tfidf', TfidfVectorizer(max_features=10000))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('tfidf', TfidfVectorizer(max_features=10000))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;TfidfVectorizer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">?<span>Documentation for TfidfVectorizer</span></a></label><div class="sk-toggleable__content fitted"><pre>TfidfVectorizer(max_features=10000)</pre></div> </div></div></div></div></div></div>
</div>
</div>
<section id="trouver-le-texte-le-plus-similaire" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="trouver-le-texte-le-plus-similaire"><span class="header-section-number">3.1</span> Trouver le texte le plus similaire</h2>
<p>En premier lieu, on peut chercher le texte le plus proche, au sens de TF-IDF, d‚Äôune phrase donn√©e. Prenons cet exemple:</p>
<div id="aae2fa5a" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="aae2fa5a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="aae2fa5a-1"><a href="#aae2fa5a-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"He was afraid by Frankenstein monster"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comment retrouver le texte le plus proche de celui-ci ? Il faudrait transformer notre texte dans cette m√™me repr√©sentation vectorielle et rapprocher ensuite celui-ci des autres textes repr√©sent√©s sous cette m√™me forme.</p>
<p>Cela revient √† effectuer une t√¢che de recherche d‚Äôinformation, cas d‚Äôusage classique du NLP, mis en oeuvre par exemple par les moteurs de recherche. Le terme Frankenstein √©tant assez discrminant, nous devrions, gr√¢ce √† TF-IDF, retrouver des similarit√©s entre notre texte et d‚Äôautres textes √©crits par Mary Shelley.</p>
<p>Une m√©trique r√©guli√®rement utilis√©e pour comparer des vecteurs est la similarit√© cosinus. Il s‚Äôagit d‚Äôailleurs d‚Äôune mesure centrale dans l‚Äôapproche moderne du NLP. Celle-ci a plus de sens avec des vecteurs dense, que nous verrons prochainement, qu‚Äôavec des vecteurs comportant beaucoup de 0 comme le sont les vecteurs <em>sparse</em> des mesures <em>bag-of-words</em>. N√©anmoins c‚Äôest d√©j√† un exercice int√©ressant pour comprendre la similarit√© entre deux vecteurs.</p>
<p>Si chaque dimension d‚Äôun vecteur correspond √† une direction, l‚Äôid√©e derri√®re la similarit√© cosinus est de mesurer l‚Äôangle entre deux vecteurs. L‚Äôangle sera r√©duit si les vecteurs sont proches.</p>
<p><a href="https://miro.medium.com/v2/resize:fit:824/1*GK56xmDIWtNQAD_jnBIt2g.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://miro.medium.com/v2/resize:fit:824/1*GK56xmDIWtNQAD_jnBIt2g.png" class="img-fluid"></a></p>
<section id="avec-scikit-learn" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="avec-scikit-learn"><span class="header-section-number">3.1.1</span> Avec <code>Scikit-Learn</code></h3>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 1: recherche de similarit√© avec TF-IDF
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Utiliser la m√©thode <code>transform</code> pour vectoriser tout notre corpus d‚Äôentra√Ænement.</p></li>
<li><p>En supposant que votre jeu d‚Äôentra√Ænement vectoris√© s‚Äôappelle <code>X_train_tfidf</code>, vous pouvez le transformer en <em>DataFrame</em> avec la commande suivante:</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>X_train_tfidf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    X_train_tfidf.todense(), columns<span class="op">=</span>pipeline_tfidf.get_feature_names_out()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>Utiliser la m√©thode <code>cosine_similarity</code> de <code>Scikit</code> pour calculer la similarit√© cosinus entre notre texte vectoris√© et l‚Äôensemble du corpus d‚Äôentra√Ænement gr√¢ce au code suivant:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>cosine_similarities <span class="op">=</span> cosine_similarity(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    X_train_tfidf, pipeline_tfidf.transform([text])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>).flatten()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>top_4_indices <span class="op">=</span> np.argsort(cosine_similarities)[<span class="op">-</span><span class="dv">4</span>:][</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    ::<span class="op">-</span><span class="dv">1</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># Sort and reverse for descending order</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>top_4_similarities <span class="op">=</span> cosine_similarities[top_4_indices]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li>Retrouver les documents concern√©s. √ätes-vous satisfait du r√©sultat ? Comprenez-vous ce qu‚Äôil s‚Äôest pass√© ?</li>
</ol>
</div>
</div>
</div>
<p>A l‚Äôissue de l‚Äôexercice, les 4 textes les plus similaires sont:</p>
<div id="1e4ed60f" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8181</td>
<td>Listen to me, Frankenstein.</td>
<td>MWS</td>
<td>0.402964</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8606</td>
<td>He was gazing at me gaspingly and fascinatedly...</td>
<td>HPL</td>
<td>0.330177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14550</td>
<td>The light is dimmer and the gods are afraid. . .</td>
<td>HPL</td>
<td>0.314670</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11366</td>
<td>I screamed aloud that I was not afraid; that I...</td>
<td>HPL</td>
<td>0.311235</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="avec-langchain" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="avec-langchain"><span class="header-section-number">3.1.2</span> Avec <code>Langchain</code></h3>
<p>Cette approche de calcul de similarit√© textuelle est assez laborieuse avec <code>Scikit</code>. Avec le d√©veloppement continu d‚Äôapplications <code>Python</code> utilisant des mod√®les de langage, un √©cosyst√®me tr√®s complet s‚Äôest d√©velopp√© pour pouvoir faire ces t√¢ches en quelques lignes de code avec <code>Python</code>.</p>
<p>Parmi les outils les plus pr√©cieux, nous trouvons <a href="https://www.langchain.com/"><code>Langchain</code></a> un √©cosyst√®me <code>Python</code> haut-niveau permettant de construire des cha√Ænes de production utilisant des donn√©es textuelles.</p>
<p>Nous allons ici proc√©der en 2 √©tapes:</p>
<ul>
<li>Cr√©er un <em>retriever</em>, c‚Äôest-√†-dire vectoriser avec TF-IDF notre corpus (les textes de nos trois auteurs) et les stocker sous forme de base de donn√©es vectorielle.</li>
<li>Vectoriser √† la vol√©e notre texte de recherche (l‚Äôobject <code>text</code> cr√©√© pr√©c√©demment) et rechercher sa contrepartie la plus proche dans la base de donn√©es vectorielle.</li>
</ul>
<p>La vectorisation de notre corpus se fait tr√®s simplement gr√¢ce √† <code>Langchain</code>
puisque le TFIDFVectoriser de <code>Scikit</code> est encapsul√© dans un module <em>ad hoc</em> de <code>Lanchain</code></p>
<div id="46af2f5c" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="46af2f5c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="46af2f5c-1"><a href="#46af2f5c-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain_community.retrievers <span class="im">import</span> TFIDFRetriever</span>
<span id="46af2f5c-2"><a href="#46af2f5c-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain_community.document_loaders <span class="im">import</span> DataFrameLoader</span>
<span id="46af2f5c-3"><a href="#46af2f5c-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="46af2f5c-4"><a href="#46af2f5c-4" aria-hidden="true" tabindex="-1"></a>loader <span class="op">=</span> DataFrameLoader(spooky_df, page_content_column<span class="op">=</span><span class="st">"text_clean"</span>)</span>
<span id="46af2f5c-5"><a href="#46af2f5c-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="46af2f5c-6"><a href="#46af2f5c-6" aria-hidden="true" tabindex="-1"></a>retriever <span class="op">=</span> TFIDFRetriever.from_documents(loader.load())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cet objet <code>retriever</code> est un point d‚Äôentr√©e sur notre corpus. <code>Langchain</code> pr√©sente l‚Äôint√©r√™t de fournir plusieurs points d‚Äôentr√©es standardis√©s, forts utiles dans les projets de NLP puisqu‚Äôil suffit de changer les vectoriseurs en entr√©e sans avoir √† changer leur usage en fin de cha√Æne.</p>
<p>La m√©thode <code>invoke</code> permet de rechercher les vecteurs les plus similaires √† notre texte de recherche:</p>
<div id="02901fd2" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="02901fd2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="02901fd2-1"><a href="#02901fd2-1" aria-hidden="true" tabindex="-1"></a>retriever.invoke(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>[Document(metadata={'id': 'id12587', 'text': 'Listen to me, Frankenstein.', 'author': 'MWS', 'author_encoded': 2}, page_content='listen to me frankenstein'),
 Document(metadata={'id': 'id09284', 'text': 'I screamed aloud that I was not afraid; that I never could be afraid; and others screamed with me for solace.', 'author': 'HPL', 'author_encoded': 1}, page_content='i screamed aloud that i was not afraid that i never could be afraid and others screamed with me for solace'),
 Document(metadata={'id': 'id09797', 'text': 'It seemed to be a sort of monster, or symbol representing a monster, of a form which only a diseased fancy could conceive.', 'author': 'HPL', 'author_encoded': 1}, page_content='it seemed to be a sort of monster or symbol representing a monster of a form which only a diseased fancy could conceive'),
 Document(metadata={'id': 'id10816', 'text': 'And, as I have implied, it was not of the dead man himself that I became afraid.', 'author': 'HPL', 'author_encoded': 1}, page_content='and as i have implied it was not of the dead man himself that i became afraid')]</code></pre>
</div>
</div>
<p>La sortie est un objet <code>Lanchain</code>, ce qui n‚Äôest pas pratique pour nous dans notre situation. On se ram√®ne √† un <em>DataFrame</em>:</p>
<div id="3c0f89c0" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="3c0f89c0"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="3c0f89c0-1"><a href="#3c0f89c0-1" aria-hidden="true" tabindex="-1"></a>documents <span class="op">=</span> []</span>
<span id="3c0f89c0-2"><a href="#3c0f89c0-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> best_echoes <span class="kw">in</span> retriever.invoke(text):</span>
<span id="3c0f89c0-3"><a href="#3c0f89c0-3" aria-hidden="true" tabindex="-1"></a>    documents <span class="op">+=</span> [{<span class="op">**</span>best_echoes.metadata, <span class="op">**</span>{<span class="st">"text_clean"</span>: best_echoes.page_content}}]</span>
<span id="3c0f89c0-4"><a href="#3c0f89c0-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="3c0f89c0-5"><a href="#3c0f89c0-5" aria-hidden="true" tabindex="-1"></a>documents <span class="op">=</span> pd.DataFrame(documents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut ajouter √† ce <em>DataFrame</em> la colonne de score:</p>
<p>On retrouve bien les m√™mes documents:</p>
<div id="23b8e943" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">author_encoded</th>
<th data-quarto-table-cell-role="th">text_clean</th>
<th data-quarto-table-cell-role="th">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>id12587</td>
<td>Listen to me, Frankenstein.</td>
<td>MWS</td>
<td>2</td>
<td>listen to me frankenstein</td>
<td>0.402964</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>id09284</td>
<td>I screamed aloud that I was not afraid; that I...</td>
<td>HPL</td>
<td>1</td>
<td>i screamed aloud that i was not afraid that i ...</td>
<td>0.311235</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>id09797</td>
<td>It seemed to be a sort of monster, or symbol r...</td>
<td>HPL</td>
<td>1</td>
<td>it seemed to be a sort of monster or symbol re...</td>
<td>0.295587</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>id10816</td>
<td>And, as I have implied, it was not of the dead...</td>
<td>HPL</td>
<td>1</td>
<td>and as i have implied it was not of the dead m...</td>
<td>0.261818</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
La m√©trique BM25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>BM25 est un mod√®le de r√©cup√©ration d‚Äôinformations bas√© sur la pertinence probabiliste, au m√™me titre que TF-IDF. BM25 est souvent utilis√©e dans les moteurs de recherche pour classer les documents par rapport √† une requ√™te.</p>
<p>BM25 repose sur une combinaison de la fr√©quence des termes (TF), la fr√©quence inverse des documents (IDF), et une normalisation bas√©e sur la longueur des documents. Autrement dit, il s‚Äôagit de tenir compte d‚Äôam√©liorer TF-IDF tout en normalisant les mesures en fonction de la taille des <em>strings</em> afin de ne pas surpond√©rer les grands documents.</p>
<p>BM25 est donc particuli√®rement performant dans des environnements o√π les documents varient en longueur et en contenu. C‚Äôest pour cette raison que des moteurs de recherche comme <code>Elasticsearch</code> en ont fait une pierre angulaire du m√©canisme de recherche.</p>
</div>
</div>
</div>
<p>Pourquoi ne sont-ils pas tous pertinents ? On peut anticiper plusieurs raisons √† cela.</p>
<p>La premi√®re hypoth√®se vient du fait qu‚Äôon entra√Æne notre vectoriseur sur un corpus biais√©. Certes Frankestein est un terme rare mais il est beaucoup plus fr√©quent dans notre corpus que dans la langue anglaise. L‚Äô<em>inverse document frequency</em> est donc biais√©e en d√©faveur de ce terme: son apparition devrait √™tre un signe beaucoup plus fort que le texte recherch√© correspond √† Mary Shelley. Si cela peut am√©liorer un peu la pertinence des r√©sultats renvoy√©s, ce n‚Äôest n√©anmoins pas l√† que le b√¢t blesse.</p>
<p>L‚Äôapproche fr√©quentiste suppose que les termes sont aussi dissemblables les uns que les autres. Une phrase o√π appara√Æt le terme <em>‚Äúcr√©ature‚Äù</em> ne b√©n√©ficiera pas d‚Äôun score positif si on recherche <em>‚Äúmonstre‚Äù</em>. De plus, l√† encore, nous avons pris notre corpus comme un sac o√π les mots sont ind√©pendants: on n‚Äôa pas plus de chance de tirer <em>‚ÄúFrankenstein‚Äù</em> apr√®s <em>‚Äúdocteur‚Äù</em>. Ces limites vont nous amener vers le sujet des <em>embeddings</em>. N√©anmoins, si l‚Äôapproche fr√©quentiste est un peu <em>old school</em>, elle n‚Äôest n√©anmoins pas inutile et repr√©sente souvent une <em>‚Äútough to beat baseline‚Äù</em>. Dans les domaines de l‚Äôextraction d‚Äôinformation avec des textes courts, o√π chaque terme est porteur d‚Äôun signal fort, cette approche est souvent judicieuse.</p>
</section>
</section>
<section id="trouver-lauteur-le-plus-proche-une-introduction-au-classifieur-naif-bayes" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="trouver-lauteur-le-plus-proche-une-introduction-au-classifieur-naif-bayes"><span class="header-section-number">3.2</span> Trouver l‚Äôauteur le plus proche: une introduction au classifieur naif Bayes</h2>
<p>Avant d‚Äôexplorer les <em>embeddings</em>, nous pouvons essayer d‚Äôavoir un cas d‚Äôusage un petit peu diff√©rent dans notre cadre probabiliste. Supposons qu‚Äôon d√©sire maintenant faire de la pr√©diction d‚Äôauteur. Si l‚Äôintuition pr√©c√©dente est vraie - certains mots sont plus probables dans les textes de certains auteurs - cela veut dire qu‚Äôon peut entra√Æner un algorithme de classification automatique √† pr√©dire un auteur √† partir d‚Äôun texte.</p>
<p>La m√©thode la plus naturelle pour se lancer dans cette approche est d‚Äôutiliser le classifieur naif de Bayes. Ce dernier est parfaitement adapt√© √† l‚Äôapproche fr√©quentiste que nous avons adopt√©e jusqu‚Äô√† pr√©sent puisqu‚Äôil exploite les probabilit√©s d‚Äôoccurrence de mots par auteur.</p>
<p>Le classifieur naif de Bayes consiste √† appliquer une r√®gle de d√©cision, √† savoir s√©lectionner la classe la plus probable sachant la structure observ√©e du document, c‚Äôest-√†-dire les mots apparaissant dans celui-ci.</p>
<p>Autrement dit, on s√©lectionne la classe <span class="math inline">\(\widehat{c}\)</span> qui est la plus probable, sachant les termes dans le document <span class="math inline">\(d\)</span>.</p>
<p><span id="eq-definition-bayes"><span class="math display">\[
\widehat{c} = \arg \max_{c \in \mathcal{C}} \mathbb{P}(c|d) =  \arg \max_{c \in \mathcal{C}} \frac{ \mathbb{P}(d|c)\mathbb{P}(c)}{\mathbb{P}(d)}
\tag{3.1}\]</span></span></p>
<p>Comme ceci est classique en estimation bay√©sienne, on peut se passer de certains termes constants, √† savoir <span class="math inline">\(\mathbb{P}(d)\)</span>. La d√©finition de la classe estim√©e peut ainsi √™tre reformul√©e de cette mani√®re:</p>
<p><span id="eq-rewriting-bayes"><span class="math display">\[
\widehat{c} = \arg \max_{c \in \mathcal{C}} \mathbb{P}(d|c)\mathbb{P}(c)
\tag{3.2}\]</span></span></p>
<p>L‚Äôhypoth√®se du sac de mot intervient √† ce niveau. Un document <span class="math inline">\(d\)</span> est une collection de mots <span class="math inline">\(w_i\)</span> dont l‚Äôordre n‚Äôa pas d‚Äôint√©r√™t. Autrement dit, on peut se contenter de faire un mod√®le sur les mots, sans faire intervenir des probabilit√©s conditionnelles sur l‚Äôordre d‚Äôoccurrence.
La seconde hypoth√®se forte est l‚Äôhypoth√®se naive √† laquelle la m√©thode doit son nom: la probabilit√© de tirer un mot ne d√©pend que de la cat√©gorie <span class="math inline">\(c\)</span> d‚Äôappartenance du document. Autrement dit, on peut consid√©rer qu‚Äôun document est une suite de tirage ind√©pendants de mots dont la probabilit√© ne d√©pend que de l‚Äôauteur.</p>
<p>Comme cela est expliqu√© dans la boite d√©di√©e, en faisant ces hypoth√®ses, on peut r√©√©crire ce classifieur sous la forme</p>
<p><span class="math display">\[
\widehat{c} = \arg \max_{c \in \mathcal{C}} \mathbb{P}(c)\prod_{w \in \mathcal{W}}{\mathbb{P}(w|c)}
\]</span></p>
<p>avec <span class="math inline">\(\mathcal{W}\)</span> l‚Äôensemble des mots dans le corpus (notre vocabulaire).</p>
<p>Empiriquement, nous sommes dans une t√¢che d‚Äôapprentissage supervis√© o√π le <em>label</em> est la classe du document et les <em>features</em> sont nos mots vectoris√©s. Empiriquement, les probabilit√©s sont estim√©es √† partir du d√©nombrement des mots dans le corpus et des types de documents dans le corpus.</p>
<p>Il est bien-s√ªr possible de calculer toutes ces grandeurs √† la main mais <code>Scikit</code> permet d‚Äôimpl√©menter un estimateur naif de Bayes apr√®s avoir vectoris√© son corpus comme le montre le prochain exercice. Cela peut n√©anmoins poser un probl√®me pratique: en principe, le corpus de test ne doit pas comporter de nouveaux mots car ces ‚Äúnouvelles‚Äù dimensions n‚Äô√©taient pas pr√©sentes dans le corpus d‚Äôentra√Ænement. En pratique, la solution la plus simple est souvent celle choisie: ces mots sont ignor√©s.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 2: le classifieur naif de Bayes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>En repartant de l‚Äôexemple pr√©c√©dent, d√©finir un <em>pipeline</em> qui vectorise chaque document (utiliser <code>CountVectorizer</code> plut√¥t que <code>TFIDFVectorizer</code>) et effectue une pr√©diction gr√¢ce √† un mod√®le naif de Bayes.</li>
<li>Entra√Æner ce mod√®le, faire une pr√©diction sur le jeu de test.</li>
<li>Evaluer la performance de votre mod√®le</li>
<li>Faire une pr√©diction sur la phrase que nous avons utilis√©e tout √† l‚Äôheure dans la variable <code>text</code>. Obtenez-vous ce qui √©tait attendu ?</li>
<li>Regarder les probabilit√©s obtenues (m√©thode <code>predict_proba</code>).</li>
</ol>
</div>
</div>
</div>
<div id="62830d8e" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="62830d8e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="62830d8e-1"><a href="#62830d8e-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="62830d8e-2"><a href="#62830d8e-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB</span>
<span id="62830d8e-3"><a href="#62830d8e-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="62830d8e-4"><a href="#62830d8e-4" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline(</span>
<span id="62830d8e-5"><a href="#62830d8e-5" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"vectorizer"</span>, CountVectorizer()), (<span class="st">"classifier"</span>, MultinomialNB())]</span>
<span id="62830d8e-6"><a href="#62830d8e-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="62830d8e-7"><a href="#62830d8e-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="62830d8e-8"><a href="#62830d8e-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the pipeline on the training data</span></span>
<span id="62830d8e-9"><a href="#62830d8e-9" aria-hidden="true" tabindex="-1"></a>pipeline.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<style>#sk-container-id-3 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-3 {
  color: var(--sklearn-color-text);
}

#sk-container-id-3 pre {
  padding: 0;
}

#sk-container-id-3 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-3 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-3 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-3 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-3 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-3 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-3 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-3 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-3 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-3 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-3 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-3 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-3 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-3 div.sk-label label.sk-toggleable__label,
#sk-container-id-3 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-3 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-3 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-3 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-3 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-3 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-3 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-3 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-3 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-3 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('vectorizer', CountVectorizer()),
                ('classifier', MultinomialNB())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('vectorizer', CountVectorizer()),
                ('classifier', MultinomialNB())])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;CountVectorizer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">?<span>Documentation for CountVectorizer</span></a></label><div class="sk-toggleable__content fitted"><pre>CountVectorizer()</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;MultinomialNB<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.naive_bayes.MultinomialNB.html">?<span>Documentation for MultinomialNB</span></a></label><div class="sk-toggleable__content fitted"><pre>MultinomialNB()</pre></div> </div></div></div></div></div></div>
</div>
</div>
<p>On obtient une pr√©cision satisfaisante:</p>
<div id="e7b6938a" class="cell" data-execution_count="27">
<div class="cell-output cell-output-stdout">
<pre><code>Pr√©cision: 0.8429519918283963</code></pre>
</div>
</div>
<p>Les performances d√©compos√©es sont les suivantes:</p>
<div id="11839429" class="cell" data-execution_count="28">
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

         EAP       0.85      0.85      0.85      1580
         HPL       0.87      0.82      0.84      1127
         MWS       0.81      0.86      0.83      1209

    accuracy                           0.84      3916
   macro avg       0.84      0.84      0.84      3916
weighted avg       0.84      0.84      0.84      3916
</code></pre>
</div>
</div>
<p>Sans surprise, on obtient bien la pr√©diction de Mary Shelley:</p>
<div id="74dfcf02" class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>'MWS'</code></pre>
</div>
</div>
<p>Finalement, si on regarde les probabilit√©s estim√©es (question 5), on se rend compte que la pr√©diction est tr√®s certaine:</p>
<div id="472fe2d8" class="cell" data-execution_count="30">
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">proba</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EAP</td>
<td>0.001675</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>HPL</td>
<td>0.084844</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MWS</td>
<td>0.913481</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comprendre la logique du classifieur naif de Bayes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Supposons que nous sommes dans un probl√®me de classification avec des classes $(c_1,‚Ä¶,c_K) (ensemble not√© <span class="math inline">\(\mathcal{C}\)</span>). Nous pla√ßant dans le cadre de pens√©e du sac de mot, nous pouvons ne pas nous pr√©occuper des positions des mots dans les documents, qui complexifieraient beaucoup l‚Äô√©criture de nos √©quations.</p>
<p>L‚Äô√©quation <a href="#eq-rewriting-bayes" class="quarto-xref">Equation&nbsp;3.2</a> peut √™tre r√©√©crite</p>
<p><span class="math display">\[
\widehat{c} = \arg \max_{c \in \mathcal{C}} \mathbb{P}(w_1, ..., w_n|c)\mathbb{P}(c)
\]</span></p>
<p>Dans le monde bay√©sien, on nomme <span class="math inline">\(\mathbb{P}(w_1, ..., w_n|c)\)</span> la vraisemblance (<em>likelihood</em>) et <span class="math inline">\(\mathbb{P}(c)\)</span> l‚Äô<em>a priori</em> (<em>prior</em>).</p>
<p>L‚Äôhypoth√®se Bayes naive permet de traiter un document comme une suite de tirages al√©atoires dont les probabilit√©s ne d√©pendent que de la cat√©gorie. Dans ce cas, le tirage d‚Äôune phrase est une suite de tirages de mots et la probabilit√© compos√©e est donc</p>
<p><span class="math display">\[
\mathbb{P}(w_1, ..., w_n|c) = \prod_{i=1}^n \mathbb{P}(w_i|c)
\]</span></p>
<p>Par exemple, en simplifiant en deux classes, si les probabilit√©s sont celles du <a href="#tbl-fake-proba" class="quarto-xref">Table&nbsp;3.1</a>, la phrase <em>‚Äúafraid by Doctor Frankenstein‚Äù</em> aura un peu moins de 1% de chance (0.8%) d‚Äô√™tre √©crite si l‚Äôautrice est Mary Shelley mais sera encore moins vraisemblable chez Lovecraft (0.006%) car si <em>‚Äúafraid‚Äù</em> est tr√®s probable chez lui, Frankenstein est un √©v√©nement rare qui rend peu vraisemblable cette composition de mots.</p>
<div id="tbl-fake-proba" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fake-proba-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Exemple fictif de probabilit√©s de tirage
</figcaption>
<div aria-describedby="tbl-fake-proba-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 29%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Mot (<span class="math inline">\(w_i\)</span>)</th>
<th>Probabilit√© chez Mary Shelley</th>
<th>Probabilit√© chez Lovecraft</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Afraid</td>
<td>0.1</td>
<td>0.6</td>
</tr>
<tr class="even">
<td>By</td>
<td>0.2</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td>Doctor</td>
<td>0.2</td>
<td>0.05</td>
</tr>
<tr class="even">
<td>Frankenstein</td>
<td>0.2</td>
<td>0.01</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>En composant ces diff√©rentes √©quations, on obtient</p>
<p><span class="math display">\[
\widehat{c} = \arg \max_{c \in \mathcal{C}} \mathbb{P}(c)\prod_{w \in \mathcal{W}}{\mathbb{P}(w|c)}
\]</span></p>
<p>La contrepartie empirique de <span class="math inline">\(\mathbb{P}(c)\)</span> est assez √©vidente: la fr√©quence observ√©e de chaque cat√©gorie (les auteurs) dans notre corpus. Autrement dit,</p>
<p><span class="math display">\[
\widehat{\mathbb{P}(c)} = \frac{n_c}{n_{doc}}
\]</span></p>
<p>Quelle est la contrepartie empirique de <span class="math inline">\(\mathbb{P}(w_i|c)\)</span> ? C‚Äôest la fr√©quence d‚Äôapparition du mot en question chez l‚Äôauteur. Pour le calculer, il suffit de compter le nombre de fois qu‚Äôil appara√Æt chez l‚Äôauteur et de diviser par le nombre de mots de l‚Äôauteur.</p>
</div>
</div>
</div>
</section>
</section>
<section id="le-mod√®le-word2vec-une-repr√©sentation-plus-synth√©tique" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Le mod√®le Word2Vec, une repr√©sentation plus synth√©tique</h1>
<section id="vers-une-repr√©sentation-plus-synth√©tique-du-langage" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="vers-une-repr√©sentation-plus-synth√©tique-du-langage"><span class="header-section-number">4.1</span> Vers une repr√©sentation plus synth√©tique du langage</h2>
<p>La repr√©sentation vectorielle issue de l‚Äôapproche <em>bag of words</em> n‚Äôest pas tr√®s synth√©tique ni stable et surtout est assez frustre.</p>
<p>Si on a un petit corpus, on va avoir des probl√®mes √† extrapoler puisque de nouveaux textes ont toutes les chances d‚Äôapporter de nouveaux mots, qui sont de nouvelles dimensions de <em>features</em> qui n‚Äô√©taient pas pr√©sentes dans le corpus d‚Äôentra√Ænement, ce qui conceptuellement est un probl√®me puisque les algorithmes de <em>machine learning</em> n‚Äôont pas vocation √† pr√©dire sur des caract√©ristiques sur lesquelles ils n‚Äôont pas √©t√© entra√Æn√©<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>A l‚Äôinverse, plus on a de texte dans un corpus, plus notre repr√©sentation vectorielle sera importante. Par exemple, si votre sac de mot a vu tout le vocabulaire fran√ßais, soit 60 000 mots selon l‚Äô<a href="https://www.dictionnaire-academie.fr/article/QDL056">Acad√©mie Fran√ßaise</a> (les estimations √©tant de 200 000 pour la langue anglaise), cela fait des vecteurs de taille cons√©quente. Cependant, la diversit√© des textes est, en pratique, bien moindre: l‚Äôusage courant du Fran√ßais n√©cessite plut√¥t autour de 3000 mots et la plupart des textes, notamment s‚Äôils sont courts, n‚Äôutilisent pas un vocabulaire si complet. Ceci implique donc des vecteurs tr√®s peu denses, avec beaucoup de 0.</p>
<p>La vectorisation selon cette approche est donc peu efficace; le signal est peu compress√©. Des repr√©sentations denses, c‚Äôest-√†-dire de dimension plus faible mais portant toutes une information, semblent plus ad√©quate pour pouvoir g√©n√©raliser notre mod√©lisation du langage.
L‚Äôalgorithme qui a rendu c√©l√®bre cette approche est le mod√®le <code>Word2Vec</code>, en quelques sortes le premier anc√™tre commun des LLM modernes. La repr√©sentation vectorielle de <code>Word2Vec</code> est assez synth√©tique: la dimension de ces <em>embeddings</em> est entre 100 et 300.</p>
</section>
<section id="des-relations-s√©mantique-entre-les-termes" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="des-relations-s√©mantique-entre-les-termes"><span class="header-section-number">4.2</span> Des relations s√©mantique entre les termes</h2>
<p>Cette repr√©sentation dense va repr√©senter une solution √† une limite de l‚Äôapproche <em>bag of words</em> que nous avons √©voqu√©e √† de multiples reprises. Chacune de ces dimensions va repr√©senter un facteur latent,
c‚Äôest √† dire une variable inobserv√©e,
de la m√™me mani√®re que les composantes principales produites par une ACP. Ces dimensions latentes peuvent √™tre interpr√©t√©es comme des dimensions ‚Äúfondamentales‚Äù du langage</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://jalammar.github.io/images/word2vec/word2vec.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Illustration du principe de la repr√©sentation de Word2Vec (source: Jay Alammar)"><img src="https://jalammar.github.io/images/word2vec/word2vec.png" class="img-fluid figure-img" alt="Illustration du principe de la repr√©sentation de Word2Vec (source: Jay Alammar)"></a></p>
<figcaption>Illustration du principe de la repr√©sentation de Word2Vec (source: <a href="https://jalammar.github.io/illustrated-word2vec/">Jay Alammar</a>)</figcaption>
</figure>
</div>
<p>Par exemple, un humain sait qu‚Äôun document contenant le mot <em>‚ÄúRoi‚Äù</em>
et un autre document contenant le mot <em>‚ÄúReine‚Äù</em> ont beaucoup de chance
d‚Äôaborder des sujets semblables. Un mod√®le <code>Word2Vec</code> bien entra√Æn√© va capter
qu‚Äôil existe un facteur latent de type <em>‚Äúroyaut√©‚Äù</em>
et la similarit√© entre les vecteurs associ√©s aux deux mots sera forte.</p>
<p>La magie va m√™me plus loin : le mod√®le captera aussi qu‚Äôil existe un
facteur latent de type <em>‚Äúgenre‚Äù</em>,
et va permettre de construire un espace s√©mantique dans lequel les
relations arithm√©tiques entre vecteurs ont du sens. Par exemple,</p>
<p><span class="math display">\[
\text{king} - \text{man} + \text{woman} ‚âà \text{queen}
\]</span></p>
<p>ou, pour reprendre, l‚Äôexemple issu du papier originel <code>Word2Vec</code> <span class="citation" data-cites="mikolov2013efficient">(<a href="#ref-mikolov2013efficient" role="doc-biblioref">Mikolov 2013</a>)</span>,</p>
<p><span class="math display">\[
\text{Paris} - \text{France} + \text{Italy} ‚âà \text{Rome}
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://ssphub.netlify.app/post/embedding/word_embedding.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Illustration du plongement lexical. Source : Post de blog Word Embedding : Basics"><img src="https://ssphub.netlify.app/post/embedding/word_embedding.png" class="img-fluid figure-img" alt="Illustration du plongement lexical. Source : Post de blog Word Embedding : Basics"></a></p>
<figcaption>Illustration du plongement lexical. Source : Post de blog <a href="https://medium.com/@hari4om/word-embedding-d816f643140">Word Embedding : Basics</a></figcaption>
</figure>
</div>
<p>Un autre ‚Äúmiracle‚Äù de cette approche est qu‚Äôon obtient une forme de transfert entre les langues. Les relations s√©mantiques pouvant √™tre similaires entre les langues, pour de nombreux mots usuels, on peut voir translater certaines langues les unes avec les autres si elles ont un socle commun (par exemple les langues occidentales). Ce concept est le point de d√©part des traducteurs automatiques et des IA multilingues</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://engineering.fb.com/wp-content/uploads/2018/01/GJ_9lgFMnVaR0ZYAAAAAAABV9MkQbj0JAAAC.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Exemple de translation entre deux repr√©sentations vectorielles. Source: Meta"><img src="https://engineering.fb.com/wp-content/uploads/2018/01/GJ_9lgFMnVaR0ZYAAAAAAABV9MkQbj0JAAAC.gif" class="img-fluid figure-img" alt="Exemple de translation entre deux repr√©sentations vectorielles. Source: Meta"></a></p>
<figcaption>Exemple de translation entre deux repr√©sentations vectorielles. Source: <a href="https://engineering.fb.com/2018/01/24/ml-applications/under-the-hood-multilingual-embeddings/">Meta</a></figcaption>
</figure>
</div>
</section>
<section id="comment-ces-mod√®les-sont-ils-entra√Æn√©s" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="comment-ces-mod√®les-sont-ils-entra√Æn√©s"><span class="header-section-number">4.3</span> Comment ces mod√®les sont-ils entra√Æn√©s ?</h2>
<p>Ces mod√®les sont entra√Æn√©s √† partir d‚Äôune t√¢che de pr√©diction r√©solue par un r√©seau de neurones simple, g√©n√©ralement avec une approche par renforcement.</p>
<p>L‚Äôid√©e fondamentale est que la signification d‚Äôun mot se comprend en regardant les mots qui apparaissent fr√©quemment dans son voisinage. Pour un mot donn√©, on va donc essayer de pr√©dire les mots qui apparaissent dans une fen√™tre autour du mot cible.</p>
<p>En r√©p√©tant cette t√¢che de nombreuses fois et sur un corpus suffisamment vari√©,
on obtient finalement des <em>embeddings</em> pour chaque mot du vocabulaire,
qui pr√©sentent les propri√©t√©s discut√©es pr√©c√©demment. L‚Äôensemble des articles <code>Wikipedia</code> est un des corpus de pr√©dilection des personnes ayant construit des plongements
lexicaux. Il comporte en effet des phrases compl√®tes, contrairement √† des informations issues de commentaires de r√©seaux sociaux,
et propose des rapprochements int√©ressants entre des personnes, des lieux, etc.</p>
<p>Le contexte d‚Äôun mot est d√©fini par une fen√™tre de taille fixe autour de ce mot. La taille de la fen√™tre est un param√®tre de la construction de l‚Äô<em>embedding</em>. Le corpus fournit un grand ensemble d‚Äôexemples mots-contexte, qui peuvent servir √† entra√Æner un r√©seau de neurones.</p>
<p>Plus pr√©cis√©ment, il existe deux approches, dont nous ne d√©velopperons pas les d√©tails :</p>
<ul>
<li><em>Continuous bag of words</em> (CBOW), o√π le mod√®le est entra√Æn√© √† pr√©dire un mot √† partir de son contexte ;</li>
<li><em>Skip-gram</em>, o√π le mod√®le tente de pr√©dire le contexte √† partir d‚Äôun seul mot.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://ssphub.netlify.app/post/embedding/CBOW_Skipgram_training.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Illustration de la diff√©rence entre les approches CBOW et Skip-gram"><img src="https://ssphub.netlify.app/post/embedding/CBOW_Skipgram_training.png" class="img-fluid figure-img" alt="Illustration de la diff√©rence entre les approches CBOW et Skip-gram"></a></p>
<figcaption>Illustration de la diff√©rence entre les approches CBOW et Skip-gram</figcaption>
</figure>
</div>
</section>
<section id="mod√®les-li√©s" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="mod√®les-li√©s"><span class="header-section-number">4.4</span> Mod√®les li√©s</h2>
<p>Plusieurs mod√®les ont une filiation directe avec le mod√®le <code>Word2Vec</code> quoiqu‚Äôils s‚Äôen distinguent par la nature de l‚Äôarchitecture utilis√©e.</p>
<p>C‚Äôest le cas, par exemple, du mod√®le mod√®le <a href="https://nlp.stanford.edu/projects/glove/"><code>GloVe</code></a>, d√©velopp√© en 2014 √† Stanford,
qui ne repose pas sur des r√©seaux de neurones mais sur la construction d‚Äôune grande matrice de co-occurrences de mots. Pour chaque mot, il s‚Äôagit de calculer les fr√©quences d‚Äôapparition des autres mots dans une fen√™tre de taille fixe autour de lui. La matrice de co-occurrences obtenue est ensuite factoris√©e par une d√©composition en valeurs singuli√®res.</p>
<p>Le mod√®le <a href="https://fasttext.cc/"><code>FastText</code></a>, d√©velopp√© en 2016 par une √©quipe de <code>Facebook</code>, fonctionne de fa√ßon similaire √† <code>Word2Vec</code> mais se distingue particuli√®rement sur deux points :</p>
<ul>
<li>En plus des mots eux-m√™mes, le mod√®le apprend des repr√©sentations pour les n-grams de caract√®res (sous-s√©quences de caract√®res de taille <span class="math inline">\(n\)</span>, par exemple <em>¬´ tar ¬ª</em>, <em>¬´ art ¬ª</em> et <em>¬´ rte ¬ª</em> sont les trigrammes du mot <em>¬´ tarte ¬ª</em>), ce qui le rend notamment robuste aux variations d‚Äôorthographe ;</li>
<li>Le mod√®le a √©t√© optimis√© pour que son entra√Ænement soit particuli√®rement rapide.</li>
</ul>
<p>Le mod√®le <a href="https://fasttext.cc/"><code>FastText</code></a> est particuli√®rement performant pour les probl√©matiques de classification automatique. L‚ÄôInsee l‚Äôutilise par exemple pour plusieurs mod√®les de classification de libell√©s textuels dans des nomenclatures.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://ssphub.netlify.app/post/embedding/fasttext.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Illustration du mod√®le fastText"><img src="https://ssphub.netlify.app/post/embedding/fasttext.png" class="img-fluid figure-img" alt="Illustration du mod√®le fastText"></a></p>
<figcaption>Illustration du mod√®le fastText</figcaption>
</figure>
</div>
<p>Voici un exemple sur un projet de classification automatis√©e des professions dans la typologie
des nomenclatures d‚Äôactivit√©s (les PCS) √† partir d‚Äôun mod√®le entra√Æn√© par la librairie <code>Fasttext</code> :</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="694" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 693;"><span id="cb9-694"><a href="#cb9-694" aria-hidden="true" tabindex="-1"></a>viewof activite <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>( </span>
<span id="cb9-695"><a href="#cb9-695" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">label</span><span class="op">:</span> <span class="st">''</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">'data scientist'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">800</span>}</span>
<span id="cb9-696"><a href="#cb9-696" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="702" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 701;"><span id="cb10-702"><a href="#cb10-702" aria-hidden="true" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">json</span>(urlApe)<span class="op">.</span><span class="fu">then</span>(res <span class="kw">=&gt;</span> {</span>
<span id="cb10-703"><a href="#cb10-703" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> IC<span class="op">,</span> results<span class="op">;</span></span>
<span id="cb10-704"><a href="#cb10-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-705"><a href="#cb10-705" aria-hidden="true" tabindex="-1"></a>  ({ IC<span class="op">,</span> <span class="op">...</span>results } <span class="op">=</span> res)<span class="op">;</span></span>
<span id="cb10-706"><a href="#cb10-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-707"><a href="#cb10-707" aria-hidden="true" tabindex="-1"></a>  IC <span class="op">=</span> <span class="pp">parseFloat</span>(IC)<span class="op">;</span></span>
<span id="cb10-708"><a href="#cb10-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-709"><a href="#cb10-709" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> rows <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(results)<span class="op">.</span><span class="fu">map</span>(obj <span class="kw">=&gt;</span> {</span>
<span id="cb10-710"><a href="#cb10-710" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`</span></span>
<span id="cb10-711"><a href="#cb10-711" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;tr&gt;</span></span>
<span id="cb10-712"><a href="#cb10-712" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>obj<span class="op">.</span><span class="at">code</span><span class="sc">}</span><span class="vs"> | </span><span class="sc">${</span>obj<span class="op">.</span><span class="at">libelle</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb10-713"><a href="#cb10-713" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>obj<span class="op">.</span><span class="at">probabilite</span><span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb10-714"><a href="#cb10-714" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/tr&gt;</span></span>
<span id="cb10-715"><a href="#cb10-715" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb10-716"><a href="#cb10-716" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">join</span>(<span class="st">''</span>)<span class="op">;</span></span>
<span id="cb10-717"><a href="#cb10-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-718"><a href="#cb10-718" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> confidenceRow <span class="op">=</span> <span class="vs">`&lt;tr&gt;</span></span>
<span id="cb10-719"><a href="#cb10-719" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="text-align:left; "&gt;&lt;em&gt;Indice de confiance : </span><span class="sc">${</span>IC<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs">&lt;/em&gt;&lt;/td&gt;</span></span>
<span id="cb10-720"><a href="#cb10-720" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;`</span><span class="op">;</span></span>
<span id="cb10-721"><a href="#cb10-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-722"><a href="#cb10-722" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tableHTML <span class="op">=</span> <span class="fu">html</span><span class="vs">`</span></span>
<span id="cb10-723"><a href="#cb10-723" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;table&gt;</span></span>
<span id="cb10-724"><a href="#cb10-724" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;caption&gt;</span></span>
<span id="cb10-725"><a href="#cb10-725" aria-hidden="true" tabindex="-1"></a><span class="vs">      Pr√©diction de l'activit√©</span></span>
<span id="cb10-726"><a href="#cb10-726" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/caption&gt;</span></span>
<span id="cb10-727"><a href="#cb10-727" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;tr&gt;</span></span>
<span id="cb10-728"><a href="#cb10-728" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;th style="text-align:center;"&gt;Libell√© (NA2008)&lt;/th&gt;</span></span>
<span id="cb10-729"><a href="#cb10-729" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;th&gt;Probabilit√©&lt;/th&gt;</span></span>
<span id="cb10-730"><a href="#cb10-730" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/tr&gt;</span></span>
<span id="cb10-731"><a href="#cb10-731" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>rows<span class="sc">}</span></span>
<span id="cb10-732"><a href="#cb10-732" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>confidenceRow<span class="sc">}</span></span>
<span id="cb10-733"><a href="#cb10-733" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/table&gt;`</span><span class="op">;</span></span>
<span id="cb10-734"><a href="#cb10-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-735"><a href="#cb10-735" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Now you can use the tableHTML as needed, for example, inserting it into the DOM.</span></span>
<span id="cb10-736"><a href="#cb10-736" aria-hidden="true" tabindex="-1"></a>  <span class="co">// For example, assuming you have a container with the id "tableContainer":</span></span>
<span id="cb10-737"><a href="#cb10-737" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> tableHTML<span class="op">;</span></span>
<span id="cb10-738"><a href="#cb10-738" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="744" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 743;"><span id="cb11-744"><a href="#cb11-744" aria-hidden="true" tabindex="-1"></a>activite_debounce <span class="op">=</span> <span class="fu">debounce</span>(viewof activite<span class="op">,</span> <span class="dv">2000</span>)</span>
<span id="cb11-745"><a href="#cb11-745" aria-hidden="true" tabindex="-1"></a>urlApe <span class="op">=</span> <span class="vs">`https://codification-ape-test.lab.sspcloud.fr/predict?nb_echos_max=3&amp;prob_min=0&amp;text_feature=</span><span class="sc">${</span>activite_debounce<span class="sc">}</span><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="749" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 748;"><span id="cb12-749"><a href="#cb12-749" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {debounce} <span class="im">from</span> <span class="st">"@mbostock/debouncing-input"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<p>Ces mod√®les sont h√©ritiers de <code>Word2Vec</code> dans le sens o√π ils reprennent une repr√©sentation vectorielle dense de faible dimension de documents textuels. <code>Word2Vec</code> reste un mod√®le h√©ritier de la logique sac de mot. La repr√©sentation d‚Äôune phrase ou d‚Äôun document est une forme de moyenne des repr√©sentations des mots qui les composent.</p>
<p>Depuis 2013, plusieurs r√©volutions ont amen√© √† enrichir les mod√®les de langage pour aller au-del√† d‚Äôune repr√©sentation par mot de ceux-ci. Des architectures beaucoup plus complexes pour repr√©senter non seulement les mots sous forme d‚Äô<em>embeddings</em> mais aussi les phrases et les documents sont aujourd‚Äôhui √† l‚Äôoeuvre et peuvent √™tre reli√©es √† la r√©volution des architectures <em>transformers</em>.</p>
</section>
</section>
<section id="les-transformers-une-repr√©sentation-plus-riche-du-langage" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Les <em>transformers</em>: une repr√©sentation plus riche du langage</h1>
<p>Si le mod√®le <code>Word2Vec</code> est entra√Æn√© de mani√®re contextuelle, sa vocation est de donner une repr√©sentation vectorielle d‚Äôun mot de mani√®re absolue, ind√©pendamment du contexte. Par exemple, le terme <em>‚Äúbanc‚Äù</em> aura exactement la m√™me repr√©sentation vectorielle qu‚Äôil se trouve dans la phrase <em>‚ÄúElle court vers le banc de sable‚Äù</em> ou ‚ÄúIl t‚Äôattend sur un banc au parc‚Äù_. C‚Äôest une limite majeure de ce type d‚Äôapproche et on se doute bien de l‚Äôimportance du contexte pour l‚Äôinterpr√©tation du langage.</p>
<p>L‚Äôobjectif des architectures <em>transformers</em> est de permettre des repr√©sentations vectorielles contextuelles. Autrement dit, un mot aura plusieurs repr√©sentations vectorielles, selon son contexte d‚Äôoccurrence. Ces mod√®les s‚Äôappuient sur le m√©canisme d‚Äôattention <span class="citation" data-cites="vaswani2017attention">(<a href="#ref-vaswani2017attention" role="doc-biblioref">Vaswani 2017</a>)</span>. Avant cette approche, lorsqu‚Äôun mod√®le apprenait √† vectoriser un texte et qu‚Äôil arrivait au √©ni√®me mot, la seule m√©moire qu‚Äôil gardait √©tait celle du mot pr√©c√©dent. Par r√©currence, cela signifiait qu‚Äôil gardait une m√©moire des mots pr√©c√©dents mais celle-ci tendait √† se dissiper. Par cons√©quent, pour un mot arrivant loin dans la phrase, il √©tait probable que le contexte de d√©but de phrase √©tait oubli√©. Autrement dit, dans la phrase <em>‚Äú√† la plage, il allait explorer le banc‚Äù</em>, il √©tait fort probable qu‚Äôarriv√© au mot <em>‚Äúbanc‚Äù</em>, le mod√®le ait oubli√© le d√©but de phrase qui avait pourtant de l‚Äôimportance pour l‚Äôinterpr√©tation.</p>
<p>L‚Äôobjectif du m√©canisme d‚Äôattention est de cr√©er une m√©moire interne au mod√®le permettant, pour tout mot d‚Äôun texte, de pouvoir garder trace des autres mots. Bien-s√ªr tous ne sont pas pertinents pour interpr√©ter le texte mais cela √©vite d‚Äôoublier ceux qui sont importants. L‚Äôinnovation principale des derni√®res ann√©es en NLP a √©t√© de parvenir √† cr√©er des m√©canismes d‚Äôattention √† grande √©chelle sans pour autant rendre intractables les mod√®les. Les fen√™tres de contexte des mod√®les les plus performants deviennent immenses. Par exemple le mod√®le Llama 3.1 (rendu public par Meta en Juillet 2024) propose une fen√™tre de contexte de 128 000 <em>tokens</em>, soit environ 96 000 mots, l‚Äô√©quivalent du <em>Hobbit</em> de Tolkien. Autrement dit, pour d√©duire la subtilit√© du sens d‚Äôun mot, ce mod√®le peut parcourir un contexte aussi long qu‚Äôun roman d‚Äôenviron 300 pages.</p>
<p>Les deux mod√®les qui ont marqu√© leur √©poque dans le domaine sont les mod√®les <code>BERT</code> d√©velopp√© en 2018 par <em>Google</em> (qui √©tait d√©j√† √† l‚Äôorigine de <code>Word2Vec</code>) et la premi√®re version du bien-connu <code>GPT</code> d‚Äô<code>OpenAI</code>, qui, en 2017, √©tait le premier mod√®le pr√©entrain√© bas√© sur l‚Äôarchitecture <em>transformer</em>. Ces deux familles de <em>transformer</em> diff√®rent dans la mani√®re dont ils int√®grent le contexte pour faire une pr√©diction. <code>GPT</code> est un mod√®le autor√©gressif, donc ne consid√®re que les <em>tokens</em> avant celui dont on d√©sire faire une pr√©diction. <code>BERT</code> utilise les <em>tokens</em> √† gauche et √† droite pour inf√©rer le contexte. Ces deux grands mod√®les de langage entra√Æn√©s sont entra√Æn√©s par auto-renforcement, principalement sur des t√¢ches de pr√©diction du prochain <em>token</em> <span class="citation" data-cites="huggingfacecourse">(<a href="#ref-huggingfacecourse" role="doc-biblioref">Face 2022</a>)</span>. Depuis le succ√®s de <code>ChatGPT</code>, les nouveaux mod√®les GPT (√† partir de la version 3) ne sont plus <em>open source</em>. Pour les utiliser, il faut donc passer par les API d‚ÄôOpenAI. Il existe n√©anmoins de nombreuses alternatives dont les poids sont ouverts, √† d√©faut d‚Äô√™tre <em>open source</em><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, qui permettent d‚Äôutiliser ces LLM par le biais de <code>Python</code>, par le biais, notamment, de la librairie <code>transformers</code> d√©velopp√©e par <em>Hugging Face</em>.</p>
<p>Quand on travaille avec des corpus de taille restreinte,
c‚Äôest g√©n√©ralement une mauvaise id√©e d‚Äôentra√Æner son propre mod√®le <em>from scratch</em>. Heureusement, des mod√®les pr√©-entra√Æn√©s sur de tr√®s gros corpus sont disponibles. Ils permettent de r√©aliser du <em>transfer learning</em>, c‚Äôest-√†-dire de b√©n√©ficier de la performance d‚Äôun mod√®le qui a √©t√© entra√Æn√© sur une autre t√¢che ou bien sur un autre corpus.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Refaire un train/test split avec 500 lignes al√©atoires</li>
<li>Importer le mod√®le <code>all-MiniLM-L6-v2</code> avec le package <code>sentence transformers</code>. Encoder <code>X_train</code> et <code>X_test</code></li>
<li>Faire une classification avec une m√©thode simple, par exemple des SVC, s‚Äôappuyant sur les <em>embeddings</em> produits √† la question pr√©c√©dente. Comme le jeu d‚Äôentra√Ænement est r√©duit, vous pouvez faire de la validation crois√©e.</li>
<li>Comprendre pourquoi les performances sont d√©t√©rior√©es par rapport au classifieur naif de Bayes.</li>
</ol>
</div>
</div>
</div>
<p>R√©ponse √† la question 1:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>random_rows <span class="op">=</span> spooky_df.sample(<span class="dv">500</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> random_rows[<span class="st">"author"</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> random_rows[<span class="st">"text"</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, stratify<span class="op">=</span>y, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>R√©ponse √† la question 2:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> LinearSVC</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SentenceTransformer(<span class="st">"all-MiniLM-L6-v2"</span>, model_kwargs<span class="op">=</span>{<span class="st">"torch_dtype"</span>: <span class="st">"float16"</span>})</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>X_train_vectors <span class="op">=</span> model.encode(X_train.values)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>X_test_vectors <span class="op">=</span> model.encode(X_test.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>R√©ponse √† la question 3:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LinearSVC(max_iter<span class="op">=</span><span class="dv">10000</span>, C<span class="op">=</span><span class="fl">0.1</span>, dual<span class="op">=</span><span class="st">"auto"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> cross_val_score(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    clf, X_train_vectors, y_train, cv<span class="op">=</span><span class="dv">4</span>, scoring<span class="op">=</span><span class="st">"f1_micro"</span>, n_jobs<span class="op">=</span><span class="dv">4</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"CV scores </span><span class="sc">{</span>scores<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean F1 </span><span class="sc">{</span>np<span class="sc">.</span>mean(scores)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Mais pourquoi, avec une m√©thode tr√®s compliqu√©e, ne parvenons-nous pas √† battre une m√©thode toute simple ?</strong></p>
<p>On peut avancer plusieurs raisons :</p>
<ul>
<li>le <code>TF-IDF</code> est un mod√®le simple, mais toujours tr√®s performant
(on parle de <em>‚Äútough-to-beat baseline‚Äù</em>).</li>
<li>la classification d‚Äôauteurs est une t√¢che tr√®s particuli√®re et tr√®s ardue,
qui ne fait pas justice aux <em>embeddings</em>. Comme on l‚Äôa dit pr√©c√©demment, ces derniers se r√©v√®lent particuli√®rement pertinents lorsqu‚Äôil est question de similarit√© s√©mantique entre des textes (<em>clustering</em>, etc.).</li>
</ul>
<p>Dans le cas de notre t√¢che de classification, il est probable que
certains mots (noms de personnage, noms de lieux) soient suffisants pour classifier de mani√®re pertinente,
ce que ne permettent pas de capter les <em>embeddings</em> qui accordent √† tous les mots la m√™me importance.</p>
<section id="informations-additionnelles" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="informations-additionnelles">Informations additionnelles</h2>
<details>
<summary>
<p><i class="fa-brands fa-python" aria-label="python"></i> environment files have been tested on.</p>
</summary>
<p>Latest built version: 2024-12-26</p>
<p>Python version used:</p>
<div id="1238e957" class="cell" data-execution_count="33">
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>'3.12.6 | packaged by conda-forge | (main, Sep 30 2024, 18:08:52) [GCC 13.3.0]'</code></pre>
</div>
</div>
<div class="git-details">
<div class="pip-freeze">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">affine</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiobotocore</td>
<td style="text-align: left;">2.15.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiohappyeyeballs</td>
<td style="text-align: left;">2.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiohttp</td>
<td style="text-align: left;">3.10.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aioitertools</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiosignal</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alembic</td>
<td style="text-align: left;">1.13.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">altair</td>
<td style="text-align: left;">5.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aniso8601</td>
<td style="text-align: left;">9.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">annotated-types</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">anyio</td>
<td style="text-align: left;">4.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">appdirs</td>
<td style="text-align: left;">1.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">archspec</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attrs</td>
<td style="text-align: left;">24.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">babel</td>
<td style="text-align: left;">2.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bcrypt</td>
<td style="text-align: left;">4.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">beautifulsoup4</td>
<td style="text-align: left;">4.12.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">black</td>
<td style="text-align: left;">24.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blinker</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blis</td>
<td style="text-align: left;">0.7.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">bokeh</td>
<td style="text-align: left;">3.5.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">boltons</td>
<td style="text-align: left;">24.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">boto3</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">botocore</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">branca</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brotli</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cachetools</td>
<td style="text-align: left;">5.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cartiflette</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cartopy</td>
<td style="text-align: left;">0.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">catalogue</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cattrs</td>
<td style="text-align: left;">24.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">certifi</td>
<td style="text-align: left;">2024.8.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cffi</td>
<td style="text-align: left;">1.17.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chromedriver-autoinstaller</td>
<td style="text-align: left;">0.6.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">click</td>
<td style="text-align: left;">8.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">click-plugins</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cligj</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloudpathlib</td>
<td style="text-align: left;">0.20.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">colorama</td>
<td style="text-align: left;">0.4.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">comm</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">commonmark</td>
<td style="text-align: left;">0.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda</td>
<td style="text-align: left;">24.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda-libmamba-solver</td>
<td style="text-align: left;">24.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda-package-handling</td>
<td style="text-align: left;">2.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda_package_streaming</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">confection</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contextily</td>
<td style="text-align: left;">1.6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">contourpy</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cryptography</td>
<td style="text-align: left;">43.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cycler</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cymem</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">cytoolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dask</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">dask-expr</td>
<td style="text-align: left;">1.1.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">databricks-sdk</td>
<td style="text-align: left;">0.33.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dataclasses-json</td>
<td style="text-align: left;">0.6.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">debugpy</td>
<td style="text-align: left;">1.8.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">decorator</td>
<td style="text-align: left;">5.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Deprecated</td>
<td style="text-align: left;">1.2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">diskcache</td>
<td style="text-align: left;">5.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distributed</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">distro</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">docker</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">duckdb</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">en-core-web-sm</td>
<td style="text-align: left;">3.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">entrypoints</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">et_xmlfile</td>
<td style="text-align: left;">2.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">exceptiongroup</td>
<td style="text-align: left;">1.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">executing</td>
<td style="text-align: left;">2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fastexcel</td>
<td style="text-align: left;">0.11.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fastjsonschema</td>
<td style="text-align: left;">2.21.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fiona</td>
<td style="text-align: left;">1.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flask</td>
<td style="text-align: left;">3.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">folium</td>
<td style="text-align: left;">0.17.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fontawesomefree</td>
<td style="text-align: left;">6.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fonttools</td>
<td style="text-align: left;">4.54.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fr-core-news-sm</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">frozendict</td>
<td style="text-align: left;">2.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frozenlist</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gensim</td>
<td style="text-align: left;">4.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">geographiclib</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geopandas</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">geoplot</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geopy</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">gitdb</td>
<td style="text-align: left;">4.0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GitPython</td>
<td style="text-align: left;">3.1.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">google-auth</td>
<td style="text-align: left;">2.35.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphene</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphql-core</td>
<td style="text-align: left;">3.2.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphql-relay</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphviz</td>
<td style="text-align: left;">0.20.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">great-tables</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">greenlet</td>
<td style="text-align: left;">3.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gunicorn</td>
<td style="text-align: left;">22.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">h11</td>
<td style="text-align: left;">0.14.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">h2</td>
<td style="text-align: left;">4.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">hpack</td>
<td style="text-align: left;">4.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">0.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">httpcore</td>
<td style="text-align: left;">1.0.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">httpx</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">httpx-sse</td>
<td style="text-align: left;">0.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hyperframe</td>
<td style="text-align: left;">6.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">idna</td>
<td style="text-align: left;">3.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">imageio</td>
<td style="text-align: left;">2.36.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">importlib_metadata</td>
<td style="text-align: left;">8.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">importlib_resources</td>
<td style="text-align: left;">6.4.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">inflate64</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipykernel</td>
<td style="text-align: left;">6.29.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">ipython</td>
<td style="text-align: left;">8.28.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">itsdangerous</td>
<td style="text-align: left;">2.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jedi</td>
<td style="text-align: left;">0.19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jinja2</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">jmespath</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">joblib</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonpatch</td>
<td style="text-align: left;">1.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonpointer</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonschema</td>
<td style="text-align: left;">4.23.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonschema-specifications</td>
<td style="text-align: left;">2024.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter-cache</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter_client</td>
<td style="text-align: left;">8.6.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter_core</td>
<td style="text-align: left;">5.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kaleido</td>
<td style="text-align: left;">0.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">kiwisolver</td>
<td style="text-align: left;">1.4.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langchain</td>
<td style="text-align: left;">0.3.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">langchain-community</td>
<td style="text-align: left;">0.3.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langchain-core</td>
<td style="text-align: left;">0.3.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">langchain-text-splitters</td>
<td style="text-align: left;">0.3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langcodes</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">langsmith</td>
<td style="text-align: left;">0.1.147</td>
</tr>
<tr class="odd">
<td style="text-align: left;">language_data</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lazy_loader</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">libmambapy</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">locket</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;">5.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lz4</td>
<td style="text-align: left;">4.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">1.3.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">mamba</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mapclassify</td>
<td style="text-align: left;">2.8.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">marisa-trie</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Markdown</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">markdown-it-py</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MarkupSafe</td>
<td style="text-align: left;">2.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">marshmallow</td>
<td style="text-align: left;">3.23.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">matplotlib</td>
<td style="text-align: left;">3.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">matplotlib-inline</td>
<td style="text-align: left;">0.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mdurl</td>
<td style="text-align: left;">0.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">menuinst</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mercantile</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mizani</td>
<td style="text-align: left;">0.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mlflow</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mlflow-skinny</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">msgpack</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">multidict</td>
<td style="text-align: left;">6.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">multivolumefile</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">munkres</td>
<td style="text-align: left;">1.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">murmurhash</td>
<td style="text-align: left;">1.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">mypy-extensions</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">narwhals</td>
<td style="text-align: left;">1.19.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbclient</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nbformat</td>
<td style="text-align: left;">5.10.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">nest_asyncio</td>
<td style="text-align: left;">1.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">networkx</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">nltk</td>
<td style="text-align: left;">3.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numpy</td>
<td style="text-align: left;">1.26.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">opencv-python-headless</td>
<td style="text-align: left;">4.10.0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">openpyxl</td>
<td style="text-align: left;">3.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-api</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">opentelemetry-sdk</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-semantic-conventions</td>
<td style="text-align: left;">0.37b0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">orjson</td>
<td style="text-align: left;">3.10.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome</td>
<td style="text-align: left;">1.3.0.post0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OWSLib</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">packaging</td>
<td style="text-align: left;">24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pandas</td>
<td style="text-align: left;">2.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">paramiko</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parso</td>
<td style="text-align: left;">0.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">partd</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pathspec</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">patsy</td>
<td style="text-align: left;">0.5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pebble</td>
<td style="text-align: left;">5.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pexpect</td>
<td style="text-align: left;">4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pickleshare</td>
<td style="text-align: left;">0.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pillow</td>
<td style="text-align: left;">10.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pip</td>
<td style="text-align: left;">24.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">platformdirs</td>
<td style="text-align: left;">4.3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">5.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotnine</td>
<td style="text-align: left;">0.13.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pluggy</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">polars</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">preshed</td>
<td style="text-align: left;">3.0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">prometheus_client</td>
<td style="text-align: left;">0.21.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prometheus_flask_exporter</td>
<td style="text-align: left;">0.23.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">prompt_toolkit</td>
<td style="text-align: left;">3.0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">protobuf</td>
<td style="text-align: left;">4.25.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">psutil</td>
<td style="text-align: left;">6.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ptyprocess</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pure_eval</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">py7zr</td>
<td style="text-align: left;">0.20.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyarrow</td>
<td style="text-align: left;">17.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyarrow-hotfix</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyasn1</td>
<td style="text-align: left;">0.6.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyasn1_modules</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pybcj</td>
<td style="text-align: left;">1.0.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycosat</td>
<td style="text-align: left;">0.6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycparser</td>
<td style="text-align: left;">2.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycryptodomex</td>
<td style="text-align: left;">3.21.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic</td>
<td style="text-align: left;">2.10.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pydantic_core</td>
<td style="text-align: left;">2.27.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic-settings</td>
<td style="text-align: left;">2.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pygments</td>
<td style="text-align: left;">2.18.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyNaCl</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pynsee</td>
<td style="text-align: left;">0.1.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyogrio</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyOpenSSL</td>
<td style="text-align: left;">24.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyparsing</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyppmd</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyproj</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyshp</td>
<td style="text-align: left;">2.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PySocks</td>
<td style="text-align: left;">1.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-dateutil</td>
<td style="text-align: left;">2.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-dotenv</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-magic</td>
<td style="text-align: left;">0.4.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">pytz</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyu2f</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pywaffle</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PyYAML</td>
<td style="text-align: left;">6.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyzmq</td>
<td style="text-align: left;">26.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyzstd</td>
<td style="text-align: left;">0.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">querystring_parser</td>
<td style="text-align: left;">1.2.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rasterio</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">referencing</td>
<td style="text-align: left;">0.35.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">regex</td>
<td style="text-align: left;">2024.9.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests</td>
<td style="text-align: left;">2.32.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests-cache</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests-toolbelt</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">retrying</td>
<td style="text-align: left;">1.3.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">rich</td>
<td style="text-align: left;">13.9.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rpds-py</td>
<td style="text-align: left;">0.22.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsa</td>
<td style="text-align: left;">4.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rtree</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruamel.yaml</td>
<td style="text-align: left;">0.18.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ruamel.yaml.clib</td>
<td style="text-align: left;">0.2.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">s3fs</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s3transfer</td>
<td style="text-align: left;">0.10.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">scikit-image</td>
<td style="text-align: left;">0.24.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scikit-learn</td>
<td style="text-align: left;">1.5.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">scipy</td>
<td style="text-align: left;">1.13.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">seaborn</td>
<td style="text-align: left;">0.13.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">selenium</td>
<td style="text-align: left;">4.27.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setuptools</td>
<td style="text-align: left;">74.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">shapely</td>
<td style="text-align: left;">2.0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shellingham</td>
<td style="text-align: left;">1.5.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">six</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smart-open</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">smmap</td>
<td style="text-align: left;">5.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sniffio</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">sortedcontainers</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">soupsieve</td>
<td style="text-align: left;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy</td>
<td style="text-align: left;">3.7.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy-legacy</td>
<td style="text-align: left;">3.0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy-loggers</td>
<td style="text-align: left;">1.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SQLAlchemy</td>
<td style="text-align: left;">2.0.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">sqlparse</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">srsly</td>
<td style="text-align: left;">2.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">stack-data</td>
<td style="text-align: left;">0.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">statsmodels</td>
<td style="text-align: left;">0.14.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">tabulate</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tblib</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tenacity</td>
<td style="text-align: left;">9.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">texttable</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">thinc</td>
<td style="text-align: left;">8.2.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">threadpoolctl</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tifffile</td>
<td style="text-align: left;">2024.12.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">toolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">topojson</td>
<td style="text-align: left;">1.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tornado</td>
<td style="text-align: left;">6.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">tqdm</td>
<td style="text-align: left;">4.66.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">traitlets</td>
<td style="text-align: left;">5.14.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">trio</td>
<td style="text-align: left;">0.28.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trio-websocket</td>
<td style="text-align: left;">0.11.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">truststore</td>
<td style="text-align: left;">0.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typer</td>
<td style="text-align: left;">0.15.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">typing_extensions</td>
<td style="text-align: left;">4.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typing-inspect</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tzdata</td>
<td style="text-align: left;">2024.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unidecode</td>
<td style="text-align: left;">1.3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">url-normalize</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urllib3</td>
<td style="text-align: left;">1.26.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">wasabi</td>
<td style="text-align: left;">1.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">weasel</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">webdriver-manager</td>
<td style="text-align: left;">4.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">websocket-client</td>
<td style="text-align: left;">1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Werkzeug</td>
<td style="text-align: left;">3.0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">wheel</td>
<td style="text-align: left;">0.44.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wordcloud</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wsproto</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">xgboost</td>
<td style="text-align: left;">2.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xlrd</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">xyzservices</td>
<td style="text-align: left;">2024.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yarl</td>
<td style="text-align: left;">1.13.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellowbrick</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zict</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zipp</td>
<td style="text-align: left;">3.20.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zstandard</td>
<td style="text-align: left;">0.23.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<details>
<summary>
<p>View file history <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></p>
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="909" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 908;"><span id="cb17-909"><a href="#cb17-909" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Ce fichier a √©t√© modifi√© __</span><span class="sc">${</span>table_commit<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">__ fois depuis sa cr√©ation le </span><span class="sc">${</span>creation_string<span class="sc">}</span><span class="vs"> (derni√®re modification le </span><span class="sc">${</span>last_modification_string<span class="sc">}</span><span class="vs">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="916" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 915;"><span id="cb18-916"><a href="#cb18-916" aria-hidden="true" tabindex="-1"></a>creation <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb18-917"><a href="#cb18-917" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb18-918"><a href="#cb18-918" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-919"><a href="#cb18-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-920"><a href="#cb18-920" aria-hidden="true" tabindex="-1"></a>last_modification <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb18-921"><a href="#cb18-921" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb18-922"><a href="#cb18-922" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-923"><a href="#cb18-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-924"><a href="#cb18-924" aria-hidden="true" tabindex="-1"></a>creation_string <span class="op">=</span> creation<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb18-925"><a href="#cb18-925" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb18-926"><a href="#cb18-926" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb18-927"><a href="#cb18-927" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb18-928"><a href="#cb18-928" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb18-929"><a href="#cb18-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-930"><a href="#cb18-930" aria-hidden="true" tabindex="-1"></a>last_modification_string <span class="op">=</span> last_modification<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb18-931"><a href="#cb18-931" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb18-932"><a href="#cb18-932" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb18-933"><a href="#cb18-933" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb18-934"><a href="#cb18-934" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="940" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 939;"><span id="cb19-940"><a href="#cb19-940" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_table<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="945" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 944;"><span id="cb20-945"><a href="#cb20-945" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_plot<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="expression">

</div>
</div>
</div>
<table class="commit-table" border="1">
<thead>
<tr>
<th>
SHA
</th>
<th>
Date
</th>
<th>
Author
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/24d4ff6">24d4ff6</a>
</td>
<td>
2024-12-09 15:22:19
</td>
<td>
lgaliana
</td>
<td>
ensure non executable block
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3817cdc">3817cdc</a>
</td>
<td>
2024-12-09 13:34:56
</td>
<td>
lgaliana
</td>
<td>
eval false pour le dernier exo
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/8d09742">8d09742</a>
</td>
<td>
2024-12-09 13:34:16
</td>
<td>
lgaliana
</td>
<td>
update embedding
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/441da89">441da89</a>
</td>
<td>
2024-12-08 20:28:21
</td>
<td>
lgaliana
</td>
<td>
Utilise un service pytorch
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/0ec1e15">0ec1e15</a>
</td>
<td>
2024-12-07 15:54:20
</td>
<td>
lgaliana
</td>
<td>
Commence √† d√©crire l‚Äôattention
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/35443b7">35443b7</a>
</td>
<td>
2024-12-07 13:40:34
</td>
<td>
lgaliana
</td>
<td>
Word2Vec
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/89397cf">89397cf</a>
</td>
<td>
2024-12-06 21:50:25
</td>
<td>
lgaliana
</td>
<td>
Preprocessing
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4181dab">4181dab</a>
</td>
<td>
2024-12-06 13:16:36
</td>
<td>
lgaliana
</td>
<td>
Transition
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/38b5152">38b5152</a>
</td>
<td>
2024-12-05 22:21:11
</td>
<td>
lgaliana
</td>
<td>
d√©tails sur l‚Äôapproche proba
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/5df69cc">5df69cc</a>
</td>
<td>
2024-12-05 17:56:47
</td>
<td>
lgaliana
</td>
<td>
up
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/1b7188a">1b7188a</a>
</td>
<td>
2024-12-05 13:21:11
</td>
<td>
lgaliana
</td>
<td>
Embedding chapter
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c641de0">c641de0</a>
</td>
<td>
2024-08-22 11:37:13
</td>
<td>
Lino Galiana
</td>
<td>
A series of fix for notebooks that were bugging (#545)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c5a9fb7">c5a9fb7</a>
</td>
<td>
2024-07-22 09:56:18
</td>
<td>
Julien PRAMIL
</td>
<td>
Fix bug in LDA chapter (#525)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c9f9f8a">c9f9f8a</a>
</td>
<td>
2024-04-24 15:09:35
</td>
<td>
Lino Galiana
</td>
<td>
Dark mode and CSS improvements (#494)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/06d003a">06d003a</a>
</td>
<td>
2024-04-23 10:09:22
</td>
<td>
Lino Galiana
</td>
<td>
Continue la restructuration des sous-parties (#492)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/005d89b">005d89b</a>
</td>
<td>
2023-12-20 17:23:04
</td>
<td>
Lino Galiana
</td>
<td>
Finalise l‚Äôaffichage des statistiques Git (#478)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3437373">3437373</a>
</td>
<td>
2023-12-16 20:11:06
</td>
<td>
Lino Galiana
</td>
<td>
Am√©liore l‚Äôexercice sur le LASSO (#473)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4cd44f3">4cd44f3</a>
</td>
<td>
2023-12-11 17:37:50
</td>
<td>
Antoine Palazzolo
</td>
<td>
Relecture NLP (#474)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/deaafb6">deaafb6</a>
</td>
<td>
2023-12-11 13:44:34
</td>
<td>
Thomas Faria
</td>
<td>
Relecture Thomas partie NLP (#472)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/1f23de2">1f23de2</a>
</td>
<td>
2023-12-01 17:25:36
</td>
<td>
Lino Galiana
</td>
<td>
Stockage des images sur S3 (#466)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/6855667">6855667</a>
</td>
<td>
2023-11-29 10:21:01
</td>
<td>
Romain Avouac
</td>
<td>
Corrections tp vectorisation + improve badge creation (#465)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/69cf52b">69cf52b</a>
</td>
<td>
2023-11-21 16:12:37
</td>
<td>
Antoine Palazzolo
</td>
<td>
[On-going] Suggestions chapitres mod√©lisation (#452)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/652009d">652009d</a>
</td>
<td>
2023-10-09 13:56:34
</td>
<td>
Lino Galiana
</td>
<td>
Finalise le cleaning (#430)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a771183">a771183</a>
</td>
<td>
2023-10-09 11:27:45
</td>
<td>
Antoine Palazzolo
</td>
<td>
Relecture TD2 par Antoine (#418)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/154f09e">154f09e</a>
</td>
<td>
2023-09-26 14:59:11
</td>
<td>
Antoine Palazzolo
</td>
<td>
Des typos corrig√©es par Antoine (#411)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/9a4e226">9a4e226</a>
</td>
<td>
2023-08-28 17:11:52
</td>
<td>
Lino Galiana
</td>
<td>
Action to check URL still exist (#399)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3bdf3b0">3bdf3b0</a>
</td>
<td>
2023-08-25 11:23:02
</td>
<td>
Lino Galiana
</td>
<td>
Simplification de la structure ü§ì (#393)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/78ea2cb">78ea2cb</a>
</td>
<td>
2023-07-20 20:27:31
</td>
<td>
Lino Galiana
</td>
<td>
Change titles levels (#381)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/29ff3f5">29ff3f5</a>
</td>
<td>
2023-07-07 14:17:53
</td>
<td>
linogaliana
</td>
<td>
description everywhere
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f21a24d">f21a24d</a>
</td>
<td>
2023-07-02 10:58:15
</td>
<td>
Lino Galiana
</td>
<td>
Pipeline Quarto &amp; Pages üöÄ (#365)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/b395985">b395985</a>
</td>
<td>
2023-02-13 17:29:36
</td>
<td>
Lino Galiana
</td>
<td>
Retire shortcode spoiler (#352)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f10815b">f10815b</a>
</td>
<td>
2022-08-25 16:00:03
</td>
<td>
Lino Galiana
</td>
<td>
Notebooks should now look more beautiful (#260)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/d201e3c">d201e3c</a>
</td>
<td>
2022-08-03 15:50:34
</td>
<td>
Lino Galiana
</td>
<td>
Pimp la homepage ‚ú® (#249)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/12965ba">12965ba</a>
</td>
<td>
2022-05-25 15:53:27
</td>
<td>
Lino Galiana
</td>
<td>
:launch: Bascule vers quarto (#226)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/9c71d6e">9c71d6e</a>
</td>
<td>
2022-03-08 10:34:26
</td>
<td>
Lino Galiana
</td>
<td>
Plus d‚Äô√©l√©ments sur S3 (#218)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/7058752">7058752</a>
</td>
<td>
2022-03-04 15:35:17
</td>
<td>
Lino Galiana
</td>
<td>
Relecture Word2Vec (#216)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/ce1f2b5">ce1f2b5</a>
</td>
<td>
2022-02-16 13:54:27
</td>
<td>
Lino Galiana
</td>
<td>
spacy corpus pre-downloaded
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/66e2837">66e2837</a>
</td>
<td>
2021-12-24 16:54:45
</td>
<td>
Lino Galiana
</td>
<td>
Fix a few typos in the new pipeline tutorial (#208)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/8ab1956">8ab1956</a>
</td>
<td>
2021-12-23 21:07:30
</td>
<td>
Romain Avouac
</td>
<td>
TP vectorization prediction authors (#206)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/09b60a1">09b60a1</a>
</td>
<td>
2021-12-21 19:58:58
</td>
<td>
Lino Galiana
</td>
<td>
Relecture suite du NLP (#205)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/495599d">495599d</a>
</td>
<td>
2021-12-19 18:33:05
</td>
<td>
Lino Galiana
</td>
<td>
Des √©l√©ments suppl√©mentaires dans la partie NLP (#202)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2a8809f">2a8809f</a>
</td>
<td>
2021-10-27 12:05:34
</td>
<td>
Lino Galiana
</td>
<td>
Simplification des hooks pour gagner en flexibilit√© et clart√© (#166)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/2e4d586">2e4d586</a>
</td>
<td>
2021-09-02 12:03:39
</td>
<td>
Lino Galiana
</td>
<td>
Simplify badges generation (#130)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4cdb759">4cdb759</a>
</td>
<td>
2021-05-12 10:37:23
</td>
<td>
Lino Galiana
</td>
<td>
:sparkles: :star2: Nouveau th√®me hugo :snake: :fire: (#105)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/7f9f97b">7f9f97b</a>
</td>
<td>
2021-04-30 21:44:04
</td>
<td>
Lino Galiana
</td>
<td>
üê≥ + üêç New workflow (docker üê≥) and new dataset for modelization (2020 üá∫üá∏ elections) (#99)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/d164635">d164635</a>
</td>
<td>
2020-12-08 16:22:00
</td>
<td>
Lino Galiana
</td>
<td>
:books: Premi√®re partie NLP (#87)
</td>
</tr>
</tbody>
</table>
</details>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="956" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 955;"><span id="cb21-956"><a href="#cb21-956" aria-hidden="true" tabindex="-1"></a>git_history_table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb21-957"><a href="#cb21-957" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">,</span></span>
<span id="cb21-958"><a href="#cb21-958" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-959"><a href="#cb21-959" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb21-960"><a href="#cb21-960" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SHA</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`[</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>github_repo<span class="sc">}</span><span class="vs">/commit/</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb21-961"><a href="#cb21-961" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Description</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">replacePullRequestPattern</span>(x<span class="op">,</span> github_repo)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb21-962"><a href="#cb21-962" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*Date: x =&gt; x.toLocaleString("fr", {</span></span>
<span id="cb21-963"><a href="#cb21-963" aria-hidden="true" tabindex="-1"></a><span class="co">        "month": "numeric",</span></span>
<span id="cb21-964"><a href="#cb21-964" aria-hidden="true" tabindex="-1"></a><span class="co">        "day": "numeric",</span></span>
<span id="cb21-965"><a href="#cb21-965" aria-hidden="true" tabindex="-1"></a><span class="co">        "year": "numeric"</span></span>
<span id="cb21-966"><a href="#cb21-966" aria-hidden="true" tabindex="-1"></a><span class="co">        })</span></span>
<span id="cb21-967"><a href="#cb21-967" aria-hidden="true" tabindex="-1"></a><span class="co">      */</span></span>
<span id="cb21-968"><a href="#cb21-968" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-969"><a href="#cb21-969" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-970"><a href="#cb21-970" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="976" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 975;"><span id="cb22-976"><a href="#cb22-976" aria-hidden="true" tabindex="-1"></a>git_history_plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb22-977"><a href="#cb22-977" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb22-978"><a href="#cb22-978" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"royalblue"</span>})<span class="op">,</span></span>
<span id="cb22-979"><a href="#cb22-979" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb22-980"><a href="#cb22-980" aria-hidden="true" tabindex="-1"></a>          table_commit<span class="op">,</span></span>
<span id="cb22-981"><a href="#cb22-981" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">pointerX</span>({<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>}))<span class="op">,</span></span>
<span id="cb22-982"><a href="#cb22-982" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(table_commit<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"royalblue"</span>})</span>
<span id="cb22-983"><a href="#cb22-983" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb22-984"><a href="#cb22-984" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="990" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 989;"><span id="cb23-990"><a href="#cb23-990" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">replacePullRequestPattern</span>(inputString<span class="op">,</span> githubRepo) {</span>
<span id="cb23-991"><a href="#cb23-991" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use a regular expression to match the pattern #digit</span></span>
<span id="cb23-992"><a href="#cb23-992" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> pattern <span class="op">=</span> <span class="ss">/#</span><span class="sc">(\d+)</span><span class="ss">/g</span><span class="op">;</span></span>
<span id="cb23-993"><a href="#cb23-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-994"><a href="#cb23-994" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Replace the pattern with ${github_repo}/pull/#digit</span></span>
<span id="cb23-995"><a href="#cb23-995" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> replacedString <span class="op">=</span> inputString<span class="op">.</span><span class="fu">replace</span>(pattern<span class="op">,</span> <span class="st">'[#$1]('</span> <span class="op">+</span> githubRepo <span class="op">+</span> <span class="st">'/pull/$1)'</span>)<span class="op">;</span></span>
<span id="cb23-996"><a href="#cb23-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-997"><a href="#cb23-997" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replacedString<span class="op">;</span></span>
<span id="cb23-998"><a href="#cb23-998" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="1004" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1003;"><span id="cb24-1004"><a href="#cb24-1004" aria-hidden="true" tabindex="-1"></a>github_repo <span class="op">=</span> <span class="st">"https://github.com/linogaliana/python-datascientist"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="1009" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1008;"><span id="cb25-1009"><a href="#cb25-1009" aria-hidden="true" tabindex="-1"></a>table_commit <span class="op">=</span> {</span>
<span id="cb25-1010"><a href="#cb25-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1011"><a href="#cb25-1011" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the HTML table by its class name</span></span>
<span id="cb25-1012"><a href="#cb25-1012" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb25-1013"><a href="#cb25-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1014"><a href="#cb25-1014" aria-hidden="true" tabindex="-1"></a><span class="co">// Check if the table exists</span></span>
<span id="cb25-1015"><a href="#cb25-1015" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (table) {</span>
<span id="cb25-1016"><a href="#cb25-1016" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialize an array to store the table data</span></span>
<span id="cb25-1017"><a href="#cb25-1017" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dataArray <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb25-1018"><a href="#cb25-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1019"><a href="#cb25-1019" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract headers from the first row</span></span>
<span id="cb25-1020"><a href="#cb25-1020" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> headers <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb25-1021"><a href="#cb25-1021" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb25-1022"><a href="#cb25-1022" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">.</span><span class="fu">push</span>(table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span>[i]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>())<span class="op">;</span></span>
<span id="cb25-1023"><a href="#cb25-1023" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-1024"><a href="#cb25-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1025"><a href="#cb25-1025" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Iterate through the rows, starting from the second row</span></span>
<span id="cb25-1026"><a href="#cb25-1026" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb25-1027"><a href="#cb25-1027" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> row <span class="op">=</span> table<span class="op">.</span><span class="at">rows</span>[i]<span class="op">;</span></span>
<span id="cb25-1028"><a href="#cb25-1028" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> rowData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb25-1029"><a href="#cb25-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1030"><a href="#cb25-1030" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Iterate through the cells in the row</span></span>
<span id="cb25-1031"><a href="#cb25-1031" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> row<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb25-1032"><a href="#cb25-1032" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Use headers as keys and cell content as values</span></span>
<span id="cb25-1033"><a href="#cb25-1033" aria-hidden="true" tabindex="-1"></a>            rowData[headers[j]] <span class="op">=</span> row<span class="op">.</span><span class="at">cells</span>[j]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb25-1034"><a href="#cb25-1034" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-1035"><a href="#cb25-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1036"><a href="#cb25-1036" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Push the rowData object to the dataArray</span></span>
<span id="cb25-1037"><a href="#cb25-1037" aria-hidden="true" tabindex="-1"></a>        dataArray<span class="op">.</span><span class="fu">push</span>(rowData)<span class="op">;</span></span>
<span id="cb25-1038"><a href="#cb25-1038" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-1039"><a href="#cb25-1039" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-1040"><a href="#cb25-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1041"><a href="#cb25-1041" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataArray</span>
<span id="cb25-1042"><a href="#cb25-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1043"><a href="#cb25-1043" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="1049" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1048;"><span id="cb26-1049"><a href="#cb26-1049" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the element with class 'git-details'</span></span>
<span id="cb26-1050"><a href="#cb26-1050" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-1051"><a href="#cb26-1051" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> gitDetails <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb26-1052"><a href="#cb26-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1053"><a href="#cb26-1053" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Check if the element exists</span></span>
<span id="cb26-1054"><a href="#cb26-1054" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (gitDetails) {</span>
<span id="cb26-1055"><a href="#cb26-1055" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Hide the element</span></span>
<span id="cb26-1056"><a href="#cb26-1056" aria-hidden="true" tabindex="-1"></a>      gitDetails<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb26-1057"><a href="#cb26-1057" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-1058"><a href="#cb26-1058" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="1064" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1063;"><span id="cb27-1064"><a href="#cb27-1064" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.12/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="declaration">

</div>
</div>
</div>



</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-huggingfacecourse" class="csl-entry" role="listitem">
Face, Hugging. 2022. <span>‚ÄúThe Hugging Face Course, 2022.‚Äù</span> <a href="https://huggingface.co/course" class="uri">https://huggingface.co/course</a>.
</div>
<div id="ref-mikolov2013efficient" class="csl-entry" role="listitem">
Mikolov, Tomas. 2013. <span>‚ÄúEfficient Estimation of Word Representations in Vector Space.‚Äù</span> <em>arXiv Preprint arXiv:1301.3781</em> 3781.
</div>
<div id="ref-vaswani2017attention" class="csl-entry" role="listitem">
Vaswani, A. 2017. <span>‚ÄúAttention Is All You Need.‚Äù</span> <em>Advances in Neural Information Processing Systems</em>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Cette remarque peut appara√Ætre √©tonnante alors que les IA g√©n√©ratives occupent une place importante dans nos usages. N√©anmoins, il faut garder √† l‚Äôesprit que certes vous posez de nouvelles questions √† des IA mais vous les posez dans des termes qu‚Äôelles connaissent: du langage naturel dans une langue pr√©sente dans leur corpus d‚Äôentra√Ænement, des images num√©riques qui sont donc interpr√©tables par une machine, etc. Autrement dit, votre <em>prompt</em> n‚Äôest pas, en soi, inconnu pour l‚ÄôIA, elle peut l‚Äôinterpr√©ter m√™me si son contenu est nouveau et original.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>Certaines organisations, comme Meta pour Llama, mettent √† disposition les poids apr√®s entra√Ænement de leur mod√®le sur la plateforme <em>Hugging Face</em>, permettant une r√©utilisation de ces mod√®les si la licence le permet. N√©anmoins, il ne s‚Äôagit pas pour autant de mod√®les <em>open source</em> puisque le code utilis√© pour entra√Æner les mod√®les et constituer les corpus d‚Äôapprentissage, issus de collectes massives de donn√©es par <em>webscraping</em>, et les √©ventuelles annotations suppl√©mentaires pour en faire des versions sp√©cialis√©es, ne sont pas partag√©s.<a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@book{galiana2023,
  author = {Galiana, Lino},
  title = {Python Pour La Data Science},
  date = {2023},
  url = {https://pythonds.linogaliana.fr/},
  doi = {10.5281/zenodo.8229676},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-galiana2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Galiana, Lino. 2023. <em>Python Pour La Data Science</em>. <a href="https://doi.org/10.5281/zenodo.8229676">https://doi.org/10.5281/zenodo.8229676</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBhY3Rpdml0ZSA9IElucHV0cy50ZXh0KCBcbiAge2xhYmVsOiAnJywgdmFsdWU6ICdkYXRhIHNjaWVudGlzdCcsIHdpZHRoOiA4MDB9XG4pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkMy5qc29uKHVybEFwZSkudGhlbihyZXMgPT4ge1xuICB2YXIgSUMsIHJlc3VsdHM7XG5cbiAgKHsgSUMsIC4uLnJlc3VsdHMgfSA9IHJlcyk7XG5cbiAgSUMgPSBwYXJzZUZsb2F0KElDKTtcblxuICBjb25zdCByb3dzID0gT2JqZWN0LnZhbHVlcyhyZXN1bHRzKS5tYXAob2JqID0+IHtcbiAgICByZXR1cm4gYFxuICAgIDx0cj5cbiAgICAgIDx0ZD4ke29iai5jb2RlfSB8ICR7b2JqLmxpYmVsbGV9PC90ZD5cbiAgICAgIDx0ZD4ke29iai5wcm9iYWJpbGl0ZS50b0ZpeGVkKDMpfTwvdGQ+XG4gICAgPC90cj5cbiAgYDtcbiAgfSkuam9pbignJyk7XG5cbiAgY29uc3QgY29uZmlkZW5jZVJvdyA9IGA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJ0ZXh0LWFsaWduOmxlZnQ7IFwiPjxlbT5JbmRpY2UgZGUgY29uZmlhbmNlIDogJHtJQy50b0ZpeGVkKDMpfTwvZW0+PC90ZD5cbiAgPC90cj5gO1xuXG4gIGNvbnN0IHRhYmxlSFRNTCA9IGh0bWxgXG4gIDx0YWJsZT5cbiAgICA8Y2FwdGlvbj5cbiAgICAgIFByw6lkaWN0aW9uIGRlIGwnYWN0aXZpdMOpXG4gICAgPC9jYXB0aW9uPlxuICAgIDx0cj5cbiAgICAgIDx0aCBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyO1wiPkxpYmVsbMOpIChOQTIwMDgpPC90aD5cbiAgICAgIDx0aD5Qcm9iYWJpbGl0w6k8L3RoPlxuICAgIDwvdHI+XG4gICAgICAke3Jvd3N9XG4gICAgICAke2NvbmZpZGVuY2VSb3d9XG4gIDwvdGFibGU+YDtcblxuICAvLyBOb3cgeW91IGNhbiB1c2UgdGhlIHRhYmxlSFRNTCBhcyBuZWVkZWQsIGZvciBleGFtcGxlLCBpbnNlcnRpbmcgaXQgaW50byB0aGUgRE9NLlxuICAvLyBGb3IgZXhhbXBsZSwgYXNzdW1pbmcgeW91IGhhdmUgYSBjb250YWluZXIgd2l0aCB0aGUgaWQgXCJ0YWJsZUNvbnRhaW5lclwiOlxuICByZXR1cm4gdGFibGVIVE1MO1xufSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhY3Rpdml0ZV9kZWJvdW5jZSA9IGRlYm91bmNlKHZpZXdvZiBhY3Rpdml0ZSwgMjAwMClcbnVybEFwZSA9IGBodHRwczovL2NvZGlmaWNhdGlvbi1hcGUtdGVzdC5sYWIuc3NwY2xvdWQuZnIvcHJlZGljdD9uYl9lY2hvc19tYXg9MyZwcm9iX21pbj0wJnRleHRfZmVhdHVyZT0ke2FjdGl2aXRlX2RlYm91bmNlfWBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7ZGVib3VuY2V9IGZyb20gXCJAbWJvc3RvY2svZGVib3VuY2luZy1pbnB1dFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGBDZSBmaWNoaWVyIGEgw6l0w6kgbW9kaWZpw6kgX18ke3RhYmxlX2NvbW1pdC5sZW5ndGh9X18gZm9pcyBkZXB1aXMgc2EgY3LDqWF0aW9uIGxlICR7Y3JlYXRpb25fc3RyaW5nfSAoZGVybmnDqHJlIG1vZGlmaWNhdGlvbiBsZSAke2xhc3RfbW9kaWZpY2F0aW9uX3N0cmluZ30pYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY3JlYXRpb24gPSBkMy5taW4oXG4gIHRhYmxlX2NvbW1pdC5tYXAoZCA9PiBuZXcgRGF0ZShkLkRhdGUpKVxuKVxuXG5sYXN0X21vZGlmaWNhdGlvbiA9IGQzLm1heChcbiAgdGFibGVfY29tbWl0Lm1hcChkID0+IG5ldyBEYXRlKGQuRGF0ZSkpXG4pXG5cbmNyZWF0aW9uX3N0cmluZyA9IGNyZWF0aW9uLnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgXCJtb250aFwiOiBcImxvbmdcIixcbiAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG59KVxuXG5sYXN0X21vZGlmaWNhdGlvbl9zdHJpbmcgPSBsYXN0X21vZGlmaWNhdGlvbi50b0xvY2FsZVN0cmluZyhcImZyXCIsIHtcbiAgXCJkYXlcIjogXCJudW1lcmljXCIsXG4gIFwibW9udGhcIjogXCJsb25nXCIsXG4gIFwieWVhclwiOiBcIm51bWVyaWNcIlxufSlcblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Z2l0X2hpc3RvcnlfdGFibGV9PC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Z2l0X2hpc3RvcnlfcGxvdH08L2Rpdj5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJnaXRfaGlzdG9yeV90YWJsZSA9IElucHV0cy50YWJsZShcbiAgdGFibGVfY29tbWl0LFxuICB7XG4gICAgZm9ybWF0OiB7XG4gICAgICBTSEE6IHggPT4gbWRgWyR7eH1dKCR7Z2l0aHViX3JlcG99L2NvbW1pdC8ke3h9KWAsXG4gICAgICBEZXNjcmlwdGlvbjogeCA9PiBtZGAke3JlcGxhY2VQdWxsUmVxdWVzdFBhdHRlcm4oeCwgZ2l0aHViX3JlcG8pfWAsXG4gICAgICAvKkRhdGU6IHggPT4geC50b0xvY2FsZVN0cmluZyhcImZyXCIsIHtcbiAgICAgICAgXCJtb250aFwiOiBcIm51bWVyaWNcIixcbiAgICAgICAgXCJkYXlcIjogXCJudW1lcmljXCIsXG4gICAgICAgIFwieWVhclwiOiBcIm51bWVyaWNcIlxuICAgICAgICB9KVxuICAgICAgKi9cbiAgICB9XG4gIH1cbilcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJnaXRfaGlzdG9yeV9wbG90ID0gUGxvdC5wbG90KHtcbiAgbWFya3M6IFtcbiAgICBQbG90LnJ1bGVZKFswXSwge3N0cm9rZTogXCJyb3lhbGJsdWVcIn0pLFxuICAgIFBsb3QuZG90KFxuICAgICAgICAgIHRhYmxlX2NvbW1pdCxcbiAgICAgICAgICBQbG90LnBvaW50ZXJYKHt4OiAoZCkgPT4gbmV3IERhdGUoZC5kYXRlKSwgeTogMCwgc3Ryb2tlOiBcInJlZFwifSkpLFxuICAgIFBsb3QuZG90KHRhYmxlX2NvbW1pdCwge3g6IChkKSA9PiBuZXcgRGF0ZShkLkRhdGUpLCB5OiAwLCBmaWxsOiBcInJveWFsYmx1ZVwifSlcbiAgXVxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiByZXBsYWNlUHVsbFJlcXVlc3RQYXR0ZXJuKGlucHV0U3RyaW5nLCBnaXRodWJSZXBvKSB7XG4gICAgLy8gVXNlIGEgcmVndWxhciBleHByZXNzaW9uIHRvIG1hdGNoIHRoZSBwYXR0ZXJuICNkaWdpdFxuICAgIHZhciBwYXR0ZXJuID0gLyMoXFxkKykvZztcblxuICAgIC8vIFJlcGxhY2UgdGhlIHBhdHRlcm4gd2l0aCAke2dpdGh1Yl9yZXBvfS9wdWxsLyNkaWdpdFxuICAgIHZhciByZXBsYWNlZFN0cmluZyA9IGlucHV0U3RyaW5nLnJlcGxhY2UocGF0dGVybiwgJ1sjJDFdKCcgKyBnaXRodWJSZXBvICsgJy9wdWxsLyQxKScpO1xuXG4gICAgcmV0dXJuIHJlcGxhY2VkU3RyaW5nO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdpdGh1Yl9yZXBvID0gXCJodHRwczovL2dpdGh1Yi5jb20vbGlub2dhbGlhbmEvcHl0aG9uLWRhdGFzY2llbnRpc3RcIlxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRhYmxlX2NvbW1pdCA9IHtcblxuLy8gR2V0IHRoZSBIVE1MIHRhYmxlIGJ5IGl0cyBjbGFzcyBuYW1lXG52YXIgdGFibGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWl0LXRhYmxlJyk7XG5cbi8vIENoZWNrIGlmIHRoZSB0YWJsZSBleGlzdHNcbmlmICh0YWJsZSkge1xuICAgIC8vIEluaXRpYWxpemUgYW4gYXJyYXkgdG8gc3RvcmUgdGhlIHRhYmxlIGRhdGFcbiAgICB2YXIgZGF0YUFycmF5ID0gW107XG5cbiAgICAvLyBFeHRyYWN0IGhlYWRlcnMgZnJvbSB0aGUgZmlyc3Qgcm93XG4gICAgdmFyIGhlYWRlcnMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhYmxlLnJvd3NbMF0uY2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaGVhZGVycy5wdXNoKHRhYmxlLnJvd3NbMF0uY2VsbHNbaV0udGV4dENvbnRlbnQudHJpbSgpKTtcbiAgICB9XG5cbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIHJvd3MsIHN0YXJ0aW5nIGZyb20gdGhlIHNlY29uZCByb3dcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRhYmxlLnJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHJvdyA9IHRhYmxlLnJvd3NbaV07XG4gICAgICAgIHZhciByb3dEYXRhID0ge307XG5cbiAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBjZWxscyBpbiB0aGUgcm93XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcm93LmNlbGxzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAvLyBVc2UgaGVhZGVycyBhcyBrZXlzIGFuZCBjZWxsIGNvbnRlbnQgYXMgdmFsdWVzXG4gICAgICAgICAgICByb3dEYXRhW2hlYWRlcnNbal1dID0gcm93LmNlbGxzW2pdLnRleHRDb250ZW50LnRyaW0oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFB1c2ggdGhlIHJvd0RhdGEgb2JqZWN0IHRvIHRoZSBkYXRhQXJyYXlcbiAgICAgICAgZGF0YUFycmF5LnB1c2gocm93RGF0YSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGRhdGFBcnJheVxuXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG4vLyBHZXQgdGhlIGVsZW1lbnQgd2l0aCBjbGFzcyAnZ2l0LWRldGFpbHMnXG57XG4gIHZhciBnaXREZXRhaWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1pdC10YWJsZScpO1xuXG4gIC8vIENoZWNrIGlmIHRoZSBlbGVtZW50IGV4aXN0c1xuICBpZiAoZ2l0RGV0YWlscykge1xuICAgICAgLy8gSGlkZSB0aGUgZWxlbWVudFxuICAgICAgZ2l0RGV0YWlscy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiUGxvdCA9IHJlcXVpcmUoJ0BvYnNlcnZhYmxlaHEvcGxvdEAwLjYuMTIvZGlzdC9wbG90LnVtZC5taW4uanMnKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhY3Rpdml0ZScpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../content/NLP";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pythonds\.linogaliana\.fr");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="linogaliana/python-datascientist" data-repo-id="MDEwOlJlcG9zaXRvcnkyODAxNjE2Nzc=" data-category="General" data-category-id="DIC_kwDOELLtjc4B-5TX" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/NLP/02_exoclean.html" class="pagination-link" aria-label="L'analyse fr√©quentiste par l'approche bag-of-words : int√©r√™t et limites">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">L‚Äôanalyse fr√©quentiste par l‚Äôapproche bag-of-words : int√©r√™t et limites</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Python pour la <em>data science</em>, Lino Galiana.<br>
Licence <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i><br>
Code source disponible sur <a href="https://github.com/linogaliana/python-datascientist"><code>Github</code></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/NLP/03_embedding.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Site construit avec <i class="fa-brands fa-python" aria-label="python"></i> et <a href="https://quarto.org/"><code>Quarto</code></a><br>
Inspiration pour la mise en forme du site <a href="https://www.andreashandel.com">ici</a><br>
<a href="https://github.com/linogaliana/python-datascientist">Code source disponible sur <i class="fa-brands fa-github" aria-label="github"></i> <code>GitHub</code></a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","descPosition":"bottom","closeEffect":"zoom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>