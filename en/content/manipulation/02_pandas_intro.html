<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lino Galiana">
<meta name="dcterms.date" content="2025-02-08">
<meta name="description" content="Pandas is the central piece of the Python ecosystem for data science. This chapter presents the first data exploration that can be performed with Pandas in order to explore the structure of a dataset.">

<title>Introduction to Pandas – Python for data science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/manipulation/02_pandas_suite.html" rel="next">
<link href="../../content/manipulation/01_numpy.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #e9f3fa;
      }
</style>
<script id="toggle-light-dark-elements" type="application/javascript">
// Extend Quarto theme toggling to allow elements to be displayed/hidden in light/dark themes

// Replicated from https://github.com/quarto-dev/quarto-cli/blob/84d4659/src/resources/formats/html/templates/quarto-html.ejs
const getColorSchemeSentinel = () => {
  const localAlternateSentinel = 'default';
  if (window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    return storageValue != null ? storageValue : localAlternateSentinel;
  } else {
    return localAlternateSentinel;
  }
};

// Function to toggle light and dark elements based on color scheme
const toggleColorSchemeElements = () => {
  const scheme = getColorSchemeSentinel();
  const lightElements = document.getElementsByClassName('only-light');
  const darkElements = document.getElementsByClassName('only-dark');

  for (var i = 0; i < lightElements.length; i++) {
    lightElements[i].style.display = scheme == 'default' ? 'block' : 'none';
  }
  for (var i = 0; i < darkElements.length; i++) {
    darkElements[i].style.display = scheme == 'default' ? 'none' : 'block';
  }
};

// Function to check if the user's browser prefers dark themes
const prefersDarkTheme = () => {
  if (window.matchMedia) {
    return window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return false;
};

document.addEventListener('readystatechange', function() {
  // Set the default color scheme based on browser preference
  if (document.readyState === 'interactive' && window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    if (storageValue == null && prefersDarkTheme()) {
      window.localStorage.setItem('quarto-color-scheme', 'alternate');
    }
  }
  // Add event listener for when the readyState is complete (and default toggler is set)
  if (document.readyState === 'complete') {
    // Toggle scheme once
    toggleColorSchemeElements();
    // Append our toggle function to the old one
    const oldToggle = window.quartoToggleColorScheme;
    window.quartoToggleColorScheme = () => {
      oldToggle();
      toggleColorSchemeElements();
    }
  }
});

</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/styles.css">
<meta name="twitter:title" content="Introduction to Pandas – Python for data science">
<meta name="twitter:description" content="Pandas est l’élément central de l’écosystème Python pour la data science. Ce chapitre présente les premières
manipulations de données qu’on peut faire grâce à Pandas pour explorer
la structure de son jeu de données.">
<meta name="twitter:image" content="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/panda_stretching.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Python pour la data science">
<meta name="citation_author" content="Lino Galiana">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2025-02-08">
<meta name="citation_fulltext_html_url" content="https://pythonds.linogaliana.fr/">
<meta name="citation_doi" content="10.5281/zenodo.8229676">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Coding for economists;,citation_author=undefined Turrell;,citation_author=undefined contributors;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://aeturrell.github.io/coding-for-economists;">
<meta name="citation_reference" content="citation_title=The hugging face course, 2022;,citation_author=Hugging Face;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=https://huggingface.co/course;">
<meta name="citation_reference" content="citation_title=The signal and the noise: Why so many predictions fail-but some don’t;,citation_author=Nate Silver;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Efficient estimation of word representations in vector space;,citation_author=Tomas Mikolov;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=3781;,citation_journal_title=arXiv preprint arXiv:1301.3781;">
<meta name="citation_reference" content="citation_title=Attention is all you need;,citation_author=A Vaswani;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Advances in Neural Information Processing Systems;">
<meta name="citation_reference" content="citation_title=Tableau politique de la france de l’ouest sous la troisième république: 102 cartes et croquis, 1 carte hors texte;,citation_author=André Siegfried;,citation_publication_date=1913;,citation_cover_date=1913;,citation_year=1913;">
<meta name="citation_reference" content="citation_title=Statistical learning;,citation_author=Gareth James;,citation_author=Daniela Witten;,citation_author=Trevor Hastie;,citation_author=Robert Tibshirani;,citation_author=Jonathan Taylor;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_inbook_title=An introduction to statistical learning: With applications in python;">
<meta name="citation_reference" content="citation_title=Une histoire du conflit politique: Elections et inégalités sociales en france, 1789-2022;,citation_author=Thomas Piketty;,citation_author=Julia Cagé;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Interpretable machine learning: A guide for making black box models explainable;,citation_author=Molnar Christoph;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;">
<meta name="citation_reference" content="citation_title=A gentle introduction to conformal prediction and distribution-free uncertainty quantification;,citation_author=Anastasios N Angelopoulos;,citation_author=Stephen Bates;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_journal_title=arXiv preprint arXiv:2107.07511;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang Härdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Discovering statistics using r;,citation_author=A Field;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_publisher=Sage;">
<meta name="citation_reference" content="citation_title=psyTeachR Book Template;,citation_author=DeBruine Lisa;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://github.com/psyteachr/template/;">
<meta name="citation_reference" content="citation_title=The grammar of graphics;,citation_author=Leland Wilkinson;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Hands-on machine learning with scikit-learn, keras, and TensorFlow;,citation_author=Aurélien Géron;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang Härdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Random forests;,citation_author=Leo Breiman;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_volume=45;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Bagging predictors;,citation_author=Leo Breiman;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_volume=24;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=R for data science;,citation_author=Hadley Wickham;,citation_author=Mine Çetinkaya-Rundel;,citation_author=Garrett Grolemund;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Computational reproducibility of jupyter notebooks from biomedical publications;,citation_author=Sheeba Samuel;,citation_author=Daniel Mietchen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2308.07333;">
<meta name="citation_reference" content="citation_title=Python data science handbook: Essential tools for working with data;,citation_author=Jake VanderPlas;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;">
<meta name="citation_reference" content="citation_title=Machine learning methods that economists should know about;,citation_author=Susan Athey;,citation_author=Guido W Imbens;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=11;,citation_journal_title=Annual Review of Economics;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data an illustration with scanner data and crowd-sourced nutritional data;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=Proceedings of the 2022 &amp;amp;amp;quot;Journées de Méthodologie Statistiques&amp;quot;;">
<meta name="citation_reference" content="citation_title=Data visualization with python and JavaScript;,citation_author=Kyran Dale;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=Sémiologie graphique;,citation_author=Jacques Bertin;,citation_publication_date=1967;,citation_cover_date=1967;,citation_year=1967;">
<meta name="citation_reference" content="citation_title=La sémiologie graphique de jacques bertin a cinquante ans;,citation_author=Gilles Palsky;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Visions carto (en ligne);">
<meta name="citation_reference" content="citation_title=Fundamentals of data visualization: A primer on making informative and compelling figures;,citation_author=Claus O Wilke;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=How to train BERT with an academic budget;,citation_author=Peter Izsak;,citation_author=Moshe Berchansky;,citation_author=Omer Levy;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2104.07705;">
<meta name="citation_reference" content="citation_title=Python for data analysis: Data wrangling with pandas, NumPy, and IPython;,citation_author=Wes McKinney;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Residential segregation, daytime segregation and spatial frictions: An analysis from mobile phone data;,citation_author=Lino Galiana;,citation_author=François Sémécurbe;,citation_author=Benjamin Sakarovitch;,citation_author=Zbigniew Smoreda;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data: An illustration with scanner and crowd-sourced nutritional datasets;,citation_abstract=Food retailers’ scanner data provide unprecedented details on local consumption, provided that product identifiers allow a linkage with features of interest, such as nutritional information. In this paper, we enrich a large retailer dataset with nutritional information extracted from crowd-sourced and administrative nutritional datasets. To compensate for imperfect matching through the barcode, we develop a methodology to efficiently match short textual descriptions. After a preprocessing step to normalize short labels, we resort to fuzzy matching based on several tokenizers (including n-grams) by querying an ElasticSearch customized index and validate candidates echos as matches with a Levensthein edit-distance and an embedding-based similarity measure created from a siamese neural network model. The pipeline is composed of several steps successively relaxing constraints to find relevant matching candidates.;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1145/3524458.3547244;,citation_doi=10.1145/3524458.3547244;,citation_isbn=9781450392846;,citation_conference_title=Proceedings of the 2022 ACM conference on information technology for social good;,citation_conference=Association for Computing Machinery;,citation_series_title=GoodIT ’22;">
<meta name="citation_reference" content="citation_title=Guide de sémiologie cartographique;,citation_author=undefined Insee;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Energy and policy considerations for deep learning in NLP;,citation_author=Emma Strubell;,citation_author=Ananya Ganesh;,citation_author=Andrew McCallum;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://arxiv.org/abs/1906.02243;">
<meta name="citation_reference" content="citation_title=High-resolution image synthesis with latent diffusion models;,citation_author=Robin Rombach;,citation_author=Andreas Blattmann;,citation_author=Dominik Lorenz;,citation_author=Patrick Esser;,citation_author=Björn Ommer;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_conference_title=Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR);">
<meta name="citation_reference" content="citation_title=Apache arrow and the&amp;amp;amp;quot; 10 things i hate about pandas;,citation_author=Wes McKinney;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_volume=21;,citation_journal_title=Blog, September;">
<meta name="citation_reference" content="citation_title=Many researchers were not compliant with their published data sharing statement: Mixed-methods study;,citation_author=Mirko Gabelica;,citation_author=Ružica Bojčić;,citation_author=Livia Puljak;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_journal_title=Journal of Clinical Epidemiology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Credit scoring in the era of big data;,citation_author=Mikella Hurley;,citation_author=Julius Adebayo;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=18;,citation_journal_title=Yale JL &amp;amp;amp; Tech.;,citation_publisher=HeinOnline;">
<meta name="citation_reference" content="citation_title=Econometrics and machine learning;,citation_author=Arthur Charpentier;,citation_author=Emmanuel Flachaire;,citation_author=Antoine Ly;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=505;,citation_journal_title=Economie et Statistique;,citation_publisher=Persée-Portail des revues scientifiques en SHS;">
<meta name="citation_reference" content="citation_title=Machine learning: An applied econometric approach;,citation_author=Sendhil Mullainathan;,citation_author=Jann Spiess;,citation_publication_date=2017-05;,citation_cover_date=2017-05;,citation_year=2017;,citation_fulltext_html_url=https://www.aeaweb.org/articles?id=10.1257/jep.31.2.87;,citation_issue=2;,citation_doi=10.1257/jep.31.2.87;,citation_volume=31;,citation_journal_title=Journal of Economic Perspectives;">
<meta name="citation_reference" content="citation_title=Le problème du réalisme des hypothèses en économie politique;,citation_author=Pierre Salmon;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;">
<meta name="citation_reference" content="citation_title=The methodology of positive economics;,citation_author=Milton Friedman;,citation_publication_date=1953;,citation_cover_date=1953;,citation_year=1953;,citation_inbook_title=Essays in positive economics;">
<meta name="citation_reference" content="citation_title=L’empreinte carbone du numérique;,citation_author=undefined Arcep;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in ML-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2207.07048;,citation_doi=10.48550/ARXIV.2207.07048;,citation_publisher=arXiv;">
<meta name="citation_reference" content="citation_title=Growth in a time of debt;,citation_author=Carmen M Reinhart;,citation_author=Kenneth S Rogoff;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_issue=2;,citation_volume=100;,citation_journal_title=American economic review;,citation_publisher=American Economic Association;">
<meta name="citation_reference" content="citation_title=We do not know the population of every country in the world for the past two thousand years;,citation_author=Timothy W Guinnane;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=3;,citation_volume=83;,citation_journal_title=The Journal of Economic History;">
<meta name="citation_reference" content="citation_title=Artificial intelligence: A modern approach (4th edition);,citation_author=Stuart J. Russell;,citation_author=Peter Norvig;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=http://aima.cs.berkeley.edu/;,citation_isbn=9781292401133;">
<meta name="citation_reference" content="citation_title=Data scientist, the sexiest job of the 21st century;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century;,citation_issue=5;,citation_volume=90;,citation_journal_title=Harvard business review;">
<meta name="citation_reference" content="citation_title=Is data scientist still the sexiest job of the 21st century?;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=90;,citation_journal_title=Harvard Business Review;,citation_publisher=Harvard Business Publishing;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in machine-learning-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=9;,citation_volume=4;,citation_journal_title=Patterns;,citation_publisher=Elsevier;">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="../../content/getting-started/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/01_environment.html">
 <span class="dropdown-text">A functional Python environment for data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/02_data_analysis.html">
 <span class="dropdown-text">How to deal with a data set</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/03_revisions.html">
 <span class="dropdown-text">A few refresher exercises to get back in the saddle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wrangle" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wrangle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wrangle">    
        <li>
    <a class="dropdown-item" href="../../content/manipulation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/01_numpy.html">
 <span class="dropdown-text">Numpy, the foundation of data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_intro.html">
 <span class="dropdown-text">Introduction to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_suite.html">
 <span class="dropdown-text">Data wrangling with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/03_geopandas_intro.html">
 <span class="dropdown-text">Introduction to spatial data with Geopandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04a_webscraping_TP.html">
 <span class="dropdown-text">Web scraping with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04c_API_TP.html">
 <span class="dropdown-text">Retrieve data with APIs from Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04b_regex_TP.html">
 <span class="dropdown-text">Mastering regular expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-communicate" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Communicate</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-communicate">    
        <li>
    <a class="dropdown-item" href="../../content/visualisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/matplotlib.html">
 <span class="dropdown-text">Building graphics with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/maps.html">
 <span class="dropdown-text">Introduction to cartography with Python</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model">    
        <li>
    <a class="dropdown-item" href="../../content/modelisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/0_preprocessing.html">
 <span class="dropdown-text">Preprocessing before building machine learning models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/1_modelevaluation.html">
 <span class="dropdown-text">Evaluating model quality</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/3_regression.html">
 <span class="dropdown-text">An introduction to regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/4_featureselection.html">
 <span class="dropdown-text">Variable selection: an introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/5_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/6_pipeline.html">
 <span class="dropdown-text">Premier pas vers l’industrialisation avec les pipelines scikit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/7_mlapi.html">
 <span class="dropdown-text">Mettre à disposition un modèle par le biais d’une API</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nlp" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NLP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nlp">    
        <li>
    <a class="dropdown-item" href="../../content/NLP/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/01_intro.html">
 <span class="dropdown-text">Nettoyer et structurer l’information dans les données textuelles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/02_exoclean.html">
 <span class="dropdown-text">L’analyse fréquentiste par l’approche bag-of-words : intérêt et limites</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/03_embedding.html">
 <span class="dropdown-text">Les embeddings, où comment synthétiser l’information textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-depth" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-depth</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-depth">    
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/continuous_integration.html">
 <span class="dropdown-text">Intégration continue avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/s3.html">
 <span class="dropdown-text">Les nouveaux modes d’accès aux données : le format Parquet et les données sur le cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_approfondissement.html">
 <span class="dropdown-text">Approfondissement ElasticSearch pour des recherches de proximité géographique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_intro.html">
 <span class="dropdown-text">Introduction à ElasticSearch pour la recherche textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-git" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Git</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-git">    
        <li>
    <a class="dropdown-item" href="../../content/git/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/introgit.html">
 <span class="dropdown-text">Découvrir Git par la pratique: la gymnastique quotidienne</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/exogit.html">
 <span class="dropdown-text">Un cadavre exquis pour découvrir le travail collaboratif <code>Git</code></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-annexes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Annexes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-annexes">    
        <li>
    <a class="dropdown-item" href="../../content/annexes/evaluation.html">
 <span class="dropdown-text">Évaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/annexes/corrections.html">
 <span class="dropdown-text">Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://linogaliana.github.io/python-datascientist-slides/#/title-slide">
 <span class="dropdown-text">Slides de présentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/linogaliana/python-datascientist" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/manipulation/02_pandas_intro.html">Introduction to Pandas</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Introduction to Pandas</h1>
                  <div>
        <div class="description">
          <p><code>Pandas</code> is the central piece of the <code>Python</code> ecosystem for data science. This chapter presents the first data exploration that can be performed with <code>Pandas</code> in order to explore the structure of a dataset.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Tutoriel</div>
                <div class="quarto-category">Exercices</div>
                <div class="quarto-category">Manipulation</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lino Galiana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2025-02-08</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/01_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy, the foundation of data science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/02_pandas_intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction to Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/02_pandas_suite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data wrangling with Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/03_geopandas_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to spatial data with Geopandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04a_webscraping_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web scraping with Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04c_API_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Retrieve data with APIs from Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04b_regex_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mastering regular expressions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#data-used-in-this-chapter" id="toc-data-used-in-this-chapter" class="nav-link" data-scroll-target="#data-used-in-this-chapter"><span class="header-section-number">1.1</span> Data used in this chapter</a></li>
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment"><span class="header-section-number">1.2</span> Environment</a></li>
  </ul></li>
  <li><a href="#pandas-logic" id="toc-pandas-logic" class="nav-link" data-scroll-target="#pandas-logic"><span class="header-section-number">2</span> <code>Pandas</code> logic</a>
  <ul class="collapse">
  <li><a href="#anatomy-of-a-pandas-table" id="toc-anatomy-of-a-pandas-table" class="nav-link" data-scroll-target="#anatomy-of-a-pandas-table"><span class="header-section-number">2.1</span> Anatomy of a <code>Pandas</code> table</a></li>
  <li><a href="#before-seeing-dataframe-we-need-to-know-pandas-series" id="toc-before-seeing-dataframe-we-need-to-know-pandas-series" class="nav-link" data-scroll-target="#before-seeing-dataframe-we-need-to-know-pandas-series"><span class="header-section-number">2.2</span> Before seeing <code>DataFrame</code>, we need to know <code>Pandas</code> <code>Series</code></a></li>
  </ul></li>
  <li><a href="#from-series-to-dataframe" id="toc-from-series-to-dataframe" class="nav-link" data-scroll-target="#from-series-to-dataframe"><span class="header-section-number">3</span> From <code>Series</code> to <code>DataFrame</code></a>
  <ul class="collapse">
  <li><a href="#the-concept-of-tidy-data" id="toc-the-concept-of-tidy-data" class="nav-link" data-scroll-target="#the-concept-of-tidy-data"><span class="header-section-number">3.1</span> The concept of <em>tidy data</em></a></li>
  </ul></li>
  <li><a href="#importing-data-with-pandas" id="toc-importing-data-with-pandas" class="nav-link" data-scroll-target="#importing-data-with-pandas"><span class="header-section-number">4</span> Importing Data with <code>Pandas</code></a>
  <ul class="collapse">
  <li><a href="#reading-data-from-a-local-path" id="toc-reading-data-from-a-local-path" class="nav-link" data-scroll-target="#reading-data-from-a-local-path"><span class="header-section-number">4.1</span> Reading Data from a Local Path</a></li>
  <li><a href="#reading-from-a-csv-available-on-the-internet" id="toc-reading-from-a-csv-available-on-the-internet" class="nav-link" data-scroll-target="#reading-from-a-csv-available-on-the-internet"><span class="header-section-number">4.2</span> Reading from a CSV Available on the Internet</a></li>
  </ul></li>
  <li><a href="#exploring-the-structure-of-a-dataframe" id="toc-exploring-the-structure-of-a-dataframe" class="nav-link" data-scroll-target="#exploring-the-structure-of-a-dataframe"><span class="header-section-number">5</span> Exploring the Structure of a DataFrame</a>
  <ul class="collapse">
  <li><a href="#dimensions-and-structure-of-a-dataframe" id="toc-dimensions-and-structure-of-a-dataframe" class="nav-link" data-scroll-target="#dimensions-and-structure-of-a-dataframe"><span class="header-section-number">5.1</span> Dimensions and Structure of a DataFrame</a></li>
  <li><a href="#dimensions-and-structure-of-a-dataframe-1" id="toc-dimensions-and-structure-of-a-dataframe-1" class="nav-link" data-scroll-target="#dimensions-and-structure-of-a-dataframe-1"><span class="header-section-number">5.2</span> Dimensions and Structure of a DataFrame</a></li>
  <li><a href="#accessing-elements-of-a-dataframe" id="toc-accessing-elements-of-a-dataframe" class="nav-link" data-scroll-target="#accessing-elements-of-a-dataframe"><span class="header-section-number">5.3</span> Accessing elements of a DataFrame</a></li>
  <li><a href="#accessing-rows" id="toc-accessing-rows" class="nav-link" data-scroll-target="#accessing-rows"><span class="header-section-number">5.4</span> Accessing rows</a></li>
  </ul></li>
  <li><a href="#main-data-wrangling-routine" id="toc-main-data-wrangling-routine" class="nav-link" data-scroll-target="#main-data-wrangling-routine"><span class="header-section-number">6</span> Main data wrangling routine</a>
  <ul class="collapse">
  <li><a href="#operations-on-columns-adding-or-removing-variables-renaming-them-etc." id="toc-operations-on-columns-adding-or-removing-variables-renaming-them-etc." class="nav-link" data-scroll-target="#operations-on-columns-adding-or-removing-variables-renaming-them-etc."><span class="header-section-number">6.1</span> Operations on Columns: Adding or Removing Variables, Renaming Them, etc.</a></li>
  <li><a href="#reordering-observations" id="toc-reordering-observations" class="nav-link" data-scroll-target="#reordering-observations"><span class="header-section-number">6.2</span> Reordering observations</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">6.3</span> Filtering</a></li>
  <li><a href="#summary-of-main-operations" id="toc-summary-of-main-operations" class="nav-link" data-scroll-target="#summary-of-main-operations"><span class="header-section-number">6.4</span> Summary of main operations</a></li>
  </ul></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">7</span> Descriptive Statistics</a>
  <ul class="collapse">
  <li><a href="#counts" id="toc-counts" class="nav-link" data-scroll-target="#counts"><span class="header-section-number">7.1</span> Counts</a></li>
  <li><a href="#aggregated-statistics" id="toc-aggregated-statistics" class="nav-link" data-scroll-target="#aggregated-statistics"><span class="header-section-number">7.2</span> Aggregated statistics</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="header-section-number">7.3</span> Missing values</a></li>
  </ul></li>
  <li><a href="#quick-graphical-representations" id="toc-quick-graphical-representations" class="nav-link" data-scroll-target="#quick-graphical-representations"><span class="header-section-number">8</span> Quick graphical representations</a></li>
  <li><a href="#synthesis-exercise" id="toc-synthesis-exercise" class="nav-link" data-scroll-target="#synthesis-exercise"><span class="header-section-number">9</span> Synthesis exercise</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a>
  <ul class="collapse">
  <li><a href="#informations-additionnelles" id="toc-informations-additionnelles" class="nav-link" data-scroll-target="#informations-additionnelles">Informations additionnelles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/manipulation/02_pandas_intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<a href="#" onclick="this.href = location.href.replace('/en/', '/');" class="button-cta">
<button class="btn"><i class="fa fa-language"></i> Passer à la version française 🇫🇷</button>
</a></p>
<div class="badge-container"><div class="badge-text">If you want to try the examples in this tutorial:</div><a href="https://github.com/linogaliana/python-datascientist-notebooks/blob/main/notebooks/en/manipulation/02_pandas_intro.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/static/v1?logo=github&amp;label=&amp;message=View%20on%20GitHub&amp;color=181717" alt="View on GitHub"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/vscode-python?autoLaunch=true&amp;name=«02_pandas_intro»&amp;init.personalInit=«https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-vscode.sh»&amp;init.personalInitArgs=«en/manipulation%2002_pandas_intro%20correction»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue" alt="Onyxia"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/jupyter-python?autoLaunch=true&amp;name=«02_pandas_intro»&amp;init.personalInit=«https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-jupyter.sh»&amp;init.personalInitArgs=«en/manipulation%2002_pandas_intro%20correction»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange" alt="Onyxia"></a>
<a href="https://colab.research.google.com/github/linogaliana/python-datascientist-notebooks//en/blob/main//notebooks/en/manipulation/02_pandas_intro.ipynb" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a><br></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Skills to be acquired by the end of this chapter
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Import a dataset as a <code>Pandas</code> dataframe and explore its structure;</li>
<li>Perform manipulations on columns and rows;</li>
<li>Construct aggregate statistics and chain operations;</li>
<li>Use <code>Pandas</code> graphical methods to quickly represent data distribution.</li>
</ul>
</div>
</div>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The <code>Pandas</code> package has been the central piece of the data science ecosystem for about a decade. The <em>DataFrame</em>, a central object in languages like <code>R</code> or <code>Stata</code>, had long been absent in the <code>Python</code> ecosystem. Yet, thanks to <code>Numpy</code>, all the basic components were present but needed to be reconfigured to meet the needs of data scientists.</p>
<p>Wes McKinney, when he built <code>Pandas</code> to provide a dataframe leveraging the numerical computation library <code>Numpy</code> in the background, enabled a significant leap forward for <code>Python</code> in data analysis, explaining its popularity in the data science ecosystem. <code>Pandas</code> is not without limitations<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, which we will have the opportunity to discuss, but the vast array of analysis methods it offers greatly simplifies data analysis work. For more information on this package, the reference book by <span class="citation" data-cites="mckinney2012python">McKinney (<a href="#ref-mckinney2012python" role="doc-biblioref">2012</a>)</span> presents many of the package’s features.</p>
<p>In this chapter, we will focus on the most relevant elements in the context of an introduction to data science, leaving interested users to deepen their knowledge with the abundant resources available on the subject.</p>
<p>As datasets generally gain value by associating multiple sources, for example, to relate a record to contextual data or to link two client databases to obtain meaningful data, the next chapter will present how to merge different datasets with <code>Pandas</code>. By the end of the next chapter, thanks to data merging, we will have a detailed database on the carbon footprints of the French<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<section id="data-used-in-this-chapter" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="data-used-in-this-chapter"><span class="header-section-number">1.1</span> Data used in this chapter</h2>
<p>In this <code>Pandas</code> tutorial, we will use:</p>
<ul>
<li>Greenhouse gas emissions estimated at the municipal level by ADEME. The dataset is available on <a href="https://www.data.gouv.fr/fr/datasets/inventaire-de-gaz-a-effet-de-serre-territorialise/#_">data.gouv</a> and can be queried directly in <code>Python</code> with <a href="https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert">this URL</a>.</li>
</ul>
<p>The <a href="../../content/manipulation/02_pandas_suite.html">next chapter</a> will allow us to apply the elements presented in this chapter with the above data combined with contextual data at the municipal level.</p>
</section>
<section id="environment" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="environment"><span class="header-section-number">1.2</span> Environment</h2>
<p>We will follow the usual conventions in importing packages:</p>
<div id="30b7e0b7" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="30b7e0b7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="30b7e0b7-1"><a href="#30b7e0b7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="30b7e0b7-2"><a href="#30b7e0b7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="30b7e0b7-3"><a href="#30b7e0b7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To obtain reproducible results, you can set the seed of the pseudo-random number generator.</p>
<div id="02ffb5b7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="02ffb5b7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="02ffb5b7-1"><a href="#02ffb5b7-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Throughout this demonstration of the main <code>Pandas</code> functionalities, and in the next chapter, I recommend regularly referring to the following resources:</p>
<ul>
<li>The <a href="https://pandas.pydata.org/docs/user_guide/index.html">official <code>Pandas</code> documentation</a>, especially the <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/comparison/index.html">language comparison page</a>, which is very useful;</li>
<li><a href="https://observablehq.com/@observablehq/data-wrangling-translations">This tutorial</a>, designed for users of <a href="https://observablehq.com"><code>Observable Javascript</code></a>, but offering many interesting examples for <code>Pandas</code> aficionados;</li>
<li>The following <a href="https://becominghuman.ai/cheat-sheets-for-ai-neural-networks-machine-learning-deep-learning-big-data-678c51b4b463">cheatsheet from this post</a>.</li>
</ul>
<p>As a reminder, to execute the code examples in an interactive notebook, you can use the shortcuts at the top of the page to launch it in your preferred environment.</p>
</section>
</section>
<section id="pandas-logic" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> <code>Pandas</code> logic</h1>
<section id="anatomy-of-a-pandas-table" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="anatomy-of-a-pandas-table"><span class="header-section-number">2.1</span> Anatomy of a <code>Pandas</code> table</h2>
<p>The central object in the <code>Pandas</code> logic is the <code>DataFrame</code>. It is a special data structure with two dimensions, structured by aligning rows and columns. Unlike a matrix, columns can be of different types.</p>
<p>A <code>DataFrame</code> consists of the following elements:</p>
<ul>
<li>the row index;</li>
<li>the column name;</li>
<li>the data value;</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/pandasDF.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Structure of a Pandas DataFrame, borrowed from https://x.com/epfl_exts/status/997506000600084480"><img src="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/pandasDF.png" class="img-fluid figure-img" alt="Structure of a Pandas DataFrame, borrowed from https://x.com/epfl_exts/status/997506000600084480"></a></p>
<figcaption>Structure of a <code>Pandas</code> <em>DataFrame</em>, borrowed from <a href="https://x.com/epfl_exts/status/997506000600084480" class="uri">https://x.com/epfl_exts/status/997506000600084480</a></figcaption>
</figure>
</div>
</section>
<section id="before-seeing-dataframe-we-need-to-know-pandas-series" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="before-seeing-dataframe-we-need-to-know-pandas-series"><span class="header-section-number">2.2</span> Before seeing <code>DataFrame</code>, we need to know <code>Pandas</code> <code>Series</code></h2>
<p>In fact, a <em>DataFrame</em> is a collection of objects called <code>pandas.Series</code>. These <code>Series</code> are one-dimensional objects that are extensions of the one-dimensional <code>Numpy</code> arrays<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. In particular, to facilitate the handling of categorical or temporal data, additional variable types are available in <code>Pandas</code> compared to <code>Numpy</code> (<code>categorical</code>, <code>datetime64</code>, and <code>timedelta64</code>). These types are associated with optimized methods to facilitate the processing of this data.</p>
<p>There are several possible types for a <code>pandas.Series</code>, extending the basic data types in <code>Python</code>, which will determine the behavior of this variable. Indeed, many operations do not have the same meaning depending on whether the value is numeric or not.</p>
<p>The simplest types (<code>int</code> or <code>float</code>) correspond to numeric values:</p>
<div id="4c60db81" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="4c60db81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="4c60db81-1"><a href="#4c60db81-1" aria-hidden="true" tabindex="-1"></a>poids <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">12</span>])</span>
<span id="4c60db81-2"><a href="#4c60db81-2" aria-hidden="true" tabindex="-1"></a>poids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0     3
1     7
2    12
dtype: int64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Missing Values are tricky !
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In general, if <code>Pandas</code> exclusively detects integer values in a variable, it will use the <code>int</code> type to optimize memory. This choice makes sense. However, it has a drawback: <code>Numpy</code>, and therefore by extension <code>Pandas</code>, cannot represent missing values for the <code>int</code> type (more on missing values below).</p>
<p>Pending the shift to <code>Arrow</code>, which can handle missing values in <code>int</code>, the method to use is to convert to the <code>float</code> type if the variable will have missing values, which is quite simple:</p>
</div>
</div>
</div>
<p>For textual data, it is just as simple:</p>
<div id="05862de4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="05862de4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="05862de4-1"><a href="#05862de4-1" aria-hidden="true" tabindex="-1"></a>animal <span class="op">=</span> pd.Series([<span class="st">"chat"</span>, <span class="st">"chien"</span>, <span class="st">"koala"</span>])</span>
<span id="05862de4-2"><a href="#05862de4-2" aria-hidden="true" tabindex="-1"></a>animal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0     chat
1    chien
2    koala
dtype: object</code></pre>
</div>
</div>
<p>The <code>object</code> type is a catch-all for exclusively textual data types (type <code>str</code>) or a mix of textual and numerical data (type <code>mixed</code>). Historically, it was an intermediate type between the <code>factor</code> and <code>character</code> of <code>R</code>. However, recently, there is an equivalent type to <code>factor</code> in <code>Pandas</code> for variables with a finite and relatively short list of values, the <code>category</code> type. The <code>object</code> type can cause unexpected errors due to its mixed nature, so it is recommended to choose the nature of a variable and convert it:</p>
<div id="dee860ab" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="dee860ab"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="dee860ab" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="dee860ab-1" class="code-annotation-target"><a href="#dee860ab-1" aria-hidden="true" tabindex="-1"></a>animal.astype(<span class="st">"category"</span>)</span>
<a class="code-annotation-anchor" data-target-cell="dee860ab" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="dee860ab-2" class="code-annotation-target"><a href="#dee860ab-2" aria-hidden="true" tabindex="-1"></a>animal.astype(<span class="bu">str</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="dee860ab" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="dee860ab" data-code-lines="1" data-code-annotation="1">Pour convertir en <code>category</code> (le choix qui fait sens ici)</span>
</dd>
<dt data-target-cell="dee860ab" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="dee860ab" data-code-lines="2" data-code-annotation="2">Pour convertir en <code>str</code> (si on désire faire des opérations textuelles ultérieures)</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0     chat
1    chien
2    koala
dtype: object</code></pre>
</div>
</div>
<p>It is important to examine the types of your <code>Pandas</code> objects and convert them if they do not make sense; <code>Pandas</code> makes optimized choices, but it may be necessary to correct them because <code>Pandas</code> does not know your future data usage. This is one of the tasks to do during <em>feature engineering</em>, the set of steps for preparing data for future use.</p>
</section>
</section>
<section id="from-series-to-dataframe" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> From <code>Series</code> to <code>DataFrame</code></h1>
<p>We have created two independent series, <code>animal</code> and <code>poids</code>, which are related. In the matrix world, this would correspond to moving from a vector to a matrix. In the <code>Pandas</code> world, this means moving from a <code>Series</code> to a <code>DataFrame</code>.</p>
<p>This is done naturally with <code>Pandas</code>:</p>
<div id="e26afccb" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="e26afccb"><pre class="sourceCode python code-annotation-code code-with-copy"><code class="sourceCode python"><span id="e26afccb-1"><a href="#e26afccb-1" aria-hidden="true" tabindex="-1"></a>animaux <span class="op">=</span> pd.DataFrame(<span class="bu">zip</span>(animal, poids), columns<span class="op">=</span>[<span class="st">"animal"</span>, <span class="st">"poids"</span>])</span>
<span id="e26afccb-2"><a href="#e26afccb-2" aria-hidden="true" tabindex="-1"></a>animaux</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">animal</th>
<th data-quarto-table-cell-role="th">poids</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chat</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chien</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>koala</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ol type="1">
<li>We need to use <code>zip</code> here because <code>Pandas</code> expects a structure like <code>{"var1": [val1, val2], "var2": [val1, val2]}</code>, which is not what we prepared previously. However, we will see that this approach is not the most common for creating a <code>DataFrame</code>.</li>
</ol>
<p>The essential difference between a <code>Series</code> and a <code>Numpy</code> object is indexing. In <code>Numpy</code>, indexing is implicit; it allows accessing data (the one at the index located at position <em>i</em>). With a <code>Series</code>, you can, of course, use a positional index, but more importantly, you can use more explicit indices.</p>
<p>This allows accessing data more naturally, using column names, for example:</p>
<div id="5bb98c3b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="5bb98c3b"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5bb98c3b-1"><a href="#5bb98c3b-1" aria-hidden="true" tabindex="-1"></a>animaux[<span class="st">"poids"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0     3
1     7
2    12
Name: poids, dtype: int64</code></pre>
</div>
</div>
<p>The existence of an index makes subsetting, that is, selecting rows or columns, particularly easy. DataFrames have two indices: those for rows and those for columns. You can make selections on both dimensions. Anticipating later exercises, you can see that this will facilitate row selection:</p>
<div id="3da6997d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="3da6997d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="3da6997d-1"><a href="#3da6997d-1" aria-hidden="true" tabindex="-1"></a>animaux.loc[animaux[<span class="st">"animal"</span>] <span class="op">==</span> <span class="st">"chat"</span>, <span class="st">"poids"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0    3
Name: poids, dtype: int64</code></pre>
</div>
</div>
<p>This instruction is equivalent to the SQL command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> poids <span class="kw">FROM</span> animaux <span class="kw">WHERE</span> animal <span class="op">==</span> <span class="ot">"chat"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If we return to our <code>animaux</code> dataset, we can see the row number displayed on the left:</p>
<div id="df392b10" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="df392b10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="df392b10-1"><a href="#df392b10-1" aria-hidden="true" tabindex="-1"></a>animaux</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">animal</th>
<th data-quarto-table-cell-role="th">poids</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chat</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chien</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>koala</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This is the default index for the row dimension because we did not configure one. It is not mandatory; it is quite possible to have an index corresponding to a variable of interest (we will discover this when we explore <code>groupby</code> in the next chapter). However, this can be tricky, and it is recommended that this be only transitory, hence the importance of regularly performing <code>reset_index</code>.</p>
<section id="the-concept-of-tidy-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="the-concept-of-tidy-data"><span class="header-section-number">3.1</span> The concept of <em>tidy data</em></h2>
<p>The concept of <strong><em>tidy</em></strong> data, popularized by Hadley Wickham through his <code>R</code> packages (see <span class="citation" data-cites="wickham2023r">Wickham, Çetinkaya-Rundel, and Grolemund (<a href="#ref-wickham2023r" role="doc-biblioref">2023</a>)</span>), is highly relevant for describing the structure of a <code>Pandas</code> DataFrame. The three rules of tidy data are as follows:</p>
<ul>
<li>Each <strong>variable</strong> has its own column;</li>
<li>Each <strong>observation</strong> has its own row;</li>
<li>A <strong>value</strong>, representing an observation of a variable, is located in a single cell.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/91adc/images/tidy-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Illustration of the tidy data concept (borrowed from H. Wickham)"><img src="https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/91adc/images/tidy-1.png" class="img-fluid figure-img" alt="Illustration of the tidy data concept (borrowed from H. Wickham)"></a></p>
<figcaption>Illustration of the <em>tidy data</em> concept (borrowed from H. Wickham)</figcaption>
</figure>
</div>
<p>These principles may seem like common sense, but you will find that many data formats do not adhere to them. For example, Excel spreadsheets often have values spanning multiple columns or several merged rows. Restructuring this data according to the tidy data principle will be crucial to performing analysis on it.</p>
</section>
</section>
<section id="importing-data-with-pandas" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Importing Data with <code>Pandas</code></h1>
<p>If you had to manually create all your DataFrames from vectors, <code>Pandas</code> would not be practical. <code>Pandas</code> offers many functions to read data stored in different formats.</p>
<p>The simplest data to read are tabular data stored in an appropriate format. The two main formats to know are <code>CSV</code> and <code>Parquet</code>. The former has the advantage of simplicity - it is universal, known to all, and readable by any text editor. The latter is gaining popularity in the data ecosystem because it addresses some limitations of CSV (optimized storage, predefined variable types…) but has the disadvantage of not being readable without a suitable tool (which fortunately are increasingly present in standard code editors like <code>VSCode</code>). For more information on the difference between <code>CSV</code> and <code>Parquet</code>, refer to the <a href="../../content/modern-ds/s3.html">deep dive chapters</a> on the subject.</p>
<p>Data stored in other text-derived formats from <code>CSV</code> (<code>.txt</code>, <code>.tsv</code>…) or formats like <code>JSON</code> are readable with <code>Pandas</code>, but sometimes it takes a bit of iteration to find the correct reading parameters. In other chapters, we will discover that other data formats related to different data structures are also readable with <code>Python</code>.</p>
<p>Flat formats (<code>.csv</code>, <code>.txt</code>…) and the <code>Parquet</code> format are easy to use with <code>Pandas</code> because they are not proprietary and they store data in a tidy form. Data from spreadsheets, <code>Excel</code> or <code>LibreOffice</code>, are more or less complicated to import depending on whether they follow this schema or not. This is because these tools are used indiscriminately. While in the data science world, they should primarily be used to disseminate final tables for reporting, they are often used to disseminate raw data that could be better shared through more suitable channels.</p>
<p>One of the main difficulties with spreadsheets is that the data are usually associated with documentation in the same tab - for example, the spreadsheet has some lines describing the sources before the table - which requires human intelligence to assist <code>Pandas</code> during the import phase. This will always be possible, but when there is an alternative in the form of a flat file, there should be no hesitation.</p>
<section id="reading-data-from-a-local-path" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="reading-data-from-a-local-path"><span class="header-section-number">4.1</span> Reading Data from a Local Path</h2>
<p>This exercise aims to demonstrate the benefit of using a relative path rather than an absolute path to enhance code reproducibility. However, we will later recommend reading directly from the internet when possible and when it does not involve the recurrent download of a large file.</p>
<p>To prepare for this exercise, the following code will allow you to download data and write it locally:</p>
<div id="e16df8d2" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="e16df8d2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e16df8d2-1"><a href="#e16df8d2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="e16df8d2-2"><a href="#e16df8d2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="e16df8d2-3"><a href="#e16df8d2-3" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://www.insee.fr/fr/statistiques/fichier/6800675/v_commune_2023.csv"</span></span>
<span id="e16df8d2-4"><a href="#e16df8d2-4" aria-hidden="true" tabindex="-1"></a>url_backup <span class="op">=</span> <span class="st">"https://minio.lab.sspcloud.fr/lgaliana/data/python-ENSAE/cog_2023.csv"</span></span>
<span id="e16df8d2-5"><a href="#e16df8d2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="e16df8d2-6"><a href="#e16df8d2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="e16df8d2-7"><a href="#e16df8d2-7" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="e16df8d2-8"><a href="#e16df8d2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> requests.exceptions.RequestException <span class="im">as</span> e:</span>
<span id="e16df8d2-9"><a href="#e16df8d2-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error : </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="e16df8d2-10"><a href="#e16df8d2-10" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url_backup)</span>
<span id="e16df8d2-11"><a href="#e16df8d2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="e16df8d2-12"><a href="#e16df8d2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Only download if one of the request succeeded</span></span>
<span id="e16df8d2-13"><a href="#e16df8d2-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="e16df8d2-14"><a href="#e16df8d2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"cog_2023.csv"</span>, <span class="st">"wb"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="e16df8d2-15"><a href="#e16df8d2-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">file</span>.write(response.content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preliminary Exercise: Importing a CSV (Optional)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Use the code above ☝️ to download the data. Use <code>Pandas</code> to read the downloaded file.</li>
<li>Find where the data was written. Observe the structure of this directory.</li>
<li>Create a new folder using the file explorer (on the left in <code>Jupyter</code> or <code>VSCode</code>). Move the CSV and the notebook. Restart the kernel and adjust your code if needed. Repeat this process several times with different folders. What issues might you encounter?</li>
</ol>
</div>
</div>
</div>
<div id="d344ae8a" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TYPECOM</th>
<th data-quarto-table-cell-role="th">COM</th>
<th data-quarto-table-cell-role="th">REG</th>
<th data-quarto-table-cell-role="th">DEP</th>
<th data-quarto-table-cell-role="th">CTCD</th>
<th data-quarto-table-cell-role="th">ARR</th>
<th data-quarto-table-cell-role="th">TNCC</th>
<th data-quarto-table-cell-role="th">NCC</th>
<th data-quarto-table-cell-role="th">NCCENR</th>
<th data-quarto-table-cell-role="th">LIBELLE</th>
<th data-quarto-table-cell-role="th">CAN</th>
<th data-quarto-table-cell-role="th">COMPARENT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>COM</td>
<td>01001</td>
<td>84.0</td>
<td>01</td>
<td>01D</td>
<td>012</td>
<td>5</td>
<td>ABERGEMENT CLEMENCIAT</td>
<td>Abergement-Clémenciat</td>
<td>L'Abergement-Clémenciat</td>
<td>0108</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>COM</td>
<td>01002</td>
<td>84.0</td>
<td>01</td>
<td>01D</td>
<td>011</td>
<td>5</td>
<td>ABERGEMENT DE VAREY</td>
<td>Abergement-de-Varey</td>
<td>L'Abergement-de-Varey</td>
<td>0101</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The main issue with reading from files stored locally is the risk of becoming dependent on a file system that is not necessarily shared. It is better, whenever possible, to directly read the data with an <code>HTTPS</code> link, which <code>Pandas</code> can handle. Moreover, when working with open data, this ensures that you are using the latest available data and not a local duplication that may not be up to date.</p>
</section>
<section id="reading-from-a-csv-available-on-the-internet" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="reading-from-a-csv-available-on-the-internet"><span class="header-section-number">4.2</span> Reading from a CSV Available on the Internet</h2>
<p>The URL to access the data can be stored in an ad hoc variable:</p>
<div id="bdc1cda5" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="bdc1cda5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="bdc1cda5-1"><a href="#bdc1cda5-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The goal of the next exercise is to get familiar with importing and displaying data using <code>Pandas</code> and displaying a few observations.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1: Importing a CSV and Exploring Data Structure
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Import the data from Ademe using the <code>Pandas</code> package and the dedicated command for importing CSVs. Name the obtained <code>DataFrame</code> <code>emissions</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</li>
<li>Use the appropriate methods to display the first 10 values, the last 15 values, and a random sample of 10 values using the appropriate methods from the <code>Pandas</code> package.</li>
<li>Draw 5 percent of the sample without replacement.</li>
<li>Keep only the first 10 rows and randomly draw from these to obtain a DataFrame of 100 data points.</li>
<li>Make 100 draws from the first 6 rows with a probability of 1/2 for the first observation and a uniform probability for the others.</li>
</ol>
<details>
<summary>
If you get stuck on question 1
</summary>
<p>Read the documentation for <code>read_csv</code> (very well done) or look for examples online to discover this function.</p>
</details>
</div>
</div>
</div>
<p>As illustrated by this exercise, displaying DataFrames in notebooks is quite ergonomic. The first and last rows are displayed automatically. For valuation tables present in a report or research article, the next chapter introduces <code>great_tables</code>, which offers very rich table formatting features.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Be careful with <code>display</code> and commands that reveal data (<code>head</code>, <code>tail</code>, etc.) in a notebook that handles confidential data when using version control software like <code>Git</code> (see dedicated chapters).</p>
<p>Indeed, you may end up sharing data inadvertently in the <code>Git</code> history. As explained in the chapter dedicated to <code>Git</code>, a file named <code>.gitignore</code> is sufficient to create some rules to avoid unintentional sharing of data with <code>Git</code>.</p>
</div>
</div>
</div>
</section>
</section>
<section id="exploring-the-structure-of-a-dataframe" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Exploring the Structure of a DataFrame</h1>
<p><code>Pandas</code> offers a data schema quite familiar to users of statistical software like <code>R</code>. Similar to the main data processing paradigms like the <em>tidyverse</em> (<code>R</code>), the grammar of <code>Pandas</code> inherits from <code>SQL</code> logic. The philosophy is very similar: operations are performed to select rows, columns, sort rows based on column values, apply standardized treatments to variables, etc. Generally, operations that reference variable names are preferred over those that reference row or column numbers.</p>
<p>Whether you are familiar with <code>SQL</code> or <code>R</code>, you will find a similar logic to what you know, although the names might differ: <code>df.loc[df['y']=='b']</code> may be written as <code>df %&gt;% filter(y=='b')</code> (<code>R</code>) or <code>SELECT * FROM df WHERE y == 'b'</code> (<code>SQL</code>), but the logic is the same.</p>
<p><code>Pandas</code> offers a plethora of pre-implemented functionalities. It is highly recommended, before writing a function, to consider if it is natively implemented in <code>Numpy</code>, <code>Pandas</code>, etc. Most of the time, if a solution is implemented in a library, it should be used as it will be more efficient than what you would implement.</p>
<p>To present the most practical methods for data analysis, we can use the example of the municipal CO2 consumption data from Ademe, which was the focus of the previous exercises.</p>
<div id="c6db544e" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="c6db544e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c6db544e-1"><a href="#c6db544e-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(</span>
<span id="c6db544e-2"><a href="#c6db544e-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert"</span></span>
<span id="c6db544e-3"><a href="#c6db544e-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="c6db544e-4"><a href="#c6db544e-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01005</td>
<td>AMBERIEUX-EN-DOMBES</td>
<td>1859.160954</td>
<td>NaN</td>
<td>NaN</td>
<td>1144.429311</td>
<td>216.217508</td>
<td>94.182310</td>
<td>276.448534</td>
<td>663.683146</td>
<td>1756.341319</td>
<td>782.404357</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01006</td>
<td>AMBLEON</td>
<td>448.966808</td>
<td>NaN</td>
<td>NaN</td>
<td>77.033834</td>
<td>48.401549</td>
<td>NaN</td>
<td>NaN</td>
<td>43.714019</td>
<td>398.786800</td>
<td>51.681756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35793</td>
<td>95676</td>
<td>VILLERS-EN-ARTHIES</td>
<td>1628.065094</td>
<td>NaN</td>
<td>NaN</td>
<td>165.045396</td>
<td>65.063617</td>
<td>11.772789</td>
<td>34.556067</td>
<td>176.098160</td>
<td>309.627908</td>
<td>235.439109</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35794</td>
<td>95678</td>
<td>VILLIERS-ADAM</td>
<td>698.630772</td>
<td>NaN</td>
<td>NaN</td>
<td>1331.126598</td>
<td>111.480954</td>
<td>2.354558</td>
<td>6.911213</td>
<td>1395.529811</td>
<td>18759.370071</td>
<td>403.404815</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35795</td>
<td>95680</td>
<td>VILLIERS-LE-BEL</td>
<td>107.564967</td>
<td>NaN</td>
<td>NaN</td>
<td>8367.174532</td>
<td>225.622903</td>
<td>534.484607</td>
<td>1568.845431</td>
<td>22613.830247</td>
<td>12217.122402</td>
<td>13849.512001</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35796</td>
<td>95682</td>
<td>VILLIERS-LE-SEC</td>
<td>1090.890170</td>
<td>NaN</td>
<td>NaN</td>
<td>326.748418</td>
<td>108.969749</td>
<td>2.354558</td>
<td>6.911213</td>
<td>67.235487</td>
<td>4663.232127</td>
<td>85.657725</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35797</td>
<td>95690</td>
<td>WY-DIT-JOLI-VILLAGE</td>
<td>1495.103542</td>
<td>NaN</td>
<td>NaN</td>
<td>125.236417</td>
<td>97.728612</td>
<td>4.709115</td>
<td>13.822427</td>
<td>117.450851</td>
<td>504.400972</td>
<td>147.867245</td>
</tr>
</tbody>
</table>

<p>35798 rows × 12 columns</p>
</div>
</div>
</div>
<section id="dimensions-and-structure-of-a-dataframe" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="dimensions-and-structure-of-a-dataframe"><span class="header-section-number">5.1</span> Dimensions and Structure of a DataFrame</h2>
<p>The first useful methods allow displaying some attributes of a <code>DataFrame</code>.</p>
<div id="c7036fd1" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="c7036fd1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c7036fd1-1"><a href="#c7036fd1-1" aria-hidden="true" tabindex="-1"></a>df.axes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>[RangeIndex(start=0, stop=35798, step=1),
 Index(['INSEE commune', 'Commune', 'Agriculture', 'Autres transports',
        'Autres transports international', 'CO2 biomasse hors-total', 'Déchets',
        'Energie', 'Industrie hors-énergie', 'Résidentiel', 'Routier',
        'Tertiaire'],
       dtype='object')]</code></pre>
</div>
</div>
<div id="0124a0f8" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="0124a0f8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="0124a0f8-1"><a href="#0124a0f8-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Index(['INSEE commune', 'Commune', 'Agriculture', 'Autres transports',
       'Autres transports international', 'CO2 biomasse hors-total', 'Déchets',
       'Energie', 'Industrie hors-énergie', 'Résidentiel', 'Routier',
       'Tertiaire'],
      dtype='object')</code></pre>
</div>
</div>
<div id="c5e0f520" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="c5e0f520"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c5e0f520-1"><a href="#c5e0f520-1" aria-hidden="true" tabindex="-1"></a>df.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>RangeIndex(start=0, stop=35798, step=1)</code></pre>
</div>
</div>
</section>
<section id="dimensions-and-structure-of-a-dataframe-1" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="dimensions-and-structure-of-a-dataframe-1"><span class="header-section-number">5.2</span> Dimensions and Structure of a DataFrame</h2>
<p>The first useful methods allow displaying some attributes of a <code>DataFrame</code>.</p>
<div id="89df0603" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="89df0603"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="89df0603-1"><a href="#89df0603-1" aria-hidden="true" tabindex="-1"></a>df.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>2</code></pre>
</div>
</div>
<div id="e12c33bd" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="e12c33bd"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e12c33bd-1"><a href="#e12c33bd-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(35798, 12)</code></pre>
</div>
</div>
<div id="5e35f7de" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="5e35f7de"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5e35f7de-1"><a href="#5e35f7de-1" aria-hidden="true" tabindex="-1"></a>df.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>429576</code></pre>
</div>
</div>
<p>To know the dimensions of a DataFrame, some practical methods can be used:</p>
<div id="6ce23468" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="6ce23468"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6ce23468-1"><a href="#6ce23468-1" aria-hidden="true" tabindex="-1"></a>df.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>2</code></pre>
</div>
</div>
<div id="acbce666" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="acbce666"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="acbce666-1"><a href="#acbce666-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>(35798, 12)</code></pre>
</div>
</div>
<div id="bde662d3" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="bde662d3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="bde662d3-1"><a href="#bde662d3-1" aria-hidden="true" tabindex="-1"></a>df.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>429576</code></pre>
</div>
</div>
<p>To determine the number of unique values of a variable, rather than writing a function yourself, use the <code>nunique</code> method. For example,</p>
<div id="dee81c82" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="dee81c82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="dee81c82-1"><a href="#dee81c82-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Commune"</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>33338</code></pre>
</div>
</div>
<p><code>Pandas</code> offers many useful methods. Here is a summary of those related to data structure, accompanied by a comparison with <code>R</code>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 23%">
<col style="width: 21%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Operation</th>
<th>pandas</th>
<th>dplyr (<code>R</code>)</th>
<th>data.table (<code>R</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Retrieve column names</td>
<td><code>df.columns</code></td>
<td><code>colnames(df)</code></td>
<td><code>colnames(df)</code></td>
</tr>
<tr class="even">
<td>Retrieve dimensions</td>
<td><code>df.shape</code></td>
<td><code>dim(df)</code></td>
<td><code>dim(df)</code></td>
</tr>
<tr class="odd">
<td>Retrieve unique values of a variable</td>
<td><code>df['myvar'].nunique()</code></td>
<td><code>df %&gt;%  summarise(distinct(myvar))</code></td>
<td><code>df[,uniqueN(myvar)]</code></td>
</tr>
</tbody>
</table>
</section>
<section id="accessing-elements-of-a-dataframe" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="accessing-elements-of-a-dataframe"><span class="header-section-number">5.3</span> Accessing elements of a DataFrame</h2>
<p>In SQL, performing operations on columns is done with the <code>SELECT</code> command. With <code>Pandas</code>, to access an entire column, several approaches can be used:</p>
<ul>
<li><code>dataframe.variable</code>, for example <code>df.Energie</code>. This method requires column names without spaces or special characters, which excludes many real datasets. It is not recommended.</li>
<li><code>dataframe[['variable']]</code> to return the variable as a <code>DataFrame</code>. This method can be tricky for a single variable; it’s better to use <code>dataframe.loc[:,['variable']]</code>, which is more explicit about the nature of the resulting object.</li>
<li><code>dataframe['variable']</code> to return the variable as a <code>Series</code>. For example, <code>df[['Autres transports']]</code> or <code>df['Autres transports']</code>. This is the preferred method.</li>
</ul>
<p>To retrieve multiple columns at once, there are two approaches, with the second being preferable:</p>
<ul>
<li><code>dataframe[['variable1', 'variable2']]</code></li>
<li><code>dataframe.loc[:, ['variable1', 'variable2']]</code></li>
</ul>
<p>This is equivalent to <code>SELECT variable1, variable2 FROM dataframe</code> in SQL.</p>
<p>Using <code>.loc</code> may seem excessively verbose, but it ensures that you are performing a subset operation on the column dimension. DataFrames have two indices, for rows and columns, and implicit operations can sometimes cause surprises, so it’s more reliable to be explicit.</p>
</section>
<section id="accessing-rows" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="accessing-rows"><span class="header-section-number">5.4</span> Accessing rows</h2>
<p>To access one or more values in a <code>DataFrame</code>, there are two recommended methods, depending on the form of the row or column indices used:</p>
<ul>
<li><code>df.iloc</code>: uses indices. This method is somewhat unreliable because a DataFrame’s indices can change during processing (especially when performing group operations).</li>
<li><code>df.loc</code>: uses labels. This method is recommended.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Code snippets using the <code>df.ix</code> structure should be avoided as the function is deprecated and may disappear at any time.</p>
</div>
</div>
</div>
<p><code>iloc</code> refers to the indexing from 0 to <em>N</em>, where <em>N</em> equals <code>df.shape[0]</code> of a <code>pandas.DataFrame</code>. <code>loc</code> refers to the values of <code>df</code>’s index. For example, with the <code>pandas.DataFrame</code> <code>df_example</code>:</p>
<div id="a6717433" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="a6717433"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a6717433-1"><a href="#a6717433-1" aria-hidden="true" tabindex="-1"></a>df_example <span class="op">=</span> pd.DataFrame(</span>
<span id="a6717433-2"><a href="#a6717433-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"month"</span>: [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>], <span class="st">"year"</span>: [<span class="dv">2012</span>, <span class="dv">2014</span>, <span class="dv">2013</span>, <span class="dv">2014</span>], <span class="st">"sale"</span>: [<span class="dv">55</span>, <span class="dv">40</span>, <span class="dv">84</span>, <span class="dv">31</span>]}</span>
<span id="a6717433-3"><a href="#a6717433-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="a6717433-4"><a href="#a6717433-4" aria-hidden="true" tabindex="-1"></a>df_example <span class="op">=</span> df_example.set_index(<span class="st">"month"</span>)</span>
<span id="a6717433-5"><a href="#a6717433-5" aria-hidden="true" tabindex="-1"></a>df_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">sale</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2012</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2014</td>
<td>40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2013</td>
<td>84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>2014</td>
<td>31</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>df_example.loc[1, :]</code> will return the first row of <code>df</code> (row where the <code>month</code> index equals 1);</li>
<li><code>df_example.iloc[1, :]</code> will return the second row (since Python indexing starts at 0);</li>
<li><code>df_example.iloc[:, 1]</code> will return the second column, following the same principle.</li>
</ul>
<p>Later exercises will allow practicing this syntax on our dataset of carbon emissions.</p>
</section>
</section>
<section id="main-data-wrangling-routine" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Main data wrangling routine</h1>
<p>The most frequent operations in <code>SQL</code> are summarized in the following table. It is useful to know them (many data manipulation syntaxes use these terms) because, one way or another, they cover most data manipulation uses. We will describe some of them later:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 23%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Operation</th>
<th>SQL</th>
<th>pandas</th>
<th>dplyr (<code>R</code>)</th>
<th>data.table (<code>R</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Select variables by name</td>
<td><code>SELECT</code></td>
<td><code>df[['Autres transports','Energie']]</code></td>
<td><code>df %&gt;% select(Autres transports, Energie)</code></td>
<td><code>df[, c('Autres transports','Energie')]</code></td>
</tr>
<tr class="even">
<td>Select observations based on one or more conditions</td>
<td><code>FILTER</code></td>
<td><code>df[df['Agriculture']&gt;2000]</code></td>
<td><code>df %&gt;% filter(Agriculture&gt;2000)</code></td>
<td><code>df[Agriculture&gt;2000]</code></td>
</tr>
<tr class="odd">
<td>Sort the table by one or more variables</td>
<td><code>SORT BY</code></td>
<td><code>df.sort_values(['Commune','Agriculture'])</code></td>
<td><code>df %&gt;% arrange(Commune, Agriculture)</code></td>
<td><code>df[order(Commune, Agriculture)]</code></td>
</tr>
<tr class="even">
<td>Add variables that are functions of other variables</td>
<td><code>SELECT *, LOG(Agriculture) AS x FROM df</code></td>
<td><code>df['x'] = np.log(df['Agriculture'])</code></td>
<td><code>df %&gt;% mutate(x = log(Agriculture))</code></td>
<td><code>df[,x := log(Agriculture)]</code></td>
</tr>
<tr class="odd">
<td>Perform an operation by group</td>
<td><code>GROUP BY</code></td>
<td><code>df.groupby('Commune').mean()</code></td>
<td><code>df %&gt;% group_by(Commune) %&gt;% summarise(m = mean)</code></td>
<td><code>df[,mean(Commune), by = Commune]</code></td>
</tr>
<tr class="even">
<td>Join two databases (inner join)</td>
<td><code>SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.x</code></td>
<td><code>table1.merge(table2, left_on = 'id', right_on = 'x')</code></td>
<td><code>table1 %&gt;% inner_join(table2, by = c('id'='x'))</code></td>
<td><code>merge(table1, table2, by.x = 'id', by.y = 'x')</code></td>
</tr>
</tbody>
</table>
<section id="operations-on-columns-adding-or-removing-variables-renaming-them-etc." class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="operations-on-columns-adding-or-removing-variables-renaming-them-etc."><span class="header-section-number">6.1</span> Operations on Columns: Adding or Removing Variables, Renaming Them, etc.</h2>
<p>Technically, <code>Pandas</code> DataFrames are <em>mutable</em> objects in the <code>Python</code> language, meaning it is possible to change the DataFrame as needed during processing.</p>
<p>The most classic operation is adding or removing variables to the data table. The simplest way to add columns is by reassignment. For example, to create a <code>dep</code> variable that corresponds to the first two digits of the commune code (INSEE code), simply take the variable and apply the appropriate treatment (in this case, keep only its first two characters):</p>
<div id="81b48401" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="81b48401"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="81b48401-1"><a href="#81b48401-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"dep"</span>] <span class="op">=</span> df[<span class="st">"INSEE commune"</span>].<span class="bu">str</span>[:<span class="dv">2</span>]</span>
<span id="81b48401-2"><a href="#81b48401-2" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
<td>01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
<td>01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
<td>01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In SQL, the method depends on the execution engine. In pseudo-code, it would be:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> everything(), <span class="fu">SUBSTR</span>(<span class="ot">"code_insee"</span>, <span class="dv">2</span>) <span class="kw">AS</span> dep <span class="kw">FROM</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is possible to apply this approach to creating columns on multiple columns. One of the advantages of this approach is that it allows recycling column names.</p>
<div id="30b8eb75" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="30b8eb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="30b8eb75-1"><a href="#30b8eb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">vars</span> <span class="op">=</span> [<span class="st">"Agriculture"</span>, <span class="st">"Déchets"</span>, <span class="st">"Energie"</span>]</span>
<span id="30b8eb75-2"><a href="#30b8eb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="30b8eb75-3"><a href="#30b8eb75-3" aria-hidden="true" tabindex="-1"></a>df[[v <span class="op">+</span> <span class="st">"_log"</span> <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">vars</span>]] <span class="op">=</span> np.log(df.loc[:, <span class="bu">vars</span>])</span>
<span id="30b8eb75-4"><a href="#30b8eb75-4" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">Agriculture_log</th>
<th data-quarto-table-cell-role="th">Déchets_log</th>
<th data-quarto-table-cell-role="th">Energie_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
<td>01</td>
<td>8.219171</td>
<td>4.619374</td>
<td>0.856353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
<td>01</td>
<td>6.164010</td>
<td>4.946455</td>
<td>0.856353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
<td>01</td>
<td>6.212693</td>
<td>8.578159</td>
<td>6.906086</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The equivalent SQL query would be quite tedious to write. For such operations, the benefit of a high-level library like <code>Pandas</code> becomes clear.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This is possible thanks to the native vectorization of <code>Numpy</code> operations and the magic of <code>Pandas</code> that rearranges everything. This is not usable with just any function. For other functions, you will need to use <code>assign</code>, generally through lambda functions, temporary functions acting as pass-throughs. For example, to create a variable using this approach, you would do:</p>
<div id="b6ebbe91" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="b6ebbe91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b6ebbe91-1"><a href="#b6ebbe91-1" aria-hidden="true" tabindex="-1"></a>df.assign(Energie_log<span class="op">=</span><span class="kw">lambda</span> x: np.log(x[<span class="st">"Energie"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">Agriculture_log</th>
<th data-quarto-table-cell-role="th">Déchets_log</th>
<th data-quarto-table-cell-role="th">Energie_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
<td>01</td>
<td>8.219171</td>
<td>4.619374</td>
<td>0.856353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
<td>01</td>
<td>6.164010</td>
<td>4.946455</td>
<td>0.856353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
<td>01</td>
<td>6.212693</td>
<td>8.578159</td>
<td>6.906086</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01005</td>
<td>AMBERIEUX-EN-DOMBES</td>
<td>1859.160954</td>
<td>NaN</td>
<td>NaN</td>
<td>1144.429311</td>
<td>216.217508</td>
<td>94.182310</td>
<td>276.448534</td>
<td>663.683146</td>
<td>1756.341319</td>
<td>782.404357</td>
<td>01</td>
<td>7.527881</td>
<td>5.376285</td>
<td>4.545232</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01006</td>
<td>AMBLEON</td>
<td>448.966808</td>
<td>NaN</td>
<td>NaN</td>
<td>77.033834</td>
<td>48.401549</td>
<td>NaN</td>
<td>NaN</td>
<td>43.714019</td>
<td>398.786800</td>
<td>51.681756</td>
<td>01</td>
<td>6.106949</td>
<td>3.879532</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35793</td>
<td>95676</td>
<td>VILLERS-EN-ARTHIES</td>
<td>1628.065094</td>
<td>NaN</td>
<td>NaN</td>
<td>165.045396</td>
<td>65.063617</td>
<td>11.772789</td>
<td>34.556067</td>
<td>176.098160</td>
<td>309.627908</td>
<td>235.439109</td>
<td>95</td>
<td>7.395148</td>
<td>4.175366</td>
<td>2.465791</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35794</td>
<td>95678</td>
<td>VILLIERS-ADAM</td>
<td>698.630772</td>
<td>NaN</td>
<td>NaN</td>
<td>1331.126598</td>
<td>111.480954</td>
<td>2.354558</td>
<td>6.911213</td>
<td>1395.529811</td>
<td>18759.370071</td>
<td>403.404815</td>
<td>95</td>
<td>6.549122</td>
<td>4.713854</td>
<td>0.856353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35795</td>
<td>95680</td>
<td>VILLIERS-LE-BEL</td>
<td>107.564967</td>
<td>NaN</td>
<td>NaN</td>
<td>8367.174532</td>
<td>225.622903</td>
<td>534.484607</td>
<td>1568.845431</td>
<td>22613.830247</td>
<td>12217.122402</td>
<td>13849.512001</td>
<td>95</td>
<td>4.678095</td>
<td>5.418865</td>
<td>6.281303</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35796</td>
<td>95682</td>
<td>VILLIERS-LE-SEC</td>
<td>1090.890170</td>
<td>NaN</td>
<td>NaN</td>
<td>326.748418</td>
<td>108.969749</td>
<td>2.354558</td>
<td>6.911213</td>
<td>67.235487</td>
<td>4663.232127</td>
<td>85.657725</td>
<td>95</td>
<td>6.994749</td>
<td>4.691070</td>
<td>0.856353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35797</td>
<td>95690</td>
<td>WY-DIT-JOLI-VILLAGE</td>
<td>1495.103542</td>
<td>NaN</td>
<td>NaN</td>
<td>125.236417</td>
<td>97.728612</td>
<td>4.709115</td>
<td>13.822427</td>
<td>117.450851</td>
<td>504.400972</td>
<td>147.867245</td>
<td>95</td>
<td>7.309951</td>
<td>4.582194</td>
<td>1.549500</td>
</tr>
</tbody>
</table>

<p>35798 rows × 16 columns</p>
</div>
</div>
</div>
<p>With methods from <code>Pandas</code> or <code>Numpy</code> like this, it is not beneficial and even counterproductive as it slows down the code.</p>
</div>
</div>
</div>
<p>Variables can be easily renamed using the <code>rename</code> method, which works well with dictionaries. To rename columns, specify the parameter <code>axis = 'columns'</code> or <code>axis=1</code>. The <code>axis</code> parameter is often necessary because many <code>Pandas</code> methods assume by default that operations are done on the row index:</p>
<div id="a64ab230" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="a64ab230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a64ab230-1"><a href="#a64ab230-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.rename({<span class="st">"Energie"</span>: <span class="st">"eneg"</span>, <span class="st">"Agriculture"</span>: <span class="st">"agr"</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="a64ab230-2"><a href="#a64ab230-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">agr</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">eneg</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">Agriculture_log</th>
<th data-quarto-table-cell-role="th">Déchets_log</th>
<th data-quarto-table-cell-role="th">Energie_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
<td>01</td>
<td>8.219171</td>
<td>4.619374</td>
<td>0.856353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
<td>01</td>
<td>6.164010</td>
<td>4.946455</td>
<td>0.856353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
<td>01</td>
<td>6.212693</td>
<td>8.578159</td>
<td>6.906086</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01005</td>
<td>AMBERIEUX-EN-DOMBES</td>
<td>1859.160954</td>
<td>NaN</td>
<td>NaN</td>
<td>1144.429311</td>
<td>216.217508</td>
<td>94.182310</td>
<td>276.448534</td>
<td>663.683146</td>
<td>1756.341319</td>
<td>782.404357</td>
<td>01</td>
<td>7.527881</td>
<td>5.376285</td>
<td>4.545232</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01006</td>
<td>AMBLEON</td>
<td>448.966808</td>
<td>NaN</td>
<td>NaN</td>
<td>77.033834</td>
<td>48.401549</td>
<td>NaN</td>
<td>NaN</td>
<td>43.714019</td>
<td>398.786800</td>
<td>51.681756</td>
<td>01</td>
<td>6.106949</td>
<td>3.879532</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Finally, to delete columns, use the <code>drop</code> method with the <code>columns</code> argument:</p>
<div id="ed4269ab" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="ed4269ab"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ed4269ab-1"><a href="#ed4269ab-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"eneg"</span>, <span class="st">"agr"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reordering-observations" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="reordering-observations"><span class="header-section-number">6.2</span> Reordering observations</h2>
<p>The <code>sort_values</code> method allows reordering observations in a <code>DataFrame</code>, keeping the column order the same.</p>
<p>For example, to sort in descending order of CO2 consumption in the residential sector, you would do:</p>
<div id="2da2e454" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="2da2e454"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="2da2e454-1"><a href="#2da2e454-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sort_values(<span class="st">"Résidentiel"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="2da2e454-2"><a href="#2da2e454-2" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">Agriculture_log</th>
<th data-quarto-table-cell-role="th">Déchets_log</th>
<th data-quarto-table-cell-role="th">Energie_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">12167</td>
<td>31555</td>
<td>TOULOUSE</td>
<td>4482.980062</td>
<td>130.792683</td>
<td>576394.181208</td>
<td>88863.732538</td>
<td>277062.573234</td>
<td>410675.902028</td>
<td>586054.672836</td>
<td>288175.400126</td>
<td>31</td>
<td>7.268255</td>
<td>11.394859</td>
<td>11.424640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16774</td>
<td>44109</td>
<td>NANTES</td>
<td>138738.544337</td>
<td>250814.701179</td>
<td>193478.248177</td>
<td>18162.261628</td>
<td>77897.138554</td>
<td>354259.013785</td>
<td>221068.632724</td>
<td>173447.582779</td>
<td>44</td>
<td>5.513507</td>
<td>9.807101</td>
<td>9.767748</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27294</td>
<td>67482</td>
<td>STRASBOURG</td>
<td>124998.576639</td>
<td>122266.944279</td>
<td>253079.442156</td>
<td>119203.251573</td>
<td>135685.440035</td>
<td>353586.424577</td>
<td>279544.852332</td>
<td>179562.761386</td>
<td>67</td>
<td>6.641974</td>
<td>11.688585</td>
<td>9.885411</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Thus, in one line of code, you can identify the cities where the residential sector consumes the most. In SQL, you would do:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> df <span class="kw">ORDER</span> <span class="kw">BY</span> <span class="ot">"Résidentiel"</span> <span class="kw">DESC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filtering" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="filtering"><span class="header-section-number">6.3</span> Filtering</h2>
<p>The operation of selecting rows is called <code>FILTER</code> in SQL. It is used based on a logical condition (clause <code>WHERE</code>). Data is selected based on a logical condition.</p>
<p>There are several methods in <code>Pandas</code>. The simplest is to use boolean masks, as seen in the chapter <a href="../../content/manipulation/01_numpy.html"><code>numpy</code></a>.</p>
<p>For example, to select the municipalities in Hauts-de-Seine, you can start by using the result of the <code>str.startswith</code> method (which returns <code>True</code> or <code>False</code>):</p>
<div id="a8e7c715" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="a8e7c715"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a8e7c715-1"><a href="#a8e7c715-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"INSEE commune"</span>].<span class="bu">str</span>.startswith(<span class="st">"92"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>12167    False
16774    False
27294    False
12729    False
22834    False
         ...  
20742    False
20817    False
20861    False
20898    False
20957    False
Name: INSEE commune, Length: 35798, dtype: bool</code></pre>
</div>
</div>
<p><code>str.</code> is a special method in <code>Pandas</code> that allows treating each value of a vector as a native <code>string</code> in <code>Python</code> to which a subsequent method (in this case, <code>startswith</code>) is applied.</p>
<p>The above instruction returns a vector of booleans. We previously saw that the <code>loc</code> method is used for subsetting on both row and column indices. It works with boolean vectors. In this case, if subsetting on the row dimension (or column), it will return all observations (or variables) that satisfy this condition.</p>
<p>Thus, by combining these two elements, we can filter our data to get only the results for the 92:</p>
<div id="d73aa6f3" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="d73aa6f3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="d73aa6f3-1"><a href="#d73aa6f3-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">"INSEE commune"</span>].<span class="bu">str</span>.startswith(<span class="st">"92"</span>)].head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">Agriculture_log</th>
<th data-quarto-table-cell-role="th">Déchets_log</th>
<th data-quarto-table-cell-role="th">Energie_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">35494</td>
<td>92012</td>
<td>BOULOGNE-BILLANCOURT</td>
<td>1250.483441</td>
<td>34.234669</td>
<td>51730.704250</td>
<td>964.828694</td>
<td>25882.493998</td>
<td>92216.971456</td>
<td>64985.280901</td>
<td>60349.109482</td>
<td>92</td>
<td>NaN</td>
<td>6.871951</td>
<td>9.084530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35501</td>
<td>92025</td>
<td>COLOMBES</td>
<td>411.371588</td>
<td>14.220061</td>
<td>53923.847088</td>
<td>698.685861</td>
<td>50244.664227</td>
<td>87469.549463</td>
<td>52070.927943</td>
<td>41526.600867</td>
<td>92</td>
<td>NaN</td>
<td>6.549201</td>
<td>9.461557</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The equivalent SQL code may vary depending on the execution engine (<code>DuckDB</code>, <code>PostGre</code>, <code>MySQL</code>) but would take a form similar to this:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> df <span class="kw">WHERE</span> STARTSWITH(<span class="ot">"INSEE commune"</span>, <span class="ot">"92"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="summary-of-main-operations" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="summary-of-main-operations"><span class="header-section-number">6.4</span> Summary of main operations</h2>
<p>The main manipulations are as follows:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/select_pandas.png" class="img-fluid" alt="Selecting Columns">
<img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/rename_pandas.png" class="img-fluid" alt="Renaming Columns"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/mutate_pandas.png" class="img-fluid" alt="Creating New Columns">
<img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/filter_pandas.png" class="img-fluid" alt="Selecting Rows"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/arrange_pandas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Reordering the DataFrame"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/arrange_pandas.png" class="img-fluid figure-img" alt="Reordering the DataFrame"></a></p>
<figcaption>Reordering the DataFrame</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="descriptive-statistics" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Descriptive Statistics</h1>
<p>To start again from the raw source, let’s recreate our dataset for the examples:</p>
<div id="c7bf47dd" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="c7bf47dd"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c7bf47dd-1"><a href="#c7bf47dd-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(</span>
<span id="c7bf47dd-2"><a href="#c7bf47dd-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert"</span></span>
<span id="c7bf47dd-3"><a href="#c7bf47dd-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="c7bf47dd-4"><a href="#c7bf47dd-4" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>Pandas</code> includes several methods to construct aggregate statistics: sum, count of unique values, count of non-missing values, mean, variance, etc.</p>
<p>The most generic method is <code>describe</code></p>
<div id="44c6331b" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="44c6331b"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="44c6331b-1"><a href="#44c6331b-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>35736.000000</td>
<td>9979.000000</td>
<td>2.891000e+03</td>
<td>35798.000000</td>
<td>35792.000000</td>
<td>3.449000e+04</td>
<td>3.449000e+04</td>
<td>35792.000000</td>
<td>35778.000000</td>
<td>35798.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2459.975760</td>
<td>654.919940</td>
<td>7.692345e+03</td>
<td>1774.381550</td>
<td>410.806329</td>
<td>6.625698e+02</td>
<td>2.423128e+03</td>
<td>1783.677872</td>
<td>3535.501245</td>
<td>1105.165915</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2926.957701</td>
<td>9232.816833</td>
<td>1.137643e+05</td>
<td>7871.341922</td>
<td>4122.472608</td>
<td>2.645571e+04</td>
<td>5.670374e+04</td>
<td>8915.902379</td>
<td>9663.156628</td>
<td>5164.182507</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.003432</td>
<td>0.000204</td>
<td>3.972950e-04</td>
<td>3.758088</td>
<td>0.132243</td>
<td>2.354558e+00</td>
<td>1.052998e+00</td>
<td>1.027266</td>
<td>0.555092</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>797.682631</td>
<td>52.560412</td>
<td>1.005097e+01</td>
<td>197.951108</td>
<td>25.655166</td>
<td>2.354558e+00</td>
<td>6.911213e+00</td>
<td>96.052911</td>
<td>419.700460</td>
<td>94.749885</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>1559.381285</td>
<td>106.795928</td>
<td>1.992434e+01</td>
<td>424.849988</td>
<td>54.748653</td>
<td>4.709115e+00</td>
<td>1.382243e+01</td>
<td>227.091193</td>
<td>1070.895593</td>
<td>216.297718</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>3007.883903</td>
<td>237.341501</td>
<td>3.298311e+01</td>
<td>1094.749825</td>
<td>110.820941</td>
<td>5.180027e+01</td>
<td>1.520467e+02</td>
<td>749.469293</td>
<td>3098.612157</td>
<td>576.155869</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>98949.317760</td>
<td>513140.971691</td>
<td>3.303394e+06</td>
<td>576394.181208</td>
<td>275500.374439</td>
<td>2.535858e+06</td>
<td>6.765119e+06</td>
<td>410675.902028</td>
<td>586054.672836</td>
<td>288175.400126</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>which is similar to the eponymous method in <code>Stata</code> or the <code>PROC FREQ</code> of <code>SAS</code>, two proprietary languages. However, it provides a lot of information, which can often be overwhelming. Therefore, it is more practical to work directly on a few columns or choose the statistics you want to use.</p>
<section id="counts" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="counts"><span class="header-section-number">7.1</span> Counts</h2>
<p>The first type of statistics you might want to implement involves counting or enumerating values.</p>
<p>For example, if you want to know the number of municipalities in your dataset, you can use the <code>count</code> method or <code>nunique</code> if you are interested in unique values.</p>
<div id="fe8ef9e3" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="fe8ef9e3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fe8ef9e3-1"><a href="#fe8ef9e3-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Commune"</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>np.int64(35798)</code></pre>
</div>
</div>
<div id="da4937a5" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="da4937a5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="da4937a5-1"><a href="#da4937a5-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Commune"</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>33338</code></pre>
</div>
</div>
<p>In SQL, the first instruction would be <code>SELECT COUNT(Commune) FROM df</code>, the second <code>SELECT COUNT DISTINCT Commune FROM df</code>. Here, this allows us to understand that there may be duplicates in the <code>Commune</code> column, which needs to be considered if we want to uniquely identify our municipalities (this will be addressed in the next chapter on data merging).</p>
<p>The coherence of the <code>Pandas</code> syntax allows you to do this for several columns simultaneously. In SQL, this would be possible but the code would start to become quite verbose:</p>
<div id="e1fefacc" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="e1fefacc"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e1fefacc-1"><a href="#e1fefacc-1" aria-hidden="true" tabindex="-1"></a>df.loc[:, [<span class="st">"Commune"</span>, <span class="st">"INSEE commune"</span>]].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>Commune          35798
INSEE commune    35798
dtype: int64</code></pre>
</div>
</div>
<div id="a1618ab1" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="a1618ab1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a1618ab1-1"><a href="#a1618ab1-1" aria-hidden="true" tabindex="-1"></a>df.loc[:, [<span class="st">"Commune"</span>, <span class="st">"INSEE commune"</span>]].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Commune          33338
INSEE commune    35798
dtype: int64</code></pre>
</div>
</div>
<p>With these two simple commands, we understand that our <code>INSEE commune</code> variable (the INSEE code) will be more reliable for identifying municipalities than the names, which are not necessarily unique. The purpose of the INSEE code is to provide a unique identifier, unlike the postal code which can be shared by several municipalities.</p>
</section>
<section id="aggregated-statistics" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="aggregated-statistics"><span class="header-section-number">7.2</span> Aggregated statistics</h2>
<p><code>Pandas</code> includes several methods to construct statistics on multiple columns: sum, mean, variance, etc.</p>
<p>The methods are quite straightforward:</p>
<div id="9fb3c8b1" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="9fb3c8b1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="9fb3c8b1-1"><a href="#9fb3c8b1-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Agriculture"</span>].<span class="bu">sum</span>()</span>
<span id="9fb3c8b1-2"><a href="#9fb3c8b1-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Agriculture"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>np.float64(2459.975759687974)</code></pre>
</div>
</div>
<p>Again, the consistency of <code>Pandas</code> allows generalizing the calculation of statistics to multiple columns:</p>
<div id="5eb1c737" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="5eb1c737"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5eb1c737-1"><a href="#5eb1c737-1" aria-hidden="true" tabindex="-1"></a>df.loc[:, [<span class="st">"Agriculture"</span>, <span class="st">"Résidentiel"</span>]].<span class="bu">sum</span>()</span>
<span id="5eb1c737-2"><a href="#5eb1c737-2" aria-hidden="true" tabindex="-1"></a>df.loc[:, [<span class="st">"Agriculture"</span>, <span class="st">"Résidentiel"</span>]].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>Agriculture    2459.975760
Résidentiel    1783.677872
dtype: float64</code></pre>
</div>
</div>
<p>It is possible to generalize this to all columns. However, it is necessary to introduce the <code>numeric_only</code> parameter to perform the aggregation task only on the relevant variables:</p>
<div id="d49e7dca" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="d49e7dca"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="d49e7dca-1"><a href="#d49e7dca-1" aria-hidden="true" tabindex="-1"></a>df.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>Agriculture                        2459.975760
Autres transports                   654.919940
Autres transports international    7692.344960
CO2 biomasse hors-total            1774.381550
Déchets                             410.806329
Energie                             662.569846
Industrie hors-énergie             2423.127789
Résidentiel                        1783.677872
Routier                            3535.501245
Tertiaire                          1105.165915
dtype: float64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Version 2.0 of <code>Pandas</code> introduced a change in the behavior of aggregation methods.</p>
<p>It is now necessary to specify whether you want to perform operations exclusively on numeric columns. This is why we explicitly state the argument <code>numeric_only = True</code> here. This behavior was previously implicit.</p>
</div>
</div>
</div>
<p>The practical method to know is <code>agg</code>. This allows defining the statistics you want to calculate for each variable:</p>
<div id="b2323c9f" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="b2323c9f"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b2323c9f-1"><a href="#b2323c9f-1" aria-hidden="true" tabindex="-1"></a>df.agg(</span>
<span id="b2323c9f-2"><a href="#b2323c9f-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="b2323c9f-3"><a href="#b2323c9f-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Agriculture"</span>: [<span class="st">"sum"</span>, <span class="st">"mean"</span>],</span>
<span id="b2323c9f-4"><a href="#b2323c9f-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Résidentiel"</span>: [<span class="st">"mean"</span>, <span class="st">"std"</span>],</span>
<span id="b2323c9f-5"><a href="#b2323c9f-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Commune"</span>: <span class="st">"nunique"</span>,</span>
<span id="b2323c9f-6"><a href="#b2323c9f-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="b2323c9f-7"><a href="#b2323c9f-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Commune</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">sum</td>
<td>8.790969e+07</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2.459976e+03</td>
<td>1783.677872</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>8915.902379</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">nunique</td>
<td>NaN</td>
<td>NaN</td>
<td>33338.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The output of aggregation methods is an indexed <code>Series</code> (methods like <code>df.sum()</code>) or directly a <code>DataFrame</code> (the <code>agg</code> method). It is generally more practical to have a <code>DataFrame</code> than an indexed <code>Series</code> if you want to rework the table to draw conclusions. Therefore, it is useful to transform the outputs from <code>Series</code> to <code>DataFrame</code> and then apply the <code>reset_index</code> method to convert the index into a column. From there, you can modify the <code>DataFrame</code> to make it more readable.</p>
<p>For example, if you are interested in the share of each sector in total emissions, you can proceed in two steps. First, create an observation per sector representing its total emissions:</p>
<div id="cc9ed88a" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cc9ed88a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cc9ed88a-1"><a href="#cc9ed88a-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Etape 1: création d'un DataFrame propre</span></span>
<span id="cc9ed88a-2"><a href="#cc9ed88a-2" aria-hidden="true" tabindex="-1"></a>emissions_totales <span class="op">=</span> pd.DataFrame(</span>
<span id="cc9ed88a-3"><a href="#cc9ed88a-3" aria-hidden="true" tabindex="-1"></a>    df.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>), columns<span class="op">=</span>[<span class="st">"emissions"</span>]</span>
<span id="cc9ed88a-4"><a href="#cc9ed88a-4" aria-hidden="true" tabindex="-1"></a>).reset_index(names<span class="op">=</span><span class="st">"secteur"</span>)</span>
<span id="cc9ed88a-5"><a href="#cc9ed88a-5" aria-hidden="true" tabindex="-1"></a>emissions_totales</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secteur</th>
<th data-quarto-table-cell-role="th">emissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Agriculture</td>
<td>8.790969e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Autres transports</td>
<td>6.535446e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Autres transports international</td>
<td>2.223857e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CO2 biomasse hors-total</td>
<td>6.351931e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Déchets</td>
<td>1.470358e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Energie</td>
<td>2.285203e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Industrie hors-énergie</td>
<td>8.357368e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Résidentiel</td>
<td>6.384140e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Routier</td>
<td>1.264932e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Tertiaire</td>
<td>3.956273e+07</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then, work minimally on the dataset to get some interesting conclusions about the structure of emissions in France:</p>
<div id="6fa86e4d" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="6fa86e4d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6fa86e4d-1"><a href="#6fa86e4d-1" aria-hidden="true" tabindex="-1"></a>emissions_totales[<span class="st">"emissions (%)"</span>] <span class="op">=</span> (</span>
<span id="6fa86e4d-2"><a href="#6fa86e4d-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="op">*</span> emissions_totales[<span class="st">"emissions"</span>] <span class="op">/</span> emissions_totales[<span class="st">"emissions"</span>].<span class="bu">sum</span>()</span>
<span id="6fa86e4d-3"><a href="#6fa86e4d-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="6fa86e4d-4"><a href="#6fa86e4d-4" aria-hidden="true" tabindex="-1"></a>(emissions_totales.sort_values(<span class="st">"emissions"</span>, ascending<span class="op">=</span><span class="va">False</span>).<span class="bu">round</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secteur</th>
<th data-quarto-table-cell-role="th">emissions</th>
<th data-quarto-table-cell-role="th">emissions (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Routier</td>
<td>126493164.0</td>
<td>24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>Agriculture</td>
<td>87909694.0</td>
<td>17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Industrie hors-énergie</td>
<td>83573677.0</td>
<td>16.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Résidentiel</td>
<td>63841398.0</td>
<td>12.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>CO2 biomasse hors-total</td>
<td>63519311.0</td>
<td>12.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Tertiaire</td>
<td>39562729.0</td>
<td>7.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Energie</td>
<td>22852034.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Autres transports international</td>
<td>22238569.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Déchets</td>
<td>14703580.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Autres transports</td>
<td>6535446.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This table is not well-formatted and far from being presentable, but it is already useful from an exploratory perspective. It helps us understand the most emitting sectors, namely transport, agriculture, and industry, excluding energy. The fact that energy is relatively low in emissions can be explained by the French energy mix, where nuclear power represents a majority of electricity production.</p>
<p>To go further in formatting this table to have communicable statistics outside of <code>Python</code>, we will explore <code>great_tables</code> in the next chapter.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The data structure resulting from <code>df.sum</code> is quite practical (it is tidy). We could do exactly the same operation as <code>df.sum(numeric_only = True)</code> with the following code:</p>
<div id="581ed488" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="581ed488"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="581ed488-1"><a href="#581ed488-1" aria-hidden="true" tabindex="-1"></a>df.select_dtypes(include<span class="op">=</span><span class="st">"number"</span>).agg(func<span class="op">=</span><span class="bu">sum</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_9287/1114394405.py:1: FutureWarning:

The provided callable &lt;built-in function sum&gt; is currently using DataFrame.sum. In a future version of pandas, the provided callable will be used directly. To keep current behavior pass the string "sum" instead.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>Agriculture                        8.790969e+07
Autres transports                  6.535446e+06
Autres transports international    2.223857e+07
CO2 biomasse hors-total            6.351931e+07
Déchets                            1.470358e+07
Energie                            2.285203e+07
Industrie hors-énergie             8.357368e+07
Résidentiel                        6.384140e+07
Routier                            1.264932e+08
Tertiaire                          3.956273e+07
dtype: float64</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="missing-values" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="missing-values"><span class="header-section-number">7.3</span> Missing values</h2>
<p>So far, we haven’t discussed what could be a stumbling block for a data scientist: missing values.</p>
<p>Real datasets are rarely complete, and missing values can reflect many realities: data retrieval issues, irrelevant variables for a given observation, etc.</p>
<p>Technically, <code>Pandas</code> handles missing values without issues (except for <code>int</code> variables, but that’s an exception). By default, missing values are displayed as <code>NaN</code> and are of type <code>np.nan</code> (for temporal values, i.e., of type <code>datetime64</code>, missing values are <code>NaT</code>). We get consistent aggregation behavior when combining two columns, one of which has missing values.</p>
<div id="acce8b41" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="acce8b41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="acce8b41-1"><a href="#acce8b41-1" aria-hidden="true" tabindex="-1"></a>ventes <span class="op">=</span> pd.DataFrame(</span>
<span id="acce8b41-2"><a href="#acce8b41-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="acce8b41-3"><a href="#acce8b41-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"prix"</span>: np.random.uniform(size<span class="op">=</span><span class="dv">5</span>),</span>
<span id="acce8b41-4"><a href="#acce8b41-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"client1"</span>: [i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)],</span>
<span id="acce8b41-5"><a href="#acce8b41-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"client2"</span>: [i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)] <span class="op">+</span> [np.nan],</span>
<span id="acce8b41-6"><a href="#acce8b41-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"produit"</span>: [np.nan] <span class="op">+</span> [<span class="st">"yaourt"</span>, <span class="st">"pates"</span>, <span class="st">"riz"</span>, <span class="st">"tomates"</span>],</span>
<span id="acce8b41-7"><a href="#acce8b41-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="acce8b41-8"><a href="#acce8b41-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="acce8b41-9"><a href="#acce8b41-9" aria-hidden="true" tabindex="-1"></a>ventes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prix</th>
<th data-quarto-table-cell-role="th">client1</th>
<th data-quarto-table-cell-role="th">client2</th>
<th data-quarto-table-cell-role="th">produit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.846498</td>
<td>1</td>
<td>1.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.688088</td>
<td>2</td>
<td>2.0</td>
<td>yaourt</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.183628</td>
<td>3</td>
<td>3.0</td>
<td>pates</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.697141</td>
<td>4</td>
<td>4.0</td>
<td>riz</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.260635</td>
<td>5</td>
<td>NaN</td>
<td>tomates</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>Pandas</code> will refuse to aggregate because, for it, a missing value is not zero:</p>
<div id="083869fa" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="083869fa"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="083869fa-1"><a href="#083869fa-1" aria-hidden="true" tabindex="-1"></a>ventes[<span class="st">"client1"</span>] <span class="op">+</span> ventes[<span class="st">"client2"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>0    2.0
1    4.0
2    6.0
3    8.0
4    NaN
dtype: float64</code></pre>
</div>
</div>
<p>It is possible to remove missing values using <code>dropna()</code>. This method will remove all rows where there is at least one missing value.</p>
<div id="daca83df" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="daca83df"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="daca83df-1"><a href="#daca83df-1" aria-hidden="true" tabindex="-1"></a>ventes.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prix</th>
<th data-quarto-table-cell-role="th">client1</th>
<th data-quarto-table-cell-role="th">client2</th>
<th data-quarto-table-cell-role="th">produit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0.688088</td>
<td>2</td>
<td>2.0</td>
<td>yaourt</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.183628</td>
<td>3</td>
<td>3.0</td>
<td>pates</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.697141</td>
<td>4</td>
<td>4.0</td>
<td>riz</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In this case, we lose two rows. It is also possible to remove only the columns where there are missing values in a DataFrame with <code>dropna()</code> using the <code>subset</code> parameter.</p>
<div id="03016c8e" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="03016c8e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="03016c8e-1"><a href="#03016c8e-1" aria-hidden="true" tabindex="-1"></a>ventes.dropna(subset<span class="op">=</span>[<span class="st">"produit"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prix</th>
<th data-quarto-table-cell-role="th">client1</th>
<th data-quarto-table-cell-role="th">client2</th>
<th data-quarto-table-cell-role="th">produit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0.688088</td>
<td>2</td>
<td>2.0</td>
<td>yaourt</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.183628</td>
<td>3</td>
<td>3.0</td>
<td>pates</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.697141</td>
<td>4</td>
<td>4.0</td>
<td>riz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>0.260635</td>
<td>5</td>
<td>NaN</td>
<td>tomates</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This time we lose only one row, the one where <code>produit</code> is missing.</p>
<p><code>Pandas</code> provides the ability to impute missing values using the <code>fillna()</code> method. For example, if you think the missing values in <code>produit</code> are zeros, you can do:</p>
<div id="f32b9d0d" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="f32b9d0d"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="f32b9d0d-1"><a href="#f32b9d0d-1" aria-hidden="true" tabindex="-1"></a>ventes.dropna(subset<span class="op">=</span>[<span class="st">"produit"</span>]).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prix</th>
<th data-quarto-table-cell-role="th">client1</th>
<th data-quarto-table-cell-role="th">client2</th>
<th data-quarto-table-cell-role="th">produit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0.688088</td>
<td>2</td>
<td>2.0</td>
<td>yaourt</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.183628</td>
<td>3</td>
<td>3.0</td>
<td>pates</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.697141</td>
<td>4</td>
<td>4.0</td>
<td>riz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>0.260635</td>
<td>5</td>
<td>0.0</td>
<td>tomates</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>If you want to impute the median for the <code>client2</code> variable, you can slightly change this code by encapsulating the median calculation inside:</p>
<div id="e07276ab" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="e07276ab"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e07276ab-1"><a href="#e07276ab-1" aria-hidden="true" tabindex="-1"></a>(ventes[<span class="st">"client2"</span>].fillna(ventes[<span class="st">"client2"</span>].median()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>0    1.0
1    2.0
2    3.0
3    4.0
4    2.5
Name: client2, dtype: float64</code></pre>
</div>
</div>
<p>For real-world datasets, it is useful to use the <code>isna</code> (or <code>isnull</code>) method combined with <code>sum</code> or <code>mean</code> to understand the extent of missing values in a dataset.</p>
<div id="b341c95a" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="b341c95a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b341c95a-1"><a href="#b341c95a-1" aria-hidden="true" tabindex="-1"></a>df.isnull().mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>Autres transports international    0.919241
Autres transports                  0.721241
Energie                            0.036538
Industrie hors-énergie             0.036538
Agriculture                        0.001732
Routier                            0.000559
Résidentiel                        0.000168
Déchets                            0.000168
INSEE commune                      0.000000
Commune                            0.000000
CO2 biomasse hors-total            0.000000
Tertiaire                          0.000000
dtype: float64</code></pre>
</div>
</div>
<p>This preparatory step is useful for anticipating the question of imputation or filtering on missing values: are they missing at random or do they reflect an issue in data retrieval? The choices related to handling missing values are not neutral methodological choices. <code>Pandas</code> provides the technical tools to do this, but the legitimacy and relevance of these choices are specific to each dataset. Data explorations aim to detect clues to make an informed decision.</p>
</section>
</section>
<section id="quick-graphical-representations" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Quick graphical representations</h1>
<p>Numerical tables are certainly useful for understanding the structure of a dataset, but their dense aspect makes them difficult to grasp. Having a simple graph can be useful to visualize the distribution of the data at a glance and thus understand the normality of an observation.</p>
<p><code>Pandas</code> includes basic graphical methods to meet this need. They are practical for quickly producing a graph, especially after complex data manipulation operations. We will delve deeper into the issue of data visualizations in the <a href="../../content/visualisation.qmd">Communicate</a> section.</p>
<p>You can apply the <code>plot()</code> method directly to a <code>Series</code>:</p>
<div id="9b03d3bf" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="9b03d3bf"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="9b03d3bf-1"><a href="#9b03d3bf-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Déchets"</span>].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="02_pandas_intro_files/figure-html/cell-73-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="02_pandas_intro_files/figure-html/cell-73-output-1.png" width="600" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The equivalent code with <code>matplotlib</code> would be:</p>
<div id="64d1f092" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="64d1f092"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="64d1f092-1"><a href="#64d1f092-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="64d1f092-2"><a href="#64d1f092-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="64d1f092-3"><a href="#64d1f092-3" aria-hidden="true" tabindex="-1"></a>plt.plot(df.index, df[<span class="st">"Déchets"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="02_pandas_intro_files/figure-html/cell-74-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="02_pandas_intro_files/figure-html/cell-74-output-1.png" width="600" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>By default, the obtained visualization is a series. This is not necessarily what is expected since it only makes sense for time series. As a data scientist working with microdata, you are more often interested in a histogram to get an idea of the data distribution. To do this, simply add the argument <code>kind = 'hist'</code>:</p>
<div id="187c34bf" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="187c34bf"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="187c34bf-1"><a href="#187c34bf-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Déchets"</span>].hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="02_pandas_intro_files/figure-html/cell-75-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="02_pandas_intro_files/figure-html/cell-75-output-1.png" width="592" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>With data that has a non-normalized distribution, which represents many real-world variables, histograms are generally not very informative. The log can be a solution to bring some extreme values to a comparable scale:</p>
<div id="991cea3c" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="991cea3c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="991cea3c-1"><a href="#991cea3c-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Déchets"</span>].plot(kind<span class="op">=</span><span class="st">"hist"</span>, logy<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="02_pandas_intro_files/figure-html/cell-76-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="02_pandas_intro_files/figure-html/cell-76-output-1.png" width="591" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The output is a <code>matplotlib</code> object. Customizing these figures is thus possible (and even desirable because the default <code>matplotlib</code> graphs are quite basic). However, this is a quick method for constructing figures that require work for a finalized visualization. This involves thorough work on the <code>matplotlib</code> object or using a higher-level library for graphical representation (<code>seaborn</code>, <code>plotnine</code>, <code>plotly</code>, etc.).</p>
<p>The part of this course dedicated to data visualization will briefly present these different visualization paradigms. These do not exempt you from using common sense in choosing the graph used to represent a descriptive statistic (see <a href="https://ssphub.netlify.app/talk/2024-02-29-mauviere/">this conference by Eric Mauvière</a>).</p>
</section>
<section id="synthesis-exercise" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Synthesis exercise</h1>
<p>This exercise synthesizes several steps of data preparation and exploration to better understand the structure of the phenomenon we want to study, namely carbon emissions in France.</p>
<p>It is recommended to start from a clean session (in a notebook, you should do <code>Restart Kernel</code>) to avoid an environment polluted by other objects. You can then run the following code to get the necessary base:</p>
<div id="91eb66e4" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="91eb66e4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="91eb66e4-1"><a href="#91eb66e4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="91eb66e4-2"><a href="#91eb66e4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="91eb66e4-3"><a href="#91eb66e4-3" aria-hidden="true" tabindex="-1"></a>emissions <span class="op">=</span> pd.read_csv(</span>
<span id="91eb66e4-4"><a href="#91eb66e4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert"</span></span>
<span id="91eb66e4-5"><a href="#91eb66e4-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="91eb66e4-6"><a href="#91eb66e4-6" aria-hidden="true" tabindex="-1"></a>emissions.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2: Discovering the Pandas Verbs for Data Manipulation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>First, let’s get familiar with operations on columns.</p>
<ol type="1">
<li>Create a <code>DataFrame</code> <code>emissions_copy</code> keeping only the columns <code>INSEE commune</code>, <code>Commune</code>, <code>Autres transports</code>, and <code>Autres transports international</code>.</li>
</ol>
<details>
<summary>
Hint for this question
</summary>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/select_pandas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/select_pandas.png" class="img-fluid" data-fig-width="50%"></a></p>
</details>
<ol start="2" type="1">
<li>Since the variable names are not practical, rename them as follows:
<ul>
<li><code>INSEE commune</code> <span class="math inline">\(\to\)</span> <code>code_insee</code></li>
<li><code>Autres transports</code> <span class="math inline">\(\to\)</span> <code>transports</code></li>
<li><code>Autres transports international</code> <span class="math inline">\(\to\)</span> <code>transports_international</code></li>
</ul></li>
</ol>
<details>
<summary>
Hint for this question
</summary>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/rename_pandas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/rename_pandas.png" class="img-fluid" data-fig-width="50%"></a></p>
</details>
<ol start="3" type="1">
<li><p>For simplicity, replace missing values (<code>NA</code>) with 0. Use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.fillna.html"><code>fillna</code></a> method to transform missing values into 0.</p></li>
<li><p>Create the following variables:</p>
<ul>
<li><code>dep</code>: the department. This can be created using the first two characters of <code>code_insee</code> by applying the <code>str</code> method;</li>
<li><code>transports_total</code>: the emissions of the transport sector (sum of the two variables).</li>
</ul></li>
</ol>
<details>
<summary>
Hint for this question
</summary>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/mutate_pandas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/mutate_pandas.png" class="img-fluid" data-fig-width="50%"></a></p>
</details>
<ol start="5" type="1">
<li>Order the data from the biggest polluter to the smallest, then order the data from the biggest polluter to the smallest by department (from 01 to 95).</li>
</ol>
<details>
<summary>
Hint for this question
</summary>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/arrange_pandas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/arrange_pandas.png" class="img-fluid" data-fig-width="50%"></a></p>
</details>
<ol start="6" type="1">
<li>Keep only the municipalities belonging to departments 13 or 31. Order these municipalities from the biggest polluter to the smallest.</li>
</ol>
<details>
<summary>
Hint for this question
</summary>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/filter_pandas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/filter_pandas.png" class="img-fluid" data-fig-width="50%"></a></p>
</details>
<p>Return to the initial <code>emission</code> dataset.</p>
<ol start="7" type="1">
<li><p>Calculate the total emissions by sector. Calculate the share of each sector in total emissions. Convert the volumes to tons before displaying the results.</p></li>
<li><p>Calculate the total emissions for each municipality after imputing missing values to 0. Keep the top 100 emitting municipalities. Calculate the share of each sector in this emission. Understand the factors that may explain this ranking.</p></li>
</ol>
<details>
<summary>
Help if you are struggling with question 8
</summary>
<p>Play with the <code>axis</code> parameter when constructing an aggregate statistic.</p>
</details>
</div>
</div>
</div>
<p>In question 5, when the communes are ordered exclusively on the basis of the variable <code>transport_total</code>, the result is as follows:</p>
<div id="51664b45" class="cell" data-execution_count="78">
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">code_insee</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">transports</th>
<th data-quarto-table-cell-role="th">transports_international</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">transports_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">31108</td>
<td>77291</td>
<td>LE MESNIL-AMELOT</td>
<td>133834.090767</td>
<td>3.303394e+06</td>
<td>77</td>
<td>3.437228e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31099</td>
<td>77282</td>
<td>MAUREGARD</td>
<td>133699.072712</td>
<td>3.303394e+06</td>
<td>77</td>
<td>3.437093e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31111</td>
<td>77294</td>
<td>MITRY-MORY</td>
<td>89815.529858</td>
<td>2.202275e+06</td>
<td>77</td>
<td>2.292090e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Question 6 gives us this classification:</p>
<div id="4e3d75db" class="cell" data-execution_count="79">
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">code_insee</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">transports</th>
<th data-quarto-table-cell-role="th">transports_international</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">transports_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4438</td>
<td>13096</td>
<td>SAINTES-MARIES-DE-LA-MER</td>
<td>271182.758578</td>
<td>0.000000</td>
<td>13</td>
<td>271182.758578</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4397</td>
<td>13054</td>
<td>MARIGNANE</td>
<td>245375.418650</td>
<td>527360.799265</td>
<td>13</td>
<td>772736.217915</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11684</td>
<td>31069</td>
<td>BLAGNAC</td>
<td>210157.688544</td>
<td>403717.366279</td>
<td>31</td>
<td>613875.054823</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In question 7, the resulting table looks like this</p>
<div id="86e7f590" class="cell" data-execution_count="80">
<div class="cell-output cell-output-display" data-execution_count="80">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">secteur</th>
<th data-quarto-table-cell-role="th">emissions</th>
<th data-quarto-table-cell-role="th">emissions (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Routier</td>
<td>126493.0</td>
<td>24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>Agriculture</td>
<td>87910.0</td>
<td>17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Industrie hors-énergie</td>
<td>83574.0</td>
<td>16.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Résidentiel</td>
<td>63841.0</td>
<td>12.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>CO2 biomasse hors-total</td>
<td>63519.0</td>
<td>12.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e5f1b810" class="cell" data-execution_count="81">
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4382</td>
<td>13039</td>
<td>FOS-SUR-MER</td>
<td>305.092893</td>
<td>1893.383189</td>
<td>1.722723e+04</td>
<td>50891.367548</td>
<td>275500.374439</td>
<td>2.296711e+06</td>
<td>6.765119e+06</td>
<td>9466.388806</td>
<td>74631.401993</td>
<td>42068.140058</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22671</td>
<td>59183</td>
<td>DUNKERQUE</td>
<td>811.390947</td>
<td>3859.548994</td>
<td>3.327586e+05</td>
<td>71922.181764</td>
<td>23851.780482</td>
<td>1.934988e+06</td>
<td>5.997333e+06</td>
<td>113441.727216</td>
<td>94337.865738</td>
<td>70245.678455</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4398</td>
<td>13056</td>
<td>MARTIGUES</td>
<td>855.299300</td>
<td>2712.749275</td>
<td>3.043476e+04</td>
<td>35925.561051</td>
<td>44597.426397</td>
<td>1.363402e+06</td>
<td>2.380185e+06</td>
<td>22530.797276</td>
<td>84624.862481</td>
<td>44394.822725</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30560</td>
<td>76476</td>
<td>PORT-JEROME-SUR-SEINE</td>
<td>2736.931327</td>
<td>121.160849</td>
<td>2.086403e+04</td>
<td>22846.964780</td>
<td>78.941581</td>
<td>1.570236e+06</td>
<td>2.005643e+06</td>
<td>21072.566129</td>
<td>9280.824961</td>
<td>15270.357772</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31108</td>
<td>77291</td>
<td>LE MESNIL-AMELOT</td>
<td>782.183307</td>
<td>133834.090767</td>
<td>3.303394e+06</td>
<td>3330.404124</td>
<td>111.613197</td>
<td>8.240952e+02</td>
<td>2.418925e+03</td>
<td>1404.400153</td>
<td>11712.541682</td>
<td>13680.471909</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30056</td>
<td>74281</td>
<td>THONON-LES-BAINS</td>
<td>382.591429</td>
<td>145.151526</td>
<td>0.000000e+00</td>
<td>144503.815623</td>
<td>21539.524775</td>
<td>2.776024e+03</td>
<td>1.942086e+05</td>
<td>44545.339492</td>
<td>25468.667604</td>
<td>19101.562585</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33954</td>
<td>86194</td>
<td>POITIERS</td>
<td>2090.630127</td>
<td>20057.297403</td>
<td>2.183418e+04</td>
<td>95519.054766</td>
<td>13107.640015</td>
<td>5.771021e+03</td>
<td>1.693938e+04</td>
<td>110218.156827</td>
<td>91921.787626</td>
<td>73121.300634</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1918</td>
<td>06019</td>
<td>BLAUSASC</td>
<td>194.382622</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>978.840592</td>
<td>208.084792</td>
<td>2.260375e+02</td>
<td>4.362880e+05</td>
<td>538.816198</td>
<td>3949.838612</td>
<td>740.022785</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27607</td>
<td>68253</td>
<td>OTTMARSHEIM</td>
<td>506.238288</td>
<td>679.598495</td>
<td>3.526748e+01</td>
<td>4396.853500</td>
<td>237.508651</td>
<td>1.172570e+03</td>
<td>4.067258e+05</td>
<td>3220.875864</td>
<td>19317.977050</td>
<td>4921.144781</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28643</td>
<td>71076</td>
<td>CHALON-SUR-SAONE</td>
<td>1344.584721</td>
<td>1336.547546</td>
<td>6.558180e+01</td>
<td>77082.218324</td>
<td>570.662275</td>
<td>1.016933e+04</td>
<td>2.075650e+05</td>
<td>77330.230592</td>
<td>29020.646500</td>
<td>34997.262920</td>
</tr>
</tbody>
</table>

<p>100 rows × 12 columns</p>
</div>
</div>
</div>
<p>At the end of question 8, we better understand the factors that can explain high emissions at the municipal level. If we look at the top three emitting municipalities, we can see that they are cities with refineries:</p>
<div id="87e1ade5" class="cell" data-execution_count="84">
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Part Autres transports</th>
<th data-quarto-table-cell-role="th">Part Autres transports international</th>
<th data-quarto-table-cell-role="th">Part CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Part Déchets</th>
<th data-quarto-table-cell-role="th">Part Energie</th>
<th data-quarto-table-cell-role="th">Part Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Part Résidentiel</th>
<th data-quarto-table-cell-role="th">Part Routier</th>
<th data-quarto-table-cell-role="th">Part Tertiaire</th>
<th data-quarto-table-cell-role="th">Part total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4382</td>
<td>13039</td>
<td>FOS-SUR-MER</td>
<td>305.092893</td>
<td>1893.383189</td>
<td>17227.234585</td>
<td>50891.367548</td>
<td>275500.374439</td>
<td>2.296711e+06</td>
<td>6.765119e+06</td>
<td>9466.388806</td>
<td>...</td>
<td>0.019860</td>
<td>0.180696</td>
<td>0.533799</td>
<td>2.889719</td>
<td>24.090160</td>
<td>70.959215</td>
<td>0.099293</td>
<td>0.782807</td>
<td>0.441252</td>
<td>100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22671</td>
<td>59183</td>
<td>DUNKERQUE</td>
<td>811.390947</td>
<td>3859.548994</td>
<td>332758.630269</td>
<td>71922.181764</td>
<td>23851.780482</td>
<td>1.934988e+06</td>
<td>5.997333e+06</td>
<td>113441.727216</td>
<td>...</td>
<td>0.044652</td>
<td>3.849791</td>
<td>0.832091</td>
<td>0.275949</td>
<td>22.386499</td>
<td>69.385067</td>
<td>1.312444</td>
<td>1.091425</td>
<td>0.812695</td>
<td>100.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4398</td>
<td>13056</td>
<td>MARTIGUES</td>
<td>855.299300</td>
<td>2712.749275</td>
<td>30434.762405</td>
<td>35925.561051</td>
<td>44597.426397</td>
<td>1.363402e+06</td>
<td>2.380185e+06</td>
<td>22530.797276</td>
<td>...</td>
<td>0.067655</td>
<td>0.759035</td>
<td>0.895975</td>
<td>1.112249</td>
<td>34.002905</td>
<td>59.361219</td>
<td>0.561912</td>
<td>2.110523</td>
<td>1.107196</td>
<td>100.0</td>
</tr>
</tbody>
</table>

<p>3 rows × 24 columns</p>
</div>
</div>
</div>
<p>Thanks to our minimal explorations with <code>Pandas</code>, we see that this dataset provides information about the nature of the French productive fabric and the environmental consequences of certain activities.</p>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<ul>
<li><p>The site <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html">pandas.pydata</a> serves as a reference</p></li>
<li><p>The book <code>Modern Pandas</code> by Tom Augspurger: https://tomaugspurger.github.io/modern-1-intro.html</p></li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-mckinney2012python" class="csl-entry" role="listitem">
McKinney, Wes. 2012. <em>Python for Data Analysis: Data Wrangling with Pandas, NumPy, and IPython</em>. " O’Reilly Media, Inc.".
</div>
<div id="ref-wickham2023r" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, and Garrett Grolemund. 2023. <em>R for Data Science</em>. " O’Reilly Media, Inc.".
</div>
</div>
<section id="informations-additionnelles" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="informations-additionnelles">Informations additionnelles</h2>
<details>
<summary>
<p><i class="fa-brands fa-python" aria-label="python"></i> environment files have been tested on.</p>
</summary>
<p>Latest built version: 2025-02-08</p>
<p>Python version used:</p>
<div id="874181ef" class="cell" data-execution_count="86">
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>'3.12.6 | packaged by conda-forge | (main, Sep 30 2024, 18:08:52) [GCC 13.3.0]'</code></pre>
</div>
</div>
<div class="git-details">
<div class="pip-freeze">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">affine</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiobotocore</td>
<td style="text-align: left;">2.15.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiohappyeyeballs</td>
<td style="text-align: left;">2.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiohttp</td>
<td style="text-align: left;">3.10.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aioitertools</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiosignal</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alembic</td>
<td style="text-align: left;">1.13.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">altair</td>
<td style="text-align: left;">5.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aniso8601</td>
<td style="text-align: left;">9.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">annotated-types</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">anyio</td>
<td style="text-align: left;">4.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">appdirs</td>
<td style="text-align: left;">1.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">archspec</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attrs</td>
<td style="text-align: left;">24.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">babel</td>
<td style="text-align: left;">2.17.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bcrypt</td>
<td style="text-align: left;">4.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">beautifulsoup4</td>
<td style="text-align: left;">4.12.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">black</td>
<td style="text-align: left;">24.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blinker</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blis</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bokeh</td>
<td style="text-align: left;">3.5.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">boltons</td>
<td style="text-align: left;">24.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">boto3</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">botocore</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">branca</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brotli</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cachetools</td>
<td style="text-align: left;">5.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cartiflette</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cartopy</td>
<td style="text-align: left;">0.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">catalogue</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cattrs</td>
<td style="text-align: left;">24.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">certifi</td>
<td style="text-align: left;">2024.8.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cffi</td>
<td style="text-align: left;">1.17.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chromedriver-autoinstaller</td>
<td style="text-align: left;">0.6.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">click</td>
<td style="text-align: left;">8.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">click-plugins</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cligj</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloudpathlib</td>
<td style="text-align: left;">0.20.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">colorama</td>
<td style="text-align: left;">0.4.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">comm</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">commonmark</td>
<td style="text-align: left;">0.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda</td>
<td style="text-align: left;">24.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda-libmamba-solver</td>
<td style="text-align: left;">24.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda-package-handling</td>
<td style="text-align: left;">2.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda_package_streaming</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">confection</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contextily</td>
<td style="text-align: left;">1.6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">contourpy</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cryptography</td>
<td style="text-align: left;">43.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cycler</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cymem</td>
<td style="text-align: left;">2.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">cytoolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dask</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">dask-expr</td>
<td style="text-align: left;">1.1.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">databricks-sdk</td>
<td style="text-align: left;">0.33.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dataclasses-json</td>
<td style="text-align: left;">0.6.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">debugpy</td>
<td style="text-align: left;">1.8.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">decorator</td>
<td style="text-align: left;">5.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Deprecated</td>
<td style="text-align: left;">1.2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">diskcache</td>
<td style="text-align: left;">5.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distributed</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">distro</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">docker</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">duckdb</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">en_core_web_sm</td>
<td style="text-align: left;">3.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">entrypoints</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">et_xmlfile</td>
<td style="text-align: left;">2.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">exceptiongroup</td>
<td style="text-align: left;">1.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">executing</td>
<td style="text-align: left;">2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fastexcel</td>
<td style="text-align: left;">0.11.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fastjsonschema</td>
<td style="text-align: left;">2.21.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fiona</td>
<td style="text-align: left;">1.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flask</td>
<td style="text-align: left;">3.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">folium</td>
<td style="text-align: left;">0.17.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fontawesomefree</td>
<td style="text-align: left;">6.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fonttools</td>
<td style="text-align: left;">4.54.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fr_core_news_sm</td>
<td style="text-align: left;">3.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">frozendict</td>
<td style="text-align: left;">2.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frozenlist</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geographiclib</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopandas</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geoplot</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopy</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gitdb</td>
<td style="text-align: left;">4.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GitPython</td>
<td style="text-align: left;">3.1.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">google-auth</td>
<td style="text-align: left;">2.35.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphene</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphql-core</td>
<td style="text-align: left;">3.2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphql-relay</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphviz</td>
<td style="text-align: left;">0.20.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">great-tables</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">greenlet</td>
<td style="text-align: left;">3.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">gunicorn</td>
<td style="text-align: left;">22.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">h11</td>
<td style="text-align: left;">0.14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">h2</td>
<td style="text-align: left;">4.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hpack</td>
<td style="text-align: left;">4.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">0.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">httpcore</td>
<td style="text-align: left;">1.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">httpx</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">httpx-sse</td>
<td style="text-align: left;">0.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">hyperframe</td>
<td style="text-align: left;">6.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">idna</td>
<td style="text-align: left;">3.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">imageio</td>
<td style="text-align: left;">2.37.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">importlib_metadata</td>
<td style="text-align: left;">8.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">importlib_resources</td>
<td style="text-align: left;">6.4.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inflate64</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ipykernel</td>
<td style="text-align: left;">6.29.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipython</td>
<td style="text-align: left;">8.28.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">itsdangerous</td>
<td style="text-align: left;">2.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jedi</td>
<td style="text-align: left;">0.19.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jinja2</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jmespath</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">joblib</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonpatch</td>
<td style="text-align: left;">1.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonpointer</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonschema</td>
<td style="text-align: left;">4.23.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonschema-specifications</td>
<td style="text-align: left;">2024.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter-cache</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter_client</td>
<td style="text-align: left;">8.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter_core</td>
<td style="text-align: left;">5.7.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">kaleido</td>
<td style="text-align: left;">0.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kiwisolver</td>
<td style="text-align: left;">1.4.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">langchain</td>
<td style="text-align: left;">0.3.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langchain-community</td>
<td style="text-align: left;">0.3.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">langchain-core</td>
<td style="text-align: left;">0.3.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langchain-text-splitters</td>
<td style="text-align: left;">0.3.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">langcodes</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langsmith</td>
<td style="text-align: left;">0.1.147</td>
</tr>
<tr class="even">
<td style="text-align: left;">language_data</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lazy_loader</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">libmambapy</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">locket</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">loguru</td>
<td style="text-align: left;">0.7.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;">5.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lz4</td>
<td style="text-align: left;">4.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">1.3.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">mamba</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mapclassify</td>
<td style="text-align: left;">2.8.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">marisa-trie</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Markdown</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">markdown-it-py</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MarkupSafe</td>
<td style="text-align: left;">2.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">marshmallow</td>
<td style="text-align: left;">3.26.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">matplotlib</td>
<td style="text-align: left;">3.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">matplotlib-inline</td>
<td style="text-align: left;">0.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mdurl</td>
<td style="text-align: left;">0.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">menuinst</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mercantile</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mizani</td>
<td style="text-align: left;">0.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mlflow</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mlflow-skinny</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">msgpack</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">multidict</td>
<td style="text-align: left;">6.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">multivolumefile</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">munkres</td>
<td style="text-align: left;">1.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">murmurhash</td>
<td style="text-align: left;">1.0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">mypy-extensions</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">narwhals</td>
<td style="text-align: left;">1.25.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbclient</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nbformat</td>
<td style="text-align: left;">5.10.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">nest_asyncio</td>
<td style="text-align: left;">1.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">networkx</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">nltk</td>
<td style="text-align: left;">3.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numpy</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">opencv-python-headless</td>
<td style="text-align: left;">4.10.0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">openpyxl</td>
<td style="text-align: left;">3.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-api</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">opentelemetry-sdk</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-semantic-conventions</td>
<td style="text-align: left;">0.37b0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">orjson</td>
<td style="text-align: left;">3.10.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome</td>
<td style="text-align: left;">1.3.0.post0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OWSLib</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">packaging</td>
<td style="text-align: left;">24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pandas</td>
<td style="text-align: left;">2.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">paramiko</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parso</td>
<td style="text-align: left;">0.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">partd</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pathspec</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">patsy</td>
<td style="text-align: left;">0.5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pebble</td>
<td style="text-align: left;">5.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pexpect</td>
<td style="text-align: left;">4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pickleshare</td>
<td style="text-align: left;">0.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pillow</td>
<td style="text-align: left;">10.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pip</td>
<td style="text-align: left;">24.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">platformdirs</td>
<td style="text-align: left;">4.3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">5.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotnine</td>
<td style="text-align: left;">0.13.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pluggy</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">polars</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">preshed</td>
<td style="text-align: left;">3.0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">prometheus_client</td>
<td style="text-align: left;">0.21.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prometheus_flask_exporter</td>
<td style="text-align: left;">0.23.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">prompt_toolkit</td>
<td style="text-align: left;">3.0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">protobuf</td>
<td style="text-align: left;">4.25.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">psutil</td>
<td style="text-align: left;">6.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ptyprocess</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pure_eval</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">py7zr</td>
<td style="text-align: left;">0.20.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyarrow</td>
<td style="text-align: left;">17.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyarrow-hotfix</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyasn1</td>
<td style="text-align: left;">0.6.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyasn1_modules</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pybcj</td>
<td style="text-align: left;">1.0.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycosat</td>
<td style="text-align: left;">0.6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycparser</td>
<td style="text-align: left;">2.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycryptodomex</td>
<td style="text-align: left;">3.21.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic</td>
<td style="text-align: left;">2.10.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pydantic_core</td>
<td style="text-align: left;">2.27.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic-settings</td>
<td style="text-align: left;">2.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pygments</td>
<td style="text-align: left;">2.18.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyNaCl</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pynsee</td>
<td style="text-align: left;">0.1.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyogrio</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyOpenSSL</td>
<td style="text-align: left;">24.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyparsing</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyppmd</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyproj</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyshp</td>
<td style="text-align: left;">2.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PySocks</td>
<td style="text-align: left;">1.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-dateutil</td>
<td style="text-align: left;">2.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-dotenv</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-magic</td>
<td style="text-align: left;">0.4.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">pytz</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyu2f</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pywaffle</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PyYAML</td>
<td style="text-align: left;">6.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyzmq</td>
<td style="text-align: left;">26.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyzstd</td>
<td style="text-align: left;">0.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">querystring_parser</td>
<td style="text-align: left;">1.2.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rasterio</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">referencing</td>
<td style="text-align: left;">0.36.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">regex</td>
<td style="text-align: left;">2024.9.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests</td>
<td style="text-align: left;">2.32.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests-cache</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests-toolbelt</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">retrying</td>
<td style="text-align: left;">1.3.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">rich</td>
<td style="text-align: left;">13.9.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rpds-py</td>
<td style="text-align: left;">0.22.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsa</td>
<td style="text-align: left;">4.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rtree</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruamel.yaml</td>
<td style="text-align: left;">0.18.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ruamel.yaml.clib</td>
<td style="text-align: left;">0.2.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">s3fs</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s3transfer</td>
<td style="text-align: left;">0.10.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">scikit-image</td>
<td style="text-align: left;">0.24.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scikit-learn</td>
<td style="text-align: left;">1.5.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">scipy</td>
<td style="text-align: left;">1.13.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">seaborn</td>
<td style="text-align: left;">0.13.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">selenium</td>
<td style="text-align: left;">4.28.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setuptools</td>
<td style="text-align: left;">74.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">shapely</td>
<td style="text-align: left;">2.0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shellingham</td>
<td style="text-align: left;">1.5.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">six</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smart-open</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">smmap</td>
<td style="text-align: left;">5.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sniffio</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">sortedcontainers</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">soupsieve</td>
<td style="text-align: left;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy</td>
<td style="text-align: left;">3.8.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy-legacy</td>
<td style="text-align: left;">3.0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy-loggers</td>
<td style="text-align: left;">1.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SQLAlchemy</td>
<td style="text-align: left;">2.0.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">sqlparse</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">srsly</td>
<td style="text-align: left;">2.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">stack-data</td>
<td style="text-align: left;">0.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">statsmodels</td>
<td style="text-align: left;">0.14.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">tabulate</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tblib</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tenacity</td>
<td style="text-align: left;">9.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">texttable</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">thinc</td>
<td style="text-align: left;">8.3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">threadpoolctl</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tifffile</td>
<td style="text-align: left;">2025.1.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">toolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">topojson</td>
<td style="text-align: left;">1.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tornado</td>
<td style="text-align: left;">6.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">tqdm</td>
<td style="text-align: left;">4.66.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">traitlets</td>
<td style="text-align: left;">5.14.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">trio</td>
<td style="text-align: left;">0.28.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trio-websocket</td>
<td style="text-align: left;">0.11.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">truststore</td>
<td style="text-align: left;">0.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typer</td>
<td style="text-align: left;">0.15.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">typing_extensions</td>
<td style="text-align: left;">4.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typing-inspect</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tzdata</td>
<td style="text-align: left;">2024.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unidecode</td>
<td style="text-align: left;">1.3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">url-normalize</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urllib3</td>
<td style="text-align: left;">1.26.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">uv</td>
<td style="text-align: left;">0.5.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wasabi</td>
<td style="text-align: left;">1.1.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">weasel</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">webdriver-manager</td>
<td style="text-align: left;">4.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">websocket-client</td>
<td style="text-align: left;">1.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Werkzeug</td>
<td style="text-align: left;">3.0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wheel</td>
<td style="text-align: left;">0.44.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">wordcloud</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">wsproto</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xgboost</td>
<td style="text-align: left;">2.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">xlrd</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xyzservices</td>
<td style="text-align: left;">2024.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">yarl</td>
<td style="text-align: left;">1.13.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellowbrick</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">zict</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zipp</td>
<td style="text-align: left;">3.20.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">zstandard</td>
<td style="text-align: left;">0.23.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<details>
<summary>
<p>View file history <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></p>
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb34" data-startfrom="1936" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1935;"><span id="cb34-1936"><a href="#cb34-1936" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Ce fichier a été modifié __</span><span class="sc">${</span>table_commit<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">__ fois depuis sa création le </span><span class="sc">${</span>creation_string<span class="sc">}</span><span class="vs"> (dernière modification le </span><span class="sc">${</span>last_modification_string<span class="sc">}</span><span class="vs">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb35" data-startfrom="1943" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1942;"><span id="cb35-1943"><a href="#cb35-1943" aria-hidden="true" tabindex="-1"></a>creation <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb35-1944"><a href="#cb35-1944" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb35-1945"><a href="#cb35-1945" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-1946"><a href="#cb35-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1947"><a href="#cb35-1947" aria-hidden="true" tabindex="-1"></a>last_modification <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb35-1948"><a href="#cb35-1948" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb35-1949"><a href="#cb35-1949" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-1950"><a href="#cb35-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1951"><a href="#cb35-1951" aria-hidden="true" tabindex="-1"></a>creation_string <span class="op">=</span> creation<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb35-1952"><a href="#cb35-1952" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb35-1953"><a href="#cb35-1953" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb35-1954"><a href="#cb35-1954" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb35-1955"><a href="#cb35-1955" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-1956"><a href="#cb35-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1957"><a href="#cb35-1957" aria-hidden="true" tabindex="-1"></a>last_modification_string <span class="op">=</span> last_modification<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb35-1958"><a href="#cb35-1958" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb35-1959"><a href="#cb35-1959" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb35-1960"><a href="#cb35-1960" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb35-1961"><a href="#cb35-1961" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb36" data-startfrom="1967" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1966;"><span id="cb36-1967"><a href="#cb36-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_table<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb37" data-startfrom="1972" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1971;"><span id="cb37-1972"><a href="#cb37-1972" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_plot<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<table class="commit-table" border="1">
<thead>
<tr>
<th>
SHA
</th>
<th>
Date
</th>
<th>
Author
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/488780a">488780a</a>
</td>
<td>
2024-09-25 14:32:16
</td>
<td>
Lino Galiana
</td>
<td>
Change badge (#556)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4404ec1">4404ec1</a>
</td>
<td>
2024-09-21 18:28:42
</td>
<td>
lgaliana
</td>
<td>
Back to eval true
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/72d44dd">72d44dd</a>
</td>
<td>
2024-09-21 12:50:38
</td>
<td>
lgaliana
</td>
<td>
Force build for pandas chapters
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f4367f7">f4367f7</a>
</td>
<td>
2024-08-08 11:44:37
</td>
<td>
Lino Galiana
</td>
<td>
Traduction chapitre suite Pandas avec un profile (#534)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/580cba7">580cba7</a>
</td>
<td>
2024-08-07 18:59:35
</td>
<td>
Lino Galiana
</td>
<td>
Multilingual version as quarto profile (#533)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/72f42bb">72f42bb</a>
</td>
<td>
2024-07-25 19:06:38
</td>
<td>
Lino Galiana
</td>
<td>
Language message on notebooks (#529)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/195dc9e">195dc9e</a>
</td>
<td>
2024-07-25 11:59:19
</td>
<td>
linogaliana
</td>
<td>
Switch language button
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/6ca4c1c">6ca4c1c</a>
</td>
<td>
2024-07-08 17:24:11
</td>
<td>
Lino Galiana
</td>
<td>
Traduction du premier chapitre Pandas (#520)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/ce13b91">ce13b91</a>
</td>
<td>
2024-07-07 21:14:21
</td>
<td>
Lino Galiana
</td>
<td>
Lua filter for callouts (both html AND ipynb output format) !! 🎉 (#511)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a987fea">a987fea</a>
</td>
<td>
2024-06-23 18:43:06
</td>
<td>
Lino Galiana
</td>
<td>
Fix broken links (#506)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/91bfa52">91bfa52</a>
</td>
<td>
2024-05-27 15:01:32
</td>
<td>
Lino Galiana
</td>
<td>
Restructuration partie geopandas (#500)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/e0d615e">e0d615e</a>
</td>
<td>
2024-05-03 11:15:29
</td>
<td>
Lino Galiana
</td>
<td>
Restructure la partie Pandas (#497)
</td>
</tr>
</tbody>
</table>
</details>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb38" data-startfrom="1983" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1982;"><span id="cb38-1983"><a href="#cb38-1983" aria-hidden="true" tabindex="-1"></a>git_history_table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb38-1984"><a href="#cb38-1984" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">,</span></span>
<span id="cb38-1985"><a href="#cb38-1985" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb38-1986"><a href="#cb38-1986" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb38-1987"><a href="#cb38-1987" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SHA</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`[</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>github_repo<span class="sc">}</span><span class="vs">/commit/</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb38-1988"><a href="#cb38-1988" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Description</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">replacePullRequestPattern</span>(x<span class="op">,</span> github_repo)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb38-1989"><a href="#cb38-1989" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*Date: x =&gt; x.toLocaleString("fr", {</span></span>
<span id="cb38-1990"><a href="#cb38-1990" aria-hidden="true" tabindex="-1"></a><span class="co">        "month": "numeric",</span></span>
<span id="cb38-1991"><a href="#cb38-1991" aria-hidden="true" tabindex="-1"></a><span class="co">        "day": "numeric",</span></span>
<span id="cb38-1992"><a href="#cb38-1992" aria-hidden="true" tabindex="-1"></a><span class="co">        "year": "numeric"</span></span>
<span id="cb38-1993"><a href="#cb38-1993" aria-hidden="true" tabindex="-1"></a><span class="co">        })</span></span>
<span id="cb38-1994"><a href="#cb38-1994" aria-hidden="true" tabindex="-1"></a><span class="co">      */</span></span>
<span id="cb38-1995"><a href="#cb38-1995" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb38-1996"><a href="#cb38-1996" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-1997"><a href="#cb38-1997" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb39" data-startfrom="2003" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2002;"><span id="cb39-2003"><a href="#cb39-2003" aria-hidden="true" tabindex="-1"></a>git_history_plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb39-2004"><a href="#cb39-2004" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb39-2005"><a href="#cb39-2005" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"royalblue"</span>})<span class="op">,</span></span>
<span id="cb39-2006"><a href="#cb39-2006" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb39-2007"><a href="#cb39-2007" aria-hidden="true" tabindex="-1"></a>          table_commit<span class="op">,</span></span>
<span id="cb39-2008"><a href="#cb39-2008" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">pointerX</span>({<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>}))<span class="op">,</span></span>
<span id="cb39-2009"><a href="#cb39-2009" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(table_commit<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"royalblue"</span>})</span>
<span id="cb39-2010"><a href="#cb39-2010" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb39-2011"><a href="#cb39-2011" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb40" data-startfrom="2017" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2016;"><span id="cb40-2017"><a href="#cb40-2017" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">replacePullRequestPattern</span>(inputString<span class="op">,</span> githubRepo) {</span>
<span id="cb40-2018"><a href="#cb40-2018" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use a regular expression to match the pattern #digit</span></span>
<span id="cb40-2019"><a href="#cb40-2019" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> pattern <span class="op">=</span> <span class="ss">/#</span><span class="sc">(\d+)</span><span class="ss">/g</span><span class="op">;</span></span>
<span id="cb40-2020"><a href="#cb40-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2021"><a href="#cb40-2021" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Replace the pattern with ${github_repo}/pull/#digit</span></span>
<span id="cb40-2022"><a href="#cb40-2022" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> replacedString <span class="op">=</span> inputString<span class="op">.</span><span class="fu">replace</span>(pattern<span class="op">,</span> <span class="st">'[#$1]('</span> <span class="op">+</span> githubRepo <span class="op">+</span> <span class="st">'/pull/$1)'</span>)<span class="op">;</span></span>
<span id="cb40-2023"><a href="#cb40-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2024"><a href="#cb40-2024" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replacedString<span class="op">;</span></span>
<span id="cb40-2025"><a href="#cb40-2025" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb41" data-startfrom="2031" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2030;"><span id="cb41-2031"><a href="#cb41-2031" aria-hidden="true" tabindex="-1"></a>github_repo <span class="op">=</span> <span class="st">"https://github.com/linogaliana/python-datascientist"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb42" data-startfrom="2036" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2035;"><span id="cb42-2036"><a href="#cb42-2036" aria-hidden="true" tabindex="-1"></a>table_commit <span class="op">=</span> {</span>
<span id="cb42-2037"><a href="#cb42-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2038"><a href="#cb42-2038" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the HTML table by its class name</span></span>
<span id="cb42-2039"><a href="#cb42-2039" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb42-2040"><a href="#cb42-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2041"><a href="#cb42-2041" aria-hidden="true" tabindex="-1"></a><span class="co">// Check if the table exists</span></span>
<span id="cb42-2042"><a href="#cb42-2042" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (table) {</span>
<span id="cb42-2043"><a href="#cb42-2043" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialize an array to store the table data</span></span>
<span id="cb42-2044"><a href="#cb42-2044" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dataArray <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb42-2045"><a href="#cb42-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2046"><a href="#cb42-2046" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract headers from the first row</span></span>
<span id="cb42-2047"><a href="#cb42-2047" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> headers <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb42-2048"><a href="#cb42-2048" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb42-2049"><a href="#cb42-2049" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">.</span><span class="fu">push</span>(table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span>[i]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>())<span class="op">;</span></span>
<span id="cb42-2050"><a href="#cb42-2050" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-2051"><a href="#cb42-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2052"><a href="#cb42-2052" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Iterate through the rows, starting from the second row</span></span>
<span id="cb42-2053"><a href="#cb42-2053" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb42-2054"><a href="#cb42-2054" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> row <span class="op">=</span> table<span class="op">.</span><span class="at">rows</span>[i]<span class="op">;</span></span>
<span id="cb42-2055"><a href="#cb42-2055" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> rowData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb42-2056"><a href="#cb42-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2057"><a href="#cb42-2057" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Iterate through the cells in the row</span></span>
<span id="cb42-2058"><a href="#cb42-2058" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> row<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb42-2059"><a href="#cb42-2059" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Use headers as keys and cell content as values</span></span>
<span id="cb42-2060"><a href="#cb42-2060" aria-hidden="true" tabindex="-1"></a>            rowData[headers[j]] <span class="op">=</span> row<span class="op">.</span><span class="at">cells</span>[j]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb42-2061"><a href="#cb42-2061" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb42-2062"><a href="#cb42-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2063"><a href="#cb42-2063" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Push the rowData object to the dataArray</span></span>
<span id="cb42-2064"><a href="#cb42-2064" aria-hidden="true" tabindex="-1"></a>        dataArray<span class="op">.</span><span class="fu">push</span>(rowData)<span class="op">;</span></span>
<span id="cb42-2065"><a href="#cb42-2065" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-2066"><a href="#cb42-2066" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-2067"><a href="#cb42-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2068"><a href="#cb42-2068" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataArray</span>
<span id="cb42-2069"><a href="#cb42-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2070"><a href="#cb42-2070" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb43" data-startfrom="2076" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2075;"><span id="cb43-2076"><a href="#cb43-2076" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the element with class 'git-details'</span></span>
<span id="cb43-2077"><a href="#cb43-2077" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-2078"><a href="#cb43-2078" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> gitDetails <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb43-2079"><a href="#cb43-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2080"><a href="#cb43-2080" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Check if the element exists</span></span>
<span id="cb43-2081"><a href="#cb43-2081" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (gitDetails) {</span>
<span id="cb43-2082"><a href="#cb43-2082" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Hide the element</span></span>
<span id="cb43-2083"><a href="#cb43-2083" aria-hidden="true" tabindex="-1"></a>      gitDetails<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb43-2084"><a href="#cb43-2084" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-2085"><a href="#cb43-2085" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb44" data-startfrom="2091" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2090;"><span id="cb44-2091"><a href="#cb44-2091" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.12/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The equivalent ecosystem in <code>R</code>, the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>, developed by <em>Posit</em>, is of more recent design than <code>Pandas</code>. Its philosophy could thus draw inspiration from <code>Pandas</code> while addressing some limitations of the <code>Pandas</code> syntax. Since both syntaxes are an implementation in <code>Python</code> or <code>R</code> of the <code>SQL</code> philosophy, it is natural that they resemble each other and that it is pertinent for data scientists to know both languages.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Actually, it is not the carbon footprint but the <strong>national inventory</strong> since the database corresponds to a production view, not consumption. Emissions made in one municipality to satisfy the consumption of another will be attributed to the former where the carbon footprint concept would attribute it to the latter. Moreover, the emissions presented here do not include those produced by goods made abroad. This exercise is not about constructing a reliable statistic but rather understanding the logic of data merging to construct descriptive statistics.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The original goal of <code>Pandas</code> is to provide a high-level library for more abstract low-level layers, such as <code>Numpy</code> arrays. <code>Pandas</code> is gradually changing these low-level layers to favor <code>Arrow</code> over <code>Numpy</code> without destabilizing the high-level commands familiar to <code>Pandas</code> users. This shift is due to the fact that <code>Arrow</code>, a low-level computation library, is more powerful and flexible than <code>Numpy</code>. For example, <code>Numpy</code> offers limited textual types, whereas <code>Arrow</code> provides greater freedom.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Due to a lack of imagination, we are often tempted to call our main <em>dataframe</em> <code>df</code> or <code>data</code>. This is often a bad idea because the name is not very informative when you read the code a few weeks later. Self-documenting code, an approach that consists of having code that is self-explanatory, is a good practice, and it is recommended to give a simple yet effective name to know the nature of the dataset in question.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@book{galiana2023,
  author = {Galiana, Lino},
  title = {Python Pour La Data Science},
  date = {2023},
  url = {https://pythonds.linogaliana.fr/},
  doi = {10.5281/zenodo.8229676},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-galiana2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Galiana, Lino. 2023. <em>Python Pour La Data Science</em>. <a href="https://doi.org/10.5281/zenodo.8229676">https://doi.org/10.5281/zenodo.8229676</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYENlIGZpY2hpZXIgYSDDqXTDqSBtb2RpZmnDqSBfXyR7dGFibGVfY29tbWl0Lmxlbmd0aH1fXyBmb2lzIGRlcHVpcyBzYSBjcsOpYXRpb24gbGUgJHtjcmVhdGlvbl9zdHJpbmd9IChkZXJuacOocmUgbW9kaWZpY2F0aW9uIGxlICR7bGFzdF9tb2RpZmljYXRpb25fc3RyaW5nfSlgXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjcmVhdGlvbiA9IGQzLm1pbihcbiAgdGFibGVfY29tbWl0Lm1hcChkID0+IG5ldyBEYXRlKGQuRGF0ZSkpXG4pXG5cbmxhc3RfbW9kaWZpY2F0aW9uID0gZDMubWF4KFxuICB0YWJsZV9jb21taXQubWFwKGQgPT4gbmV3IERhdGUoZC5EYXRlKSlcbilcblxuY3JlYXRpb25fc3RyaW5nID0gY3JlYXRpb24udG9Mb2NhbGVTdHJpbmcoXCJmclwiLCB7XG4gIFwiZGF5XCI6IFwibnVtZXJpY1wiLFxuICBcIm1vbnRoXCI6IFwibG9uZ1wiLFxuICBcInllYXJcIjogXCJudW1lcmljXCJcbn0pXG5cbmxhc3RfbW9kaWZpY2F0aW9uX3N0cmluZyA9IGxhc3RfbW9kaWZpY2F0aW9uLnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgXCJtb250aFwiOiBcImxvbmdcIixcbiAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG59KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodG1sYDxkaXY+JHtnaXRfaGlzdG9yeV90YWJsZX08L2Rpdj5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodG1sYDxkaXY+JHtnaXRfaGlzdG9yeV9wbG90fTwvZGl2PmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdpdF9oaXN0b3J5X3RhYmxlID0gSW5wdXRzLnRhYmxlKFxuICB0YWJsZV9jb21taXQsXG4gIHtcbiAgICBmb3JtYXQ6IHtcbiAgICAgIFNIQTogeCA9PiBtZGBbJHt4fV0oJHtnaXRodWJfcmVwb30vY29tbWl0LyR7eH0pYCxcbiAgICAgIERlc2NyaXB0aW9uOiB4ID0+IG1kYCR7cmVwbGFjZVB1bGxSZXF1ZXN0UGF0dGVybih4LCBnaXRodWJfcmVwbyl9YCxcbiAgICAgIC8qRGF0ZTogeCA9PiB4LnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICAgICAgICBcIm1vbnRoXCI6IFwibnVtZXJpY1wiLFxuICAgICAgICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgICAgICAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG4gICAgICAgIH0pXG4gICAgICAqL1xuICAgIH1cbiAgfVxuKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2l0X2hpc3RvcnlfcGxvdCA9IFBsb3QucGxvdCh7XG4gIG1hcmtzOiBbXG4gICAgUGxvdC5ydWxlWShbMF0sIHtzdHJva2U6IFwicm95YWxibHVlXCJ9KSxcbiAgICBQbG90LmRvdChcbiAgICAgICAgICB0YWJsZV9jb21taXQsXG4gICAgICAgICAgUGxvdC5wb2ludGVyWCh7eDogKGQpID0+IG5ldyBEYXRlKGQuZGF0ZSksIHk6IDAsIHN0cm9rZTogXCJyZWRcIn0pKSxcbiAgICBQbG90LmRvdCh0YWJsZV9jb21taXQsIHt4OiAoZCkgPT4gbmV3IERhdGUoZC5EYXRlKSwgeTogMCwgZmlsbDogXCJyb3lhbGJsdWVcIn0pXG4gIF1cbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiByZXBsYWNlUHVsbFJlcXVlc3RQYXR0ZXJuKGlucHV0U3RyaW5nLCBnaXRodWJSZXBvKSB7XG4gICAgLy8gVXNlIGEgcmVndWxhciBleHByZXNzaW9uIHRvIG1hdGNoIHRoZSBwYXR0ZXJuICNkaWdpdFxuICAgIHZhciBwYXR0ZXJuID0gLyMoXFxkKykvZztcblxuICAgIC8vIFJlcGxhY2UgdGhlIHBhdHRlcm4gd2l0aCAke2dpdGh1Yl9yZXBvfS9wdWxsLyNkaWdpdFxuICAgIHZhciByZXBsYWNlZFN0cmluZyA9IGlucHV0U3RyaW5nLnJlcGxhY2UocGF0dGVybiwgJ1sjJDFdKCcgKyBnaXRodWJSZXBvICsgJy9wdWxsLyQxKScpO1xuXG4gICAgcmV0dXJuIHJlcGxhY2VkU3RyaW5nO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2l0aHViX3JlcG8gPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9saW5vZ2FsaWFuYS9weXRob24tZGF0YXNjaWVudGlzdFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0YWJsZV9jb21taXQgPSB7XG5cbi8vIEdldCB0aGUgSFRNTCB0YWJsZSBieSBpdHMgY2xhc3MgbmFtZVxudmFyIHRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1pdC10YWJsZScpO1xuXG4vLyBDaGVjayBpZiB0aGUgdGFibGUgZXhpc3RzXG5pZiAodGFibGUpIHtcbiAgICAvLyBJbml0aWFsaXplIGFuIGFycmF5IHRvIHN0b3JlIHRoZSB0YWJsZSBkYXRhXG4gICAgdmFyIGRhdGFBcnJheSA9IFtdO1xuXG4gICAgLy8gRXh0cmFjdCBoZWFkZXJzIGZyb20gdGhlIGZpcnN0IHJvd1xuICAgIHZhciBoZWFkZXJzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5yb3dzWzBdLmNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGhlYWRlcnMucHVzaCh0YWJsZS5yb3dzWzBdLmNlbGxzW2ldLnRleHRDb250ZW50LnRyaW0oKSk7XG4gICAgfVxuXG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSByb3dzLCBzdGFydGluZyBmcm9tIHRoZSBzZWNvbmQgcm93XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0YWJsZS5yb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciByb3cgPSB0YWJsZS5yb3dzW2ldO1xuICAgICAgICB2YXIgcm93RGF0YSA9IHt9O1xuXG4gICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgY2VsbHMgaW4gdGhlIHJvd1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJvdy5jZWxscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgLy8gVXNlIGhlYWRlcnMgYXMga2V5cyBhbmQgY2VsbCBjb250ZW50IGFzIHZhbHVlc1xuICAgICAgICAgICAgcm93RGF0YVtoZWFkZXJzW2pdXSA9IHJvdy5jZWxsc1tqXS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQdXNoIHRoZSByb3dEYXRhIG9iamVjdCB0byB0aGUgZGF0YUFycmF5XG4gICAgICAgIGRhdGFBcnJheS5wdXNoKHJvd0RhdGEpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBkYXRhQXJyYXlcblxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gR2V0IHRoZSBlbGVtZW50IHdpdGggY2xhc3MgJ2dpdC1kZXRhaWxzJ1xue1xuICB2YXIgZ2l0RGV0YWlscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21taXQtdGFibGUnKTtcblxuICAvLyBDaGVjayBpZiB0aGUgZWxlbWVudCBleGlzdHNcbiAgaWYgKGdpdERldGFpbHMpIHtcbiAgICAgIC8vIEhpZGUgdGhlIGVsZW1lbnRcbiAgICAgIGdpdERldGFpbHMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlBsb3QgPSByZXF1aXJlKCdAb2JzZXJ2YWJsZWhxL3Bsb3RAMC42LjEyL2Rpc3QvcGxvdC51bWQubWluLmpzJylcbiJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../content/manipulation";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pythonds\.linogaliana\.fr");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="linogaliana/python-datascientist" data-repo-id="MDEwOlJlcG9zaXRvcnkyODAxNjE2Nzc=" data-category="General" data-category-id="DIC_kwDOELLtjc4B-5TX" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/manipulation/01_numpy.html" class="pagination-link" aria-label="Numpy, the foundation of data science">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Numpy, the foundation of data science</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/manipulation/02_pandas_suite.html" class="pagination-link" aria-label="Data wrangling with Pandas">
        <span class="nav-page-text">Data wrangling with Pandas</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Python pour la <em>data science</em>, Lino Galiana.<br>
Licence <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i><br>
Code source disponible sur <a href="https://github.com/linogaliana/python-datascientist"><code>Github</code></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/manipulation/02_pandas_intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Site construit avec <i class="fa-brands fa-python" aria-label="python"></i> et <a href="https://quarto.org/"><code>Quarto</code></a><br>
Inspiration pour la mise en forme du site <a href="https://www.andreashandel.com">ici</a><br>
<a href="https://github.com/linogaliana/python-datascientist">Code source disponible sur <i class="fa-brands fa-github" aria-label="github"></i> <code>GitHub</code></a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","openEffect":"zoom","closeEffect":"zoom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>