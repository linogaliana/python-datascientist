<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lino Galiana">
<meta name="dcterms.date" content="2024-10-11">
<meta name="description" content="Geocoded data have been more and more used these recent years in research, public policies or business decisions. Data scientists use them a lot, whether they come from open data or geocoded digital traces. For spatial data, the GeoPandas package extends the functionalities of the Pandas ecosystem to enable handling complex geographical data in a simple manner. This chapter presents the challenge of handling spatial data with Python.">

<title>Introduction to spatial data with Geopandas – Python for data science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/manipulation/04a_webscraping_TP.html" rel="next">
<link href="../../content/manipulation/02_pandas_suite.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #e9f3fa;
      }
</style>
<script id="toggle-light-dark-elements" type="application/javascript">
// Extend Quarto theme toggling to allow elements to be displayed/hidden in light/dark themes

// Replicated from https://github.com/quarto-dev/quarto-cli/blob/84d4659/src/resources/formats/html/templates/quarto-html.ejs
const getColorSchemeSentinel = () => {
  const localAlternateSentinel = 'default';
  if (window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    return storageValue != null ? storageValue : localAlternateSentinel;
  } else {
    return localAlternateSentinel;
  }
};

// Function to toggle light and dark elements based on color scheme
const toggleColorSchemeElements = () => {
  const scheme = getColorSchemeSentinel();
  const lightElements = document.getElementsByClassName('only-light');
  const darkElements = document.getElementsByClassName('only-dark');

  for (var i = 0; i < lightElements.length; i++) {
    lightElements[i].style.display = scheme == 'default' ? 'block' : 'none';
  }
  for (var i = 0; i < darkElements.length; i++) {
    darkElements[i].style.display = scheme == 'default' ? 'none' : 'block';
  }
};

// Function to check if the user's browser prefers dark themes
const prefersDarkTheme = () => {
  if (window.matchMedia) {
    return window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return false;
};

document.addEventListener('readystatechange', function() {
  // Set the default color scheme based on browser preference
  if (document.readyState === 'interactive' && window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    if (storageValue == null && prefersDarkTheme()) {
      window.localStorage.setItem('quarto-color-scheme', 'alternate');
    }
  }
  // Add event listener for when the readyState is complete (and default toggler is set)
  if (document.readyState === 'complete') {
    // Toggle scheme once
    toggleColorSchemeElements();
    // Append our toggle function to the old one
    const oldToggle = window.quartoToggleColorScheme;
    window.quartoToggleColorScheme = () => {
      oldToggle();
      toggleColorSchemeElements();
    }
  }
});

</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Introduction to spatial data with Geopandas – Python for data science">
<meta name="twitter:description" content="Les données géolocalisées se sont multipliées depuis quelques années, qu’il
s’agisse de données open-data ou de traces numériques géolocalisées de
type big-data. Pour les données spatiales, le package GeoPandas
étend les fonctionalités de l’écosystème Pandas afin de permettre
de manipuler des données géographiques complexes de manière simple.">
<meta name="twitter:image" content="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/pirate.jfif">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Python pour la data science">
<meta name="citation_author" content="Lino Galiana">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2024-10-11">
<meta name="citation_fulltext_html_url" content="https://pythonds.linogaliana.fr/">
<meta name="citation_doi" content="10.5281/zenodo.8229676">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Coding for economists;,citation_author=undefined Turrell;,citation_author=undefined contributors;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://aeturrell.github.io/coding-for-economists;">
<meta name="citation_reference" content="citation_title=Discovering statistics using r;,citation_author=A Field;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_publisher=Sage;">
<meta name="citation_reference" content="citation_title=psyTeachR Book Template;,citation_author=DeBruine Lisa;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://github.com/psyteachr/template/;">
<meta name="citation_reference" content="citation_title=The grammar of graphics;,citation_author=Leland Wilkinson;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Hands-on machine learning with scikit-learn, keras, and TensorFlow;,citation_author=Aurélien Géron;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang Härdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Random forests;,citation_author=Leo Breiman;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_volume=45;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Bagging predictors;,citation_author=Leo Breiman;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_volume=24;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=R for data science;,citation_author=Hadley Wickham;,citation_author=Mine Çetinkaya-Rundel;,citation_author=Garrett Grolemund;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Computational reproducibility of jupyter notebooks from biomedical publications;,citation_author=Sheeba Samuel;,citation_author=Daniel Mietchen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2308.07333;">
<meta name="citation_reference" content="citation_title=Python data science handbook: Essential tools for working with data;,citation_author=Jake VanderPlas;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;">
<meta name="citation_reference" content="citation_title=Machine learning methods that economists should know about;,citation_author=Susan Athey;,citation_author=Guido W Imbens;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=11;,citation_journal_title=Annual Review of Economics;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data an illustration with scanner data and crowd-sourced nutritional data;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=Proceedings of the 2022 &amp;amp;amp;quot;Journées de Méthodologie Statistiques&amp;quot;;">
<meta name="citation_reference" content="citation_title=Data visualization with python and JavaScript;,citation_author=Kyran Dale;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=Sémiologie graphique;,citation_author=Jacques Bertin;,citation_publication_date=1967;,citation_cover_date=1967;,citation_year=1967;">
<meta name="citation_reference" content="citation_title=La sémiologie graphique de jacques bertin a cinquante ans;,citation_author=Gilles Palsky;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Visions carto (en ligne);">
<meta name="citation_reference" content="citation_title=Fundamentals of data visualization: A primer on making informative and compelling figures;,citation_author=Claus O Wilke;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=How to train BERT with an academic budget;,citation_author=Peter Izsak;,citation_author=Moshe Berchansky;,citation_author=Omer Levy;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2104.07705;">
<meta name="citation_reference" content="citation_title=Python for data analysis: Data wrangling with pandas, NumPy, and IPython;,citation_author=Wes McKinney;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Residential segregation, daytime segregation and spatial frictions: An analysis from mobile phone data;,citation_author=Lino Galiana;,citation_author=François Sémécurbe;,citation_author=Benjamin Sakarovitch;,citation_author=Zbigniew Smoreda;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data: An illustration with scanner and crowd-sourced nutritional datasets;,citation_abstract=Food retailers’ scanner data provide unprecedented details on local consumption, provided that product identifiers allow a linkage with features of interest, such as nutritional information. In this paper, we enrich a large retailer dataset with nutritional information extracted from crowd-sourced and administrative nutritional datasets. To compensate for imperfect matching through the barcode, we develop a methodology to efficiently match short textual descriptions. After a preprocessing step to normalize short labels, we resort to fuzzy matching based on several tokenizers (including n-grams) by querying an ElasticSearch customized index and validate candidates echos as matches with a Levensthein edit-distance and an embedding-based similarity measure created from a siamese neural network model. The pipeline is composed of several steps successively relaxing constraints to find relevant matching candidates.;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1145/3524458.3547244;,citation_doi=10.1145/3524458.3547244;,citation_isbn=9781450392846;,citation_conference_title=Proceedings of the 2022 ACM conference on information technology for social good;,citation_conference=Association for Computing Machinery;,citation_series_title=GoodIT ’22;">
<meta name="citation_reference" content="citation_title=Guide de sémiologie cartographique;,citation_author=undefined Insee;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Energy and policy considerations for deep learning in NLP;,citation_author=Emma Strubell;,citation_author=Ananya Ganesh;,citation_author=Andrew McCallum;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://arxiv.org/abs/1906.02243;">
<meta name="citation_reference" content="citation_title=High-resolution image synthesis with latent diffusion models;,citation_author=Robin Rombach;,citation_author=Andreas Blattmann;,citation_author=Dominik Lorenz;,citation_author=Patrick Esser;,citation_author=Björn Ommer;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_conference_title=Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR);">
<meta name="citation_reference" content="citation_title=Apache arrow and the&amp;amp;amp;quot; 10 things i hate about pandas;,citation_author=Wes McKinney;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_volume=21;,citation_journal_title=Blog, September;">
<meta name="citation_reference" content="citation_title=Many researchers were not compliant with their published data sharing statement: Mixed-methods study;,citation_author=Mirko Gabelica;,citation_author=Ružica Bojčić;,citation_author=Livia Puljak;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_journal_title=Journal of Clinical Epidemiology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Credit scoring in the era of big data;,citation_author=Mikella Hurley;,citation_author=Julius Adebayo;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=18;,citation_journal_title=Yale JL &amp;amp;amp; Tech.;,citation_publisher=HeinOnline;">
<meta name="citation_reference" content="citation_title=Econometrics and machine learning;,citation_author=Arthur Charpentier;,citation_author=Emmanuel Flachaire;,citation_author=Antoine Ly;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=505;,citation_journal_title=Economie et Statistique;,citation_publisher=Persée-Portail des revues scientifiques en SHS;">
<meta name="citation_reference" content="citation_title=Machine learning: An applied econometric approach;,citation_author=Sendhil Mullainathan;,citation_author=Jann Spiess;,citation_publication_date=2017-05;,citation_cover_date=2017-05;,citation_year=2017;,citation_fulltext_html_url=https://www.aeaweb.org/articles?id=10.1257/jep.31.2.87;,citation_issue=2;,citation_doi=10.1257/jep.31.2.87;,citation_volume=31;,citation_journal_title=Journal of Economic Perspectives;">
<meta name="citation_reference" content="citation_title=Le problème du réalisme des hypothèses en économie politique;,citation_author=Pierre Salmon;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;">
<meta name="citation_reference" content="citation_title=The methodology of positive economics;,citation_author=Milton Friedman;,citation_publication_date=1953;,citation_cover_date=1953;,citation_year=1953;,citation_inbook_title=Essays in positive economics;">
<meta name="citation_reference" content="citation_title=L’empreinte carbone du numérique;,citation_author=undefined Arcep;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in ML-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2207.07048;,citation_doi=10.48550/ARXIV.2207.07048;,citation_publisher=arXiv;">
<meta name="citation_reference" content="citation_title=Growth in a time of debt;,citation_author=Carmen M Reinhart;,citation_author=Kenneth S Rogoff;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_issue=2;,citation_volume=100;,citation_journal_title=American economic review;,citation_publisher=American Economic Association;">
<meta name="citation_reference" content="citation_title=We do not know the population of every country in the world for the past two thousand years;,citation_author=Timothy W Guinnane;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=3;,citation_volume=83;,citation_journal_title=The Journal of Economic History;">
<meta name="citation_reference" content="citation_title=Artificial intelligence: A modern approach (4th edition);,citation_author=Stuart J. Russell;,citation_author=Peter Norvig;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=http://aima.cs.berkeley.edu/;,citation_isbn=9781292401133;">
<meta name="citation_reference" content="citation_title=Data scientist, the sexiest job of the 21st century;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century;,citation_issue=5;,citation_volume=90;,citation_journal_title=Harvard business review;">
<meta name="citation_reference" content="citation_title=Is data scientist still the sexiest job of the 21st century?;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=90;,citation_journal_title=Harvard Business Review;,citation_publisher=Harvard Business Publishing;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in machine-learning-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=9;,citation_volume=4;,citation_journal_title=Patterns;,citation_publisher=Elsevier;">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="../../content/getting-started/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/01_environment.html">
 <span class="dropdown-text">A functional Python environment for data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/02_data_analysis.html">
 <span class="dropdown-text">How to deal with a data set</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/03_revisions.html">
 <span class="dropdown-text">A few refresher exercises to get back in the saddle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wrangle" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wrangle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wrangle">    
        <li>
    <a class="dropdown-item" href="../../content/manipulation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/01_numpy.html">
 <span class="dropdown-text">Numpy, the foundation of data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_intro.html">
 <span class="dropdown-text">Introduction to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_suite.html">
 <span class="dropdown-text">Data wrangling with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/03_geopandas_intro.html">
 <span class="dropdown-text">Introduction to spatial data with Geopandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04a_webscraping_TP.html">
 <span class="dropdown-text">Web scraping with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04c_API_TP.html">
 <span class="dropdown-text">Retrieve data with APIs from Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04b_regex_TP.html">
 <span class="dropdown-text">Mastering regular expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-communicate" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Communicate</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-communicate">    
        <li>
    <a class="dropdown-item" href="../../content/visualisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/matplotlib.html">
 <span class="dropdown-text">De beaux graphiques avec python : mise en pratique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/maps.html">
 <span class="dropdown-text">De belles cartes avec python : mise en pratique</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model">    
        <li>
    <a class="dropdown-item" href="../../content/modelisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/0_preprocessing.html">
 <span class="dropdown-text">Préparation des données pour construire un modèle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/1_modelevaluation.html">
 <span class="dropdown-text">Evaluer la qualité d’un modèle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/2_SVM.html">
 <span class="dropdown-text">Classification: premier modèle avec les SVM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/3_regression.html">
 <span class="dropdown-text">Régression : une introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/4_featureselection.html">
 <span class="dropdown-text">Sélection de variables : une introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/5_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/6_pipeline.html">
 <span class="dropdown-text">Premier pas vers l’industrialisation avec les pipelines scikit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/7_mlapi.html">
 <span class="dropdown-text">Mettre à disposition un modèle par le biais d’une API</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nlp" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NLP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nlp">    
        <li>
    <a class="dropdown-item" href="../../content/NLP/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/01_intro.html">
 <span class="dropdown-text">Nettoyer et structurer l’information dans les données textuelles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/02_exoclean.html">
 <span class="dropdown-text">L’analyse fréquentiste par l’approche bag-of-words : intérêt et limites</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/03_lda.html">
 <span class="dropdown-text">Latent Dirichlet Allocation (LDA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/04_word2vec.html">
 <span class="dropdown-text">Méthodes de vectorisation : comptages et word embeddings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/05_exo_supp.html">
 <span class="dropdown-text">Exercices supplémentaires</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-depth" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-depth</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-depth">    
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/continuous_integration.html">
 <span class="dropdown-text">Intégration continue avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/s3.html">
 <span class="dropdown-text">Les nouveaux modes d’accès aux données : le format parquet et les données sur le cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_approfondissement.html">
 <span class="dropdown-text">Approfondissement ElasticSearch pour des recherches de proximité géographique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_intro.html">
 <span class="dropdown-text">Introduction à ElasticSearch pour la recherche textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-git" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Git</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-git">    
        <li>
    <a class="dropdown-item" href="../../content/git/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/introgit.html">
 <span class="dropdown-text">Découvrir Git par la pratique: la gymnastique quotidienne</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/exogit.html">
 <span class="dropdown-text">Un cadavre exquis pour découvrir le travail collaboratif <code>Git</code></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-annexes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Annexes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-annexes">    
        <li>
    <a class="dropdown-item" href="../../content/annexes/evaluation.html">
 <span class="dropdown-text">Evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/annexes/corrections.html">
 <span class="dropdown-text">Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://linogaliana.github.io/python-datascientist-slides/#/title-slide">
 <span class="dropdown-text">Slides de présentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/linogaliana/python-datascientist" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/manipulation/03_geopandas_intro.html">Introduction to spatial data with Geopandas</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Introduction to spatial data with Geopandas</h1>
                  <div>
        <div class="description">
          <p>Geocoded data have been more and more used these recent years in research, public policies or business decisions. Data scientists use them a lot, whether they come from open data or geocoded digital traces. For spatial data, the <code>GeoPandas</code> package extends the functionalities of the <code>Pandas</code> ecosystem to enable handling complex geographical data in a simple manner. This chapter presents the challenge of handling spatial data with <code>Python</code>.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Tutoriel</div>
                <div class="quarto-category">Manipulation</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lino Galiana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2024-10-11</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/01_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy, the foundation of data science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/02_pandas_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/02_pandas_suite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data wrangling with Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/03_geopandas_intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction to spatial data with Geopandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04a_webscraping_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web scraping with Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04c_API_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Retrieve data with APIs from Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04b_regex_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mastering regular expressions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#whats-so-special-with-spatial-data" id="toc-whats-so-special-with-spatial-data" class="nav-link" data-scroll-target="#whats-so-special-with-spatial-data"><span class="header-section-number">1.1</span> What’s so special with spatial data ?</a></li>
  <li><a href="#structure-of-spatial-data" id="toc-structure-of-spatial-data" class="nav-link" data-scroll-target="#structure-of-spatial-data"><span class="header-section-number">1.2</span> Structure of spatial data</a></li>
  <li><a href="#spatial-data-analysis-is-not-new" id="toc-spatial-data-analysis-is-not-new" class="nav-link" data-scroll-target="#spatial-data-analysis-is-not-new"><span class="header-section-number">1.3</span> Spatial data analysis is not new</a></li>
  <li><a href="#where-can-we-find-french-spatial-data" id="toc-where-can-we-find-french-spatial-data" class="nav-link" data-scroll-target="#where-can-we-find-french-spatial-data"><span class="header-section-number">1.4</span> Where can we find French spatial data?</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives"><span class="header-section-number">1.5</span> Objectives</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">1.6</span> Data</a></li>
  <li><a href="#preliminary-installations" id="toc-preliminary-installations" class="nav-link" data-scroll-target="#preliminary-installations"><span class="header-section-number">1.7</span> Preliminary installations</a></li>
  </ul></li>
  <li><a href="#from-pandas-to-geopandas" id="toc-from-pandas-to-geopandas" class="nav-link" data-scroll-target="#from-pandas-to-geopandas"><span class="header-section-number">2</span> From <code>Pandas</code> to <code>Geopandas</code></a>
  <ul class="collapse">
  <li><a href="#anatomy-of-a-geopandas-object" id="toc-anatomy-of-a-geopandas-object" class="nav-link" data-scroll-target="#anatomy-of-a-geopandas-object"><span class="header-section-number">2.1</span> Anatomy of a <code>GeoPandas</code> object</a></li>
  </ul></li>
  <li><a href="#reading-and-enriching-spatial-data" id="toc-reading-and-enriching-spatial-data" class="nav-link" data-scroll-target="#reading-and-enriching-spatial-data"><span class="header-section-number">3</span> Reading and enriching spatial data</a>
  <ul class="collapse">
  <li><a href="#shapefile-.shp-and-geopackage-.gpkg-formats" id="toc-shapefile-.shp-and-geopackage-.gpkg-formats" class="nav-link" data-scroll-target="#shapefile-.shp-and-geopackage-.gpkg-formats"><span class="header-section-number">3.1</span> Shapefile (<code>.shp</code>) and geopackage (<code>.gpkg</code>) formats</a></li>
  <li><a href="#geojson-and-topojson" id="toc-geojson-and-topojson" class="nav-link" data-scroll-target="#geojson-and-topojson"><span class="header-section-number">3.2</span> GeoJSON and TopoJSON</a></li>
  <li><a href="#other-data-formats" id="toc-other-data-formats" class="nav-link" data-scroll-target="#other-data-formats"><span class="header-section-number">3.3</span> Other data formats</a></li>
  <li><a href="#an-exercise-to-discover-spatial-data" id="toc-an-exercise-to-discover-spatial-data" class="nav-link" data-scroll-target="#an-exercise-to-discover-spatial-data"><span class="header-section-number">3.4</span> An exercise to discover spatial data</a></li>
  </ul></li>
  <li><a href="#the-coordinate-reference-system-crs" id="toc-the-coordinate-reference-system-crs" class="nav-link" data-scroll-target="#the-coordinate-reference-system-crs"><span class="header-section-number">4</span> The coordinate reference system (CRS)</a>
  <ul class="collapse">
  <li><a href="#principle" id="toc-principle" class="nav-link" data-scroll-target="#principle"><span class="header-section-number">4.1</span> Principle</a></li>
  <li><a href="#the-mercator-system" id="toc-the-mercator-system" class="nav-link" data-scroll-target="#the-mercator-system"><span class="header-section-number">4.2</span> The Mercator System</a></li>
  <li><a href="#handling-with-geopandas" id="toc-handling-with-geopandas" class="nav-link" data-scroll-target="#handling-with-geopandas"><span class="header-section-number">4.3</span> Handling with <code>GeoPandas</code></a></li>
  <li><a href="#exercise-to-understand-how-important-a-projection-system-can-be" id="toc-exercise-to-understand-how-important-a-projection-system-can-be" class="nav-link" data-scroll-target="#exercise-to-understand-how-important-a-projection-system-can-be"><span class="header-section-number">4.4</span> Exercise to understand how important a projection system can be</a></li>
  </ul></li>
  <li><a href="#import-and-explore-spatial-datasets" id="toc-import-and-explore-spatial-datasets" class="nav-link" data-scroll-target="#import-and-explore-spatial-datasets"><span class="header-section-number">5</span> Import and explore spatial datasets</a>
  <ul class="collapse">
  <li><a href="#locate-data-on-a-map" id="toc-locate-data-on-a-map" class="nav-link" data-scroll-target="#locate-data-on-a-map"><span class="header-section-number">5.1</span> Locate data on a map</a></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application"><span class="header-section-number">5.2</span> Application</a></li>
  <li><a href="#geometric-operations" id="toc-geometric-operations" class="nav-link" data-scroll-target="#geometric-operations"><span class="header-section-number">5.3</span> Geometric operations</a></li>
  </ul></li>
  <li><a href="#enrichments-through-the-spatial-dimension-spatial-joins" id="toc-enrichments-through-the-spatial-dimension-spatial-joins" class="nav-link" data-scroll-target="#enrichments-through-the-spatial-dimension-spatial-joins"><span class="header-section-number">6</span> Enrichments through the spatial dimension: spatial joins</a>
  <ul class="collapse">
  <li><a href="#principle-1" id="toc-principle-1" class="nav-link" data-scroll-target="#principle-1"><span class="header-section-number">6.1</span> Principle</a></li>
  <li><a href="#example-locating-stations-in-their-neighborhood" id="toc-example-locating-stations-in-their-neighborhood" class="nav-link" data-scroll-target="#example-locating-stations-in-their-neighborhood"><span class="header-section-number">6.2</span> Example: locating stations in their neighborhood</a></li>
  <li><a href="#additional-exercise" id="toc-additional-exercise" class="nav-link" data-scroll-target="#additional-exercise"><span class="header-section-number">6.3</span> Additional exercise</a></li>
  <li><a href="#informations-additionnelles" id="toc-informations-additionnelles" class="nav-link" data-scroll-target="#informations-additionnelles">Informations additionnelles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/manipulation/03_geopandas_intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<a href="#" onclick="this.href = location.href.replace('/en/', '/');" class="button-cta">
<button class="btn"><i class="fa fa-language"></i> Passer à la version française 🇫🇷</button>
</a></p>
<p>If you want to try the examples in this tutorial:</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="692" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 691;"><span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">pathname</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">".html"</span><span class="op">,</span> <span class="st">".qmd"</span>)<span class="op">;</span></span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a>path_modified <span class="op">=</span> (path<span class="op">.</span><span class="fu">includes</span>(<span class="st">'en/content'</span>)) <span class="op">?</span> path<span class="op">.</span><span class="fu">replace</span>(<span class="st">'en/content'</span><span class="op">,</span> <span class="st">'content/en'</span>) <span class="op">:</span> path</span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span><span class="sc">${</span><span class="fu">printBadges</span>({<span class="dt">fpath</span><span class="op">:</span> path_modified})<span class="sc">}</span><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="697" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 696;"><span id="cb2-697"><a href="#cb2-697" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span><span class="fu">getConditionalHTML</span>(path<span class="op">,</span> <span class="kw">true</span>)<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="727" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 726;"><span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">isBetweenSeptAndDec</span>() {</span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> now <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> start <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(now<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// September 1st (month is zero-indexed)</span></span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> end <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(now<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">24</span>)<span class="op">;</span> <span class="co">// December 24th (month is zero-indexed)</span></span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> now <span class="op">&gt;=</span> start <span class="op">&amp;&amp;</span> now <span class="op">&lt;=</span> end<span class="op">;</span></span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="737" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 736;"><span id="cb4-737"><a href="#cb4-737" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getConditionalHTML</span>(path<span class="op">,</span> print) {</span>
<span id="cb4-738"><a href="#cb4-738" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (print <span class="op">===</span> <span class="kw">false</span>) <span class="cf">return</span> <span class="vs">``</span></span>
<span id="cb4-739"><a href="#cb4-739" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">isBetweenSeptAndDec</span>()) {</span>
<span id="cb4-740"><a href="#cb4-740" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">md</span><span class="vs">`&lt;i&gt;La correction sera visible prochainement sur cette page. En attendant, la liste des corrections déjà acccessibles est [ici](/content/annexes/corrections.html)&lt;/i&gt;`</span><span class="op">;</span> <span class="co">// Return an empty string if not between the dates</span></span>
<span id="cb4-741"><a href="#cb4-741" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-742"><a href="#cb4-742" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`</span></span>
<span id="cb4-743"><a href="#cb4-743" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;details&gt;</span></span>
<span id="cb4-744"><a href="#cb4-744" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;summary&gt;</span></span>
<span id="cb4-745"><a href="#cb4-745" aria-hidden="true" tabindex="-1"></a><span class="vs">                Pour ouvrir la version corrigée sous forme de &lt;i&gt;notebook&lt;/i&gt;</span></span>
<span id="cb4-746"><a href="#cb4-746" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/summary&gt;</span></span>
<span id="cb4-747"><a href="#cb4-747" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span><span class="fu">printBadges</span>({ <span class="dt">fpath</span><span class="op">:</span> path<span class="op">,</span> <span class="dt">correction</span><span class="op">:</span> <span class="kw">true</span> })<span class="sc">}</span></span>
<span id="cb4-748"><a href="#cb4-748" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/details&gt;</span></span>
<span id="cb4-749"><a href="#cb4-749" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb4-750"><a href="#cb4-750" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-751"><a href="#cb4-751" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="766" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 765;"><span id="cb5-766"><a href="#cb5-766" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">renderCorrection</span>({ fpath<span class="op">,</span> correction }) {</span>
<span id="cb5-767"><a href="#cb5-767" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (correction) {</span>
<span id="cb5-768"><a href="#cb5-768" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`</span><span class="sc">${</span><span class="fu">printBadges</span>({ <span class="dt">fpath</span><span class="op">:</span> fpath<span class="op">,</span> <span class="dt">correction</span><span class="op">:</span> <span class="kw">true</span> })<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb5-769"><a href="#cb5-769" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-770"><a href="#cb5-770" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;i&gt;La correction sera visible prochainement sur cette page.&lt;/i&gt;`</span><span class="op">;</span></span>
<span id="cb5-771"><a href="#cb5-771" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-772"><a href="#cb5-772" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="774" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 773;"><span id="cb6-774"><a href="#cb6-774" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">reminderBadges</span>({</span>
<span id="cb6-775"><a href="#cb6-775" aria-hidden="true" tabindex="-1"></a>    sourceFile <span class="op">=</span> <span class="st">"content/01_toto.Rmd"</span><span class="op">,</span></span>
<span id="cb6-776"><a href="#cb6-776" aria-hidden="true" tabindex="-1"></a>    type <span class="op">=</span> [<span class="st">'md'</span><span class="op">,</span> <span class="st">'html'</span>]<span class="op">,</span></span>
<span id="cb6-777"><a href="#cb6-777" aria-hidden="true" tabindex="-1"></a>    split <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb6-778"><a href="#cb6-778" aria-hidden="true" tabindex="-1"></a>    onyxiaOnly <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb6-779"><a href="#cb6-779" aria-hidden="true" tabindex="-1"></a>    sspCloudService <span class="op">=</span> <span class="st">"python"</span><span class="op">,</span></span>
<span id="cb6-780"><a href="#cb6-780" aria-hidden="true" tabindex="-1"></a>    GPU <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb6-781"><a href="#cb6-781" aria-hidden="true" tabindex="-1"></a>    correction <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb6-782"><a href="#cb6-782" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb6-783"><a href="#cb6-783" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(type)) {</span>
<span id="cb6-784"><a href="#cb6-784" aria-hidden="true" tabindex="-1"></a>        type <span class="op">=</span> type[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb6-785"><a href="#cb6-785" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-786"><a href="#cb6-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-787"><a href="#cb6-787" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> notebook <span class="op">=</span> sourceFile<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">(</span><span class="ss">.Rmd</span><span class="sc">|</span><span class="ss">.qmd</span><span class="sc">)</span><span class="ss">/</span><span class="op">,</span> <span class="st">".ipynb"</span>)<span class="op">;</span></span>
<span id="cb6-788"><a href="#cb6-788" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (correction) {</span>
<span id="cb6-789"><a href="#cb6-789" aria-hidden="true" tabindex="-1"></a>        notebook <span class="op">=</span> notebook<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/content/</span><span class="op">,</span> <span class="st">"corrections"</span>)<span class="op">;</span></span>
<span id="cb6-790"><a href="#cb6-790" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-791"><a href="#cb6-791" aria-hidden="true" tabindex="-1"></a>        notebook <span class="op">=</span> notebook<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/content/</span><span class="op">,</span> <span class="st">"notebooks"</span>)<span class="op">;</span></span>
<span id="cb6-792"><a href="#cb6-792" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-793"><a href="#cb6-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-794"><a href="#cb6-794" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> githubRepoNotebooksSimplified <span class="op">=</span> <span class="st">"github/linogaliana/python-datascientist-notebooks"</span><span class="op">;</span></span>
<span id="cb6-795"><a href="#cb6-795" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> githubAlias <span class="op">=</span> githubRepoNotebooksSimplified<span class="op">.</span><span class="fu">replace</span>(<span class="st">"github"</span><span class="op">,</span> <span class="st">"github.com"</span>)<span class="op">;</span></span>
<span id="cb6-796"><a href="#cb6-796" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> githubRepoNotebooks <span class="op">=</span> <span class="vs">`https://</span><span class="sc">${</span>githubAlias<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-797"><a href="#cb6-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-798"><a href="#cb6-798" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> githubLink <span class="op">;</span></span>
<span id="cb6-799"><a href="#cb6-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-800"><a href="#cb6-800" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (notebook <span class="op">===</span> <span class="st">""</span>) {</span>
<span id="cb6-801"><a href="#cb6-801" aria-hidden="true" tabindex="-1"></a>        githubLink <span class="op">=</span> githubRepoNotebooks<span class="op">;</span></span>
<span id="cb6-802"><a href="#cb6-802" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-803"><a href="#cb6-803" aria-hidden="true" tabindex="-1"></a>        githubLink <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>githubRepoNotebooks<span class="sc">}</span><span class="vs">/blob/main`</span><span class="op">;</span></span>
<span id="cb6-804"><a href="#cb6-804" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-805"><a href="#cb6-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-806"><a href="#cb6-806" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> notebookRelPath <span class="op">=</span> <span class="vs">`/</span><span class="sc">${</span>notebook<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-807"><a href="#cb6-807" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [section<span class="op">,</span> chapter] <span class="op">=</span> notebook<span class="op">.</span><span class="fu">split</span>(<span class="st">"/"</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb6-808"><a href="#cb6-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-809"><a href="#cb6-809" aria-hidden="true" tabindex="-1"></a>    githubLink <span class="op">=</span> <span class="vs">`&lt;a href="</span><span class="sc">${</span>githubLink<span class="sc">}${</span>notebookRelPath<span class="sc">}</span><span class="vs">" class="github"&gt;&lt;i class="fab fa-github"&gt;&lt;/i&gt;&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb6-810"><a href="#cb6-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-811"><a href="#cb6-811" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> sectionLatest <span class="op">=</span> section<span class="op">.</span><span class="fu">split</span>(<span class="st">"/"</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb6-812"><a href="#cb6-812" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> chapterNoExtension <span class="op">=</span> chapter<span class="op">.</span><span class="fu">replace</span>(<span class="st">".ipynb"</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb6-813"><a href="#cb6-813" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-814"><a href="#cb6-814" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (sourceFile<span class="op">.</span><span class="fu">includes</span>(<span class="st">'en/'</span>)) {</span>
<span id="cb6-815"><a href="#cb6-815" aria-hidden="true" tabindex="-1"></a>        sectionLatest <span class="op">=</span> <span class="vs">`en/</span><span class="sc">${</span>sectionLatest<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-816"><a href="#cb6-816" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-817"><a href="#cb6-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-818"><a href="#cb6-818" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> onyxiaInitArgs <span class="op">=</span> [sectionLatest<span class="op">,</span> chapterNoExtension]<span class="op">;</span></span>
<span id="cb6-819"><a href="#cb6-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-820"><a href="#cb6-820" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (correction) {</span>
<span id="cb6-821"><a href="#cb6-821" aria-hidden="true" tabindex="-1"></a>        onyxiaInitArgs<span class="op">.</span><span class="fu">push</span>(<span class="st">"correction"</span>)<span class="op">;</span></span>
<span id="cb6-822"><a href="#cb6-822" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-823"><a href="#cb6-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-824"><a href="#cb6-824" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> gpuSuffix <span class="op">=</span> GPU <span class="op">?</span> <span class="st">"-gpu"</span> <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb6-825"><a href="#cb6-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-826"><a href="#cb6-826" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sspcloudJupyterLinkLauncher <span class="op">=</span> <span class="vs">`https://datalab.sspcloud.fr/launcher/ide/jupyter-</span><span class="sc">${</span>sspCloudService<span class="sc">}${</span>gpuSuffix<span class="sc">}</span><span class="vs">?autoLaunch=true&amp;onyxia.friendlyName=%C2%AB</span><span class="sc">${</span>chapterNoExtension<span class="sc">}</span><span class="vs">%C2%BB&amp;init.personalInit=%C2%ABhttps%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmaster%2Fsspcloud%2Finit-jupyter.sh%C2%BB&amp;init.personalInitArgs=%C2%AB</span><span class="sc">${</span>onyxiaInitArgs<span class="op">.</span><span class="fu">join</span>(<span class="st">'%20'</span>)<span class="sc">}</span><span class="vs">%C2%BB`</span><span class="op">;</span></span>
<span id="cb6-827"><a href="#cb6-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-828"><a href="#cb6-828" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> sspcloudJupyterLink<span class="op">;</span></span>
<span id="cb6-829"><a href="#cb6-829" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="op">===</span> <span class="st">"md"</span>) {</span>
<span id="cb6-830"><a href="#cb6-830" aria-hidden="true" tabindex="-1"></a>        sspcloudJupyterLink <span class="op">=</span> <span class="vs">`[![Onyxia](https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange)](</span><span class="sc">${</span>sspcloudJupyterLinkLauncher<span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb6-831"><a href="#cb6-831" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-832"><a href="#cb6-832" aria-hidden="true" tabindex="-1"></a>        sspcloudJupyterLink <span class="op">=</span> <span class="vs">`&lt;a href="</span><span class="sc">${</span>sspcloudJupyterLinkLauncher<span class="sc">}</span><span class="vs">" target="_blank" rel="noopener"&gt;&lt;img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange" alt="Onyxia"&gt;&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb6-833"><a href="#cb6-833" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-834"><a href="#cb6-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-835"><a href="#cb6-835" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (split <span class="op">===</span> <span class="dv">4</span>) {</span>
<span id="cb6-836"><a href="#cb6-836" aria-hidden="true" tabindex="-1"></a>        sspcloudJupyterLink <span class="op">+=</span> <span class="st">'&lt;br&gt;'</span><span class="op">;</span></span>
<span id="cb6-837"><a href="#cb6-837" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-838"><a href="#cb6-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-839"><a href="#cb6-839" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sspcloudVscodeLinkLauncher <span class="op">=</span> <span class="vs">`https://datalab.sspcloud.fr/launcher/ide/vscode-</span><span class="sc">${</span>sspCloudService<span class="sc">}${</span>gpuSuffix<span class="sc">}</span><span class="vs">?autoLaunch=true&amp;onyxia.friendlyName=%C2%AB</span><span class="sc">${</span>chapterNoExtension<span class="sc">}</span><span class="vs">%C2%BB&amp;init.personalInit=%C2%ABhttps%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmaster%2Fsspcloud%2Finit-vscode.sh%C2%BB&amp;init.personalInitArgs=%C2%AB</span><span class="sc">${</span>onyxiaInitArgs<span class="op">.</span><span class="fu">join</span>(<span class="st">'%20'</span>)<span class="sc">}</span><span class="vs">%C2%BB`</span><span class="op">;</span></span>
<span id="cb6-840"><a href="#cb6-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-841"><a href="#cb6-841" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> sspcloudVscodeLink<span class="op">;</span></span>
<span id="cb6-842"><a href="#cb6-842" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="op">===</span> <span class="st">"md"</span>) {</span>
<span id="cb6-843"><a href="#cb6-843" aria-hidden="true" tabindex="-1"></a>        sspcloudVscodeLink <span class="op">=</span> <span class="vs">`[![Onyxia](https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue)](</span><span class="sc">${</span>sspcloudVscodeLinkLauncher<span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb6-844"><a href="#cb6-844" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-845"><a href="#cb6-845" aria-hidden="true" tabindex="-1"></a>        sspcloudVscodeLink <span class="op">=</span> <span class="vs">`&lt;a href="</span><span class="sc">${</span>sspcloudVscodeLinkLauncher<span class="sc">}</span><span class="vs">" target="_blank" rel="noopener"&gt;&lt;img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue" alt="Onyxia"&gt;&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb6-846"><a href="#cb6-846" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-847"><a href="#cb6-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-848"><a href="#cb6-848" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (split <span class="op">===</span> <span class="dv">5</span>) {</span>
<span id="cb6-849"><a href="#cb6-849" aria-hidden="true" tabindex="-1"></a>        sspcloudVscodeLink <span class="op">+=</span> <span class="st">'&lt;br&gt;'</span><span class="op">;</span></span>
<span id="cb6-850"><a href="#cb6-850" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-851"><a href="#cb6-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-852"><a href="#cb6-852" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> colabLink<span class="op">;</span></span>
<span id="cb6-853"><a href="#cb6-853" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="op">===</span> <span class="st">"md"</span>) {</span>
<span id="cb6-854"><a href="#cb6-854" aria-hidden="true" tabindex="-1"></a>        colabLink <span class="op">=</span> <span class="vs">`[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](http://colab.research.google.com/</span><span class="sc">${</span>githubRepoNotebooksSimplified<span class="sc">}</span><span class="vs">/blob/main</span><span class="sc">${</span>notebookRelPath<span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb6-855"><a href="#cb6-855" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-856"><a href="#cb6-856" aria-hidden="true" tabindex="-1"></a>        colabLink <span class="op">=</span> <span class="vs">`&lt;a href="https://colab.research.google.com/</span><span class="sc">${</span>githubRepoNotebooksSimplified<span class="sc">}</span><span class="vs">/blob/main</span><span class="sc">${</span>notebookRelPath<span class="sc">}</span><span class="vs">" target="_blank" rel="noopener"&gt;&lt;img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"&gt;&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb6-857"><a href="#cb6-857" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-858"><a href="#cb6-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-859"><a href="#cb6-859" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (split <span class="op">===</span> <span class="dv">7</span>) {</span>
<span id="cb6-860"><a href="#cb6-860" aria-hidden="true" tabindex="-1"></a>        colabLink <span class="op">+=</span> <span class="st">'&lt;br&gt;'</span><span class="op">;</span></span>
<span id="cb6-861"><a href="#cb6-861" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-862"><a href="#cb6-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-863"><a href="#cb6-863" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> vscodeLink<span class="op">;</span></span>
<span id="cb6-864"><a href="#cb6-864" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="op">===</span> <span class="st">"md"</span>) {</span>
<span id="cb6-865"><a href="#cb6-865" aria-hidden="true" tabindex="-1"></a>        vscodeLink <span class="op">=</span> <span class="vs">`[![githubdev](https://img.shields.io/static/v1?logo=visualstudiocode&amp;label=&amp;message=Open%20in%20Visual Studio Code&amp;labelColor=2c2c32&amp;color=007acc&amp;logoColor=007acc)](https://github.dev/linogaliana/python-datascientist-notebooks</span><span class="sc">${</span>notebookRelPath<span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb6-866"><a href="#cb6-866" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-867"><a href="#cb6-867" aria-hidden="true" tabindex="-1"></a>        vscodeLink <span class="op">=</span> <span class="vs">`&lt;a href="https://github.dev/linogaliana/python-datascientist-notebooks</span><span class="sc">${</span>notebookRelPath<span class="sc">}</span><span class="vs">" target="_blank" rel="noopener"&gt;&lt;img src="https://img.shields.io/static/v1?logo=visualstudiocode&amp;label=&amp;message=Open%20in%20Visual%20Studio%20Code&amp;labelColor=2c2c32&amp;color=007acc&amp;logoColor=007acc" alt="githubdev"&gt;&lt;/a&gt;&lt;/p&gt;`</span><span class="op">;</span></span>
<span id="cb6-868"><a href="#cb6-868" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-869"><a href="#cb6-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-870"><a href="#cb6-870" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> badges <span class="op">=</span> [</span>
<span id="cb6-871"><a href="#cb6-871" aria-hidden="true" tabindex="-1"></a>        githubLink<span class="op">,</span></span>
<span id="cb6-872"><a href="#cb6-872" aria-hidden="true" tabindex="-1"></a>        sspcloudVscodeLink<span class="op">,</span></span>
<span id="cb6-873"><a href="#cb6-873" aria-hidden="true" tabindex="-1"></a>        sspcloudJupyterLink</span>
<span id="cb6-874"><a href="#cb6-874" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb6-875"><a href="#cb6-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-876"><a href="#cb6-876" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>onyxiaOnly) {</span>
<span id="cb6-877"><a href="#cb6-877" aria-hidden="true" tabindex="-1"></a>        badges<span class="op">.</span><span class="fu">push</span>(colabLink)<span class="op">;</span></span>
<span id="cb6-878"><a href="#cb6-878" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-879"><a href="#cb6-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-880"><a href="#cb6-880" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> result <span class="op">=</span> badges<span class="op">.</span><span class="fu">join</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)<span class="op">;</span></span>
<span id="cb6-881"><a href="#cb6-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-882"><a href="#cb6-882" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="op">===</span> <span class="st">"html"</span>) {</span>
<span id="cb6-883"><a href="#cb6-883" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="vs">`&lt;p class="badges"&gt;</span><span class="sc">${</span>result<span class="sc">}</span><span class="vs">&lt;/p&gt;`</span><span class="op">;</span></span>
<span id="cb6-884"><a href="#cb6-884" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-885"><a href="#cb6-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-886"><a href="#cb6-886" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (onyxiaOnly) {</span>
<span id="cb6-887"><a href="#cb6-887" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>sspcloudJupyterLink<span class="sc">}${</span>sspcloudVscodeLink<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb6-888"><a href="#cb6-888" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-889"><a href="#cb6-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-890"><a href="#cb6-890" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb6-891"><a href="#cb6-891" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-892"><a href="#cb6-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-893"><a href="#cb6-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-894"><a href="#cb6-894" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">printBadges</span>({</span>
<span id="cb6-895"><a href="#cb6-895" aria-hidden="true" tabindex="-1"></a>    fpath<span class="op">,</span></span>
<span id="cb6-896"><a href="#cb6-896" aria-hidden="true" tabindex="-1"></a>    onyxiaOnly <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb6-897"><a href="#cb6-897" aria-hidden="true" tabindex="-1"></a>    split <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb6-898"><a href="#cb6-898" aria-hidden="true" tabindex="-1"></a>    type <span class="op">=</span> <span class="st">"html"</span><span class="op">,</span></span>
<span id="cb6-899"><a href="#cb6-899" aria-hidden="true" tabindex="-1"></a>    sspCloudService <span class="op">=</span> <span class="st">"python"</span><span class="op">,</span></span>
<span id="cb6-900"><a href="#cb6-900" aria-hidden="true" tabindex="-1"></a>    GPU <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb6-901"><a href="#cb6-901" aria-hidden="true" tabindex="-1"></a>    correction <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb6-902"><a href="#cb6-902" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb6-903"><a href="#cb6-903" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> badges <span class="op">=</span> <span class="fu">reminderBadges</span>({</span>
<span id="cb6-904"><a href="#cb6-904" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sourceFile</span><span class="op">:</span> fpath<span class="op">,</span></span>
<span id="cb6-905"><a href="#cb6-905" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> type<span class="op">,</span></span>
<span id="cb6-906"><a href="#cb6-906" aria-hidden="true" tabindex="-1"></a>        <span class="dt">split</span><span class="op">:</span> split<span class="op">,</span></span>
<span id="cb6-907"><a href="#cb6-907" aria-hidden="true" tabindex="-1"></a>        <span class="dt">onyxiaOnly</span><span class="op">:</span> onyxiaOnly<span class="op">,</span></span>
<span id="cb6-908"><a href="#cb6-908" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sspCloudService</span><span class="op">:</span> sspCloudService<span class="op">,</span></span>
<span id="cb6-909"><a href="#cb6-909" aria-hidden="true" tabindex="-1"></a>        <span class="dt">GPU</span><span class="op">:</span> GPU<span class="op">,</span></span>
<span id="cb6-910"><a href="#cb6-910" aria-hidden="true" tabindex="-1"></a>        <span class="dt">correction</span><span class="op">:</span> correction</span>
<span id="cb6-911"><a href="#cb6-911" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb6-912"><a href="#cb6-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-913"><a href="#cb6-913" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> badges</span>
<span id="cb6-914"><a href="#cb6-914" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="whats-so-special-with-spatial-data" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="whats-so-special-with-spatial-data"><span class="header-section-number">1.1</span> What’s so special with spatial data ?</h2>
<p>Previous chapters have introduced how structured data can be leveraged using the <code>Pandas</code> library. We will now explore the analysis of more complex data, namely spatial data. These datasets are more sophisticated than tabular data since they not only share the properties of tabular data (flattened data in a structure of columns and rows) but also include an additional geographical dimension. This dimension can be more or less complex depending on the nature of the data: it can be points (2D location coordinates), lines (a series of points), directional lines (the same structure as before but with a direction), polygons (a set of points), etc. This diversity of geographic objects aims to allow information systems and representations of numerous geographic objects.</p>
<p>From now on, we will refer to <em>“spatial data”</em> as all data that pertain to the geographical characteristics of objects (location, contours, links). The geographical characteristics of objects are described using a <strong>coordinate system</strong>. These allow the representation of the geographic object in a two-dimensional Euclidean space <span class="math inline">\((x,y)\)</span>. The transition from the real space (the Earth, which is a three-dimensional sphere) to the planar space is done through a <strong>projection system</strong>.</p>
</section>
<section id="structure-of-spatial-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="structure-of-spatial-data"><span class="header-section-number">1.2</span> Structure of spatial data</h2>
<p>Spatial data typically gather two types of data:</p>
<ol type="1">
<li><strong>Geographical data</strong> (or geometries): geometric objects such as points, vectors, polygons, or meshes (<em>raster</em>). Example: the shape of each municipality, the coordinates of a building, etc. ;</li>
<li><strong>Attributive data</strong> (or attributes): measurements and characteristics associated with geometric objects. Example: the population of each municipality, the number of windows and the number of floors of a building, etc.</li>
</ol>
<p><strong>Spatial data are frequently processed using a geographic information system (GIS)</strong>, which is an information system capable of storing, organizing, and presenting alphanumeric data spatially referenced by coordinates in a reference system (CRS). <code>Python</code> has functionalities allowing it to perform the same tasks as a GIS (processing spatial data, creating cartographic representations).</p>
</section>
<section id="spatial-data-analysis-is-not-new" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="spatial-data-analysis-is-not-new"><span class="header-section-number">1.3</span> Spatial data analysis is not new</h2>
<p>Initially used mainly for military or administrative purposes, cartographic production has been very common to represent socioeconomic information since at least the 19th century. The most well-known representation in this field is the choropleth map<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>According to <span class="citation" data-cites="chen2008brief">Chen et al. (<a href="#ref-chen2008brief" role="doc-biblioref">2008</a>)</span>, the first representation of this type was proposed by Charles Dupin in 1926 to represent education levels in France. The emergence of choropleth maps is indeed inseparable from the organization of power into entities considered unitary: world maps often represent color gradients based on nations, national maps based on administrative levels (regions, departments, municipalities, but also states or <em>landers</em>).</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Carte_figurative_de_l%27instruction_populaire_de_la_France.jpg/800px-Carte_figurative_de_l%27instruction_populaire_de_la_France.jpg" class="img-fluid quarto-figure quarto-figure-center" style="width:60.0%" alt="The first choropleth map by Dupin (1826)">.</p>
<p>While the production of geographical information may have been closely tied to military use and administrative management of a territory, the digitalization of the economy has multiplied the actors concerned with collecting and making geographical data available. Thus, handling and representing spatial data is no longer the exclusive domain of geographers and geomatics engineers. Data scientists must be able to quickly explore the structure of a geographic dataset just as they would with traditional tabular datasets.</p>
</section>
<section id="where-can-we-find-french-spatial-data" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="where-can-we-find-french-spatial-data"><span class="header-section-number">1.4</span> Where can we find French spatial data?</h2>
<p>During our journey of discovering <code>Pandas</code>, we have already encountered some geolocated sources, notably produced by INSEE. This institution publishes numerous local statistics, such as the Filosofi data we encountered in the previous chapter. Beyond INSEE, all institutions of the public statistical system (INSEE and ministerial statistical services) publish many aggregated data sources at different geographical scales: sub-municipal level (e.g., <a href="https://www.insee.fr/fr/statistiques/6215138?sommaire=6215217">200m tiles</a>), municipal level, or supra-municipal levels (administrative or study area zonings).</p>
<p>More generally, many French administrations outside the public statistical system disseminate geographic data on <a href="https://www.data.gouv.fr/fr/">data.gouv</a>. For example, we previously exploited a dataset from ADEME whose geographical dimension was the municipality.</p>
<p>The central player in the French public geographic data ecosystem is <a href="https://www.ign.fr/">IGN</a>. Well known to hiking enthusiasts for its <em>“Top 25”</em> maps, which can be found on the <a href="https://www.geoportail.gouv.fr/carte">geoportail</a>, IGN is also responsible for mapping the legal boundaries of French administrative entities (AdminExpress base), forests (BDForêt), roads (BDRoute), buildings (BDTopo), etc. We briefly mentioned the <a href="https://github.com/InseeFrLab/cartiflette"><code>cartiflette</code></a> library in the previous chapter, which allows flexible retrieval of administrative map bases (AdminExpress base) with <code>Python</code>; we will go further in this chapter.</p>
<p>The public authorities are no longer the only ones producing and disseminating spatial data. Collecting GPS coordinates has become almost automatic, and many actors collect, exploit, and even sell geospatial data on their users. These data can be very precise and rich on certain issues, such as mobility. However, it is necessary to keep in mind when wanting to extrapolate statistics built on these data that they concern users of the specific service, who may not be representative of the behaviors of the population as a whole.</p>
</section>
<section id="objectives" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="objectives"><span class="header-section-number">1.5</span> Objectives</h2>
<p>This chapter illustrates some central principles of data analysis through practical examples:</p>
<ul>
<li>Manipulations on the attributes of datasets;</li>
<li>Geometric manipulations;</li>
<li>Management of cartographic projections;</li>
<li>Quick creation of maps (to be explored further in a later chapter).</li>
</ul>
</section>
<section id="data" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="data"><span class="header-section-number">1.6</span> Data</h2>
<p>In this chapter, we will use the following data:</p>
<ul>
<li><a href="https://opendata.paris.fr/explore/dataset/velib-emplacement-des-stations/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr">Free floating bike rents (Vélib) data</a>;</li>
<li><a href="https://geoservices.ign.fr/adminexpress">French administrative design</a> through a <code>Python</code> package named <a href="https://github.com/InseeFrLab/cartiflette"><code>cartiflette</code></a> which facilitates the retrieval of this source.</li>
</ul>
</section>
<section id="preliminary-installations" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="preliminary-installations"><span class="header-section-number">1.7</span> Preliminary installations</h2>
<p>This tutorial requires some package installations to be reproducible</p>
<div id="install-dependencies" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="install-dependencies"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="install-dependencies-1"><a href="#install-dependencies-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas fiona shapely pyproj rtree </span>
<span id="install-dependencies-2"><a href="#install-dependencies-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install contextily</span>
<span id="install-dependencies-3"><a href="#install-dependencies-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install geopandas</span>
<span id="install-dependencies-4"><a href="#install-dependencies-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install topojson</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To be able to run this tutorial, the following imports will be useful.</p>
<div id="load-dependencies" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="load-dependencies"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="load-dependencies-1"><a href="#load-dependencies-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="load-dependencies-2"><a href="#load-dependencies-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> contextily <span class="im">as</span> ctx</span>
<span id="load-dependencies-3"><a href="#load-dependencies-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The <code>cartiflette</code> package is experimental and is only available on
<a href="https://github.com/InseeFrLab/cartogether"><code>Github</code></a>, not on <code>PyPi</code>.
It is expected to evolve quickly and this page will be updated
when new functionalities (especially the use of <code>API</code>)
are available to further simplify the retrieval of
geographic boundaries.</p>
</div>
</div>
</div>
<p>To install <code>cartiflette</code>, you need to use the following commands
from a <code>Jupyter Notebook</code> (if you use the command line directly,
you can remove the <code>!</code> at the beginning of the line):</p>
<div id="install-cartiflette" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="install-cartiflette"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="install-cartiflette-1"><a href="#install-cartiflette-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install py7zr geopandas openpyxl tqdm s3fs</span>
<span id="install-cartiflette-2"><a href="#install-cartiflette-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install PyYAML xlrd</span>
<span id="install-cartiflette-3"><a href="#install-cartiflette-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install git<span class="op">+</span>https:<span class="op">//</span>github.com<span class="op">/</span>inseefrlab<span class="op">/</span>cartiflette</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="from-pandas-to-geopandas" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> From <code>Pandas</code> to <code>Geopandas</code></h1>
<p>The <code>Geopandas</code> package is a toolkit designed to facilitate the manipulation of spatial data. <strong>The great strength of <code>Geopandas</code> is that it allows for the manipulation of spatial data as if it were traditional data</strong>, because it is based on the ISO 19125 <a href="https://en.wikipedia.org/wiki/Simple_Features"><em>simple feature access</em></a> standard defined jointly by the <em>Open Geospatial Consortium (OGC)</em> and the <em>International Organization for Standardization (ISO)</em>. <code>Geopandas</code> relies on <code>Pandas</code> for handling the tabular aspect of spatial data and on <a href="https://shapely.readthedocs.io/en/stable/manual.html"><code>Shapely</code></a> and <a href="https://gdal.org/index.html"><code>GDAL</code></a> for geometric manipulations. However, just as <code>Pandas</code> allows you to use <code>Numpy</code> without knowing it, working with <code>Geopandas</code> lets you leverage <code>Shapely</code> and <code>GDAL</code> without having to deal with them directly.</p>
<p>Compared to a standard <em>DataFrame</em>, a <code>Geopandas</code> object includes an additional column: <code>geometry</code>. This column stores the coordinates of geographic objects (or sets of coordinates in the case of boundaries). A <code>Geopandas</code> object inherits the properties of a <code>Pandas</code> <em>DataFrame</em> but offers methods tailored to the handling of spatial data. Therefore, with <code>GeoPandas</code>, you have attributes based on the principle of <em>tidy</em> data discussed in the <a href="content/manipulation/02_pandas_intro.qmd">previous chapter</a> while the associated geometry is managed consistently alongside the attributes.</p>
<p>Thus, with <code>Geopandas</code>, you can perform attribute manipulations as with <code>pandas</code>, but you can also manipulate the spatial dimension of the data. Specifically, you can:</p>
<ul>
<li>Calculate distances and areas;</li>
<li>Aggregate zonings quickly (e.g., grouping municipalities into departments);</li>
<li>Find out which municipality a building is located in based on its geographic coordinates;</li>
<li>Recalculate coordinates in another projection system;</li>
<li>Create a map quickly and easily.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Manipulating data in a <code>Geopandas</code> object is significantly slower than in a traditional <code>DataFrame</code> (since <code>Python</code> has to handle geographic information during data manipulation).
When working with large datasets, it may be preferable to perform operations on the data before attaching geometry to it.</p>
</div>
</div>
</div>
<p>Compared to specialized software like <code>QGIS</code>, <code>Python</code> allows for the automation of data processing and visualization. In fact, <code>QGIS</code> itself uses <code>Python</code>…</p>
<section id="anatomy-of-a-geopandas-object" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="anatomy-of-a-geopandas-object"><span class="header-section-number">2.1</span> Anatomy of a <code>GeoPandas</code> object</h2>
<p>In summary, a <code>GeoPandas</code> object consists of the following elements:</p>
<p><a href="https://rgeo.linogaliana.fr/slides/img/sf.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://rgeo.linogaliana.fr/slides/img/sf.png" class="img-fluid"></a></p>
<ol type="1">
<li><strong>Attributes</strong>: These are the values associated with each geographic level. This is the usual tabular dimension, treated similarly to a standard <code>Pandas</code> object.</li>
<li><strong>Geometries</strong>: These are numerical values interpreted to represent the geographic dimension. They allow representation in a specific reference frame (the reference system).</li>
<li><strong>Reference System</strong>: This system transforms positions on the globe (3D with an asymmetrical sphere) into a 2D plane. There are numerous systems, identifiable by an EPSG code (4326, 2154, etc.). Their manipulation is facilitated by <code>Geopandas</code>, which relies on <code>Shapely</code>, just as <code>Pandas</code> relies on <code>Numpy</code> or <code>Arrow</code>.</li>
</ol>
</section>
</section>
<section id="reading-and-enriching-spatial-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Reading and enriching spatial data</h1>
<p>In the previous chapter, we discussed flat data formats such as <code>CSV</code> and newer formats like <code>Parquet</code>. These are suitable for tabular data. For geographic data, which store information across multiple dimensions (attributes and geometry), there are specialized formats.</p>
<section id="shapefile-.shp-and-geopackage-.gpkg-formats" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="shapefile-.shp-and-geopackage-.gpkg-formats"><span class="header-section-number">3.1</span> Shapefile (<code>.shp</code>) and geopackage (<code>.gpkg</code>) formats</h2>
<p>The historical format for storing spatial data is the <a href="https://en.wikipedia.org/wiki/Shapefile">shapefile</a>. It is a proprietary format developed by ESRI that has become a de facto standard. In this format, data</p>
</section>
<section id="geojson-and-topojson" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="geojson-and-topojson"><span class="header-section-number">3.2</span> GeoJSON and TopoJSON</h2>
<p>The development of a format to rival the hegemony of the shapefile is intrinsically linked to the emergence of web technologies in the cartography sector. These web technologies rely on Javascript and adhere to the JSON format standards.</p>
<p>The GeoJSON format stores both attributes and geometries in a single file. This makes it quite convenient to use and it has become the preferred format among web developers. However, storing all information in one file can make it quite large if the geometries are very detailed, though it is still less bulky than the shapefile. <code>GeoPandas</code> is well-equipped to read files in the GeoJSON format, and data-sharing platforms like <code>data.gouv</code> favor this format over the shapefile.</p>
<p>To reduce file size, the TopoJSON format has recently emerged. It is built on the same principles as GeoJSON but reduces the volume of stored geometric data by simplifying it, retaining only arcs and directions between points. As this format is new, it is not yet well-integrated into the <code>Python</code> ecosystem.</p>
</section>
<section id="other-data-formats" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="other-data-formats"><span class="header-section-number">3.3</span> Other data formats</h2>
<p>The ecosystem of geographic data formats is much more fragmented than that of structured data. Each format offers advantages that make it suitable for certain types of data but has limitations that prevent it from becoming a standard for other types of data.</p>
<p>For example, GPS data extracted from various applications (e.g., <code>Strava</code>) are stored in the GPX format. This format is particularly well-suited for geolocated traces with altitude. However, it is not the most appropriate format for storing directional lines, which are essential for routing applications.</p>
<p>The shapefile and geojson formats are sufficiently versatile to adapt to various types of geographic data, even if they are not the optimal format for every type of data. Within this generalist class of formats, the Geoparquet might be the next trending format. As its name suggests, it is an extension of the Parquet format to geographic data. This format is not yet mature but is worth keeping an eye on, as the large user base of the Parquet ecosystem could lead to a rapid shift if a stable implementation of Geoparquet emerges.</p>
<p>This <a href="https://si.ecrins-parcnational.com/blog/2020-02-geojson-shapefile-geopackage.html">page</a> provides a more detailed comparison of the main geographic data formats. The help section of <a href="https://geopandas.org/io.html"><code>Geopandas</code></a> offers code snippets for various situations.</p>
</section>
<section id="an-exercise-to-discover-spatial-data" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="an-exercise-to-discover-spatial-data"><span class="header-section-number">3.4</span> An exercise to discover spatial data</h2>
<p>The goal of this exercise is to illustrate the similarity between <code>GeoPandas</code> objects and the <code>Pandas</code> objects we previously explored.</p>
<p>We will directly import the <code>AdminExpress</code> data (official boundaries of municipalities produced by IGN) using <code>cartiflette</code>:</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1: Discovering spatial objects
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>First, we will retrieve geographic data using the <code>cartiflette</code> package and its <code>carti_download</code> function.</p>
<ol type="1">
<li>Use the code below to download municipal data (IGN’s <code>Admin Express</code> product) for the departments of the inner suburbs (75, 92, 93, and 94) in a simplified manner using the <code>cartiflette</code> package:</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | echo: true</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># | output: false</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cartiflette <span class="im">import</span> carti_download</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>communes_borders <span class="op">=</span> carti_download(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span><span class="dv">4326</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>[<span class="st">"75"</span>, <span class="st">"92"</span>, <span class="st">"93"</span>, <span class="st">"94"</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    borders<span class="op">=</span><span class="st">"COMMUNE"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    vectorfile_format<span class="op">=</span><span class="st">"geojson"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    filter_by<span class="op">=</span><span class="st">"DEPARTEMENT"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    source<span class="op">=</span><span class="st">"EXPRESS-COG-CARTO-TERRITOIRE"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    year<span class="op">=</span><span class="dv">2022</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li><p>Look at the first few rows of the data. Identify the difference from a standard dataframe.</p></li>
<li><p>Display the projection system (attribute <code>crs</code>) of <code>communes_borders</code>. This controls the transformation of the three-dimensional terrestrial space into a flat surface. Use <code>to_crs</code> to transform the data into Lambert 93, the official system (EPSG code 2154).</p></li>
<li><p>Display the municipalities of Hauts de Seine (department 92) and use the <code>plot</code> method.</p></li>
<li><p>Keep only Paris and plot the borders on a map: what is the problem for an analysis of intramural Paris?</p></li>
</ol>
<p>You will quickly notice the problem. We do not have the boundaries of Parisian districts, which greatly impoverishes the map of Paris.</p>
<ol start="6" type="1">
<li>This time, use the argument <code>borders="COMMUNE_ARRONDISSEMENT"</code> to obtain a consolidated map with the municipalities and districts in large cities. Convert to Lambert 93.</li>
</ol>
</div>
</div>
</div>
<p>The visualization provided in the question shows that our <code>GeoDataFrame</code> includes a <code>geometry</code> column containing the necessary information to determine the municipal boundaries.</p>
<div id="4fd97673" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;Geographic 2D CRS: EPSG:4326&gt;
Name: WGS 84
Axis Info [ellipsoidal]:
- Lat[north]: Geodetic latitude (degree)
- Lon[east]: Geodetic longitude (degree)
Area of Use:
- name: World.
- bounds: (-180.0, -90.0, 180.0, 90.0)
Datum: World Geodetic System 1984 ensemble
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich</code></pre>
</div>
</div>
<p>The data is in WGS84, we reproject it to Lambert 93</p>
<div id="f0744702" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-9-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="03_geopandas_intro_files/figure-html/cell-9-output-1.png" width="229" height="389" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>In question 5, the issue for Paris is easily noticeable: the boundaries of the arrondissements are missing. This significantly reduces the detail of the map of Paris.</p>
<div id="f089b052" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-10-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="03_geopandas_intro_files/figure-html/cell-10-output-1.png" width="540" height="298" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>At the end of question 6, we obtain the expected map for inner Paris:</p>
<div id="33c27101" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-12-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="03_geopandas_intro_files/figure-html/cell-12-output-1.png" width="540" height="297" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="the-coordinate-reference-system-crs" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> The coordinate reference system (CRS)</h1>
<section id="principle" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="principle"><span class="header-section-number">4.1</span> Principle</h2>
<p>Spatial data is richer than traditional data because it usually includes additional elements to place objects in a Cartesian space. This additional dimension can be simple (a point has two additional pieces of information: <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) or quite complex (polygons, lines with direction, etc.).</p>
<p>Cartographic analysis, therefore, borrows concepts from geometry to represent objects in space. <strong>Projections</strong> are at the heart of managing spatial data. These projections consist of transforming a position in terrestrial space into a position on a plane. This is a projection operation from a three-dimensional space into a two-dimensional space. This <a href="https://www.earthdatascience.org/courses/earth-analytics/spatial-data-r/geographic-vs-projected-coordinate-reference-systems-UTM/">post</a> offers rich elements on the subject, including the following image that clearly shows the principle of a projection:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.earthdatascience.org/images/courses/earth-analytics/spatial-data/spatial-projection-transformations-crs.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Different types of projection"><img src="https://www.earthdatascience.org/images/courses/earth-analytics/spatial-data/spatial-projection-transformations-crs.png" class="img-fluid figure-img" alt="Different types of projection"></a></p>
<figcaption>Different types of projection</figcaption>
</figure>
</div>
<p>This operation is not neutral. One of the consequences of the <a href="https://en.wikipedia.org/wiki/Theorema_egregium">remarkable theorem of Gauss</a> is that the surface of the Earth cannot be mapped without distortion. A projection cannot simultaneously keep distances and angles intact (i.e., positions). Thus, there is no universally better projection, which opens the door to the coexistence of many different projections, designed for different tasks. A poor projection system can distort visual appreciation and also cause errors in calculations on the spatial dimension.</p>
<p><strong>Projection systems are subject to international standards and are often designated by so-called EPSG codes</strong>. This <a href="https://epsg.io/">site</a> is a good reference. The most common for French users are as follows (more info <a href="https://geodesie.ign.fr/contenu/fichiers/documentation/SRCfrance.pdf">here</a>):</p>
<ul>
<li><code>2154</code>: Lambert 93 projection system. This is the official projection system. Most data published by the administration for the metropolis is available in this projection system.</li>
<li><code>27572</code>: Lambert II extended. This is the former official projection system. Older spatial data may be in this format.</li>
<li><code>4326</code>: WGS 84 or pseudo-Mercator system or <em>Web Mercator</em>. This is not actually a projection system but a coordinate system (longitude/latitude) that simply allows angular positioning on the ellipsoid. It is used for GPS data. This is the most common system, especially when working with web map backgrounds.</li>
</ul>
</section>
<section id="the-mercator-system" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-mercator-system"><span class="header-section-number">4.2</span> The Mercator System</h2>
<p>As mentioned above, one of the best-known projections is the Web Mercator projection (EPSG code 3857), which projects spherical longitude and latitude data from the WGS84 system (EPSG 4326) onto flat maps. This is the geodetic system used by the American <a href="https://en.wikipedia.org/wiki/Satellite_navigation">GNSS</a> <a href="https://en.wikipedia.org/wiki/Global_Positioning_System"><strong>GPS</strong></a>, which is used by the vast majority of global navigation systems, let alone Google Maps. This projection preserves angles, which means it distorts distances. It was originally designed to represent the Northern Hemisphere. The farther you move away from it, the more distances are distorted. This leads to well-known distortions (Greenland being oversized, Africa reduced in size, Antarctica being immense, etc.). However, the Mercator projection keeps positions intact. This property explains its use in GPS systems and navigation map backgrounds like <em>Google Maps</em>. It is a projection primarily designed for navigation, not for representing socio-economic information on Earth. This projection is inseparable from the great explorations of the Renaissance, as highlighted by <a href="https://x.com/JulesGrandin/status/1765668642094514447">this Twitter thread</a> by Jules Grandin.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/truesize.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Example of country re-projection from the site thetruesize.com"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/truesize.png" class="img-fluid figure-img" alt="Example of country re-projection from the site thetruesize.com"></a></p>
<figcaption><em>Example of country re-projection from the site <a href="https://thetruesize.com/">thetruesize.com</a></em></figcaption>
</figure>
</div>
<div id="fig-mercator-funny" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mercator-funny-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://rgeo.linogaliana.fr/exercises/img/mercator.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;4.1: “Don’t trust the Mercator projection” on Reddit"><img src="https://rgeo.linogaliana.fr/exercises/img/mercator.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mercator-funny-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: “Don’t trust the Mercator projection” on <code>Reddit</code>
</figcaption>
</figure>
</div>
<p>Notice the significant variations in proportions for certain countries depending on the chosen projections:</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="822" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 821;"><span id="cb9-822"><a href="#cb9-822" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>container_projection<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="1481" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1480;"><span id="cb10-1481"><a href="#cb10-1481" aria-hidden="true" tabindex="-1"></a>container_projection <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="container"&gt;</span></span>
<span id="cb10-1482"><a href="#cb10-1482" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="row"&gt;</span></span>
<span id="cb10-1483"><a href="#cb10-1483" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="projection"&gt;</span></span>
<span id="cb10-1484"><a href="#cb10-1484" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="projection-label"&gt;Choisir une projection&lt;/div&gt;</span></span>
<span id="cb10-1485"><a href="#cb10-1485" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>viewof projection<span class="sc">}</span></span>
<span id="cb10-1486"><a href="#cb10-1486" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb10-1487"><a href="#cb10-1487" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb10-1488"><a href="#cb10-1488" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="row"&gt;</span></span>
<span id="cb10-1489"><a href="#cb10-1489" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="projectedMap"&gt;</span></span>
<span id="cb10-1490"><a href="#cb10-1490" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>projectedMap<span class="sc">}</span></span>
<span id="cb10-1491"><a href="#cb10-1491" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb10-1492"><a href="#cb10-1492" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb10-1493"><a href="#cb10-1493" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="1487" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1486;"><span id="cb11-1487"><a href="#cb11-1487" aria-hidden="true" tabindex="-1"></a>viewof projection <span class="op">=</span> <span class="fu">projectionInput</span>({</span>
<span id="cb11-1488"><a href="#cb11-1488" aria-hidden="true" tabindex="-1"></a>  <span class="dt">name</span><span class="op">:</span> <span class="st">""</span><span class="op">,</span></span>
<span id="cb11-1489"><a href="#cb11-1489" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="st">"Mercator"</span></span>
<span id="cb11-1490"><a href="#cb11-1490" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="1513" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1512;"><span id="cb12-1513"><a href="#cb12-1513" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {projectionInput} <span class="im">from</span> <span class="st">"@fil/d3-projections"</span></span>
<span id="cb12-1514"><a href="#cb12-1514" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {map} <span class="im">from</span> <span class="st">"@linogaliana/base-map"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="1517" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1516;"><span id="cb13-1517"><a href="#cb13-1517" aria-hidden="true" tabindex="-1"></a>projectedMap <span class="op">=</span> <span class="fu">map</span>(projection<span class="op">,</span></span>
<span id="cb13-1518"><a href="#cb13-1518" aria-hidden="true" tabindex="-1"></a>                   {</span>
<span id="cb13-1519"><a href="#cb13-1519" aria-hidden="true" tabindex="-1"></a>                     <span class="co">//svg: true,</span></span>
<span id="cb13-1520"><a href="#cb13-1520" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">value</span><span class="op">:</span> projection<span class="op">.</span><span class="at">options</span><span class="op">,</span></span>
<span id="cb13-1521"><a href="#cb13-1521" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">width</span><span class="op">:</span> width_projected_map<span class="op">,</span></span>
<span id="cb13-1522"><a href="#cb13-1522" aria-hidden="true" tabindex="-1"></a>                     <span class="co">//height: 300,</span></span>
<span id="cb13-1523"><a href="#cb13-1523" aria-hidden="true" tabindex="-1"></a>                     <span class="co">//rotate: [0, -90],</span></span>
<span id="cb13-1524"><a href="#cb13-1524" aria-hidden="true" tabindex="-1"></a>                     <span class="co">//inertia: true,</span></span>
<span id="cb13-1525"><a href="#cb13-1525" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">show_equator</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb13-1526"><a href="#cb13-1526" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">background</span><span class="op">:</span> <span class="st">"#f1f0eb"</span></span>
<span id="cb13-1527"><a href="#cb13-1527" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb13-1528"><a href="#cb13-1528" aria-hidden="true" tabindex="-1"></a>                     <span class="co">//show_structure: true</span></span>
<span id="cb13-1529"><a href="#cb13-1529" aria-hidden="true" tabindex="-1"></a>                   })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="1527" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1526;"><span id="cb14-1527"><a href="#cb14-1527" aria-hidden="true" tabindex="-1"></a>width_projected_map <span class="op">=</span> <span class="bu">screen</span><span class="op">.</span><span class="at">width</span><span class="op">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<p>To go further, the following interactive map, created by Nicolas Lambert and derived from this <a href="https://observablehq.com/@neocartocnrs/impact-of-projections-on-areas"><em>Observable notebook</em></a>, illustrates the distorting effect of the Mercator projection, among others, on our perception of country sizes.</p>
<details>
<summary>
Voir la carte interactive
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="1547" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1546;"><span id="cb15-1547"><a href="#cb15-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div class="grid-container"&gt;</span></span>
<span id="cb15-1548"><a href="#cb15-1548" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="viewof-projection"&gt;</span><span class="sc">${</span>viewof projectionBertin<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb15-1549"><a href="#cb15-1549" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="viewof-mycountry"&gt;</span><span class="sc">${</span>viewof mycountry<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb15-1550"><a href="#cb15-1550" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="map-bertin"&gt;</span><span class="sc">${</span>mapBertin<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb15-1551"><a href="#cb15-1551" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="expression">

</div>
</div>
</div>
</details>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="1562" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1561;"><span id="cb16-1562"><a href="#cb16-1562" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {map <span class="im">as</span> mapBertin<span class="op">,</span> viewof projection <span class="im">as</span> projectionBertin<span class="op">,</span> viewof mycountry} <span class="im">from</span> <span class="st">"@neocartocnrs/impact-of-projections-on-areas"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>
<p>There are actually many possible representations of the world, some more intricate than others. Projections are numerous, and some can have <a href="https://imgs.xkcd.com/comics/map_projections.png">surprising shapes</a>. For example, the <a href="https://storymaps.arcgis.com/stories/756bcae18d304a1eac140f19f4d5cb3d">Spilhaus projection</a> proposes centering the view on the oceans rather than land. That’s why it is sometimes referred to as the world as seen by fish.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="1576" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1575;"><span id="cb17-1576"><a href="#cb17-1576" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div class="centered"&gt;</span><span class="sc">${</span>spilhaus<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="1582" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1581;"><span id="cb18-1582"><a href="#cb18-1582" aria-hidden="true" tabindex="-1"></a>spilhaus <span class="op">=</span> {</span>
<span id="cb18-1583"><a href="#cb18-1583" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb18-1584"><a href="#cb18-1584" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> width<span class="op">;</span></span>
<span id="cb18-1585"><a href="#cb18-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1586"><a href="#cb18-1586" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> context <span class="op">=</span> DOM<span class="op">.</span><span class="fu">context2d</span>(width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb18-1587"><a href="#cb18-1587" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoStereographic</span>()</span>
<span id="cb18-1588"><a href="#cb18-1588" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([<span class="dv">95</span><span class="op">,</span> <span class="dv">45</span>])</span>
<span id="cb18-1589"><a href="#cb18-1589" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([width <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> height <span class="op">/</span> <span class="dv">2</span>])</span>
<span id="cb18-1590"><a href="#cb18-1590" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scale</span>(width <span class="op">/</span> <span class="fl">10.1</span>)</span>
<span id="cb18-1591"><a href="#cb18-1591" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">center</span>([<span class="dv">30</span><span class="op">,</span> <span class="op">-</span><span class="dv">5</span>])</span>
<span id="cb18-1592"><a href="#cb18-1592" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clipAngle</span>(<span class="dv">166</span>)<span class="op">;</span></span>
<span id="cb18-1593"><a href="#cb18-1593" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection<span class="op">,</span> context)<span class="op">;</span></span>
<span id="cb18-1594"><a href="#cb18-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1595"><a href="#cb18-1595" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> land <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">land</span>)<span class="op">;</span></span>
<span id="cb18-1596"><a href="#cb18-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1597"><a href="#cb18-1597" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">lineJoin</span> <span class="op">=</span> <span class="st">"round"</span><span class="op">;</span></span>
<span id="cb18-1598"><a href="#cb18-1598" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">lineCap</span> <span class="op">=</span> <span class="st">"round"</span><span class="op">;</span></span>
<span id="cb18-1599"><a href="#cb18-1599" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"#f2f1ed"</span><span class="op">;</span></span>
<span id="cb18-1600"><a href="#cb18-1600" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb18-1601"><a href="#cb18-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1602"><a href="#cb18-1602" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb18-1603"><a href="#cb18-1603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span>})<span class="op">;</span></span>
<span id="cb18-1604"><a href="#cb18-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">path</span>(land)<span class="op">;</span></span>
<span id="cb18-1605"><a href="#cb18-1605" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb18-1606"><a href="#cb18-1606" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb18-1607"><a href="#cb18-1607" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">clip</span>(<span class="st">"evenodd"</span>)<span class="op">;</span></span>
<span id="cb18-1608"><a href="#cb18-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1609"><a href="#cb18-1609" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">save</span>()<span class="op">;</span></span>
<span id="cb18-1610"><a href="#cb18-1610" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb18-1611"><a href="#cb18-1611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">path</span>(land)<span class="op">;</span></span>
<span id="cb18-1612"><a href="#cb18-1612" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">filter</span> <span class="op">=</span> <span class="st">"blur(12px)"</span><span class="op">;</span></span>
<span id="cb18-1613"><a href="#cb18-1613" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"#006994"</span><span class="op">;</span></span>
<span id="cb18-1614"><a href="#cb18-1614" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">fill</span>(<span class="st">"evenodd"</span>)<span class="op">;</span></span>
<span id="cb18-1615"><a href="#cb18-1615" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">restore</span>()<span class="op">;</span></span>
<span id="cb18-1616"><a href="#cb18-1616" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-1617"><a href="#cb18-1617" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb18-1618"><a href="#cb18-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">path</span>(d3<span class="op">.</span><span class="fu">geoGraticule10</span>())<span class="op">;</span></span>
<span id="cb18-1619"><a href="#cb18-1619" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">globalAlpha</span> <span class="op">=</span> <span class="fl">0.2</span><span class="op">;</span></span>
<span id="cb18-1620"><a href="#cb18-1620" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"#000"</span><span class="op">;</span></span>
<span id="cb18-1621"><a href="#cb18-1621" aria-hidden="true" tabindex="-1"></a>  context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb18-1622"><a href="#cb18-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1623"><a href="#cb18-1623" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> context<span class="op">.</span><span class="at">canvas</span><span class="op">;</span></span>
<span id="cb18-1624"><a href="#cb18-1624" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="1620" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1619;"><span id="cb19-1620"><a href="#cb19-1620" aria-hidden="true" tabindex="-1"></a><span class="co">//import {map as spilhausmap} with {height, width} from "@d3/spilhaus-shoreline-map"</span></span>
<span id="cb19-1621"><a href="#cb19-1621" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { world } <span class="im">from</span> <span class="st">"@d3/spilhaus-shoreline-map"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip for France
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>For France, in the WGS84 system (4326):</p>
<ul>
<li>Longitude (<span class="math inline">\(x\)</span>) revolves around 0° (from -5.2 to +9.6 to be precise)</li>
<li>Latitude (<span class="math inline">\(y\)</span>) around 45 (between +41.3 and +51.1)</li>
</ul>
<p>In the Lambert 93 system (2154):</p>
<ul>
<li>Coordinates <span class="math inline">\(x\)</span>: between 100,000 and 1,300,000</li>
<li>Latitude (<span class="math inline">\(y\)</span>): between 6,000,000 and 7,200,000</li>
</ul>
<p><a href="https://medium.com/@_FrancoisM/introduction-%C3%A0-la-manipulation-de-donn%C3%A9es-cartographiques-23b4e38d8f0f">More details</a></p>
</div>
</div>
</div>
</section>
<section id="handling-with-geopandas" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="handling-with-geopandas"><span class="header-section-number">4.3</span> Handling with <code>GeoPandas</code></h2>
<p>Regarding the management of projections with <code>GeoPandas</code>, the <a href="https://geopandas.org/projections.html">official documentation</a> is very well done. It provides the following warning that is good to keep in mind:</p>
<blockquote class="blockquote">
<p>Be aware that most of the time you don’t have to set a projection. Data loaded from a reputable source (using the geopandas.read_file() command) should always include projection information. You can see an object’s current CRS through the GeoSeries.crs attribute.</p>
<p>From time to time, however, you may get data that does not include a projection. In this situation, you have to set the CRS so geopandas knows how to interpret the coordinates.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://imgs.xkcd.com/comics/bad_map_projection_south_america.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Image borrowed from XKCD https://xkcd.com/2256/ which can also be found on https://blog.chrislansdown.com/2020/01/17/a-great-map-projection-joke/"><img src="https://imgs.xkcd.com/comics/bad_map_projection_south_america.png" class="img-fluid figure-img" alt="Image borrowed from XKCD https://xkcd.com/2256/ which can also be found on https://blog.chrislansdown.com/2020/01/17/a-great-map-projection-joke/"></a></p>
<figcaption><em>Image borrowed from XKCD <a href="https://xkcd.com/2256/" class="uri">https://xkcd.com/2256/</a> which can also be found on <a href="https://blog.chrislansdown.com/2020/01/17/a-great-map-projection-joke/" class="uri">https://blog.chrislansdown.com/2020/01/17/a-great-map-projection-joke/</a></em></figcaption>
</figure>
</div>
<p>The two main methods for defining the projection system used are:</p>
<ul>
<li><strong><code>df.set_crs</code></strong>: This command is used to specify what projection system is used, i.e., how the coordinates <em>(x,y)</em> are related to the Earth’s surface. <strong>This command should not be used to transform the coordinate system, only to define it</strong>.</li>
<li><strong><code>df.to_crs</code></strong>: <strong>This command is used to project the points of a geometry into another, i.e., to recalculate the coordinates according to another projection system</strong>.</li>
</ul>
<p>In the specific case of producing a map with an OpenStreetMaps background or a dynamic leaflet map, it is necessary to de-project the data (for example from Lambert-93) to land in the unprojected WGS 84 system (code EPSG 4326). This site <a href="https://epsg.io/">dedicated to geographic projections</a> can be useful for finding the projection system of a file where it is not indicated.</p>
<p>The next exercise will help convince you of the importance of delegating as much of the projection system management as possible to <code>GeoPandas</code>. The issue is not only about the relevance of the representation of geographic objects on the map. Indeed, all geometric operations (area calculations, distance, etc.) can be affected by the choices made regarding the projection system.</p>
</section>
<section id="exercise-to-understand-how-important-a-projection-system-can-be" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="exercise-to-understand-how-important-a-projection-system-can-be"><span class="header-section-number">4.4</span> Exercise to understand how important a projection system can be</h2>
<p>Here is some code using <code>cartiflette</code> again to retrieve French borders (divided by region):</p>
<div id="load-france-data" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="load-france-data"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="load-france-data-1"><a href="#load-france-data-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cartiflette <span class="im">import</span> carti_download</span>
<span id="load-france-data-2"><a href="#load-france-data-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="load-france-data-3"><a href="#load-france-data-3" aria-hidden="true" tabindex="-1"></a>france <span class="op">=</span> carti_download(</span>
<span id="load-france-data-4"><a href="#load-france-data-4" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>[<span class="st">"France"</span>],</span>
<span id="load-france-data-5"><a href="#load-france-data-5" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span><span class="dv">4326</span>,</span>
<span id="load-france-data-6"><a href="#load-france-data-6" aria-hidden="true" tabindex="-1"></a>    borders<span class="op">=</span><span class="st">"REGION"</span>,</span>
<span id="load-france-data-7"><a href="#load-france-data-7" aria-hidden="true" tabindex="-1"></a>    vectorfile_format<span class="op">=</span><span class="st">"geojson"</span>,</span>
<span id="load-france-data-8"><a href="#load-france-data-8" aria-hidden="true" tabindex="-1"></a>    simplification<span class="op">=</span><span class="dv">50</span>,</span>
<span id="load-france-data-9"><a href="#load-france-data-9" aria-hidden="true" tabindex="-1"></a>    filter_by<span class="op">=</span><span class="st">"FRANCE_ENTIERE"</span>,</span>
<span id="load-france-data-10"><a href="#load-france-data-10" aria-hidden="true" tabindex="-1"></a>    source<span class="op">=</span><span class="st">"EXPRESS-COG-CARTO-TERRITOIRE"</span>,</span>
<span id="load-france-data-11"><a href="#load-france-data-11" aria-hidden="true" tabindex="-1"></a>    year<span class="op">=</span><span class="dv">2022</span>,</span>
<span id="load-france-data-12"><a href="#load-france-data-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="load-france-data-13"><a href="#load-france-data-13" aria-hidden="true" tabindex="-1"></a>france <span class="op">=</span> france.loc[france[<span class="st">"INSEE_REG"</span>] <span class="op">&gt;</span> <span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2: Projections, representations, and approximations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Experiment with representing the borders of France using several projections:</li>
</ol>
<ul>
<li>Mercator WGS84 (EPSG: 4326)</li>
<li>Healpix projection (<code>+proj=healpix +lon_0=0 +a=1</code>)</li>
<li>Projection for Tahiti (EPSG: 3304)</li>
<li>Albers projection for the United States (EPSG: 5070)</li>
</ul>
<ol start="2" type="1">
<li>Calculate the area in <span class="math inline">\(km^2\)</span> of the French regions in the following two projection systems:
World Mercator WGS84 (EPSG: 3395) and Lambert 93 (EPSG: 2154). Calculate the difference in <span class="math inline">\(km^2\)</span> for each region.</li>
</ol>
</div>
</div>
</div>
<div id="0c62e4f2" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-15-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="03_geopandas_intro_files/figure-html/cell-15-output-1.png" width="447" height="442" class="figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-15-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="03_geopandas_intro_files/figure-html/cell-15-output-2.png" width="588" height="232" class="figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-15-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="03_geopandas_intro_files/figure-html/cell-15-output-3.png" width="524" height="442" class="figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-15-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="03_geopandas_intro_files/figure-html/cell-15-output-4.png" width="355" height="442" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>With question 1 illustrating some pathological cases,
we understand that projections have a distorting effect
which is clearly visible when we represent them side by side in the form of maps:</p>
<p>However, the problem is not just visual; it is also numerical. Geometric calculations lead to quite notable differences depending on the reference system used.</p>
<p>We can represent these approximations on a map<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> to get an idea of the regions where the measurement error is the greatest (subject of question 2).</p>
<div id="5b1e53ba" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-19-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="03_geopandas_intro_files/figure-html/cell-19-output-1.png" width="416" height="389" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This type of measurement error is normal at the scale of the French territory.
Projections inherited from Mercator distort distances,
especially when approaching the equator or the poles.</p>
<p>Therefore, it is always necessary to
reproject the data into the Lambert 93 system (the
official system for mainland France) before performing geometric calculations.</p>
</section>
</section>
<section id="import-and-explore-spatial-datasets" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Import and explore spatial datasets</h1>
<p>Often, the communal division serves only as a background for maps, providing context and reference points. Generally, it is used to contextualize another dataset.</p>
<p>To illustrate this approach, we will use the data on the locations and capacities of Vélib stations, available on the <a href="https://opendata.paris.fr/explore/dataset/velib-emplacement-des-stations/table/">open data site of the city of Paris</a>, and directly queryable via the URL <a href="https://opendata.paris.fr/explore/dataset/velib-emplacement-des-stations/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr" class="uri">https://opendata.paris.fr/explore/dataset/velib-emplacement-des-stations/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr</a>. This dataset will help us illustrate some classic issues in spatial data analysis.</p>
<div id="cell-load-velib" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cell-load-velib"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cell-load-velib-1"><a href="#cell-load-velib-1" aria-hidden="true" tabindex="-1"></a>velib_data <span class="op">=</span> <span class="st">"https://opendata.paris.fr/explore/dataset/velib-emplacement-des-stations/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr"</span></span>
<span id="cell-load-velib-2"><a href="#cell-load-velib-2" aria-hidden="true" tabindex="-1"></a>stations <span class="op">=</span> gpd.read_file(velib_data)</span>
<span id="cell-load-velib-3"><a href="#cell-load-velib-3" aria-hidden="true" tabindex="-1"></a>stations.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping field coordonnees_geo: unsupported OGR type: 3</code></pre>
</div>
<div id="load-velib" class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">stationcode</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25</td>
<td>Silly - Galliéni</td>
<td>21010</td>
<td>POINT (2.23255 48.83558)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>36</td>
<td>Guersant - Gouvion-Saint-Cyr</td>
<td>17041</td>
<td>POINT (2.28767 48.88288)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="locate-data-on-a-map" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="locate-data-on-a-map"><span class="header-section-number">5.1</span> Locate data on a map</h2>
<p>The first step, before thoroughly exploring the data, is to display it on a contextual map to ensure the geographic coverage of the data. In our case, this will give us an intuition about the locations of the stations, particularly their uneven density in the Parisian urban space.</p>
</section>
<section id="application" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="application"><span class="header-section-number">5.2</span> Application</h2>
<p>In the next exercise, we propose to quickly create a map with three layers:</p>
<ul>
<li>The locations of stations as points;</li>
<li>The borders of communes and arrondissements for context;</li>
<li>The borders of departments with wider lines for additional context.</li>
</ul>
<p>We will delve deeper into cartographic work in the next chapter. However, being able to quickly position your data on a map is always useful in exploratory work.</p>
<p>Before the exercise, use the following function from the <code>cartiflette</code> package to retrieve the base map of the departments of the inner suburbs:</p>
<div id="load-idf" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="load-idf"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="load-idf-1"><a href="#load-idf-1" aria-hidden="true" tabindex="-1"></a>idf <span class="op">=</span> carti_download(</span>
<span id="load-idf-2"><a href="#load-idf-2" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>[<span class="st">"11"</span>],</span>
<span id="load-idf-3"><a href="#load-idf-3" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span><span class="dv">4326</span>,</span>
<span id="load-idf-4"><a href="#load-idf-4" aria-hidden="true" tabindex="-1"></a>    borders<span class="op">=</span><span class="st">"DEPARTEMENT"</span>,</span>
<span id="load-idf-5"><a href="#load-idf-5" aria-hidden="true" tabindex="-1"></a>    vectorfile_format<span class="op">=</span><span class="st">"geojson"</span>,</span>
<span id="load-idf-6"><a href="#load-idf-6" aria-hidden="true" tabindex="-1"></a>    filter_by<span class="op">=</span><span class="st">"REGION"</span>,</span>
<span id="load-idf-7"><a href="#load-idf-7" aria-hidden="true" tabindex="-1"></a>    source<span class="op">=</span><span class="st">"EXPRESS-COG-CARTO-TERRITOIRE"</span>,</span>
<span id="load-idf-8"><a href="#load-idf-8" aria-hidden="true" tabindex="-1"></a>    year<span class="op">=</span><span class="dv">2022</span>,</span>
<span id="load-idf-9"><a href="#load-idf-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="load-idf-10"><a href="#load-idf-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="load-idf-11"><a href="#load-idf-11" aria-hidden="true" tabindex="-1"></a>petite_couronne_departements <span class="op">=</span> idf.loc[</span>
<span id="load-idf-12"><a href="#load-idf-12" aria-hidden="true" tabindex="-1"></a>    idf[<span class="st">"INSEE_DEP"</span>].isin([<span class="st">"75"</span>, <span class="st">"92"</span>, <span class="st">"93"</span>, <span class="st">"94"</span>])</span>
<span id="load-idf-13"><a href="#load-idf-13" aria-hidden="true" tabindex="-1"></a>].to_crs(<span class="dv">2154</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3: Import and explore the Velib data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Let’s start by retrieving the data needed to produce this map.</p>
<ol type="1">
<li>Check the geographic projection of <code>station</code> (attribute <code>crs</code>). If it is different from the commune data, reproject the latter to the same projection system as the Velib stations.</li>
<li>Keep only the top 50 stations (variable <code>capacity</code>).</li>
</ol>
<p>We can now build the map sequentially using the <code>plot</code> method, with the help of <a href="https://geopandas.org/en/stable/docs/user_guide/mapping.html#maps-with-layers">this documentation</a>.</p>
<ol start="3" type="1">
<li><p>First, use <code>boundary.plot</code> to represent the base layer of commune and arrondissement boundaries:</p>
<ul>
<li>Use the options <code>edgecolor = "black"</code> and <code>linewidth = 0.5</code></li>
<li>Name this object <code>base</code></li>
</ul></li>
<li><p>Add the layer of departments with the options <code>edgecolor = "blue"</code> and <code>linewidth = 0.7</code>.</p></li>
<li><p>Add the positions of the stations and adjust the size according to the <code>capacity</code> variable. The aesthetics of the obtained points can be controlled with the options <code>color = "red"</code> and <code>alpha = 0.4</code>.</p></li>
<li><p>Remove the axes and add a title with the options below:</p></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>base.set_axis_off()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>base.set_title(<span class="st">"The 50 main Velib stations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="7" type="1">
<li>Following the model below, use the <code>contextily</code> package to add a contextual OpenStreetMap base map:</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> contextily <span class="im">as</span> ctx</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ...</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ctx.add_basemap(ax, source<span class="op">=</span>ctx.providers.OpenStreetMap.Mapnik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>⚠️ <code>contextily</code> expects data in the Pseudo Mercator representation system (<a href="https://epsg.io/3857">EPSG: 3857</a>), so it will be necessary to reproject your data before creating the map.</p>
</div>
</div>
</div>
<p>The base layer obtained after question 3</p>
<div id="cell-exo2-q3" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/exo2-q3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="03_geopandas_intro_files/figure-html/exo2-q3-output-1.png" id="exo2-q3" width="420" height="425" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Then by adding the departmental boundaries (question 4).</p>
<div id="cell-exo2-q4" class="cell" data-execution_count="24">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/exo2-q4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="03_geopandas_intro_files/figure-html/exo2-q4-output-1.png" id="exo2-q4" width="420" height="425" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Then the stations (question 5).</p>
<div id="cell-exo2-q5" class="cell" data-execution_count="25">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/exo2-q5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="03_geopandas_intro_files/figure-html/exo2-q5-output-1.png" id="exo2-q5" width="420" height="425" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Next, if we remove the axes (question 6), we get:</p>
<div id="762d6c96" class="cell" data-execution_count="26">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-27-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="03_geopandas_intro_files/figure-html/cell-27-output-1.png" width="372" height="410" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="32cf2a88" class="cell" data-execution_count="27">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-28-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="03_geopandas_intro_files/figure-html/cell-28-output-1.png" width="413" height="425" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The map speaks for itself. However, for those less familiar with Parisian geography, it could be made even clearer with the addition of a contextual background map <em>openstreetmap</em>. In fine, this results in the following map:</p>
<div id="a1cac918" class="cell" data-execution_count="28">
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>&lt;Axes: title={'center': 'Les 50 principales stations de Vélib'}&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 672x480 with 0 Axes&gt;</code></pre>
</div>
</div>
</section>
<section id="geometric-operations" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="geometric-operations"><span class="header-section-number">5.3</span> Geometric operations</h2>
<p>In addition to simplified graphical representation, the main advantage of using <code>GeoPandas</code> is the availability of efficient methods for manipulating spatial dimensions. Many of these methods come from the package <a href="https://shapely.readthedocs.io/en/latest/manual.html#general-attributes-and-methods"><code>Shapely</code></a>.</p>
<p>We have already seen the <code>to_crs</code> method for reprojecting data vectorized without worrying. We have also mentioned the <code>area</code> method to calculate areas. There are many such methods, and the goal of this chapter is not to be exhaustive but to serve as a general introduction to delve deeper later. Among the most useful methods, we can mention <code>centroid</code>, which, as its name suggests, finds the centroid of each polygon, thus transforming surface data into point data. For example, to roughly represent the centers of villages in Haute-Garonne (31), after downloading the appropriate base map, we will do the following:</p>
<div id="8e4caff9" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="8e4caff9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8e4caff9-1"><a href="#8e4caff9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cartiflette <span class="im">import</span> carti_download</span>
<span id="8e4caff9-2"><a href="#8e4caff9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="8e4caff9-3"><a href="#8e4caff9-3" aria-hidden="true" tabindex="-1"></a>communes_31 <span class="op">=</span> carti_download(</span>
<span id="8e4caff9-4"><a href="#8e4caff9-4" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>[<span class="st">"31"</span>],</span>
<span id="8e4caff9-5"><a href="#8e4caff9-5" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span><span class="dv">4326</span>,</span>
<span id="8e4caff9-6"><a href="#8e4caff9-6" aria-hidden="true" tabindex="-1"></a>    borders<span class="op">=</span><span class="st">"COMMUNE"</span>,</span>
<span id="8e4caff9-7"><a href="#8e4caff9-7" aria-hidden="true" tabindex="-1"></a>    vectorfile_format<span class="op">=</span><span class="st">"geojson"</span>,</span>
<span id="8e4caff9-8"><a href="#8e4caff9-8" aria-hidden="true" tabindex="-1"></a>    filter_by<span class="op">=</span><span class="st">"DEPARTEMENT"</span>,</span>
<span id="8e4caff9-9"><a href="#8e4caff9-9" aria-hidden="true" tabindex="-1"></a>    source<span class="op">=</span><span class="st">"EXPRESS-COG-CARTO-TERRITOIRE"</span>,</span>
<span id="8e4caff9-10"><a href="#8e4caff9-10" aria-hidden="true" tabindex="-1"></a>    year<span class="op">=</span><span class="dv">2022</span>,</span>
<span id="8e4caff9-11"><a href="#8e4caff9-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="8e4caff9-12"><a href="#8e4caff9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="8e4caff9-13"><a href="#8e4caff9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># on reprojete en 3857 pour le fond de carte</span></span>
<span id="8e4caff9-14"><a href="#8e4caff9-14" aria-hidden="true" tabindex="-1"></a>communes_31 <span class="op">=</span> communes_31.to_crs(<span class="dv">3857</span>)</span>
<span id="8e4caff9-15"><a href="#8e4caff9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="8e4caff9-16"><a href="#8e4caff9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># on calcule le centroide</span></span>
<span id="8e4caff9-17"><a href="#8e4caff9-17" aria-hidden="true" tabindex="-1"></a>dep_31 <span class="op">=</span> communes_31.copy()</span>
<span id="8e4caff9-18"><a href="#8e4caff9-18" aria-hidden="true" tabindex="-1"></a>communes_31[<span class="st">"geometry"</span>] <span class="op">=</span> communes_31[<span class="st">"geometry"</span>].centroid</span>
<span id="8e4caff9-19"><a href="#8e4caff9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="8e4caff9-20"><a href="#8e4caff9-20" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> communes_31.plot(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), color<span class="op">=</span><span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="8e4caff9-21"><a href="#8e4caff9-21" aria-hidden="true" tabindex="-1"></a>dep_31.to_crs(<span class="dv">3857</span>).plot(</span>
<span id="8e4caff9-22"><a href="#8e4caff9-22" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax, zorder<span class="op">=</span><span class="dv">1</span>, edgecolor<span class="op">=</span><span class="st">"black"</span>, facecolor<span class="op">=</span><span class="st">"none"</span>, color<span class="op">=</span><span class="va">None</span></span>
<span id="8e4caff9-23"><a href="#8e4caff9-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="8e4caff9-24"><a href="#8e4caff9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ctx.add_basemap(ax, source = ctx.providers.Stamen.Toner)</span></span>
<span id="8e4caff9-25"><a href="#8e4caff9-25" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()</span>
<span id="8e4caff9-26"><a href="#8e4caff9-26" aria-hidden="true" tabindex="-1"></a>ax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-30-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="03_geopandas_intro_files/figure-html/cell-30-output-1.png" width="720" height="758" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Therefore, with <code>Geopandas</code>, the entire <code>Pandas</code> grammar can be used to process the attribute dimension of the data while the geographic dimension can be manipulated with appropriate methods.</p>
</section>
</section>
<section id="enrichments-through-the-spatial-dimension-spatial-joins" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Enrichments through the spatial dimension: spatial joins</h1>
<section id="principle-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="principle-1"><span class="header-section-number">6.1</span> Principle</h2>
<p>The previous map already illustrates the power of cartographic representation. With just a few lines of code and minimal operations on our data, we already gain a better understanding of the phenomenon we wish to observe. Specifically, we clearly detect a center-periphery structure in our data, which is not surprising but reassuring to find at first glance.</p>
<p>We also notice that the most used stations, outside of the hypercenter of Paris, are generally located on major roads or near parks. Again, nothing surprising, but it is reassuring to see this in our data.</p>
<p>Now, we can explore the structure of our dataset more thoroughly. However, if we look at it, we notice that we have limited information in the raw dataset.</p>
<div id="cell-visualise-before-spatial-joins" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cell-visualise-before-spatial-joins"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cell-visualise-before-spatial-joins-1"><a href="#cell-visualise-before-spatial-joins-1" aria-hidden="true" tabindex="-1"></a>stations.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="visualise-before-spatial-joins" class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">stationcode</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25</td>
<td>Silly - Galliéni</td>
<td>21010</td>
<td>POINT (643667.502 6859777.173)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>36</td>
<td>Guersant - Gouvion-Saint-Cyr</td>
<td>17041</td>
<td>POINT (647760.557 6864997.91)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In the previous chapter, we presented how associating datasets through a common dimension can enhance their value. In that case, it involved matching data based on common information in both datasets.</p>
<p>Now we have an additional implicit information in our two datasets: the geographical dimension. Spatial join refers to the association of datasets based on the geographical dimension. There are many different types of spatial joins: finding points within a polygon, finding intersections between multiple areas, linking a point to its nearest neighbor in another source, etc.</p>
</section>
<section id="example-locating-stations-in-their-neighborhood" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="example-locating-stations-in-their-neighborhood"><span class="header-section-number">6.2</span> Example: locating stations in their neighborhood</h2>
<p>In this exercise, we will assume that:</p>
<ul>
<li>The locations of the <code>velib</code> stations are stored in a dataframe named <code>stations</code>.</li>
<li>The administrative data is in a dataframe named <code>petite_couronne</code>.</li>
</ul>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4: Associate Stations with Their Corresponding Communes and Arrondissements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Perform a spatial join to enrich the station data by adding information from <code>petite_couronne</code>. Call this object <code>stations_info</code>.</li>
<li>Count the number of stations and the median size of the stations by arrondissement.</li>
<li>Create the objects <code>stations_19e</code> and <code>arrondissement_19e</code> to store, respectively, the stations belonging to the 19th arrondissement and the boundaries of the arrondissement.</li>
<li>Count the number of velib stations and the number of velib spots by arrondissement or commune. Represent each of these pieces of information on a map.</li>
<li>Represent the map of stations in the 19th arrondissement with the following code:</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> petite_couronne.loc[petite_couronne[<span class="st">"INSEE_DEP"</span>] <span class="op">==</span> <span class="st">"75"</span>].boundary.plot(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    edgecolor<span class="op">=</span><span class="st">"k"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>arrondissement_19e.boundary.plot(ax<span class="op">=</span>base, edgecolor<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>stations_19.plot(ax<span class="op">=</span>base, color<span class="op">=</span><span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>base.set_axis_off()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>base.set_title(<span class="st">"Les stations Vélib du 19e arrondissement"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Following the previous examples, only represent the 19th arrondissement and add an openstreetmap background to better locate the stations.</p>
<ol start="6" type="1">
<li>Represent the same information but in density (divide by the surface area of the arrondissement or commune in km²).</li>
</ol>
</div>
</div>
</div>
<p>After the spatial join, the dataset presents the following structure:</p>
<div id="b5b6c064" class="cell" data-execution_count="32">
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">stationcode</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">index_right</th>
<th data-quarto-table-cell-role="th">INSEE_DEP</th>
<th data-quarto-table-cell-role="th">INSEE_REG</th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">NOM</th>
<th data-quarto-table-cell-role="th">INSEE_COM</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">AAV2020</th>
<th data-quarto-table-cell-role="th">TAAV2017</th>
<th data-quarto-table-cell-role="th">TDAAV2017</th>
<th data-quarto-table-cell-role="th">CATEAAV2020</th>
<th data-quarto-table-cell-role="th">BV2012</th>
<th data-quarto-table-cell-role="th">LIBELLE_DEPARTEMENT</th>
<th data-quarto-table-cell-role="th">LIBELLE_REGION</th>
<th data-quarto-table-cell-role="th">PAYS</th>
<th data-quarto-table-cell-role="th">SOURCE</th>
<th data-quarto-table-cell-role="th">AREA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25</td>
<td>Silly - Galliéni</td>
<td>21010</td>
<td>POINT (643667.502 6859777.173)</td>
<td>49</td>
<td>92</td>
<td>11</td>
<td>COMMUNE_0000000009736552</td>
<td>Boulogne-Billancourt</td>
<td>92012</td>
<td>...</td>
<td>001</td>
<td>5</td>
<td>50</td>
<td>12</td>
<td>75056</td>
<td>Hauts-de-Seine</td>
<td>Île-de-France</td>
<td>France</td>
<td>IGN:EXPRESS-COG-CARTO-TERRITOIRE</td>
<td>metropole</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>36</td>
<td>Guersant - Gouvion-Saint-Cyr</td>
<td>17041</td>
<td>POINT (647760.557 6864997.91)</td>
<td>11</td>
<td>75</td>
<td>11</td>
<td>ARR_MUNI0000000009736041</td>
<td>Paris 17e Arrondissement</td>
<td>75056</td>
<td>...</td>
<td>001</td>
<td>5</td>
<td>50</td>
<td>11</td>
<td>75056</td>
<td>Paris</td>
<td>Île-de-France</td>
<td>France</td>
<td>IGN:EXPRESS-COG-CARTO-TERRITOIRE</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2 rows × 31 columns</p>
</div>
</div>
</div>
<p>We can therefore calculate statistics by district, just as we would with a <code>Pandas DataFrame</code> (question 2):</p>
<div id="cell-exo4-q2" class="cell" data-execution_count="33">
<div id="exo4-q2" class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NOM</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">capacity</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">median</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>Ville-d'Avray</td>
<td>1</td>
<td>24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>Joinville-le-Pont</td>
<td>1</td>
<td>40.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>Garches</td>
<td>2</td>
<td>21.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>La Courneuve</td>
<td>2</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>Le Pré-Saint-Gervais</td>
<td>2</td>
<td>21.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">51</td>
<td>Paris 16e Arrondissement</td>
<td>64</td>
<td>31.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>Paris 12e Arrondissement</td>
<td>66</td>
<td>38.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>Paris 13e Arrondissement</td>
<td>68</td>
<td>33.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>Paris 20e Arrondissement</td>
<td>71</td>
<td>25.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>Paris 15e Arrondissement</td>
<td>90</td>
<td>35.0</td>
</tr>
</tbody>
</table>

<p>83 rows × 3 columns</p>
</div>
</div>
</div>
<p>However, maps will probably be more illustrative. To begin with question 3, we can represent the stations of the 19th arrondissement, first within the whole of Paris.</p>
<div id="cell-exo4-q4" class="cell" data-execution_count="35">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/exo4-q4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="03_geopandas_intro_files/figure-html/exo4-q4-output-1.png" id="exo4-q4" width="540" height="317" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>We can then zoom in on this arrondissement and create a map with a more detailed background:</p>
<div id="cell-exo4-q4b" class="cell" data-execution_count="36">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/exo4-q4b-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="03_geopandas_intro_files/figure-html/exo4-q4b-output-1.png" id="exo4-q4b" width="391" height="423" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Our map after question 5 looks like the following one</p>
<div id="cell-exo4-q5" class="cell" data-execution_count="37">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/exo4-q5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="03_geopandas_intro_files/figure-html/exo4-q5-output-1.png" id="exo4-q5" width="524" height="389" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="c3c49f96" class="cell" data-execution_count="38">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-39-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="03_geopandas_intro_files/figure-html/cell-39-output-1.png" width="515" height="389" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>With this map, based on color gradients (choropleth map), the reader falls victim to a classic illusion. The most visible arrondissements on the map are the largest ones. It is logical that these areas are also better equipped with Vélib stations. Although the availability of Vélib stations is likely more related to population density and infrastructure, the size effect is likely the most visible phenomenon on our map, even though it might not be the primary factor in reality.</p>
<p>If we instead represent the capacity in terms of density, to account for the varying sizes of the arrondissements, the conclusions are reversed and better align with the expectations of a center-periphery model. The central arrondissements are better equipped. If we made a map with proportional circles rather than a choropleth map, this would be even more visible; however, cartography is not the focus of this chapter.</p>
<div id="bfc77f19" class="cell" data-execution_count="39">
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
</div>
</section>
<section id="additional-exercise" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="additional-exercise"><span class="header-section-number">6.3</span> Additional exercise</h2>
<p>The previous exercises allowed for familiarization with the processing of spatial data. However, it is often necessary to juggle more complex geometric dimensions. This can include, for example, changing territorial scales in the data or introducing merges/dissolutions of geometries.</p>
<p>We will illustrate this with an additional exercise that demonstrates how to work with data in urban economic models where we assume movement to the nearest point (<a href="https://en.wikipedia.org/wiki/Hotelling%27s_law">Hotelling’s model</a>).</p>
<p>Let’s imagine that each Vélib user moves exclusively to the nearest station (assuming there is never a shortage or overcapacity). What is the map of Vélib coverage? To answer this type of question, we frequently use the <a href="https://en.wikipedia.org/wiki/Voronoi_diagram">Voronoi tessellation</a>, a classic operation for transforming points into polygons.</p>
<p>The following exercise allows for familiarization with the construction of Voronoi<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<div class="callout callout-style-default callout-exercise callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 5 (optional): Coverage map of the stations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This exercise is more complex because it involves going back to <code>Shapely</code>, a lower-level library than <code>GeoPandas</code>.</p>
<p>This exercise is left open-ended. A possible source of inspiration is this discussion on <a href="https://gis.stackexchange.com/questions/337561/making-polygon-for-every-point-in-set-using-voronoi-diagram">StackExchange</a>.</p>
<p>The objective is to make two coverage maps: one at the level of the petite couronne and the other only within Paris intramuros.</p>
</div>
</div>
</div>
<p>The first coverage map, at the agglomeration level, shows the higher density of Velib stations in central Paris:</p>
<div id="2c66383c" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-42-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="03_geopandas_intro_files/figure-html/cell-42-output-1.png" width="725" height="758" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>If we zoom in on Paris intramuros, we also see heterogeneity in coverage.
There is less heterogeneity in coverage areas since the density is high, but we still notice divergences between certain areas.</p>
<div id="95e6e01b" class="cell" data-execution_count="42">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="03_geopandas_intro_files/figure-html/cell-43-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="03_geopandas_intro_files/figure-html/cell-43-output-1.png" width="763" height="418" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="informations-additionnelles" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="informations-additionnelles">Informations additionnelles</h2>
<details>
<summary>
<p><i class="fa-brands fa-python" aria-label="python"></i> environment files have been tested on.</p>
</summary>
<p>Latest built version: 2024-10-11</p>
<p>Python version used:</p>
<div id="caa2c4ec" class="cell" data-execution_count="44">
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>'3.12.6 | packaged by conda-forge | (main, Sep 30 2024, 18:08:52) [GCC 13.3.0]'</code></pre>
</div>
</div>
<div class="git-details">
<div class="pip-freeze">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">affine</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiobotocore</td>
<td style="text-align: left;">2.15.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiohappyeyeballs</td>
<td style="text-align: left;">2.4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiohttp</td>
<td style="text-align: left;">3.10.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aioitertools</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiosignal</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alembic</td>
<td style="text-align: left;">1.13.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">altair</td>
<td style="text-align: left;">5.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aniso8601</td>
<td style="text-align: left;">9.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">annotated-types</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">appdirs</td>
<td style="text-align: left;">1.4.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">archspec</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">attrs</td>
<td style="text-align: left;">24.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">babel</td>
<td style="text-align: left;">2.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bcrypt</td>
<td style="text-align: left;">4.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beautifulsoup4</td>
<td style="text-align: left;">4.12.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">black</td>
<td style="text-align: left;">24.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blinker</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">blis</td>
<td style="text-align: left;">0.7.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bokeh</td>
<td style="text-align: left;">3.5.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">boltons</td>
<td style="text-align: left;">24.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">boto3</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">botocore</td>
<td style="text-align: left;">1.35.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">branca</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brotli</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cachetools</td>
<td style="text-align: left;">5.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cartiflette</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cartopy</td>
<td style="text-align: left;">0.24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">catalogue</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">cattrs</td>
<td style="text-align: left;">24.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">certifi</td>
<td style="text-align: left;">2024.8.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">cffi</td>
<td style="text-align: left;">1.17.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">chromedriver-autoinstaller</td>
<td style="text-align: left;">0.6.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">click</td>
<td style="text-align: left;">8.1.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">click-plugins</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cligj</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloudpathlib</td>
<td style="text-align: left;">0.19.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">colorama</td>
<td style="text-align: left;">0.4.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comm</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">commonmark</td>
<td style="text-align: left;">0.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda</td>
<td style="text-align: left;">24.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda-libmamba-solver</td>
<td style="text-align: left;">24.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda-package-handling</td>
<td style="text-align: left;">2.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda_package_streaming</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">confection</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">contextily</td>
<td style="text-align: left;">1.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contourpy</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cryptography</td>
<td style="text-align: left;">43.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cycler</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cymem</td>
<td style="text-align: left;">2.0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cytoolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dask</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dask-expr</td>
<td style="text-align: left;">1.1.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">databricks-sdk</td>
<td style="text-align: left;">0.33.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">debugpy</td>
<td style="text-align: left;">1.8.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">decorator</td>
<td style="text-align: left;">5.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Deprecated</td>
<td style="text-align: left;">1.2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">diskcache</td>
<td style="text-align: left;">5.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distributed</td>
<td style="text-align: left;">2024.9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">distro</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">docker</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">duckdb</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">en-core-web-sm</td>
<td style="text-align: left;">3.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">entrypoints</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">et-xmlfile</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">exceptiongroup</td>
<td style="text-align: left;">1.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">executing</td>
<td style="text-align: left;">2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fastexcel</td>
<td style="text-align: left;">0.11.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fastjsonschema</td>
<td style="text-align: left;">2.20.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fiona</td>
<td style="text-align: left;">1.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flask</td>
<td style="text-align: left;">3.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">folium</td>
<td style="text-align: left;">0.17.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fontawesomefree</td>
<td style="text-align: left;">6.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fonttools</td>
<td style="text-align: left;">4.54.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fr-core-news-sm</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">frozendict</td>
<td style="text-align: left;">2.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frozenlist</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">funcy</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">gensim</td>
<td style="text-align: left;">4.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geographiclib</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopandas</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geoplot</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopy</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gitdb</td>
<td style="text-align: left;">4.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GitPython</td>
<td style="text-align: left;">3.1.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">google-auth</td>
<td style="text-align: left;">2.35.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphene</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphql-core</td>
<td style="text-align: left;">3.2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphql-relay</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphviz</td>
<td style="text-align: left;">0.20.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">great-tables</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">greenlet</td>
<td style="text-align: left;">3.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">gunicorn</td>
<td style="text-align: left;">22.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">h11</td>
<td style="text-align: left;">0.14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">h2</td>
<td style="text-align: left;">4.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hpack</td>
<td style="text-align: left;">4.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">0.5.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hyperframe</td>
<td style="text-align: left;">6.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">idna</td>
<td style="text-align: left;">3.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">imageio</td>
<td style="text-align: left;">2.35.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">importlib_metadata</td>
<td style="text-align: left;">8.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">importlib_resources</td>
<td style="text-align: left;">6.4.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">inflate64</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipykernel</td>
<td style="text-align: left;">6.29.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">ipython</td>
<td style="text-align: left;">8.28.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">itsdangerous</td>
<td style="text-align: left;">2.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jedi</td>
<td style="text-align: left;">0.19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jinja2</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">jmespath</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">joblib</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonpatch</td>
<td style="text-align: left;">1.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonpointer</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonschema</td>
<td style="text-align: left;">4.23.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonschema-specifications</td>
<td style="text-align: left;">2024.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter-cache</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter_client</td>
<td style="text-align: left;">8.6.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter_core</td>
<td style="text-align: left;">5.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kaleido</td>
<td style="text-align: left;">0.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">kiwisolver</td>
<td style="text-align: left;">1.4.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langcodes</td>
<td style="text-align: left;">3.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">language_data</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lazy_loader</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">libmambapy</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">locket</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;">5.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lz4</td>
<td style="text-align: left;">4.3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">1.3.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mamba</td>
<td style="text-align: left;">1.5.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">mapclassify</td>
<td style="text-align: left;">2.8.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">marisa-trie</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Markdown</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">markdown-it-py</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MarkupSafe</td>
<td style="text-align: left;">2.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">matplotlib</td>
<td style="text-align: left;">3.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">matplotlib-inline</td>
<td style="text-align: left;">0.1.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mdurl</td>
<td style="text-align: left;">0.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">menuinst</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mercantile</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mizani</td>
<td style="text-align: left;">0.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mlflow</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mlflow-skinny</td>
<td style="text-align: left;">2.16.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">msgpack</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">multidict</td>
<td style="text-align: left;">6.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">multivolumefile</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">munkres</td>
<td style="text-align: left;">1.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">murmurhash</td>
<td style="text-align: left;">1.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">mypy-extensions</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">narwhals</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbclient</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nbformat</td>
<td style="text-align: left;">5.10.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">nest_asyncio</td>
<td style="text-align: left;">1.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">networkx</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">nltk</td>
<td style="text-align: left;">3.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numexpr</td>
<td style="text-align: left;">2.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numpy</td>
<td style="text-align: left;">1.26.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">opencv-python-headless</td>
<td style="text-align: left;">4.10.0.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">openpyxl</td>
<td style="text-align: left;">3.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">opentelemetry-api</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">opentelemetry-sdk</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">opentelemetry-semantic-conventions</td>
<td style="text-align: left;">0.37b0</td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome</td>
<td style="text-align: left;">1.3.0.post0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OWSLib</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">packaging</td>
<td style="text-align: left;">24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pandas</td>
<td style="text-align: left;">2.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">paramiko</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parso</td>
<td style="text-align: left;">0.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">partd</td>
<td style="text-align: left;">1.4.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pathspec</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">patsy</td>
<td style="text-align: left;">0.5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pebble</td>
<td style="text-align: left;">5.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">pexpect</td>
<td style="text-align: left;">4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pickleshare</td>
<td style="text-align: left;">0.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pillow</td>
<td style="text-align: left;">10.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pip</td>
<td style="text-align: left;">24.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">platformdirs</td>
<td style="text-align: left;">4.3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">5.24.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotnine</td>
<td style="text-align: left;">0.13.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pluggy</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">polars</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">preshed</td>
<td style="text-align: left;">3.0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">prometheus_client</td>
<td style="text-align: left;">0.21.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prometheus_flask_exporter</td>
<td style="text-align: left;">0.23.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">prompt_toolkit</td>
<td style="text-align: left;">3.0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">protobuf</td>
<td style="text-align: left;">4.25.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">psutil</td>
<td style="text-align: left;">6.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ptyprocess</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pure_eval</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">py7zr</td>
<td style="text-align: left;">0.20.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyarrow</td>
<td style="text-align: left;">17.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyarrow-hotfix</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyasn1</td>
<td style="text-align: left;">0.6.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyasn1_modules</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pybcj</td>
<td style="text-align: left;">1.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycosat</td>
<td style="text-align: left;">0.6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycparser</td>
<td style="text-align: left;">2.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycryptodomex</td>
<td style="text-align: left;">3.21.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic</td>
<td style="text-align: left;">2.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pydantic_core</td>
<td style="text-align: left;">2.23.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pygments</td>
<td style="text-align: left;">2.18.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyLDAvis</td>
<td style="text-align: left;">3.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyNaCl</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pynsee</td>
<td style="text-align: left;">0.1.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyogrio</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyOpenSSL</td>
<td style="text-align: left;">24.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyparsing</td>
<td style="text-align: left;">3.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyppmd</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyproj</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyshp</td>
<td style="text-align: left;">2.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PySocks</td>
<td style="text-align: left;">1.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-dateutil</td>
<td style="text-align: left;">2.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-dotenv</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-magic</td>
<td style="text-align: left;">0.4.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">pytz</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyu2f</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pywaffle</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PyYAML</td>
<td style="text-align: left;">6.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyzmq</td>
<td style="text-align: left;">26.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyzstd</td>
<td style="text-align: left;">0.16.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">querystring_parser</td>
<td style="text-align: left;">1.2.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rasterio</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">referencing</td>
<td style="text-align: left;">0.35.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">regex</td>
<td style="text-align: left;">2024.9.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests</td>
<td style="text-align: left;">2.32.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests-cache</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">retrying</td>
<td style="text-align: left;">1.3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rich</td>
<td style="text-align: left;">13.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">rpds-py</td>
<td style="text-align: left;">0.20.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rsa</td>
<td style="text-align: left;">4.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rtree</td>
<td style="text-align: left;">1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ruamel.yaml</td>
<td style="text-align: left;">0.18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruamel.yaml.clib</td>
<td style="text-align: left;">0.2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s3fs</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">s3transfer</td>
<td style="text-align: left;">0.10.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scikit-image</td>
<td style="text-align: left;">0.24.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">scikit-learn</td>
<td style="text-align: left;">1.5.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scipy</td>
<td style="text-align: left;">1.13.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">seaborn</td>
<td style="text-align: left;">0.13.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">selenium</td>
<td style="text-align: left;">4.25.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">setuptools</td>
<td style="text-align: left;">74.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shapely</td>
<td style="text-align: left;">2.0.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">shellingham</td>
<td style="text-align: left;">1.5.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">six</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">smart-open</td>
<td style="text-align: left;">7.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smmap</td>
<td style="text-align: left;">5.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sniffio</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sortedcontainers</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">soupsieve</td>
<td style="text-align: left;">2.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy</td>
<td style="text-align: left;">3.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy-legacy</td>
<td style="text-align: left;">3.0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy-loggers</td>
<td style="text-align: left;">1.0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">SQLAlchemy</td>
<td style="text-align: left;">2.0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sqlparse</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">srsly</td>
<td style="text-align: left;">2.4.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stack-data</td>
<td style="text-align: left;">0.6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">statsmodels</td>
<td style="text-align: left;">0.14.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tabulate</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tblib</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenacity</td>
<td style="text-align: left;">9.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">texttable</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">thinc</td>
<td style="text-align: left;">8.2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">threadpoolctl</td>
<td style="text-align: left;">3.5.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tifffile</td>
<td style="text-align: left;">2024.9.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">toolz</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">topojson</td>
<td style="text-align: left;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">tornado</td>
<td style="text-align: left;">6.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tqdm</td>
<td style="text-align: left;">4.66.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">traitlets</td>
<td style="text-align: left;">5.14.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trio</td>
<td style="text-align: left;">0.26.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">trio-websocket</td>
<td style="text-align: left;">0.11.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">truststore</td>
<td style="text-align: left;">0.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">typer</td>
<td style="text-align: left;">0.12.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typing_extensions</td>
<td style="text-align: left;">4.12.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">tzdata</td>
<td style="text-align: left;">2024.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unidecode</td>
<td style="text-align: left;">1.3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">url-normalize</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urllib3</td>
<td style="text-align: left;">1.26.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">wasabi</td>
<td style="text-align: left;">1.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">weasel</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">webdriver-manager</td>
<td style="text-align: left;">4.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">websocket-client</td>
<td style="text-align: left;">1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Werkzeug</td>
<td style="text-align: left;">3.0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">wheel</td>
<td style="text-align: left;">0.44.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wordcloud</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wsproto</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">xgboost</td>
<td style="text-align: left;">2.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xlrd</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">xyzservices</td>
<td style="text-align: left;">2024.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yarl</td>
<td style="text-align: left;">1.13.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellowbrick</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zict</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zipp</td>
<td style="text-align: left;">3.20.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zstandard</td>
<td style="text-align: left;">0.23.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<details>
<summary>
<p>View file history <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></p>
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="1636" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1635;"><span id="cb28-1636"><a href="#cb28-1636" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Ce fichier a été modifié __</span><span class="sc">${</span>table_commit<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">__ fois depuis sa création le </span><span class="sc">${</span>creation_string<span class="sc">}</span><span class="vs"> (dernière modification le </span><span class="sc">${</span>last_modification_string<span class="sc">}</span><span class="vs">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-18" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>creation <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>last_modification <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>creation_string <span class="op">=</span> creation<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>last_modification_string <span class="op">=</span> last_modification<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-19-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-19-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-19-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-19-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb30-0"><a href="#cb30-0" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_table<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb31-0"><a href="#cb31-0" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_plot<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="expression">

</div>
</div>
</div>
<table class="commit-table" border="1">
<thead>
<tr>
<th>
SHA
</th>
<th>
Date
</th>
<th>
Author
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/20672a4">20672a4</a>
</td>
<td>
2024-10-11 13:11:20
</td>
<td>
Lino Galiana
</td>
<td>
Quelques correctifs supplémentaires sur Git et mercator (#566)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/0b35e23">0b35e23</a>
</td>
<td>
2024-09-23 20:16:39
</td>
<td>
lgaliana
</td>
<td>
Correction typo mise en forme anglais/français
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c641de0">c641de0</a>
</td>
<td>
2024-08-22 11:37:13
</td>
<td>
Lino Galiana
</td>
<td>
A series of fix for notebooks that were bugging (#545)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4be74ea">4be74ea</a>
</td>
<td>
2024-08-21 17:32:34
</td>
<td>
Lino Galiana
</td>
<td>
Fix a few buggy notebooks (#544)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/d4b0ae4">d4b0ae4</a>
</td>
<td>
2024-08-09 15:04:31
</td>
<td>
Lino Galiana
</td>
<td>
Geopandas en Anglais (#537)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/72f42bb">72f42bb</a>
</td>
<td>
2024-07-25 19:06:38
</td>
<td>
Lino Galiana
</td>
<td>
Language message on notebooks (#529)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/195dc9e">195dc9e</a>
</td>
<td>
2024-07-25 11:59:19
</td>
<td>
linogaliana
</td>
<td>
Switch language button
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3660ca8">3660ca8</a>
</td>
<td>
2024-07-24 13:19:04
</td>
<td>
Lino Galiana
</td>
<td>
Version anglaise de l’intro à Geopandas (#528)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/065b0ab">065b0ab</a>
</td>
<td>
2024-07-08 11:19:43
</td>
<td>
Lino Galiana
</td>
<td>
Nouveaux callout dans la partie manipulation (#513)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/a3dc832">a3dc832</a>
</td>
<td>
2024-06-24 16:15:19
</td>
<td>
Lino Galiana
</td>
<td>
Improve homepage images (#508)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/16b1021">16b1021</a>
</td>
<td>
2024-05-27 14:11:57
</td>
<td>
lgaliana
</td>
<td>
Typo dans le chapitre geopandas
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/91bfa52">91bfa52</a>
</td>
<td>
2024-05-27 15:01:32
</td>
<td>
Lino Galiana
</td>
<td>
Restructuration partie geopandas (#500)
</td>
</tr>
</tbody>
</table>
</details>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb32" data-startfrom="1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>git_history_table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">,</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SHA</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`[</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>github_repo<span class="sc">}</span><span class="vs">/commit/</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Description</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">replacePullRequestPattern</span>(x<span class="op">,</span> github_repo)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*Date: x =&gt; x.toLocaleString("fr", {</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">        "month": "numeric",</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">        "day": "numeric",</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">        "year": "numeric"</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">        })</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">      */</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>git_history_plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"royalblue"</span>})<span class="op">,</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>          table_commit<span class="op">,</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">pointerX</span>({<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>}))<span class="op">,</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(table_commit<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"royalblue"</span>})</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb34" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb34-0"><a href="#cb34-0" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">replacePullRequestPattern</span>(inputString<span class="op">,</span> githubRepo) {</span>
<span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use a regular expression to match the pattern #digit</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> pattern <span class="op">=</span> <span class="ss">/#</span><span class="sc">(\d+)</span><span class="ss">/g</span><span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Replace the pattern with ${github_repo}/pull/#digit</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> replacedString <span class="op">=</span> inputString<span class="op">.</span><span class="fu">replace</span>(pattern<span class="op">,</span> <span class="st">'[#$1]('</span> <span class="op">+</span> githubRepo <span class="op">+</span> <span class="st">'/pull/$1)'</span>)<span class="op">;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replacedString<span class="op">;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb35" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb35-0"><a href="#cb35-0" aria-hidden="true" tabindex="-1"></a>github_repo <span class="op">=</span> <span class="st">"https://github.com/linogaliana/python-datascientist"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb36" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb36-0"><a href="#cb36-0" aria-hidden="true" tabindex="-1"></a>table_commit <span class="op">=</span> {</span>
<span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the HTML table by its class name</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Check if the table exists</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (table) {</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialize an array to store the table data</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dataArray <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract headers from the first row</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> headers <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">.</span><span class="fu">push</span>(table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span>[i]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>())<span class="op">;</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Iterate through the rows, starting from the second row</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> row <span class="op">=</span> table<span class="op">.</span><span class="at">rows</span>[i]<span class="op">;</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> rowData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Iterate through the cells in the row</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> row<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Use headers as keys and cell content as values</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>            rowData[headers[j]] <span class="op">=</span> row<span class="op">.</span><span class="at">cells</span>[j]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Push the rowData object to the dataArray</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        dataArray<span class="op">.</span><span class="fu">push</span>(rowData)<span class="op">;</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataArray</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb37" data-startfrom="1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the element with class 'git-details'</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> gitDetails <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Check if the element exists</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (gitDetails) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Hide the element</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      gitDetails<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-27" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb38" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb38-0"><a href="#cb38-0" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.12/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="declaration">

</div>
</div>
</div>



</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-chen2008brief" class="csl-entry" role="listitem">
Chen, Chun-houh, Wolfgang Härdle, Antony Unwin, and Michael Friendly. 2008. <span>“A Brief History of Data Visualization.”</span> <em>Handbook of Data Visualization</em>, 15–56.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Despite all its limitations, which we will revisit, the choropleth map is nonetheless informative. Knowing how to produce one quickly to grasp the main structuring facts of a dataset is particularly useful.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This map is not too neat; it’s normal. We will see how to make beautiful maps later.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>In <a href="https://www.insee.fr/en/statistiques/4925202">this working paper</a> on mobile phone data, it is shown that this approach is not without bias in phenomena where the spatial proximity hypothesis is overly simplistic.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@book{galiana2023,
  author = {Galiana, Lino},
  title = {Python Pour La Data Science},
  date = {2023},
  url = {https://pythonds.linogaliana.fr/},
  doi = {10.5281/zenodo.8229676},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-galiana2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Galiana, Lino. 2023. <em>Python Pour La Data Science</em>. <a href="https://doi.org/10.5281/zenodo.8229676">https://doi.org/10.5281/zenodo.8229676</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBhdGggPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZShcIi5odG1sXCIsIFwiLnFtZFwiKTtcbnBhdGhfbW9kaWZpZWQgPSAocGF0aC5pbmNsdWRlcygnZW4vY29udGVudCcpKSA/IHBhdGgucmVwbGFjZSgnZW4vY29udGVudCcsICdjb250ZW50L2VuJykgOiBwYXRoXG5odG1sYCR7cHJpbnRCYWRnZXMoe2ZwYXRoOiBwYXRoX21vZGlmaWVkfSl9YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Z2V0Q29uZGl0aW9uYWxIVE1MKHBhdGgsIHRydWUpfTwvZGl2PmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIGlzQmV0d2VlblNlcHRBbmREZWMoKSB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCA4LCAxKTsgLy8gU2VwdGVtYmVyIDFzdCAobW9udGggaXMgemVyby1pbmRleGVkKVxuICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCAxMSwgMjQpOyAvLyBEZWNlbWJlciAyNHRoIChtb250aCBpcyB6ZXJvLWluZGV4ZWQpXG4gICAgXG4gICAgcmV0dXJuIG5vdyA+PSBzdGFydCAmJiBub3cgPD0gZW5kO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZ2V0Q29uZGl0aW9uYWxIVE1MKHBhdGgsIHByaW50KSB7XG4gICAgaWYgKHByaW50ID09PSBmYWxzZSkgcmV0dXJuIGBgXG4gICAgaWYgKGlzQmV0d2VlblNlcHRBbmREZWMoKSkge1xuICAgICAgICByZXR1cm4gbWRgPGk+TGEgY29ycmVjdGlvbiBzZXJhIHZpc2libGUgcHJvY2hhaW5lbWVudCBzdXIgY2V0dGUgcGFnZS4gRW4gYXR0ZW5kYW50LCBsYSBsaXN0ZSBkZXMgY29ycmVjdGlvbnMgZMOpasOgIGFjY2Nlc3NpYmxlcyBlc3QgW2ljaV0oL2NvbnRlbnQvYW5uZXhlcy9jb3JyZWN0aW9ucy5odG1sKTwvaT5gOyAvLyBSZXR1cm4gYW4gZW1wdHkgc3RyaW5nIGlmIG5vdCBiZXR3ZWVuIHRoZSBkYXRlc1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBodG1sYFxuICAgICAgICA8ZGV0YWlscz5cbiAgICAgICAgICAgIDxzdW1tYXJ5PlxuICAgICAgICAgICAgICAgIFBvdXIgb3V2cmlyIGxhIHZlcnNpb24gY29ycmlnw6llIHNvdXMgZm9ybWUgZGUgPGk+bm90ZWJvb2s8L2k+XG4gICAgICAgICAgICA8L3N1bW1hcnk+XG4gICAgICAgICAgICAke3ByaW50QmFkZ2VzKHsgZnBhdGg6IHBhdGgsIGNvcnJlY3Rpb246IHRydWUgfSl9XG4gICAgICAgIDwvZGV0YWlscz5cbiAgICAgICAgYDtcbiAgICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiByZW5kZXJDb3JyZWN0aW9uKHsgZnBhdGgsIGNvcnJlY3Rpb24gfSkge1xuICAgIGlmIChjb3JyZWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBodG1sYCR7cHJpbnRCYWRnZXMoeyBmcGF0aDogZnBhdGgsIGNvcnJlY3Rpb246IHRydWUgfSl9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaHRtbGA8aT5MYSBjb3JyZWN0aW9uIHNlcmEgdmlzaWJsZSBwcm9jaGFpbmVtZW50IHN1ciBjZXR0ZSBwYWdlLjwvaT5gO1xuICAgIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIHJlbWluZGVyQmFkZ2VzKHtcbiAgICBzb3VyY2VGaWxlID0gXCJjb250ZW50LzAxX3RvdG8uUm1kXCIsXG4gICAgdHlwZSA9IFsnbWQnLCAnaHRtbCddLFxuICAgIHNwbGl0ID0gbnVsbCxcbiAgICBvbnl4aWFPbmx5ID0gZmFsc2UsXG4gICAgc3NwQ2xvdWRTZXJ2aWNlID0gXCJweXRob25cIixcbiAgICBHUFUgPSBmYWxzZSxcbiAgICBjb3JyZWN0aW9uID0gZmFsc2Vcbn0gPSB7fSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHR5cGUpKSB7XG4gICAgICAgIHR5cGUgPSB0eXBlWzBdO1xuICAgIH1cblxuICAgIGxldCBub3RlYm9vayA9IHNvdXJjZUZpbGUucmVwbGFjZSgvKC5SbWR8LnFtZCkvLCBcIi5pcHluYlwiKTtcbiAgICBpZiAoY29ycmVjdGlvbikge1xuICAgICAgICBub3RlYm9vayA9IG5vdGVib29rLnJlcGxhY2UoL2NvbnRlbnQvLCBcImNvcnJlY3Rpb25zXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG5vdGVib29rID0gbm90ZWJvb2sucmVwbGFjZSgvY29udGVudC8sIFwibm90ZWJvb2tzXCIpO1xuICAgIH1cblxuICAgIGNvbnN0IGdpdGh1YlJlcG9Ob3RlYm9va3NTaW1wbGlmaWVkID0gXCJnaXRodWIvbGlub2dhbGlhbmEvcHl0aG9uLWRhdGFzY2llbnRpc3Qtbm90ZWJvb2tzXCI7XG4gICAgY29uc3QgZ2l0aHViQWxpYXMgPSBnaXRodWJSZXBvTm90ZWJvb2tzU2ltcGxpZmllZC5yZXBsYWNlKFwiZ2l0aHViXCIsIFwiZ2l0aHViLmNvbVwiKTtcbiAgICBjb25zdCBnaXRodWJSZXBvTm90ZWJvb2tzID0gYGh0dHBzOi8vJHtnaXRodWJBbGlhc31gO1xuXG4gICAgbGV0IGdpdGh1YkxpbmsgO1xuXG4gICAgaWYgKG5vdGVib29rID09PSBcIlwiKSB7XG4gICAgICAgIGdpdGh1YkxpbmsgPSBnaXRodWJSZXBvTm90ZWJvb2tzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdpdGh1YkxpbmsgPSBgJHtnaXRodWJSZXBvTm90ZWJvb2tzfS9ibG9iL21haW5gO1xuICAgIH1cblxuICAgIGNvbnN0IG5vdGVib29rUmVsUGF0aCA9IGAvJHtub3RlYm9va31gO1xuICAgIGNvbnN0IFtzZWN0aW9uLCBjaGFwdGVyXSA9IG5vdGVib29rLnNwbGl0KFwiL1wiKS5zbGljZSgtMik7XG5cbiAgICBnaXRodWJMaW5rID0gYDxhIGhyZWY9XCIke2dpdGh1Ykxpbmt9JHtub3RlYm9va1JlbFBhdGh9XCIgY2xhc3M9XCJnaXRodWJcIj48aSBjbGFzcz1cImZhYiBmYS1naXRodWJcIj48L2k+PC9hPmA7XG5cbiAgICBsZXQgc2VjdGlvbkxhdGVzdCA9IHNlY3Rpb24uc3BsaXQoXCIvXCIpLnNsaWNlKC0xKVswXTtcbiAgICBjb25zdCBjaGFwdGVyTm9FeHRlbnNpb24gPSBjaGFwdGVyLnJlcGxhY2UoXCIuaXB5bmJcIiwgXCJcIik7XG4gICAgXG4gICAgaWYgKHNvdXJjZUZpbGUuaW5jbHVkZXMoJ2VuLycpKSB7XG4gICAgICAgIHNlY3Rpb25MYXRlc3QgPSBgZW4vJHtzZWN0aW9uTGF0ZXN0fWA7XG4gICAgfVxuXG4gICAgY29uc3Qgb255eGlhSW5pdEFyZ3MgPSBbc2VjdGlvbkxhdGVzdCwgY2hhcHRlck5vRXh0ZW5zaW9uXTtcblxuICAgIGlmIChjb3JyZWN0aW9uKSB7XG4gICAgICAgIG9ueXhpYUluaXRBcmdzLnB1c2goXCJjb3JyZWN0aW9uXCIpO1xuICAgIH1cblxuICAgIGNvbnN0IGdwdVN1ZmZpeCA9IEdQVSA/IFwiLWdwdVwiIDogXCJcIjtcblxuICAgIGNvbnN0IHNzcGNsb3VkSnVweXRlckxpbmtMYXVuY2hlciA9IGBodHRwczovL2RhdGFsYWIuc3NwY2xvdWQuZnIvbGF1bmNoZXIvaWRlL2p1cHl0ZXItJHtzc3BDbG91ZFNlcnZpY2V9JHtncHVTdWZmaXh9P2F1dG9MYXVuY2g9dHJ1ZSZvbnl4aWEuZnJpZW5kbHlOYW1lPSVDMiVBQiR7Y2hhcHRlck5vRXh0ZW5zaW9ufSVDMiVCQiZpbml0LnBlcnNvbmFsSW5pdD0lQzIlQUJodHRwcyUzQSUyRiUyRnJhdy5naXRodWJ1c2VyY29udGVudC5jb20lMkZsaW5vZ2FsaWFuYSUyRnB5dGhvbi1kYXRhc2NpZW50aXN0JTJGbWFzdGVyJTJGc3NwY2xvdWQlMkZpbml0LWp1cHl0ZXIuc2glQzIlQkImaW5pdC5wZXJzb25hbEluaXRBcmdzPSVDMiVBQiR7b255eGlhSW5pdEFyZ3Muam9pbignJTIwJyl9JUMyJUJCYDtcblxuICAgIGxldCBzc3BjbG91ZEp1cHl0ZXJMaW5rO1xuICAgIGlmICh0eXBlID09PSBcIm1kXCIpIHtcbiAgICAgICAgc3NwY2xvdWRKdXB5dGVyTGluayA9IGBbIVtPbnl4aWFdKGh0dHBzOi8vaW1nLnNoaWVsZHMuaW8vYmFkZ2UvU1NQJTIwQ2xvdWQtTGFuY2VyX2F2ZWNfSnVweXRlci1vcmFuZ2U/bG9nbz1KdXB5dGVyJmxvZ29Db2xvcj1vcmFuZ2UpXSgke3NzcGNsb3VkSnVweXRlckxpbmtMYXVuY2hlcn0pYDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzc3BjbG91ZEp1cHl0ZXJMaW5rID0gYDxhIGhyZWY9XCIke3NzcGNsb3VkSnVweXRlckxpbmtMYXVuY2hlcn1cIiB0YXJnZXQ9XCJfYmxhbmtcIiByZWw9XCJub29wZW5lclwiPjxpbWcgc3JjPVwiaHR0cHM6Ly9pbWcuc2hpZWxkcy5pby9iYWRnZS9TU1AlMjBDbG91ZC1MYW5jZXJfYXZlY19KdXB5dGVyLW9yYW5nZT9sb2dvPUp1cHl0ZXImbG9nb0NvbG9yPW9yYW5nZVwiIGFsdD1cIk9ueXhpYVwiPjwvYT5gO1xuICAgIH1cblxuICAgIGlmIChzcGxpdCA9PT0gNCkge1xuICAgICAgICBzc3BjbG91ZEp1cHl0ZXJMaW5rICs9ICc8YnI+JztcbiAgICB9XG5cbiAgICBjb25zdCBzc3BjbG91ZFZzY29kZUxpbmtMYXVuY2hlciA9IGBodHRwczovL2RhdGFsYWIuc3NwY2xvdWQuZnIvbGF1bmNoZXIvaWRlL3ZzY29kZS0ke3NzcENsb3VkU2VydmljZX0ke2dwdVN1ZmZpeH0/YXV0b0xhdW5jaD10cnVlJm9ueXhpYS5mcmllbmRseU5hbWU9JUMyJUFCJHtjaGFwdGVyTm9FeHRlbnNpb259JUMyJUJCJmluaXQucGVyc29uYWxJbml0PSVDMiVBQmh0dHBzJTNBJTJGJTJGcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSUyRmxpbm9nYWxpYW5hJTJGcHl0aG9uLWRhdGFzY2llbnRpc3QlMkZtYXN0ZXIlMkZzc3BjbG91ZCUyRmluaXQtdnNjb2RlLnNoJUMyJUJCJmluaXQucGVyc29uYWxJbml0QXJncz0lQzIlQUIke29ueXhpYUluaXRBcmdzLmpvaW4oJyUyMCcpfSVDMiVCQmA7XG5cbiAgICBsZXQgc3NwY2xvdWRWc2NvZGVMaW5rO1xuICAgIGlmICh0eXBlID09PSBcIm1kXCIpIHtcbiAgICAgICAgc3NwY2xvdWRWc2NvZGVMaW5rID0gYFshW09ueXhpYV0oaHR0cHM6Ly9pbWcuc2hpZWxkcy5pby9iYWRnZS9TU1AlMjBDbG91ZC1MYW5jZXJfYXZlY19WU0NvZGUtYmx1ZT9sb2dvPXZpc3VhbHN0dWRpb2NvZGUmbG9nb0NvbG9yPWJsdWUpXSgke3NzcGNsb3VkVnNjb2RlTGlua0xhdW5jaGVyfSlgO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHNzcGNsb3VkVnNjb2RlTGluayA9IGA8YSBocmVmPVwiJHtzc3BjbG91ZFZzY29kZUxpbmtMYXVuY2hlcn1cIiB0YXJnZXQ9XCJfYmxhbmtcIiByZWw9XCJub29wZW5lclwiPjxpbWcgc3JjPVwiaHR0cHM6Ly9pbWcuc2hpZWxkcy5pby9iYWRnZS9TU1AlMjBDbG91ZC1MYW5jZXJfYXZlY19WU0NvZGUtYmx1ZT9sb2dvPXZpc3VhbHN0dWRpb2NvZGUmbG9nb0NvbG9yPWJsdWVcIiBhbHQ9XCJPbnl4aWFcIj48L2E+YDtcbiAgICB9XG5cbiAgICBpZiAoc3BsaXQgPT09IDUpIHtcbiAgICAgICAgc3NwY2xvdWRWc2NvZGVMaW5rICs9ICc8YnI+JztcbiAgICB9XG5cbiAgICBsZXQgY29sYWJMaW5rO1xuICAgIGlmICh0eXBlID09PSBcIm1kXCIpIHtcbiAgICAgICAgY29sYWJMaW5rID0gYFshW09wZW4gSW4gQ29sYWJdKGh0dHBzOi8vY29sYWIucmVzZWFyY2guZ29vZ2xlLmNvbS9hc3NldHMvY29sYWItYmFkZ2Uuc3ZnKV0oaHR0cDovL2NvbGFiLnJlc2VhcmNoLmdvb2dsZS5jb20vJHtnaXRodWJSZXBvTm90ZWJvb2tzU2ltcGxpZmllZH0vYmxvYi9tYWluJHtub3RlYm9va1JlbFBhdGh9KWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29sYWJMaW5rID0gYDxhIGhyZWY9XCJodHRwczovL2NvbGFiLnJlc2VhcmNoLmdvb2dsZS5jb20vJHtnaXRodWJSZXBvTm90ZWJvb2tzU2ltcGxpZmllZH0vYmxvYi9tYWluJHtub3RlYm9va1JlbFBhdGh9XCIgdGFyZ2V0PVwiX2JsYW5rXCIgcmVsPVwibm9vcGVuZXJcIj48aW1nIHNyYz1cImh0dHBzOi8vY29sYWIucmVzZWFyY2guZ29vZ2xlLmNvbS9hc3NldHMvY29sYWItYmFkZ2Uuc3ZnXCIgYWx0PVwiT3BlbiBJbiBDb2xhYlwiPjwvYT5gO1xuICAgIH1cblxuICAgIGlmIChzcGxpdCA9PT0gNykge1xuICAgICAgICBjb2xhYkxpbmsgKz0gJzxicj4nO1xuICAgIH1cblxuICAgIGxldCB2c2NvZGVMaW5rO1xuICAgIGlmICh0eXBlID09PSBcIm1kXCIpIHtcbiAgICAgICAgdnNjb2RlTGluayA9IGBbIVtnaXRodWJkZXZdKGh0dHBzOi8vaW1nLnNoaWVsZHMuaW8vc3RhdGljL3YxP2xvZ289dmlzdWFsc3R1ZGlvY29kZSZsYWJlbD0mbWVzc2FnZT1PcGVuJTIwaW4lMjBWaXN1YWwgU3R1ZGlvIENvZGUmbGFiZWxDb2xvcj0yYzJjMzImY29sb3I9MDA3YWNjJmxvZ29Db2xvcj0wMDdhY2MpXShodHRwczovL2dpdGh1Yi5kZXYvbGlub2dhbGlhbmEvcHl0aG9uLWRhdGFzY2llbnRpc3Qtbm90ZWJvb2tzJHtub3RlYm9va1JlbFBhdGh9KWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdnNjb2RlTGluayA9IGA8YSBocmVmPVwiaHR0cHM6Ly9naXRodWIuZGV2L2xpbm9nYWxpYW5hL3B5dGhvbi1kYXRhc2NpZW50aXN0LW5vdGVib29rcyR7bm90ZWJvb2tSZWxQYXRofVwiIHRhcmdldD1cIl9ibGFua1wiIHJlbD1cIm5vb3BlbmVyXCI+PGltZyBzcmM9XCJodHRwczovL2ltZy5zaGllbGRzLmlvL3N0YXRpYy92MT9sb2dvPXZpc3VhbHN0dWRpb2NvZGUmbGFiZWw9Jm1lc3NhZ2U9T3BlbiUyMGluJTIwVmlzdWFsJTIwU3R1ZGlvJTIwQ29kZSZsYWJlbENvbG9yPTJjMmMzMiZjb2xvcj0wMDdhY2MmbG9nb0NvbG9yPTAwN2FjY1wiIGFsdD1cImdpdGh1YmRldlwiPjwvYT48L3A+YDtcbiAgICB9XG5cbiAgICBjb25zdCBiYWRnZXMgPSBbXG4gICAgICAgIGdpdGh1YkxpbmssXG4gICAgICAgIHNzcGNsb3VkVnNjb2RlTGluayxcbiAgICAgICAgc3NwY2xvdWRKdXB5dGVyTGlua1xuICAgIF07XG5cbiAgICBpZiAoIW9ueXhpYU9ubHkpIHtcbiAgICAgICAgYmFkZ2VzLnB1c2goY29sYWJMaW5rKTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gYmFkZ2VzLmpvaW4oXCJcXG5cIik7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJodG1sXCIpIHtcbiAgICAgICAgcmVzdWx0ID0gYDxwIGNsYXNzPVwiYmFkZ2VzXCI+JHtyZXN1bHR9PC9wPmA7XG4gICAgfVxuXG4gICAgaWYgKG9ueXhpYU9ubHkpIHtcbiAgICAgICAgcmVzdWx0ID0gYCR7c3NwY2xvdWRKdXB5dGVyTGlua30ke3NzcGNsb3VkVnNjb2RlTGlua31gO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cblxuZnVuY3Rpb24gcHJpbnRCYWRnZXMoe1xuICAgIGZwYXRoLFxuICAgIG9ueXhpYU9ubHkgPSBmYWxzZSxcbiAgICBzcGxpdCA9IDUsXG4gICAgdHlwZSA9IFwiaHRtbFwiLFxuICAgIHNzcENsb3VkU2VydmljZSA9IFwicHl0aG9uXCIsXG4gICAgR1BVID0gZmFsc2UsXG4gICAgY29ycmVjdGlvbiA9IGZhbHNlXG59ID0ge30pIHtcbiAgICBjb25zdCBiYWRnZXMgPSByZW1pbmRlckJhZGdlcyh7XG4gICAgICAgIHNvdXJjZUZpbGU6IGZwYXRoLFxuICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICBzcGxpdDogc3BsaXQsXG4gICAgICAgIG9ueXhpYU9ubHk6IG9ueXhpYU9ubHksXG4gICAgICAgIHNzcENsb3VkU2VydmljZTogc3NwQ2xvdWRTZXJ2aWNlLFxuICAgICAgICBHUFU6IEdQVSxcbiAgICAgICAgY29ycmVjdGlvbjogY29ycmVjdGlvblxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGJhZGdlc1xufVxuXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gcHJpbnRCYWRnZXMoeyBmcGF0aDogXCJjb250ZW50L2dldHRpbmctc3RhcnRlZC8wNV9yYXBwZWxzX3R5cGVzLnFtZFwiLCBvbnl4aWFPbmx5OiBmYWxzZSwgc3BsaXQ6IDUsIHR5cGU6IFwiaHRtbFwiLCBzc3BDbG91ZFNlcnZpY2U6IFwicHl0aG9uXCIsIEdQVTogZmFsc2UsIGNvcnJlY3Rpb246IGZhbHNlIH0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Y29udGFpbmVyX3Byb2plY3Rpb259PC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY29udGFpbmVyX3Byb2plY3Rpb24gPSBodG1sYDxkaXYgY2xhc3M9XCJjb250YWluZXJcIj5cbiAgPGRpdiBjbGFzcz1cInJvd1wiPlxuICAgIDxkaXYgY2xhc3M9XCJwcm9qZWN0aW9uXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwicHJvamVjdGlvbi1sYWJlbFwiPkNob2lzaXIgdW5lIHByb2plY3Rpb248L2Rpdj5cbiAgICAgICR7dmlld29mIHByb2plY3Rpb259XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuICA8ZGl2IGNsYXNzPVwicm93XCI+XG4gICAgPGRpdiBjbGFzcz1cInByb2plY3RlZE1hcFwiPlxuICAgICAgJHtwcm9qZWN0ZWRNYXB9XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHByb2plY3Rpb24gPSBwcm9qZWN0aW9uSW5wdXQoe1xuICBuYW1lOiBcIlwiLFxuICB2YWx1ZTogXCJNZXJjYXRvclwiXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7cHJvamVjdGlvbklucHV0fSBmcm9tIFwiQGZpbC9kMy1wcm9qZWN0aW9uc1wiXG5pbXBvcnQge21hcH0gZnJvbSBcIkBsaW5vZ2FsaWFuYS9iYXNlLW1hcFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicHJvamVjdGVkTWFwID0gbWFwKHByb2plY3Rpb24sXG4gICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgLy9zdmc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcHJvamVjdGlvbi5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoX3Byb2plY3RlZF9tYXAsXG4gICAgICAgICAgICAgICAgICAgICAvL2hlaWdodDogMzAwLFxuICAgICAgICAgICAgICAgICAgICAgLy9yb3RhdGU6IFswLCAtOTBdLFxuICAgICAgICAgICAgICAgICAgICAgLy9pbmVydGlhOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgc2hvd19lcXVhdG9yOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogXCIjZjFmMGViXCJcbiAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgLy9zaG93X3N0cnVjdHVyZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgIH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoid2lkdGhfcHJvamVjdGVkX21hcCA9IHNjcmVlbi53aWR0aC8yXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2IGNsYXNzPVwiZ3JpZC1jb250YWluZXJcIj5cbiAgPGRpdiBjbGFzcz1cInZpZXdvZi1wcm9qZWN0aW9uXCI+JHt2aWV3b2YgcHJvamVjdGlvbkJlcnRpbn08L2Rpdj5cbiAgPGRpdiBjbGFzcz1cInZpZXdvZi1teWNvdW50cnlcIj4ke3ZpZXdvZiBteWNvdW50cnl9PC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJtYXAtYmVydGluXCI+JHttYXBCZXJ0aW59PC9kaXY+XG48L2Rpdj5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaW1wb3J0IHttYXAgYXMgbWFwQmVydGluLCB2aWV3b2YgcHJvamVjdGlvbiBhcyBwcm9qZWN0aW9uQmVydGluLCB2aWV3b2YgbXljb3VudHJ5fSBmcm9tIFwiQG5lb2NhcnRvY25ycy9pbXBhY3Qtb2YtcHJvamVjdGlvbnMtb24tYXJlYXNcIlxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgPGRpdiBjbGFzcz1cImNlbnRlcmVkXCI+JHtzcGlsaGF1c308L2Rpdj5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoic3BpbGhhdXMgPSB7XG4gIGNvbnN0IHdpZHRoID0gNjAwO1xuICBjb25zdCBoZWlnaHQgPSB3aWR0aDtcblxuICBjb25zdCBjb250ZXh0ID0gRE9NLmNvbnRleHQyZCh3aWR0aCwgaGVpZ2h0KTtcbiAgY29uc3QgcHJvamVjdGlvbiA9IGQzLmdlb1N0ZXJlb2dyYXBoaWMoKVxuICAgIC5yb3RhdGUoWzk1LCA0NV0pXG4gICAgLnRyYW5zbGF0ZShbd2lkdGggLyAyLCBoZWlnaHQgLyAyXSlcbiAgICAuc2NhbGUod2lkdGggLyAxMC4xKVxuICAgIC5jZW50ZXIoWzMwLCAtNV0pXG4gICAgLmNsaXBBbmdsZSgxNjYpO1xuICBjb25zdCBwYXRoID0gZDMuZ2VvUGF0aChwcm9qZWN0aW9uLCBjb250ZXh0KTtcblxuICBjb25zdCBsYW5kID0gdG9wb2pzb24uZmVhdHVyZSh3b3JsZCwgd29ybGQub2JqZWN0cy5sYW5kKTtcblxuICBjb250ZXh0LmxpbmVKb2luID0gXCJyb3VuZFwiO1xuICBjb250ZXh0LmxpbmVDYXAgPSBcInJvdW5kXCI7XG4gIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjZjJmMWVkXCI7XG4gIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgcGF0aCh7dHlwZTogXCJTcGhlcmVcIn0pO1xuICBwYXRoKGxhbmQpO1xuICBjb250ZXh0LmxpbmVXaWR0aCA9IDAuNTtcbiAgY29udGV4dC5zdHJva2UoKTtcbiAgY29udGV4dC5jbGlwKFwiZXZlbm9kZFwiKTtcblxuICBjb250ZXh0LnNhdmUoKTtcbiAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgcGF0aChsYW5kKTtcbiAgY29udGV4dC5maWx0ZXIgPSBcImJsdXIoMTJweClcIjtcbiAgY29udGV4dC5maWxsU3R5bGUgPSBcIiMwMDY5OTRcIjtcbiAgY29udGV4dC5maWxsKFwiZXZlbm9kZFwiKTtcbiAgY29udGV4dC5yZXN0b3JlKCk7XG4gIFxuICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICBwYXRoKGQzLmdlb0dyYXRpY3VsZTEwKCkpO1xuICBjb250ZXh0Lmdsb2JhbEFscGhhID0gMC4yO1xuICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjMDAwXCI7XG4gIGNvbnRleHQuc3Ryb2tlKCk7XG5cbiAgcmV0dXJuIGNvbnRleHQuY2FudmFzO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vaW1wb3J0IHttYXAgYXMgc3BpbGhhdXNtYXB9IHdpdGgge2hlaWdodCwgd2lkdGh9IGZyb20gXCJAZDMvc3BpbGhhdXMtc2hvcmVsaW5lLW1hcFwiXG5pbXBvcnQgeyB3b3JsZCB9IGZyb20gXCJAZDMvc3BpbGhhdXMtc2hvcmVsaW5lLW1hcFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgQ2UgZmljaGllciBhIMOpdMOpIG1vZGlmacOpIF9fJHt0YWJsZV9jb21taXQubGVuZ3RofV9fIGZvaXMgZGVwdWlzIHNhIGNyw6lhdGlvbiBsZSAke2NyZWF0aW9uX3N0cmluZ30gKGRlcm5pw6hyZSBtb2RpZmljYXRpb24gbGUgJHtsYXN0X21vZGlmaWNhdGlvbl9zdHJpbmd9KWBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjcmVhdGlvbiA9IGQzLm1pbihcbiAgdGFibGVfY29tbWl0Lm1hcChkID0+IG5ldyBEYXRlKGQuRGF0ZSkpXG4pXG5cbmxhc3RfbW9kaWZpY2F0aW9uID0gZDMubWF4KFxuICB0YWJsZV9jb21taXQubWFwKGQgPT4gbmV3IERhdGUoZC5EYXRlKSlcbilcblxuY3JlYXRpb25fc3RyaW5nID0gY3JlYXRpb24udG9Mb2NhbGVTdHJpbmcoXCJmclwiLCB7XG4gIFwiZGF5XCI6IFwibnVtZXJpY1wiLFxuICBcIm1vbnRoXCI6IFwibG9uZ1wiLFxuICBcInllYXJcIjogXCJudW1lcmljXCJcbn0pXG5cbmxhc3RfbW9kaWZpY2F0aW9uX3N0cmluZyA9IGxhc3RfbW9kaWZpY2F0aW9uLnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgXCJtb250aFwiOiBcImxvbmdcIixcbiAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG59KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Z2l0X2hpc3RvcnlfdGFibGV9PC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgPGRpdj4ke2dpdF9oaXN0b3J5X3Bsb3R9PC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdpdF9oaXN0b3J5X3RhYmxlID0gSW5wdXRzLnRhYmxlKFxuICB0YWJsZV9jb21taXQsXG4gIHtcbiAgICBmb3JtYXQ6IHtcbiAgICAgIFNIQTogeCA9PiBtZGBbJHt4fV0oJHtnaXRodWJfcmVwb30vY29tbWl0LyR7eH0pYCxcbiAgICAgIERlc2NyaXB0aW9uOiB4ID0+IG1kYCR7cmVwbGFjZVB1bGxSZXF1ZXN0UGF0dGVybih4LCBnaXRodWJfcmVwbyl9YCxcbiAgICAgIC8qRGF0ZTogeCA9PiB4LnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICAgICAgICBcIm1vbnRoXCI6IFwibnVtZXJpY1wiLFxuICAgICAgICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgICAgICAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG4gICAgICAgIH0pXG4gICAgICAqL1xuICAgIH1cbiAgfVxuKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdpdF9oaXN0b3J5X3Bsb3QgPSBQbG90LnBsb3Qoe1xuICBtYXJrczogW1xuICAgIFBsb3QucnVsZVkoWzBdLCB7c3Ryb2tlOiBcInJveWFsYmx1ZVwifSksXG4gICAgUGxvdC5kb3QoXG4gICAgICAgICAgdGFibGVfY29tbWl0LFxuICAgICAgICAgIFBsb3QucG9pbnRlclgoe3g6IChkKSA9PiBuZXcgRGF0ZShkLmRhdGUpLCB5OiAwLCBzdHJva2U6IFwicmVkXCJ9KSksXG4gICAgUGxvdC5kb3QodGFibGVfY29tbWl0LCB7eDogKGQpID0+IG5ldyBEYXRlKGQuRGF0ZSksIHk6IDAsIGZpbGw6IFwicm95YWxibHVlXCJ9KVxuICBdXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIHJlcGxhY2VQdWxsUmVxdWVzdFBhdHRlcm4oaW5wdXRTdHJpbmcsIGdpdGh1YlJlcG8pIHtcbiAgICAvLyBVc2UgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2ggdGhlIHBhdHRlcm4gI2RpZ2l0XG4gICAgdmFyIHBhdHRlcm4gPSAvIyhcXGQrKS9nO1xuXG4gICAgLy8gUmVwbGFjZSB0aGUgcGF0dGVybiB3aXRoICR7Z2l0aHViX3JlcG99L3B1bGwvI2RpZ2l0XG4gICAgdmFyIHJlcGxhY2VkU3RyaW5nID0gaW5wdXRTdHJpbmcucmVwbGFjZShwYXR0ZXJuLCAnWyMkMV0oJyArIGdpdGh1YlJlcG8gKyAnL3B1bGwvJDEpJyk7XG5cbiAgICByZXR1cm4gcmVwbGFjZWRTdHJpbmc7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2l0aHViX3JlcG8gPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9saW5vZ2FsaWFuYS9weXRob24tZGF0YXNjaWVudGlzdFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidGFibGVfY29tbWl0ID0ge1xuXG4vLyBHZXQgdGhlIEhUTUwgdGFibGUgYnkgaXRzIGNsYXNzIG5hbWVcbnZhciB0YWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21taXQtdGFibGUnKTtcblxuLy8gQ2hlY2sgaWYgdGhlIHRhYmxlIGV4aXN0c1xuaWYgKHRhYmxlKSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBhbiBhcnJheSB0byBzdG9yZSB0aGUgdGFibGUgZGF0YVxuICAgIHZhciBkYXRhQXJyYXkgPSBbXTtcblxuICAgIC8vIEV4dHJhY3QgaGVhZGVycyBmcm9tIHRoZSBmaXJzdCByb3dcbiAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFibGUucm93c1swXS5jZWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgICBoZWFkZXJzLnB1c2godGFibGUucm93c1swXS5jZWxsc1tpXS50ZXh0Q29udGVudC50cmltKCkpO1xuICAgIH1cblxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgcm93cywgc3RhcnRpbmcgZnJvbSB0aGUgc2Vjb25kIHJvd1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGFibGUucm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcm93ID0gdGFibGUucm93c1tpXTtcbiAgICAgICAgdmFyIHJvd0RhdGEgPSB7fTtcblxuICAgICAgICAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIGNlbGxzIGluIHRoZSByb3dcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3cuY2VsbHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIC8vIFVzZSBoZWFkZXJzIGFzIGtleXMgYW5kIGNlbGwgY29udGVudCBhcyB2YWx1ZXNcbiAgICAgICAgICAgIHJvd0RhdGFbaGVhZGVyc1tqXV0gPSByb3cuY2VsbHNbal0udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUHVzaCB0aGUgcm93RGF0YSBvYmplY3QgdG8gdGhlIGRhdGFBcnJheVxuICAgICAgICBkYXRhQXJyYXkucHVzaChyb3dEYXRhKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZGF0YUFycmF5XG5cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbi8vIEdldCB0aGUgZWxlbWVudCB3aXRoIGNsYXNzICdnaXQtZGV0YWlscydcbntcbiAgdmFyIGdpdERldGFpbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWl0LXRhYmxlJyk7XG5cbiAgLy8gQ2hlY2sgaWYgdGhlIGVsZW1lbnQgZXhpc3RzXG4gIGlmIChnaXREZXRhaWxzKSB7XG4gICAgICAvLyBIaWRlIHRoZSBlbGVtZW50XG4gICAgICBnaXREZXRhaWxzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJQbG90ID0gcmVxdWlyZSgnQG9ic2VydmFibGVocS9wbG90QDAuNi4xMi9kaXN0L3Bsb3QudW1kLm1pbi5qcycpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Byb2plY3Rpb24nKSJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../content/manipulation";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pythonds\.linogaliana\.fr");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="linogaliana/python-datascientist" data-repo-id="MDEwOlJlcG9zaXRvcnkyODAxNjE2Nzc=" data-category="General" data-category-id="DIC_kwDOELLtjc4B-5TX" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/manipulation/02_pandas_suite.html" class="pagination-link" aria-label="Data wrangling with Pandas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Data wrangling with Pandas</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/manipulation/04a_webscraping_TP.html" class="pagination-link" aria-label="Web scraping with Python">
        <span class="nav-page-text">Web scraping with Python</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Python pour la <em>data science</em>, Lino Galiana.<br>
Licence <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i><br>
Code source disponible sur <a href="https://github.com/linogaliana/python-datascientist"><code>Github</code></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/manipulation/03_geopandas_intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Site construit avec <i class="fa-brands fa-python" aria-label="python"></i> et <a href="https://quarto.org/"><code>Quarto</code></a><br>
Inspiration pour la mise en forme du site <a href="https://www.andreashandel.com">ici</a><br>
<a href="https://github.com/linogaliana/python-datascientist">Code source disponible sur <i class="fa-brands fa-github" aria-label="github"></i> <code>GitHub</code></a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","loop":false,"closeEffect":"zoom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>