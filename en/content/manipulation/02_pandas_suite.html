<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lino Galiana">
<meta name="dcterms.date" content="2024-10-11">
<meta name="description" content="The introductory chapter to Pandas presented how data were organized as DataFrames and how the Pandas ecosystem can be useful to perform simple operations on datasets. This chapter consolidates these principles by introducing two classic types of operations from the data scientist’s toolbox: group statistics and data merging.">

<title>Python for data science - Analyzing multiple datasets and producing summary statistics with Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/manipulation/03_geopandas_intro.html" rel="next">
<link href="../../content/manipulation/02_pandas_intro.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #e9f3fa;
      }
</style>
<script id="toggle-light-dark-elements" type="application/javascript">
// Extend Quarto theme toggling to allow elements to be displayed/hidden in light/dark themes

// Replicated from https://github.com/quarto-dev/quarto-cli/blob/84d4659/src/resources/formats/html/templates/quarto-html.ejs
const getColorSchemeSentinel = () => {
  const localAlternateSentinel = 'default';
  if (window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    return storageValue != null ? storageValue : localAlternateSentinel;
  } else {
    return localAlternateSentinel;
  }
};

// Function to toggle light and dark elements based on color scheme
const toggleColorSchemeElements = () => {
  const scheme = getColorSchemeSentinel();
  const lightElements = document.getElementsByClassName('only-light');
  const darkElements = document.getElementsByClassName('only-dark');

  for (var i = 0; i < lightElements.length; i++) {
    lightElements[i].style.display = scheme == 'default' ? 'block' : 'none';
  }
  for (var i = 0; i < darkElements.length; i++) {
    darkElements[i].style.display = scheme == 'default' ? 'none' : 'block';
  }
};

// Function to check if the user's browser prefers dark themes
const prefersDarkTheme = () => {
  if (window.matchMedia) {
    return window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return false;
};

document.addEventListener('readystatechange', function() {
  // Set the default color scheme based on browser preference
  if (document.readyState === 'interactive' && window.location.protocol !== 'file:') {
    const storageValue = window.localStorage.getItem('quarto-color-scheme');
    if (storageValue == null && prefersDarkTheme()) {
      window.localStorage.setItem('quarto-color-scheme', 'alternate');
    }
  }
  // Add event listener for when the readyState is complete (and default toggler is set)
  if (document.readyState === 'complete') {
    // Toggle scheme once
    toggleColorSchemeElements();
    // Append our toggle function to the old one
    const oldToggle = window.quartoToggleColorScheme;
    window.quartoToggleColorScheme = () => {
      oldToggle();
      toggleColorSchemeElements();
    }
  }
});

</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Python for data science - Analyzing multiple datasets and producing summary statistics with Pandas">
<meta name="twitter:description" content="Le chapitre d’introduction à Pandas a permis de présenter le principe de données organisées sous une forme de DataFrame et la praticité de l’écosystème Pandas pour effectuer des opérations simples sur un jeu de données. Ce chapitre consolide ces principes en présentant deux types de traitements classiques de la boite à outil des data scientists : statistiques par groupe et associations de données.">
<meta name="twitter:image" content="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/pandas_weight.webp">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Python pour la data science">
<meta name="citation_author" content="Lino Galiana">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2024-10-11">
<meta name="citation_fulltext_html_url" content="https://pythonds.linogaliana.fr/">
<meta name="citation_doi" content="10.5281/zenodo.8229676">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Coding for economists;,citation_author=undefined Turrell;,citation_author=undefined contributors;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://aeturrell.github.io/coding-for-economists;">
<meta name="citation_reference" content="citation_title=Discovering statistics using r;,citation_author=A Field;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_publisher=Sage;">
<meta name="citation_reference" content="citation_title=psyTeachR Book Template;,citation_author=DeBruine Lisa;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://github.com/psyteachr/template/;">
<meta name="citation_reference" content="citation_title=The grammar of graphics;,citation_author=Leland Wilkinson;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Hands-on machine learning with scikit-learn, keras, and TensorFlow;,citation_author=Aurélien Géron;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=A brief history of data visualization;,citation_author=Chun-houh Chen;,citation_author=Wolfgang Härdle;,citation_author=Antony Unwin;,citation_author=Michael Friendly;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of data visualization;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Random forests;,citation_author=Leo Breiman;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_volume=45;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Bagging predictors;,citation_author=Leo Breiman;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_volume=24;,citation_journal_title=Machine learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=R for data science;,citation_author=Hadley Wickham;,citation_author=Mine Çetinkaya-Rundel;,citation_author=Garrett Grolemund;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;">
<meta name="citation_reference" content="citation_title=Computational reproducibility of jupyter notebooks from biomedical publications;,citation_author=Sheeba Samuel;,citation_author=Daniel Mietchen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2308.07333;">
<meta name="citation_reference" content="citation_title=Python data science handbook: Essential tools for working with data;,citation_author=Jake VanderPlas;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;">
<meta name="citation_reference" content="citation_title=Machine learning methods that economists should know about;,citation_author=Susan Athey;,citation_author=Guido W Imbens;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=11;,citation_journal_title=Annual Review of Economics;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data an illustration with scanner data and crowd-sourced nutritional data;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_publisher=Proceedings of the 2022 &amp;amp;amp;quot;Journées de Méthodologie Statistiques&amp;quot;;">
<meta name="citation_reference" content="citation_title=Data visualization with python and JavaScript;,citation_author=Kyran Dale;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=Sémiologie graphique;,citation_author=Jacques Bertin;,citation_publication_date=1967;,citation_cover_date=1967;,citation_year=1967;">
<meta name="citation_reference" content="citation_title=La sémiologie graphique de jacques bertin a cinquante ans;,citation_author=Gilles Palsky;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Visions carto (en ligne);">
<meta name="citation_reference" content="citation_title=Fundamentals of data visualization: A primer on making informative and compelling figures;,citation_author=Claus O Wilke;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=How to train BERT with an academic budget;,citation_author=Peter Izsak;,citation_author=Moshe Berchansky;,citation_author=Omer Levy;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2104.07705;">
<meta name="citation_reference" content="citation_title=Python for data analysis: Data wrangling with pandas, NumPy, and IPython;,citation_author=Wes McKinney;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;">
<meta name="citation_reference" content="citation_title=Residential segregation, daytime segregation and spatial frictions: An analysis from mobile phone data;,citation_author=Lino Galiana;,citation_author=François Sémécurbe;,citation_author=Benjamin Sakarovitch;,citation_author=Zbigniew Smoreda;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Fuzzy matching on big-data: An illustration with scanner and crowd-sourced nutritional datasets;,citation_abstract=Food retailers’ scanner data provide unprecedented details on local consumption, provided that product identifiers allow a linkage with features of interest, such as nutritional information. In this paper, we enrich a large retailer dataset with nutritional information extracted from crowd-sourced and administrative nutritional datasets. To compensate for imperfect matching through the barcode, we develop a methodology to efficiently match short textual descriptions. After a preprocessing step to normalize short labels, we resort to fuzzy matching based on several tokenizers (including n-grams) by querying an ElasticSearch customized index and validate candidates echos as matches with a Levensthein edit-distance and an embedding-based similarity measure created from a siamese neural network model. The pipeline is composed of several steps successively relaxing constraints to find relevant matching candidates.;,citation_author=Lino Galiana;,citation_author=Milena Suarez Castillo;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1145/3524458.3547244;,citation_doi=10.1145/3524458.3547244;,citation_isbn=9781450392846;,citation_conference_title=Proceedings of the 2022 ACM conference on information technology for social good;,citation_conference=Association for Computing Machinery;,citation_series_title=GoodIT ’22;">
<meta name="citation_reference" content="citation_title=Guide de sémiologie cartographique;,citation_author=undefined Insee;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_publisher=Insee Working Paper;">
<meta name="citation_reference" content="citation_title=Energy and policy considerations for deep learning in NLP;,citation_author=Emma Strubell;,citation_author=Ananya Ganesh;,citation_author=Andrew McCallum;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://arxiv.org/abs/1906.02243;">
<meta name="citation_reference" content="citation_title=High-resolution image synthesis with latent diffusion models;,citation_author=Robin Rombach;,citation_author=Andreas Blattmann;,citation_author=Dominik Lorenz;,citation_author=Patrick Esser;,citation_author=Björn Ommer;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_conference_title=Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR);">
<meta name="citation_reference" content="citation_title=Apache arrow and the&amp;amp;amp;quot; 10 things i hate about pandas;,citation_author=Wes McKinney;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_volume=21;,citation_journal_title=Blog, September;">
<meta name="citation_reference" content="citation_title=Many researchers were not compliant with their published data sharing statement: Mixed-methods study;,citation_author=Mirko Gabelica;,citation_author=Ružica Bojčić;,citation_author=Livia Puljak;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_journal_title=Journal of Clinical Epidemiology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Credit scoring in the era of big data;,citation_author=Mikella Hurley;,citation_author=Julius Adebayo;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=18;,citation_journal_title=Yale JL &amp;amp;amp; Tech.;,citation_publisher=HeinOnline;">
<meta name="citation_reference" content="citation_title=Econometrics and machine learning;,citation_author=Arthur Charpentier;,citation_author=Emmanuel Flachaire;,citation_author=Antoine Ly;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=505;,citation_journal_title=Economie et Statistique;,citation_publisher=Persée-Portail des revues scientifiques en SHS;">
<meta name="citation_reference" content="citation_title=Machine learning: An applied econometric approach;,citation_author=Sendhil Mullainathan;,citation_author=Jann Spiess;,citation_publication_date=2017-05;,citation_cover_date=2017-05;,citation_year=2017;,citation_fulltext_html_url=https://www.aeaweb.org/articles?id=10.1257/jep.31.2.87;,citation_issue=2;,citation_doi=10.1257/jep.31.2.87;,citation_volume=31;,citation_journal_title=Journal of Economic Perspectives;">
<meta name="citation_reference" content="citation_title=Le problème du réalisme des hypothèses en économie politique;,citation_author=Pierre Salmon;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;">
<meta name="citation_reference" content="citation_title=The methodology of positive economics;,citation_author=Milton Friedman;,citation_publication_date=1953;,citation_cover_date=1953;,citation_year=1953;,citation_inbook_title=Essays in positive economics;">
<meta name="citation_reference" content="citation_title=L’empreinte carbone du numérique;,citation_author=undefined Arcep;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in ML-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2207.07048;,citation_doi=10.48550/ARXIV.2207.07048;,citation_publisher=arXiv;">
<meta name="citation_reference" content="citation_title=Growth in a time of debt;,citation_author=Carmen M Reinhart;,citation_author=Kenneth S Rogoff;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_issue=2;,citation_volume=100;,citation_journal_title=American economic review;,citation_publisher=American Economic Association;">
<meta name="citation_reference" content="citation_title=We do not know the population of every country in the world for the past two thousand years;,citation_author=Timothy W Guinnane;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=3;,citation_volume=83;,citation_journal_title=The Journal of Economic History;">
<meta name="citation_reference" content="citation_title=Artificial intelligence: A modern approach (4th edition);,citation_author=Stuart J. Russell;,citation_author=Peter Norvig;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=http://aima.cs.berkeley.edu/;,citation_isbn=9781292401133;">
<meta name="citation_reference" content="citation_title=Data scientist, the sexiest job of the 21st century;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century;,citation_issue=5;,citation_volume=90;,citation_journal_title=Harvard business review;">
<meta name="citation_reference" content="citation_title=Is data scientist still the sexiest job of the 21st century?;,citation_author=Thomas H Davenport;,citation_author=DJ Patil;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=90;,citation_journal_title=Harvard Business Review;,citation_publisher=Harvard Business Publishing;">
<meta name="citation_reference" content="citation_title=Leakage and the reproducibility crisis in machine-learning-based science;,citation_author=Sayash Kapoor;,citation_author=Arvind Narayanan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=9;,citation_volume=4;,citation_journal_title=Patterns;,citation_publisher=Elsevier;">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-introduction" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Introduction</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-introduction">    
        <li>
    <a class="dropdown-item" href="../../content/getting-started/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/01_environment.html">
 <span class="dropdown-text">A functional Python environment for data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/02_data_analysis.html">
 <span class="dropdown-text">How to deal with a data set</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/getting-started/03_revisions.html">
 <span class="dropdown-text">A few refresher exercises to get back in the saddle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wrangle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wrangle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wrangle">    
        <li>
    <a class="dropdown-item" href="../../content/manipulation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/01_numpy.html">
 <span class="dropdown-text">Numpy, the foundation of data science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_intro.html">
 <span class="dropdown-text">Introduction to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/02_pandas_suite.html">
 <span class="dropdown-text">Data wrangling with Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/03_geopandas_intro.html">
 <span class="dropdown-text">Introduction to spatial data with Geopandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04a_webscraping_TP.html">
 <span class="dropdown-text">Web scraping with Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04c_API_TP.html">
 <span class="dropdown-text">Retrieve data with APIs from Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/manipulation/04b_regex_TP.html">
 <span class="dropdown-text">Mastering regular expressions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-communicate" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Communicate</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-communicate">    
        <li>
    <a class="dropdown-item" href="../../content/visualisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/matplotlib.html">
 <span class="dropdown-text">De beaux graphiques avec python : mise en pratique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/visualisation/maps.html">
 <span class="dropdown-text">De belles cartes avec python : mise en pratique</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model">    
        <li>
    <a class="dropdown-item" href="../../content/modelisation/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/0_preprocessing.html">
 <span class="dropdown-text">Préparation des données pour construire un modèle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/1_modelevaluation.html">
 <span class="dropdown-text">Evaluer la qualité d’un modèle</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/2_SVM.html">
 <span class="dropdown-text">Classification: premier modèle avec les SVM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/3_regression.html">
 <span class="dropdown-text">Régression : une introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/4_featureselection.html">
 <span class="dropdown-text">Sélection de variables : une introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/5_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/6_pipeline.html">
 <span class="dropdown-text">Premier pas vers l’industrialisation avec les pipelines scikit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modelisation/7_mlapi.html">
 <span class="dropdown-text">Mettre à disposition un modèle par le biais d’une API</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nlp" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NLP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nlp">    
        <li>
    <a class="dropdown-item" href="../../content/NLP/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/01_intro.html">
 <span class="dropdown-text">Nettoyer et structurer l’information dans les données textuelles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/02_exoclean.html">
 <span class="dropdown-text">L’analyse fréquentiste par l’approche bag-of-words : intérêt et limites</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/03_lda.html">
 <span class="dropdown-text">Latent Dirichlet Allocation (LDA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/04_word2vec.html">
 <span class="dropdown-text">Méthodes de vectorisation : comptages et word embeddings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/NLP/05_exo_supp.html">
 <span class="dropdown-text">Exercices supplémentaires</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-depth" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-depth</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-depth">    
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/continuous_integration.html">
 <span class="dropdown-text">Intégration continue avec Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/s3.html">
 <span class="dropdown-text">Les nouveaux modes d’accès aux données : le format parquet et les données sur le cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_approfondissement.html">
 <span class="dropdown-text">Approfondissement ElasticSearch pour des recherches de proximité géographique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/modern-ds/elastic_intro.html">
 <span class="dropdown-text">Introduction à ElasticSearch pour la recherche textuelle</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-git" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Git</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-git">    
        <li>
    <a class="dropdown-item" href="../../content/git/index.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/introgit.html">
 <span class="dropdown-text">Découvrir Git par la pratique: la gymnastique quotidienne</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/git/exogit.html">
 <span class="dropdown-text">Un cadavre exquis pour découvrir le travail collaboratif <code>Git</code></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-annexes" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Annexes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-annexes">    
        <li>
    <a class="dropdown-item" href="../../content/annexes/evaluation.html">
 <span class="dropdown-text">Evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/annexes/corrections.html">
 <span class="dropdown-text">Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://linogaliana.github.io/python-datascientist-slides/#/title-slide">
 <span class="dropdown-text">Slides de présentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/linogaliana/python-datascientist" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/manipulation/02_pandas_suite.html">Data wrangling with Pandas</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Analyzing multiple datasets and producing summary statistics with Pandas</h1>
                  <div>
        <div class="description">
          <p>The introductory chapter to <code>Pandas</code> presented how data
          were organized as <em>DataFrames</em> and how the <code>Pandas</code> ecosystem
          can be useful to
          perform simple operations on datasets. This chapter consolidates these principles by introducing two classic types of operations from the data scientist’s toolbox: group statistics and data merging.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Tutoriel</div>
                <div class="quarto-category">Manipulation</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lino Galiana </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2024-10-11</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/01_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy, the foundation of data science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/02_pandas_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/02_pandas_suite.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data wrangling with Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/03_geopandas_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to spatial data with Geopandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04a_webscraping_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web scraping with Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04c_API_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Retrieve data with APIs from Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/manipulation/04b_regex_TP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mastering regular expressions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment"><span class="header-section-number">1.1</span> Environment</a></li>
  <li><a href="#data-used" id="toc-data-used" class="nav-link" data-scroll-target="#data-used"><span class="header-section-number">1.2</span> Data used</a></li>
  </ul></li>
  <li><a href="#retrieving-data-for-this-chapter" id="toc-retrieving-data-for-this-chapter" class="nav-link" data-scroll-target="#retrieving-data-for-this-chapter"><span class="header-section-number">2</span> Retrieving data for this chapter</a>
  <ul class="collapse">
  <li><a href="#french-carbon-emissions-dataset" id="toc-french-carbon-emissions-dataset" class="nav-link" data-scroll-target="#french-carbon-emissions-dataset"><span class="header-section-number">2.1</span> French carbon emissions dataset</a></li>
  </ul></li>
  <li><a href="#descriptive-statistics-by-group" id="toc-descriptive-statistics-by-group" class="nav-link" data-scroll-target="#descriptive-statistics-by-group"><span class="header-section-number">3</span> Descriptive statistics by group</a>
  <ul class="collapse">
  <li><a href="#principle" id="toc-principle" class="nav-link" data-scroll-target="#principle"><span class="header-section-number">3.1</span> Principle</a></li>
  <li><a href="#illustration-1-counting-by-group" id="toc-illustration-1-counting-by-group" class="nav-link" data-scroll-target="#illustration-1-counting-by-group"><span class="header-section-number">3.2</span> Illustration 1: counting by group</a></li>
  <li><a href="#illustration-2-aggregates-by-group" id="toc-illustration-2-aggregates-by-group" class="nav-link" data-scroll-target="#illustration-2-aggregates-by-group"><span class="header-section-number">3.3</span> Illustration 2: aggregates by group</a></li>
  <li><a href="#exercice-dapplication" id="toc-exercice-dapplication" class="nav-link" data-scroll-target="#exercice-dapplication"><span class="header-section-number">3.4</span> Exercice d’application</a></li>
  </ul></li>
  <li><a href="#restructuring-datasets" id="toc-restructuring-datasets" class="nav-link" data-scroll-target="#restructuring-datasets"><span class="header-section-number">4</span> Restructuring datasets</a>
  <ul class="collapse">
  <li><a href="#principle-1" id="toc-principle-1" class="nav-link" data-scroll-target="#principle-1"><span class="header-section-number">4.1</span> Principle</a></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application"><span class="header-section-number">4.2</span> Application</a></li>
  </ul></li>
  <li><a href="#joining-data" id="toc-joining-data" class="nav-link" data-scroll-target="#joining-data"><span class="header-section-number">5</span> Joining data</a>
  <ul class="collapse">
  <li><a href="#principle-2" id="toc-principle-2" class="nav-link" data-scroll-target="#principle-2"><span class="header-section-number">5.1</span> Principle</a></li>
  <li><a href="#implementation-with-pandas" id="toc-implementation-with-pandas" class="nav-link" data-scroll-target="#implementation-with-pandas"><span class="header-section-number">5.2</span> Implementation with <code>Pandas</code></a>
  <ul class="collapse">
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join"><span class="header-section-number">5.2.1</span> <em>Left join</em></a></li>
  <li><a href="#right-join__" id="toc-right-join__" class="nav-link" data-scroll-target="#right-join__"><span class="header-section-number">5.2.2</span> _Right join__</a></li>
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join"><span class="header-section-number">5.2.3</span> <em>Inner join</em></a></li>
  <li><a href="#full-join" id="toc-full-join" class="nav-link" data-scroll-target="#full-join"><span class="header-section-number">5.2.4</span> <em>Full join</em></a></li>
  <li><a href="#in-summary" id="toc-in-summary" class="nav-link" data-scroll-target="#in-summary"><span class="header-section-number">5.2.5</span> In summary</a></li>
  </ul></li>
  <li><a href="#examples-of-identifiers-in-french-data" id="toc-examples-of-identifiers-in-french-data" class="nav-link" data-scroll-target="#examples-of-identifiers-in-french-data"><span class="header-section-number">5.3</span> Examples of identifiers in French data</a>
  <ul class="collapse">
  <li><a href="#the-official-geographic-code-cog-the-identifier-for-geographic-data" id="toc-the-official-geographic-code-cog-the-identifier-for-geographic-data" class="nav-link" data-scroll-target="#the-official-geographic-code-cog-the-identifier-for-geographic-data"><span class="header-section-number">5.3.1</span> The Official Geographic Code (COG): The identifier for geographic data</a></li>
  <li><a href="#sirene-the-identifier-in-business-data" id="toc-sirene-the-identifier-in-business-data" class="nav-link" data-scroll-target="#sirene-the-identifier-in-business-data"><span class="header-section-number">5.3.2</span> Sirene: the identifier in business data</a></li>
  <li><a href="#the-social-security-number-and-the-issue-of-individual-identifiers-confidentiality" id="toc-the-social-security-number-and-the-issue-of-individual-identifiers-confidentiality" class="nav-link" data-scroll-target="#the-social-security-number-and-the-issue-of-individual-identifiers-confidentiality"><span class="header-section-number">5.3.3</span> The social security number and the issue of individual identifiers’ confidentiality</a></li>
  <li><a href="#why-do-we-need-a-commune-code-when-we-already-have-its-name" id="toc-why-do-we-need-a-commune-code-when-we-already-have-its-name" class="nav-link" data-scroll-target="#why-do-we-need-a-commune-code-when-we-already-have-its-name"><span class="header-section-number">5.3.4</span> Why do we need a commune code when we already have its name?</a></li>
  <li><a href="#associating-different-sources-to-compute-carbon-footprints" id="toc-associating-different-sources-to-compute-carbon-footprints" class="nav-link" data-scroll-target="#associating-different-sources-to-compute-carbon-footprints"><span class="header-section-number">5.3.5</span> Associating different sources to compute carbon footprints</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#formatting-descriptive-statistics-tables" id="toc-formatting-descriptive-statistics-tables" class="nav-link" data-scroll-target="#formatting-descriptive-statistics-tables"><span class="header-section-number">6</span> Formatting descriptive statistics tables</a></li>
  <li><a href="#pandas-towards-practice-and-beyond" id="toc-pandas-towards-practice-and-beyond" class="nav-link" data-scroll-target="#pandas-towards-practice-and-beyond"><span class="header-section-number">7</span> <code>Pandas</code>: towards practice and beyond</a>
  <ul class="collapse">
  <li><a href="#pandas-in-a-chain-of-operations" id="toc-pandas-in-a-chain-of-operations" class="nav-link" data-scroll-target="#pandas-in-a-chain-of-operations"><span class="header-section-number">7.1</span> <code>Pandas</code> in a chain of operations</a></li>
  <li><a href="#some-limitations-regarding-pandas-syntax" id="toc-some-limitations-regarding-pandas-syntax" class="nav-link" data-scroll-target="#some-limitations-regarding-pandas-syntax"><span class="header-section-number">7.2</span> Some limitations regarding <code>Pandas</code> syntax</a></li>
  </ul></li>
  <li><a href="#other-paradigms" id="toc-other-paradigms" class="nav-link" data-scroll-target="#other-paradigms"><span class="header-section-number">8</span> Other paradigms</a>
  <ul class="collapse">
  <li><a href="#polars-1" id="toc-polars-1" class="nav-link" data-scroll-target="#polars-1"><span class="header-section-number">8.1</span> <code>Polars</code></a></li>
  <li><a href="#duckdb-1" id="toc-duckdb-1" class="nav-link" data-scroll-target="#duckdb-1"><span class="header-section-number">8.2</span> <code>DuckDB</code></a></li>
  <li><a href="#spark" id="toc-spark" class="nav-link" data-scroll-target="#spark"><span class="header-section-number">8.3</span> <code>Spark</code></a></li>
  <li><a href="#informations-additionnelles" id="toc-informations-additionnelles" class="nav-link" data-scroll-target="#informations-additionnelles">Informations additionnelles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/manipulation/02_pandas_suite.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<a href="#" onclick="this.href = location.href.replace('/en/', '/');" class="button-cta">
<button class="btn"><i class="fa fa-language"></i> Passer à la version française 🇫🇷</button>
</a></p>
<div class="badge-container"><div class="badge-text">If you want to try the examples in this tutorial:</div><a href="https://github.com/linogaliana/python-datascientist-notebooks/blob/main/notebooks/en/manipulation/02_pandas_suite.ipynb" target="_blank" rel="noopener"><img src="https://img.shields.io/static/v1?logo=github&amp;label=&amp;message=View%20on%20GitHub&amp;color=181717" alt="View on GitHub"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/vscode-python?autoLaunch=true&amp;name=«02_pandas_suite»&amp;init.personalInit=«https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-vscode.sh»&amp;init.personalInitArgs=«en/manipulation%2002_pandas_suite%20correction»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_VSCode-blue?logo=visualstudiocode&amp;logoColor=blue" alt="Onyxia"></a>
<a href="https://datalab.sspcloud.fr/launcher/ide/jupyter-python?autoLaunch=true&amp;name=«02_pandas_suite»&amp;init.personalInit=«https%3A%2F%2Fraw.githubusercontent.com%2Flinogaliana%2Fpython-datascientist%2Fmain%2Fsspcloud%2Finit-jupyter.sh»&amp;init.personalInitArgs=«en/manipulation%2002_pandas_suite%20correction»" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSP%20Cloud-Lancer_avec_Jupyter-orange?logo=Jupyter&amp;logoColor=orange" alt="Onyxia"></a>
<a href="https://colab.research.google.com/github/linogaliana/python-datascientist-notebooks//en/blob/main//notebooks/en/manipulation/02_pandas_suite.ipynb" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a><br></div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The <a href="../../content/manipulation/02_pandas_intro.html">introductory chapter to <code>Pandas</code></a> presented the concept of data organized in the form of a <em>DataFrame</em> and the practicality of the <code>Pandas</code> ecosystem for performing simple operations on a dataset.</p>
<p>It is rare to work exclusively on a raw source. A dataset generally gains value when compared to other sources. For researchers, this allows contextualizing the information present in one source by comparing or associating it with other sources. For data scientists in the private sector, it often involves linking information about the same person in multiple customer databases or comparing customers with each other.</p>
<p>One of the benefits of modern data science tools, especially <code>Pandas</code>, is the ease with which they allow restructuring sources to work on multiple datasets in a project. This chapter consolidates the principles previously seen by refining the data processing. It will mainly explore two types of operations:</p>
<ul>
<li>Group descriptive statistics;</li>
<li>Data merging by common characteristics.</li>
</ul>
<p>Performing this work simply, reliably, and efficiently is essential for data scientists as this task is common. Fortunately, <code>Pandas</code> handles this very well with structured data. In the following chapters, and also throughout the <a href="../../content/nlp/index.qmd">section on text data processing</a>, we will see how to handle less structured data.</p>
<p>Through this work, we will deepen our understanding of a real world phenomenon through detailed descriptive statistics. This is an essential step before moving on to <a href="https://en.wikipedia.org/wiki/Statistical_inference">inferential statistics</a>, the approach that consists of formalizing and generalizing correlations or causal relationships between observed characteristics and a phenomenon.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Skills at the end of this chapter
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Retrieve an official dataset from Insee;</li>
<li>Build group descriptive statistics and switch between data levels;</li>
<li>Merge data (<em>reshape</em>, <em>merge</em>) to add value;</li>
<li>Create a beautiful table to communicate descriptive statistics.</li>
</ul>
</div>
</div>
</div>
<section id="environment" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="environment"><span class="header-section-number">1.1</span> Environment</h2>
<p>The previous chapter used almost exclusively the <code>Pandas</code> library. In this chapter, we will use other packages in addition to it.</p>
<p>As explained below, we will use a library called <code>pynsee</code> to retrieve Insee data useful for enriching our Ademe dataset. This library is not installed by default in <code>Python</code>. Before using it, it is necessary to install it, along with the <code>great_tables</code> library that we will see at the end of this chapter:</p>
<div id="099e8197" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="099e8197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="099e8197-1"><a href="#099e8197-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install xlrd</span>
<span id="099e8197-2"><a href="#099e8197-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pynsee</span>
<span id="099e8197-3"><a href="#099e8197-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install great_tables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The instruction <code>!pip install &lt;pkg&gt;</code> is a way to tell <code>Jupyter</code>, the execution engine behind notebooks, that the following command (<code>pip install &lt;pkg&gt;</code>) is a system command to be executed outside of <code>Python</code> (in the terminal, for example, for a <code>Linux</code> system).</p>
<p>The essential packages to start this chapter are as follows:</p>
<div id="02353824" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="02353824"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="02353824-1"><a href="#02353824-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="02353824-2"><a href="#02353824-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="02353824-3"><a href="#02353824-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="02353824-4"><a href="#02353824-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pynsee</span>
<span id="02353824-5"><a href="#02353824-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pynsee.download</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To obtain reproducible results, you can set the seed of the pseudo-random number generator.</p>
<div id="c0fccb95" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="c0fccb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c0fccb95-1"><a href="#c0fccb95-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-used" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="data-used"><span class="header-section-number">1.2</span> Data used</h2>
<p>This tutorial continues the exploration of the dataset from the previous chapter:</p>
<ul>
<li>Greenhouse gas emissions estimated at the municipal level by ADEME. The dataset is available on <a href="https://www.data.gouv.fr/fr/datasets/inventaire-de-gaz-a-effet-de-serre-territorialise/#_">data.gouv</a> and can be directly queried in Python with <a href="https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert">this URL</a>;</li>
</ul>
<p>The issues of data enrichment (associating one source with another based on common characteristics) will be presented using two sources produced by Insee:</p>
<ul>
<li>The <a href="https://www.insee.fr/fr/statistiques/fichier/6800675/v_commune_2023.csv">official geographic code</a>, a reference produced by Insee used to identify municipalities with a unique code, unlike the postal code;</li>
<li>The <a href="https://www.insee.fr/fr/metadonnees/source/serie/s1172"><em>Filosofi</em></a> data, a source on French income at a fine spatial scale constructed by Insee from tax returns and social benefit information. In this case, we will use income levels and populations<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> at the municipal level to compare them with our emissions data.</li>
</ul>
<p>To facilitate the import of Insee data, it is recommended to use the <a href="https://pynsee.readthedocs.io/en/latest/"><code>pynsee</code></a> package, which simplifies access to the main Insee datasets available on the <a href="https://www.insee.fr/fr/accueil">insee.fr</a> website or via APIs.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The <code>pynsee</code> package has two main entry points:</p>
<ul>
<li>The Insee APIs, which will be illustrated in the dedicated chapter.</li>
<li>Some datasets directly from the Insee website (<a href="https://www.insee.fr/fr/accueil">insee.fr</a>)</li>
</ul>
<p>In this chapter, we will exclusively use the second approach through the <code>pynsee.download</code> module.</p>
<p>The list of available data from this package is <a href="https://inseefrlab.github.io/DoReMIFaSol/articles/donnees_dispo.html">here</a>. The <code>download_file</code> function expects a unique identifier to know which database to fetch and restructure from the <a href="https://www.insee.fr/fr/accueil">insee.fr</a> website.</p>
<details>
<summary>
Knowing the list of available databases
</summary>
<p>To know the list of available databases, you can use the <code>meta = pynsee.get_file_list()</code> function after importing <code>pynsee</code>. This returns a <code>DataFrame</code> in which you can search, for example, using a keyword search:</p>
<div id="99f585be" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="99f585be"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="99f585be-1"><a href="#99f585be-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pynsee</span>
<span id="99f585be-2"><a href="#99f585be-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="99f585be-3"><a href="#99f585be-3" aria-hidden="true" tabindex="-1"></a>meta <span class="op">=</span> pynsee.get_file_list()</span>
<span id="99f585be-4"><a href="#99f585be-4" aria-hidden="true" tabindex="-1"></a>meta.loc[meta[<span class="st">"label"</span>].<span class="bu">str</span>.contains(<span class="vs">r"Filosofi.*2016"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">collection</th>
<th data-quarto-table-cell-role="th">link</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">zip</th>
<th data-quarto-table-cell-role="th">big_zip</th>
<th data-quarto-table-cell-role="th">data_file</th>
<th data-quarto-table-cell-role="th">tab</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">label_col</th>
<th data-quarto-table-cell-role="th">date_ref</th>
<th data-quarto-table-cell-role="th">meta_file</th>
<th data-quarto-table-cell-role="th">separator</th>
<th data-quarto-table-cell-role="th">type_col</th>
<th data-quarto-table-cell-role="th">long_col</th>
<th data-quarto-table-cell-role="th">val_col</th>
<th data-quarto-table-cell-role="th">encoding</th>
<th data-quarto-table-cell-role="th">last_row</th>
<th data-quarto-table-cell-role="th">missing_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>FILOSOFI_COM_2016</td>
<td>FILOSOFI_COM</td>
<td>Données Filosofi niveau communal – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>COM</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>FILOSOFI_EPCI_2016</td>
<td>FILOSOFI_EPCI</td>
<td>Données Filosofi niveau EPCI – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>EPCI</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>FILOSOFI_ARR_2016</td>
<td>FILOSOFI_ARR</td>
<td>Données Filosofi niveau arondissement – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>ARR</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">82</td>
<td>FILOSOFI_DEP_2016</td>
<td>FILOSOFI_DEP</td>
<td>Données Filosofi niveau départemental – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>DEP</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>FILOSOFI_REG_2016</td>
<td>FILOSOFI_REG</td>
<td>Données Filosofi niveau régional – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>REG</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">84</td>
<td>FILOSOFI_METRO_2016</td>
<td>FILOSOFI_METRO</td>
<td>Données Filosofi niveau France métropolitaine ...</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>METRO</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">85</td>
<td>FILOSOFI_AU2010_2016</td>
<td>FILOSOFI_AU2010</td>
<td>Données Filosofi niveau aire urbaine – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>AU2010</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">86</td>
<td>FILOSOFI_UU2010_2016</td>
<td>FILOSOFI_UU2010</td>
<td>Données Filosofi niveau unité urbaine – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>UU2010</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>FILOSOFI_ZE2010_2016</td>
<td>FILOSOFI_ZE2010</td>
<td>Données Filosofi niveau zone d’emploi – 2016</td>
<td>FILOSOFI</td>
<td>https://www.insee.fr/fr/statistiques/fichier/4...</td>
<td>xls</td>
<td>True</td>
<td>False</td>
<td>base-cc-filosofi-2016.xls</td>
<td>ZE2010</td>
<td>...</td>
<td>NaN</td>
<td>2016-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>9 rows × 24 columns</p>
</div>
</div>
</div>
</div>
<p>Here, meta[‘label’].str.contains(r”Filosofi.<em>2016”) means: “pandas find me all labels containing the terms Filosofi and 2016.” (.</em> means “no matter the number of words or characters in between”).</p>
</details>
</div>
</div>
</div>
</section>
</section>
<section id="retrieving-data-for-this-chapter" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Retrieving data for this chapter</h1>
<section id="french-carbon-emissions-dataset" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="french-carbon-emissions-dataset"><span class="header-section-number">2.1</span> French carbon emissions dataset</h2>
<p>As explained in the previous chapter, these data can be imported very simply with <code>Pandas</code>:</p>
<div id="a5bff615" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="a5bff615"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a5bff615-1"><a href="#a5bff615-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="a5bff615-2"><a href="#a5bff615-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="a5bff615-3"><a href="#a5bff615-3" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://koumoul.com/s/data-fair/api/v1/datasets/igt-pouvoir-de-rechauffement-global/convert"</span></span>
<span id="a5bff615-4"><a href="#a5bff615-4" aria-hidden="true" tabindex="-1"></a>emissions <span class="op">=</span> pd.read_csv(url)</span>
<span id="a5bff615-5"><a href="#a5bff615-5" aria-hidden="true" tabindex="-1"></a>emissions.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>We will already keep the names of the emitting sectors present in the database to simplify subsequent uses:</p>
<div id="99d63e76" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="99d63e76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="99d63e76-1"><a href="#99d63e76-1" aria-hidden="true" tabindex="-1"></a>secteurs <span class="op">=</span> emissions.select_dtypes(include<span class="op">=</span><span class="st">"number"</span>).columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Subsequent exploitations of these data will use the departmental dimension, the construction of which we demonstrated in the previous chapter:</p>
<div id="ee0b4b65" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="ee0b4b65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ee0b4b65-1"><a href="#ee0b4b65-1" aria-hidden="true" tabindex="-1"></a>emissions[<span class="st">"dep"</span>] <span class="op">=</span> emissions[<span class="st">"INSEE commune"</span>].<span class="bu">str</span>[:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the Filosofi data (income data) at the municipal level for 2016. It is not the same year as the CO2 emissions data, so it is not perfectly rigorous, but it will still illustrate the main functionalities of <code>Pandas</code>.</p>
<p>The main entry point for the <code>pynsee</code> function is the <code>download_file</code> function.</p>
<p>The code to download the data is as follows:</p>
<div id="bdcbe6ee" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="bdcbe6ee"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="bdcbe6ee-1"><a href="#bdcbe6ee-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pynsee.download <span class="im">import</span> download_file</span>
<span id="bdcbe6ee-2"><a href="#bdcbe6ee-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="bdcbe6ee-3"><a href="#bdcbe6ee-3" aria-hidden="true" tabindex="-1"></a>filosofi <span class="op">=</span> download_file(<span class="st">"FILOSOFI_COM_2016"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting <code>DataFrame</code> looks like this:</p>
<div id="f32ccbf9" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="f32ccbf9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="f32ccbf9-1"><a href="#f32ccbf9-1" aria-hidden="true" tabindex="-1"></a>filosofi.sample(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CODGEO</th>
<th data-quarto-table-cell-role="th">LIBGEO</th>
<th data-quarto-table-cell-role="th">NBMENFISC16</th>
<th data-quarto-table-cell-role="th">NBPERSMENFISC16</th>
<th data-quarto-table-cell-role="th">MED16</th>
<th data-quarto-table-cell-role="th">PIMP16</th>
<th data-quarto-table-cell-role="th">TP6016</th>
<th data-quarto-table-cell-role="th">TP60AGE116</th>
<th data-quarto-table-cell-role="th">TP60AGE216</th>
<th data-quarto-table-cell-role="th">TP60AGE316</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPEN16</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">34640</td>
<td>93077</td>
<td>Villemomble</td>
<td>11968</td>
<td>30123.5</td>
<td>21782.222222222223</td>
<td>61</td>
<td>19</td>
<td>22</td>
<td>23</td>
<td>19</td>
<td>...</td>
<td>23.1</td>
<td>9</td>
<td>5.1</td>
<td>2.1</td>
<td>1.7</td>
<td>1.3</td>
<td>-19.6</td>
<td>9371.481481481482</td>
<td>40950.8</td>
<td>4.36972532901237</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9988</td>
<td>28073</td>
<td>Champseru</td>
<td>121</td>
<td>326.5</td>
<td>24806</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>...</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17537</td>
<td>48190</td>
<td>Termes</td>
<td>92</td>
<td>210.5</td>
<td>19108.571428571428</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>...</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>

<p>3 rows × 29 columns</p>
</div>
</div>
</div>
</div>
<p><code>Pandas</code> automatically handled the variable types. It does this relatively well, but a check is always useful for variables that have a specific status.</p>
<p>For variables that are not of type <code>float</code> but should be, we modify their type.</p>
<div id="18eec7cf" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="18eec7cf"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="18eec7cf-1"><a href="#18eec7cf-1" aria-hidden="true" tabindex="-1"></a>filosofi <span class="op">=</span> filosofi.astype({c: <span class="st">"float"</span> <span class="cf">for</span> c <span class="kw">in</span> filosofi.columns[<span class="dv">2</span>:]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A quick glance at the data gives a fairly precise idea of how the data are organized. We notice that some variables in <code>filosofi</code> seem to have many missing values (statistical secrecy), while others seem complete. If we want to exploit <code>filosofi</code>, we need to pay attention to the chosen variable.</p>
<p>Our ultimate goal will be to link the information contained between these two datasets. Otherwise, we risk being frustrated: we will want to know more about carbon emissions but will be very limited in the possibilities of analysis without adding additional information from <code>filosofi</code>.</p>
</section>
</section>
<section id="descriptive-statistics-by-group" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Descriptive statistics by group</h1>
<section id="principle" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="principle"><span class="header-section-number">3.1</span> Principle</h2>
<p>In the previous chapter, we saw how to obtain an aggregated statistic easily with <code>Pandas</code>. However, it is common to have data with intermediate analysis strata that are relevant: geographical variables, membership in socio-demographic groups related to recorded characteristics, temporal period indicators, etc. To better understand the structure of the data, data scientists are often led to construct descriptive statistics on sub-groups present in the data. For example, we previously constructed emission statistics at the national level. But what about the emission profiles of different departments? To answer this question, it will be useful to aggregate our data at the departmental level. This will give us different information from the initial dataset (municipal level) and the most aggregated level (national level).</p>
<p>In <code>SQL</code>, it is very simple to segment data to perform operations on coherent blocks and recollect results in the appropriate dimension. The underlying logic is that of <em>split-apply-combine</em>, which is adopted by data manipulation languages, including <code>pandas</code> <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html">which is no exception</a>.</p>
<p>The following image, from <a href="https://unlhcc.github.io/r-novice-gapminder/16-plyr/">this site</a>, well represents how the <code>split</code>-<code>apply</code>-<code>combine</code> approach works:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://unlhcc.github.io/r-novice-gapminder/fig/12-plyr-fig1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1" title="Split-apply-combine (Source: unlhcc.github.io)"><img src="https://unlhcc.github.io/r-novice-gapminder/fig/12-plyr-fig1.png" class="img-fluid figure-img" data-fig-width="70%" alt="Split-apply-combine (Source: unlhcc.github.io)"></a></p>
<figcaption>Split-apply-combine (Source: <a href="https://unlhcc.github.io/r-novice-gapminder/16-plyr/">unlhcc.github.io</a>)</figcaption>
</figure>
</div>
<p>In <code>Pandas</code>, we use <code>groupby</code> to segment the data according to one or more axes (this <a href="https://realpython.com/pandas-groupby/">tutorial</a> on the subject is particularly useful). All the aggregation operations (counting, averages, etc.) that we saw earlier can be applied by group.</p>
<p>Technically, this operation involves creating an association between labels (values of group variables) and observations. Using the <code>groupby</code> method does not trigger operations until a statistic is implemented; it simply creates a formal relationship between observations and groupings that will be used later:</p>
<div id="9f83873b" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="9f83873b"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="9f83873b-1"><a href="#9f83873b-1" aria-hidden="true" tabindex="-1"></a>filosofi[<span class="st">"dep"</span>] <span class="op">=</span> filosofi[<span class="st">"CODGEO"</span>].<span class="bu">str</span>[:<span class="dv">2</span>]</span>
<span id="9f83873b-2"><a href="#9f83873b-2" aria-hidden="true" tabindex="-1"></a>filosofi.groupby(<span class="st">"dep"</span>).__class__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>pandas.core.groupby.generic.DataFrameGroupBy</code></pre>
</div>
</div>
<p>As long as we do not call an action on a <code>DataFrame</code> by group, such as <code>head</code> or <code>display</code>, <code>pandas</code> performs no operations. This is called <em>lazy evaluation</em>. For example, the result of <code>df.groupby('dep')</code> is a transformation that has not yet been evaluated:</p>
<div id="8aad2579" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="8aad2579"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8aad2579-1"><a href="#8aad2579-1" aria-hidden="true" tabindex="-1"></a>filosofi.groupby(<span class="st">"dep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fa0e710aad0&gt;</code></pre>
</div>
</div>
</section>
<section id="illustration-1-counting-by-group" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="illustration-1-counting-by-group"><span class="header-section-number">3.2</span> Illustration 1: counting by group</h2>
<p>To illustrate the application of this principle to counting, we can count the number of municipalities by department in 2023 (this statistic changes every year due to municipal mergers). For this, we simply take the reference of French municipalities from the official geographical code (COG) and count by department using <code>count</code>:</p>
<div id="4592a175" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="4592a175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="4592a175-1"><a href="#4592a175-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="4592a175-2"><a href="#4592a175-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="4592a175-3"><a href="#4592a175-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="4592a175-4"><a href="#4592a175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="4592a175-5"><a href="#4592a175-5" aria-hidden="true" tabindex="-1"></a>url_cog_2023 <span class="op">=</span> <span class="st">"https://www.insee.fr/fr/statistiques/fichier/6800675/v_commune_2023.csv"</span></span>
<span id="4592a175-6"><a href="#4592a175-6" aria-hidden="true" tabindex="-1"></a>url_backup <span class="op">=</span> <span class="st">"https://minio.lab.sspcloud.fr/lgaliana/data/python-ENSAE/cog_2023.csv"</span></span>
<span id="4592a175-7"><a href="#4592a175-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="4592a175-8"><a href="#4592a175-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Try-except clause to avoid timout issue sometimes</span></span>
<span id="4592a175-9"><a href="#4592a175-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Without timeout problem, pd.read_csv(url_cog_2023) would be sufficient</span></span>
<span id="4592a175-10"><a href="#4592a175-10" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="4592a175-11"><a href="#4592a175-11" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url_cog_2023)</span>
<span id="4592a175-12"><a href="#4592a175-12" aria-hidden="true" tabindex="-1"></a>    response.raise_for_status()</span>
<span id="4592a175-13"><a href="#4592a175-13" aria-hidden="true" tabindex="-1"></a>    cog_2023 <span class="op">=</span> pd.read_csv(StringIO(response.text))</span>
<span id="4592a175-14"><a href="#4592a175-14" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> requests.exceptions.Timeout:</span>
<span id="4592a175-15"><a href="#4592a175-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Failing back to backup"</span>)</span>
<span id="4592a175-16"><a href="#4592a175-16" aria-hidden="true" tabindex="-1"></a>    cog_2023 <span class="op">=</span> pd.read_csv(url_backup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this dataset, without resorting to group statistics, we can already know how many municipalities, departments, and regions we have in France, respectively:</p>
<div id="964e25bf" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="964e25bf"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="964e25bf" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="964e25bf-1" class="code-annotation-target"><a href="#964e25bf-1" aria-hidden="true" tabindex="-1"></a>communes <span class="op">=</span> cog_2023.loc[cog_2023[<span class="st">"TYPECOM"</span>] <span class="op">==</span> <span class="st">"COM"</span>]</span>
<span id="964e25bf-2"><a href="#964e25bf-2" aria-hidden="true" tabindex="-1"></a>communes.loc[:, [<span class="st">"COM"</span>, <span class="st">"DEP"</span>, <span class="st">"REG"</span>]].nunique()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="964e25bf" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="964e25bf" data-code-lines="1" data-code-annotation="1">We restrict to the status “Commune” because this file also contains Insee codes for other statuses, such as the “Municipal Arrondissements” of Paris, Lyon, and Marseille.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>COM    34945
DEP      101
REG       18
dtype: int64</code></pre>
</div>
</div>
<p>Now, let’s look at the departments with the most municipalities. It is the same counting function where we play, this time, on the group from which the statistic is calculated.</p>
<p>Calculating this statistic is quite straightforward when you understand the principle of calculating statistics with <code>Pandas</code>:</p>
<div id="97b89053" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="97b89053"><pre class="sourceCode python code-annotation-code code-with-copy"><code class="sourceCode python"><span id="97b89053-1"><a href="#97b89053-1" aria-hidden="true" tabindex="-1"></a>communes <span class="op">=</span> cog_2023.loc[cog_2023[<span class="st">"TYPECOM"</span>] <span class="op">==</span> <span class="st">"COM"</span>]</span>
<span id="97b89053-2"><a href="#97b89053-2" aria-hidden="true" tabindex="-1"></a>communes.groupby(<span class="st">"DEP"</span>).agg({<span class="st">"COM"</span>: <span class="st">"nunique"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">COM</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DEP</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">01</td>
<td>392</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">02</td>
<td>798</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">03</td>
<td>317</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">04</td>
<td>198</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">05</td>
<td>162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">971</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">972</td>
<td>34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">973</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">974</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">976</td>
<td>17</td>
</tr>
</tbody>
</table>

<p>101 rows × 1 columns</p>
</div>
</div>
</div>
</div>
<p>In SQL, we would use the following query:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> dep, <span class="fu">COUNT</span> <span class="kw">DISTINCT</span> <span class="ot">"COM"</span> <span class="kw">AS</span> COM </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> communes</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> dep </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> TYPECOM <span class="op">==</span> <span class="st">'COM'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The output is an indexed <code>Series</code>. This is not very convenient as we mentioned in the previous chapter. It is more practical to transform this object into a <code>DataFrame</code> with <code>reset_index</code>. Finally, with <code>sort_values</code>, we obtain the desired statistic:</p>
<div id="c3ddc810" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="c3ddc810"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c3ddc810-1"><a href="#c3ddc810-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="c3ddc810-2"><a href="#c3ddc810-2" aria-hidden="true" tabindex="-1"></a>    communes.groupby(<span class="st">"DEP"</span>)</span>
<span id="c3ddc810-3"><a href="#c3ddc810-3" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">"COM"</span>: <span class="st">"nunique"</span>})</span>
<span id="c3ddc810-4"><a href="#c3ddc810-4" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="c3ddc810-5"><a href="#c3ddc810-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">"COM"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="c3ddc810-6"><a href="#c3ddc810-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">DEP</th>
<th data-quarto-table-cell-role="th">COM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>62</td>
<td>890</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>02</td>
<td>798</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>80</td>
<td>772</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>57</td>
<td>725</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>76</td>
<td>708</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">96</td>
<td>971</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99</td>
<td>974</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>973</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">100</td>
<td>976</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>75</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>101 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</section>
<section id="illustration-2-aggregates-by-group" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="illustration-2-aggregates-by-group"><span class="header-section-number">3.3</span> Illustration 2: aggregates by group</h2>
<p>To illustrate aggregates by group, we can use the Insee <code>filosofi</code> dataset and count the population using the variable <code>NBPERSMENFISC16</code>.</p>
<p>To calculate the total for the whole of France, we can do it in two ways:</p>
<div id="287172e0" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="287172e0"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="287172e0-1"><a href="#287172e0-1" aria-hidden="true" tabindex="-1"></a>filosofi[<span class="st">"NBPERSMENFISC16"</span>].<span class="bu">sum</span>() <span class="op">*</span> <span class="fl">1e-6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>66.9322415</code></pre>
</div>
</div>
<div id="5195626f" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="5195626f"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5195626f-1"><a href="#5195626f-1" aria-hidden="true" tabindex="-1"></a>filosofi.agg({<span class="st">"NBPERSMENFISC16"</span>: <span class="st">"sum"</span>}).div(<span class="fl">1e6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>NBPERSMENFISC16    66.932242
dtype: float64</code></pre>
</div>
</div>
<p>where the results are reported in millions of people. The logic is the same when doing group statistics, it’s just a matter of replacing <code>filosofi</code> with <code>filosofi.groupby('dep')</code> to create a partitioned version of our dataset by department:</p>
<div id="4c9fd63a" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="4c9fd63a"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="4c9fd63a" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="4c9fd63a-1" class="code-annotation-target"><a href="#4c9fd63a-1" aria-hidden="true" tabindex="-1"></a>filosofi.groupby(<span class="st">"dep"</span>)[<span class="st">"NBPERSMENFISC16"</span>].<span class="bu">sum</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="4c9fd63a" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="4c9fd63a" data-code-lines="1" data-code-annotation="1">With this approach, you need to pay attention to the order of operations: first, perform the <code>groupby</code> and then select the column of interest</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>dep
01     613088.0
02     514249.0
03     329435.0
04     156537.5
05     133992.5
        ...    
92    1583682.0
93    1586664.5
94    1345977.0
95    1226059.0
97    1191947.0
Name: NBPERSMENFISC16, Length: 97, dtype: float64</code></pre>
</div>
</div>
<div id="03f57184" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="03f57184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="03f57184-1"><a href="#03f57184-1" aria-hidden="true" tabindex="-1"></a>filosofi.groupby(<span class="st">"dep"</span>).agg({<span class="st">"NBPERSMENFISC16"</span>: <span class="st">"sum"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NBPERSMENFISC16</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">01</td>
<td>613088.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">02</td>
<td>514249.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">03</td>
<td>329435.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">04</td>
<td>156537.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">05</td>
<td>133992.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">92</td>
<td>1583682.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">93</td>
<td>1586664.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">94</td>
<td>1345977.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>1226059.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>1191947.0</td>
</tr>
</tbody>
</table>

<p>97 rows × 1 columns</p>
</div>
</div>
</div>
</div>
<p>The second approach is more practical because it directly gives a <code>Pandas</code> <code>DataFrame</code> and not an unnamed indexed series. From this, a few basic manipulations can suffice to have a shareable table on departmental demographics. However, this table would be somewhat rudimentary as we currently only have the department numbers. To get the names of the departments, we would need to use a second dataset and merge the common information between them (in this case, the department number). This is the subject of the next part.</p>
</section>
<section id="exercice-dapplication" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="exercice-dapplication"><span class="header-section-number">3.4</span> Exercice d’application</h2>
<p>This application exercise uses the <code>Ademe</code> dataset named <code>emissions</code> previously discussed.</p>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1: Group Aggregations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Calculate the total emissions of the “Residential” sector by department and compare the value to the most polluting department in this sector. Draw insights from the reality that this statistic reflects.</p></li>
<li><p>Calculate the total emissions for each sector in each department. For each department, calculate the proportion of total emissions coming from each sector.</p></li>
</ol>
<details>
<summary>
Hint for this question
</summary>
<ul>
<li><em>“Group by”</em> = <code>groupby</code></li>
<li><em>“Total emissions”</em> = <code>agg({*** : "sum"})</code></li>
</ul>
</details>
</div>
</div>
</div>
<p>In question 1, the result should be as follows:</p>
<div id="778d0825" class="cell" data-execution_count="25">
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Résidentiel (% valeur max)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">59</td>
<td>59</td>
<td>3.498347e+06</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>75</td>
<td>1.934580e+06</td>
<td>0.552998</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>69</td>
<td>1.774653e+06</td>
<td>0.507283</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">62</td>
<td>62</td>
<td>1.738090e+06</td>
<td>0.496832</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">57</td>
<td>57</td>
<td>1.644192e+06</td>
<td>0.469991</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>This ranking may reflect demographics rather than the process we wish to measure. Without the addition of information on the population of each département to control for this factor, it is difficult to know whether there is a structural difference in behavior between the inhabitants of Nord (département 59) and Moselle (département 57).</p>
<p>At the end of question 2, let’s take the share of emissions from agriculture and the tertiary sector in departmental emissions:</p>
<div id="d37e8dce" class="cell" data-execution_count="27">
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Part Agriculture</th>
<th data-quarto-table-cell-role="th">Part Autres transports</th>
<th data-quarto-table-cell-role="th">Part Autres transports international</th>
<th data-quarto-table-cell-role="th">Part CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Part Déchets</th>
<th data-quarto-table-cell-role="th">Part Energie</th>
<th data-quarto-table-cell-role="th">Part Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Part Résidentiel</th>
<th data-quarto-table-cell-role="th">Part Routier</th>
<th data-quarto-table-cell-role="th">Part Tertiaire</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>1.430068e+06</td>
<td>5060.057601</td>
<td>0.000000</td>
<td>210196.604389</td>
<td>26550.858041</td>
<td>9752.578164</td>
<td>28626.245699</td>
<td>134197.515156</td>
<td>434767.868975</td>
<td>70733.245013</td>
<td>...</td>
<td>60.855172</td>
<td>0.215326</td>
<td>0.000000</td>
<td>8.944716</td>
<td>1.129846</td>
<td>0.415012</td>
<td>1.218163</td>
<td>5.710647</td>
<td>18.501132</td>
<td>3.009986</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>7.510594e+05</td>
<td>5697.938112</td>
<td>0.000000</td>
<td>70903.948092</td>
<td>26011.591018</td>
<td>6065.340741</td>
<td>17803.285591</td>
<td>61033.998303</td>
<td>253618.488432</td>
<td>43661.121359</td>
<td>...</td>
<td>60.772448</td>
<td>0.461052</td>
<td>0.000000</td>
<td>5.737238</td>
<td>2.104744</td>
<td>0.490781</td>
<td>1.440564</td>
<td>4.938605</td>
<td>20.521701</td>
<td>3.532867</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>1.539204e+06</td>
<td>8261.874450</td>
<td>18.804572</td>
<td>228415.892777</td>
<td>44814.875202</td>
<td>13138.432196</td>
<td>85214.659284</td>
<td>128315.601994</td>
<td>443832.903418</td>
<td>84364.615635</td>
<td>...</td>
<td>59.761414</td>
<td>0.320777</td>
<td>0.000730</td>
<td>8.868517</td>
<td>1.739990</td>
<td>0.510115</td>
<td>3.308560</td>
<td>4.982005</td>
<td>17.232336</td>
<td>3.275556</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>2.122331e+06</td>
<td>13796.608978</td>
<td>3124.844800</td>
<td>331420.983449</td>
<td>52412.681268</td>
<td>35405.484754</td>
<td>112897.690887</td>
<td>268862.654280</td>
<td>795413.985637</td>
<td>170211.845832</td>
<td>...</td>
<td>54.336847</td>
<td>0.353227</td>
<td>0.080004</td>
<td>8.485186</td>
<td>1.341893</td>
<td>0.906467</td>
<td>2.890457</td>
<td>6.883541</td>
<td>20.364540</td>
<td>4.357839</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>1.026604e+06</td>
<td>4599.824552</td>
<td>0.000000</td>
<td>201732.703762</td>
<td>50950.668326</td>
<td>16651.432346</td>
<td>53468.498055</td>
<td>158218.000190</td>
<td>446345.993580</td>
<td>105662.674213</td>
<td>...</td>
<td>49.732924</td>
<td>0.222835</td>
<td>0.000000</td>
<td>9.772766</td>
<td>2.468261</td>
<td>0.806664</td>
<td>2.590235</td>
<td>7.664734</td>
<td>21.622845</td>
<td>5.118737</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="94325e35" class="cell" data-execution_count="28">
<div class="cell-output cell-output-display" data-execution_count="26">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Part Agriculture</th>
<th data-quarto-table-cell-role="th">Part Autres transports</th>
<th data-quarto-table-cell-role="th">Part Autres transports international</th>
<th data-quarto-table-cell-role="th">Part CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Part Déchets</th>
<th data-quarto-table-cell-role="th">Part Energie</th>
<th data-quarto-table-cell-role="th">Part Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Part Résidentiel</th>
<th data-quarto-table-cell-role="th">Part Routier</th>
<th data-quarto-table-cell-role="th">Part Tertiaire</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>0.000000</td>
<td>42216.829025</td>
<td>1.837660e+02</td>
<td>1.186577e+06</td>
<td>27358.781206</td>
<td>147965.117571</td>
<td>434314.469384</td>
<td>1.934580e+06</td>
<td>1.625583e+06</td>
<td>1.331630e+06</td>
<td>...</td>
<td>0.000000</td>
<td>0.627255</td>
<td>0.002730</td>
<td>17.630092</td>
<td>0.406495</td>
<td>2.198457</td>
<td>6.453018</td>
<td>28.743870</td>
<td>24.152808</td>
<td>19.785275</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">94</td>
<td>2259.429643</td>
<td>218992.353559</td>
<td>3.146283e+05</td>
<td>6.914050e+05</td>
<td>213619.661516</td>
<td>76341.230740</td>
<td>467189.038927</td>
<td>1.336894e+06</td>
<td>1.169432e+06</td>
<td>7.636502e+05</td>
<td>...</td>
<td>0.043001</td>
<td>4.167781</td>
<td>5.987888</td>
<td>13.158562</td>
<td>4.065530</td>
<td>1.452898</td>
<td>8.891367</td>
<td>25.443275</td>
<td>22.256193</td>
<td>14.533505</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">92</td>
<td>91.408184</td>
<td>12340.794839</td>
<td>2.101194e+02</td>
<td>1.067889e+06</td>
<td>264497.880711</td>
<td>242842.018012</td>
<td>706597.424067</td>
<td>1.466794e+06</td>
<td>1.198420e+06</td>
<td>8.360132e+05</td>
<td>...</td>
<td>0.001577</td>
<td>0.212930</td>
<td>0.003625</td>
<td>18.425550</td>
<td>4.563695</td>
<td>4.190041</td>
<td>12.191761</td>
<td>25.308332</td>
<td>20.677765</td>
<td>14.424724</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">93</td>
<td>2018.470982</td>
<td>59617.086124</td>
<td>1.101400e+06</td>
<td>7.259516e+05</td>
<td>252166.943778</td>
<td>102837.663903</td>
<td>433216.360990</td>
<td>1.316452e+06</td>
<td>1.396911e+06</td>
<td>8.630178e+05</td>
<td>...</td>
<td>0.032277</td>
<td>0.953326</td>
<td>17.612287</td>
<td>11.608558</td>
<td>4.032355</td>
<td>1.644458</td>
<td>6.927483</td>
<td>21.051146</td>
<td>22.337751</td>
<td>13.800359</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>151715.557862</td>
<td>21772.374976</td>
<td>2.854770e+04</td>
<td>5.795888e+05</td>
<td>233522.964403</td>
<td>47044.063669</td>
<td>139710.930613</td>
<td>5.938382e+05</td>
<td>1.944266e+06</td>
<td>5.610540e+05</td>
<td>...</td>
<td>3.527399</td>
<td>0.506209</td>
<td>0.663736</td>
<td>13.475487</td>
<td>5.429428</td>
<td>1.093778</td>
<td>3.248291</td>
<td>13.806786</td>
<td>45.204334</td>
<td>13.044551</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<p>These results are quite logical; rural departments have a larger share of their emissions from agriculture, while urban departments have higher emissions from the tertiary sector, which is related to the higher density of these areas.</p>
<p>With these statistics, we progress in understanding our dataset and, consequently, the nature of CO2 emissions in France. Descriptive statistics by group help us better grasp the spatial heterogeneity of our phenomenon.</p>
<p>However, we remain limited in our ability to interpret the obtained statistics without using additional information. To give meaning and value to a statistic, it is generally necessary to associate it with additional knowledge; otherwise, it remains detached.</p>
<p>In the rest of this chapter, we will consider a primary approach which is the merging of complementary data. This process is called data enrichment. These data can be observations at the same level as the original source. For example, one of the most common merges is associating a customer database with a purchase database to relate purchasing behavior to characteristics that may explain it. Data merges can also occur at different conceptual levels, generally at a more aggregated level to contextualize finer data and compare an observation to measures within a similar group. For instance, we can associate individual travel times and modes with those of the same age group or people living in the same municipality to compare the differences between certain individuals and a similar sociodemographic group.</p>
</section>
</section>
<section id="restructuring-datasets" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Restructuring datasets</h1>
<section id="principle-1" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="principle-1"><span class="header-section-number">4.1</span> Principle</h2>
<p>When we have multiple pieces of information for the same individual or group, we generally find two types of data structures:</p>
<ul>
<li><strong>Wide</strong> format: the data contains repeated observations for the same individual (or group) in different columns.</li>
<li><strong>Long</strong> format: the data contains repeated observations for the same individual in different rows, with a column distinguishing the observation levels.</li>
</ul>
<p>An example of the distinction between the two can be taken from Hadley Wickham’s reference book, <a href="https://r4ds.hadley.nz/"><em>R for Data Science</em></a>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://d33wubrfki0l68.cloudfront.net/3aea19108d39606bbe49981acda07696c0c7fcd8/2de65/images/tidy-9.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2" title="Wide and Long Data Formats (Source: R for Data Science)"><img src="https://d33wubrfki0l68.cloudfront.net/3aea19108d39606bbe49981acda07696c0c7fcd8/2de65/images/tidy-9.png" class="img-fluid figure-img" alt="Wide and Long Data Formats (Source: R for Data Science)"></a></p>
<figcaption>Wide and Long Data Formats (Source: <a href="https://r4ds.hadley.nz/"><em>R for Data Science</em></a>)</figcaption>
</figure>
</div>
<p>The following cheat sheet will help remember the functions to apply if needed:</p>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/reshape.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://minio.lab.sspcloud.fr/lgaliana/generative-art/pythonds/reshape.png" class="img-fluid" data-fig-width="60%"></a></p>
<p>Switching from a <em>wide</em> format to a <em>long</em> format (or vice versa) can be extremely practical because certain functions are more suitable for one form of data than the other.</p>
<p>Generally, with <code>Python</code> as with <code>R</code>, <strong>long formats are often preferable</strong>. Wide formats are rather designed for spreadsheets like <code>Excel</code>, where we have a limited number of rows to create pivot tables from.</p>
</section>
<section id="application" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="application"><span class="header-section-number">4.2</span> Application</h2>
<p>The ADEME data, and the Insee data as well, are in the <em>wide</em> format. The next exercise illustrates the benefit of converting from <em>long</em> to <em>wide</em> before creating a plot with the <code>plot</code> method seen in the previous chapter.</p>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice 2: Restructuring Data: Wide to Long
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Create a copy of the ADEME data by doing <code>df_wide = emissions.copy()</code></p></li>
<li><p>Restructure the data into the <em>long</em> format to have emission data by sector while keeping the commune as the level of analysis (pay attention to other identifying variables).</p></li>
<li><p>Sum the emissions by sector and represent it graphically.</p></li>
<li><p>For each department, identify the most polluting sector.</p></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="joining-data" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Joining data</h1>
<section id="principle-2" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="principle-2"><span class="header-section-number">5.1</span> Principle</h2>
<p>Here we will focus on the most favorable case, which is the situation where information allows for an exact match between two databases[^fuzzy]. It is a daily necessity for data scientists to merge information present in multiple files. For example, in business databases, customer information (address, age, etc.) will be in one file, sales in another, and product characteristics in a third file. To have a complete base that compares all this information, it will be necessary to join these three files based on common information.</p>
<p>This practice stems from the fact that many information systems take the form of a star schema:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.databricks.com/wp-content/uploads/2022/04/star-schema-erd.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4" title="Illustration of the star schema (Source: Databricks)"><img src="https://www.databricks.com/wp-content/uploads/2022/04/star-schema-erd.png" class="img-fluid figure-img" data-fig-width="80%" alt="Illustration of the star schema (Source: Databricks)"></a></p>
<figcaption>Illustration of the star schema (Source: <a href="https://www.databricks.com/wp-content/uploads/2022/04/star-schema-erd.png">Databricks</a>)</figcaption>
</figure>
</div>
<p>This structuring of information is closely related to the model of relational tables from the 1980s. Today, there are more flexible data models where information is stacked in a data lake without an a priori structure. Nevertheless, this star schema model retains relevance because it allows sharing information only with those who need it, leaving it to those who need to link data to do so.</p>
<p>Since the logic of the star schema historically comes from relational databases, it is natural that it is an approach intrinsically linked to the philosophy of SQL, even in the vocabulary. The term “data join” is often used, inherited from the SQL <code>JOIN</code> term, and the way to describe joins (left join, right join…) comes directly from the associated SQL instructions.</p>
<p>We generally speak of left and right bases to illustrate the joins:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/join_initial.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5" title="Joins"><img src="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/join_initial.png" class="img-fluid figure-img" data-fig-width="50%" alt="Joins"></a></p>
<figcaption>Joins</figcaption>
</figure>
</div>
</section>
<section id="implementation-with-pandas" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="implementation-with-pandas"><span class="header-section-number">5.2</span> Implementation with <code>Pandas</code></h2>
<p>In <code>Pandas</code>, the most practical method to join datasets based on common characteristics is <code>merge</code>. Its main arguments allow for controlling the join behavior. We will explore them visually.</p>
<p>In our case, for constructing statistics on carbon emissions, the left base will be the <code>emissions</code> DataFrame, and the right base will be the <code>filosofi</code> DataFrame:</p>
<div id="8713c399" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="8713c399"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8713c399-1"><a href="#8713c399-1" aria-hidden="true" tabindex="-1"></a>emissions.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
<td>01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
<td>01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="fa607573" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="fa607573"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fa607573-1"><a href="#fa607573-1" aria-hidden="true" tabindex="-1"></a>filosofi.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CODGEO</th>
<th data-quarto-table-cell-role="th">LIBGEO</th>
<th data-quarto-table-cell-role="th">NBMENFISC16</th>
<th data-quarto-table-cell-role="th">NBPERSMENFISC16</th>
<th data-quarto-table-cell-role="th">MED16</th>
<th data-quarto-table-cell-role="th">PIMP16</th>
<th data-quarto-table-cell-role="th">TP6016</th>
<th data-quarto-table-cell-role="th">TP60AGE116</th>
<th data-quarto-table-cell-role="th">TP60AGE216</th>
<th data-quarto-table-cell-role="th">TP60AGE316</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
<th data-quarto-table-cell-role="th">dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01001</td>
<td>L'Abergement-Clémenciat</td>
<td>313.0</td>
<td>795.5</td>
<td>22679.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01002</td>
<td>L'Abergement-de-Varey</td>
<td>101.0</td>
<td>248.0</td>
<td>24382.083333</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>01</td>
</tr>
</tbody>
</table>

<p>2 rows × 30 columns</p>
</div>
</div>
</div>
</div>
<p>We refer to join keys as the variable(s) necessary for merging data. These are the variables common to both datasets. They do not need to have the same name, but they must share common values; otherwise, the intersection between these two datasets is the empty set.</p>
<p>We can manipulate two dimensions in the join (this will be clearer later with graphical examples):</p>
<ul>
<li>There are mainly three types of merges: left join, right join, or a combination of the two, depending on the type of pivot we want to implement.</li>
<li>Then, there are two ways to merge the values once we have chosen a pivot: inner or outer join. In the first case, we only keep the observations where the join keys are present in both datasets; in the second, we keep all observations of the pivot key variables, even if the second dataset does not have such observations, resulting in missing values.</li>
</ul>
<p>In the examples below, we will use the commune codes and departments as join keys. Using the department is not necessary since it is directly deduced from the commune code, but it helps illustrate the principle of joins on multiple variables. Note that the name of the commune is intentionally set aside for joins, even though it is common information to both datasets. However, as it is a textual field, which may follow different formatting norms in the two datasets, it is not reliable for an exact join.</p>
<p>To illustrate the principle of the left or right pivot, we will create two identifier variables for the row in our left and right datasets. This will allow us to easily find rows present in one dataset but not in the other.</p>
<div id="61be3942" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="61be3942"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="61be3942-1"><a href="#61be3942-1" aria-hidden="true" tabindex="-1"></a>emissions <span class="op">=</span> emissions.reset_index(names<span class="op">=</span>[<span class="st">"id_left"</span>])</span>
<span id="61be3942-2"><a href="#61be3942-2" aria-hidden="true" tabindex="-1"></a>filosofi <span class="op">=</span> filosofi.reset_index(names<span class="op">=</span>[<span class="st">"id_right"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="left-join" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="left-join"><span class="header-section-number">5.2.1</span> <em>Left join</em></h3>
<p>Let’s start with the left join. As its name indicates, we will take the left variable as the pivot:</p>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/left_join.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/left_join.png" class="img-fluid"></a></p>
<div id="f5b8dc69" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="f5b8dc69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="f5b8dc69-1"><a href="#f5b8dc69-1" aria-hidden="true" tabindex="-1"></a>left_merged <span class="op">=</span> emissions.merge(</span>
<span id="f5b8dc69-2"><a href="#f5b8dc69-2" aria-hidden="true" tabindex="-1"></a>    filosofi, left_on<span class="op">=</span>[<span class="st">"INSEE commune"</span>, <span class="st">"dep"</span>], right_on<span class="op">=</span>[<span class="st">"CODGEO"</span>, <span class="st">"dep"</span>], how<span class="op">=</span><span class="st">"left"</span></span>
<span id="f5b8dc69-3"><a href="#f5b8dc69-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="f5b8dc69-4"><a href="#f5b8dc69-4" aria-hidden="true" tabindex="-1"></a>left_merged.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPEN16</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>...</td>
<td>27.0</td>
<td>8.8</td>
<td>6.9</td>
<td>2.8</td>
<td>2.1</td>
<td>2.0</td>
<td>-15.7</td>
<td>10457.083333</td>
<td>33880.555556</td>
<td>3.239962</td>
</tr>
</tbody>
</table>

<p>3 rows × 44 columns</p>
</div>
</div>
</div>
</div>
<p>It is recommended to always explicitly specify the join keys using the <code>left_on</code>, <code>right_on</code>, or <code>on</code> arguments if the variable names are common between the two datasets.
If there are common variable names between the datasets that are not defined as join keys, they will not be used for the join but will be retained with a suffix that defaults to <code>_x</code> and <code>_y</code> (configurable using the <code>suffixes</code> argument).</p>
<p>The <code>Pandas</code> syntax is directly inspired by SQL, so we have a fairly transparent translation of the above instruction into SQL:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> emissions</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> filosofi</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> emissions.`INSEE commune` <span class="op">=</span> filosofi.CODGEO</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> emissions.dep <span class="op">=</span> filosofi.dep;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By performing a left join, we should, in principle, have as many rows as in the left dataset:</p>
<div id="d5291a53" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="d5291a53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="d5291a53-1"><a href="#d5291a53-1" aria-hidden="true" tabindex="-1"></a>left_merged.shape[<span class="dv">0</span>] <span class="op">==</span> emissions.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>True</code></pre>
</div>
</div>
<p>Otherwise, it indicates that there is a duplicate key on the right. Thanks to our <code>id_right</code> variable, we can identify the commune codes on the right that do not exist on the left:</p>
<div id="b875d12e" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="b875d12e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b875d12e-1"><a href="#b875d12e-1" aria-hidden="true" tabindex="-1"></a>left_merged.loc[left_merged[<span class="st">"id_right"</span>].isna()].tail(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPEN16</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">35348</td>
<td>35348</td>
<td>91182</td>
<td>COURCOURONNES</td>
<td>24.548795</td>
<td>103.360309</td>
<td>NaN</td>
<td>9623.065698</td>
<td>111.241872</td>
<td>1276.170296</td>
<td>3745.877636</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35360</td>
<td>35360</td>
<td>91222</td>
<td>ESTOUCHES</td>
<td>1790.002871</td>
<td>NaN</td>
<td>NaN</td>
<td>113.797978</td>
<td>30.548162</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35687</td>
<td>35687</td>
<td>95259</td>
<td>GADANCOURT</td>
<td>312.298700</td>
<td>NaN</td>
<td>NaN</td>
<td>142.113291</td>
<td>11.372909</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>3 rows × 44 columns</p>
</div>
</div>
</div>
</div>
<p>This is because we are using data that are not from the same reference year of the official geographical code (2016 vs 2018). During this interval, there were geographical changes, notably commune mergers. For example, the commune of Courcouronnes seen above can be found merged with Evry in the filosofi dataset (right base):</p>
<div id="6d54966c" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="6d54966c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6d54966c-1"><a href="#6d54966c-1" aria-hidden="true" tabindex="-1"></a>filosofi.loc[filosofi[<span class="st">"LIBGEO"</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.contains(<span class="st">"courcouronnes"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_right</th>
<th data-quarto-table-cell-role="th">CODGEO</th>
<th data-quarto-table-cell-role="th">LIBGEO</th>
<th data-quarto-table-cell-role="th">NBMENFISC16</th>
<th data-quarto-table-cell-role="th">NBPERSMENFISC16</th>
<th data-quarto-table-cell-role="th">MED16</th>
<th data-quarto-table-cell-role="th">PIMP16</th>
<th data-quarto-table-cell-role="th">TP6016</th>
<th data-quarto-table-cell-role="th">TP60AGE116</th>
<th data-quarto-table-cell-role="th">TP60AGE216</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
<th data-quarto-table-cell-role="th">dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">34441</td>
<td>34441</td>
<td>91228</td>
<td>Évry-Courcouronnes</td>
<td>23761.0</td>
<td>65184.5</td>
<td>17107.0</td>
<td>47.0</td>
<td>26.0</td>
<td>30.0</td>
<td>26.0</td>
<td>...</td>
<td>4.0</td>
<td>10.5</td>
<td>4.4</td>
<td>3.1</td>
<td>2.9</td>
<td>-15.0</td>
<td>9139.090909</td>
<td>30888.0</td>
<td>3.379767</td>
<td>91</td>
</tr>
</tbody>
</table>

<p>1 rows × 31 columns</p>
</div>
</div>
</div>
</div>
<p>In a public statistics construction exercise, we could not afford this discrepancy in years.</p>
</section>
<section id="right-join__" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="right-join__"><span class="header-section-number">5.2.2</span> _Right join__</h3>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/right_join.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/right_join.png" class="img-fluid"></a></p>
<p>The principle is the same, but this time it is the right base that is taken as the pivot:</p>
<div id="4e6299df" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="4e6299df"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="4e6299df-1"><a href="#4e6299df-1" aria-hidden="true" tabindex="-1"></a>right_merged <span class="op">=</span> emissions.merge(</span>
<span id="4e6299df-2"><a href="#4e6299df-2" aria-hidden="true" tabindex="-1"></a>    filosofi, left_on<span class="op">=</span>[<span class="st">"INSEE commune"</span>, <span class="st">"dep"</span>], right_on<span class="op">=</span>[<span class="st">"CODGEO"</span>, <span class="st">"dep"</span>], how<span class="op">=</span><span class="st">"right"</span></span>
<span id="4e6299df-3"><a href="#4e6299df-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="4e6299df-4"><a href="#4e6299df-4" aria-hidden="true" tabindex="-1"></a>right_merged.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPEN16</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.0</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>...</td>
<td>27.0</td>
<td>8.8</td>
<td>6.9</td>
<td>2.8</td>
<td>2.1</td>
<td>2.0</td>
<td>-15.7</td>
<td>10457.083333</td>
<td>33880.555556</td>
<td>3.239962</td>
</tr>
</tbody>
</table>

<p>3 rows × 44 columns</p>
</div>
</div>
</div>
</div>
<p>The equivalent instruction in SQL would be:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> filosofi</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> emissions</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> filosofi.CODGEO <span class="op">=</span> emissions.`INSEE commune`</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> filosofi.dep <span class="op">=</span> emissions.dep;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can, as before, check the consistency of the dimensions:</p>
<div id="97646fd3" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="97646fd3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="97646fd3-1"><a href="#97646fd3-1" aria-hidden="true" tabindex="-1"></a>right_merged.shape[<span class="dv">0</span>] <span class="op">==</span> filosofi.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>True</code></pre>
</div>
</div>
<p>To check the number of rows in the Filosofi data that we do not have in our greenhouse gas emissions dataset, we can do:</p>
<div id="6e89bbd4" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="6e89bbd4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6e89bbd4-1"><a href="#6e89bbd4-1" aria-hidden="true" tabindex="-1"></a>right_merged[<span class="st">"id_left"</span>].isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>61</code></pre>
</div>
</div>
<p>It’s a small number. What are these observations?</p>
<div id="6de95594" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="6de95594"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6de95594-1"><a href="#6de95594-1" aria-hidden="true" tabindex="-1"></a>right_merged.loc[</span>
<span id="6de95594-2"><a href="#6de95594-2" aria-hidden="true" tabindex="-1"></a>    right_merged[<span class="st">"id_left"</span>].isna(),</span>
<span id="6de95594-3"><a href="#6de95594-3" aria-hidden="true" tabindex="-1"></a>    filosofi.columns.tolist() <span class="op">+</span> emissions.columns.tolist(),</span>
<span id="6de95594-4"><a href="#6de95594-4" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_right</th>
<th data-quarto-table-cell-role="th">CODGEO</th>
<th data-quarto-table-cell-role="th">LIBGEO</th>
<th data-quarto-table-cell-role="th">NBMENFISC16</th>
<th data-quarto-table-cell-role="th">NBPERSMENFISC16</th>
<th data-quarto-table-cell-role="th">MED16</th>
<th data-quarto-table-cell-role="th">PIMP16</th>
<th data-quarto-table-cell-role="th">TP6016</th>
<th data-quarto-table-cell-role="th">TP60AGE116</th>
<th data-quarto-table-cell-role="th">TP60AGE216</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4346</td>
<td>4346</td>
<td>13055</td>
<td>Marseille</td>
<td>362971.0</td>
<td>815045.5</td>
<td>18248.000000</td>
<td>47.0</td>
<td>26.0</td>
<td>34.0</td>
<td>30.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27115</td>
<td>27115</td>
<td>69123</td>
<td>Lyon</td>
<td>225617.0</td>
<td>459305.5</td>
<td>22806.000000</td>
<td>60.0</td>
<td>15.0</td>
<td>21.0</td>
<td>13.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>69</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29288</td>
<td>29288</td>
<td>75056</td>
<td>Paris</td>
<td>1027657.0</td>
<td>2074629.5</td>
<td>26808.000000</td>
<td>69.0</td>
<td>16.0</td>
<td>17.0</td>
<td>13.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>75</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34874</td>
<td>34874</td>
<td>97201</td>
<td>L'Ajoupa-Bouillon</td>
<td>688.0</td>
<td>1634.0</td>
<td>14116.833333</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34875</td>
<td>34875</td>
<td>97202</td>
<td>Les Anses-d'Arlet</td>
<td>1390.0</td>
<td>3274.5</td>
<td>14645.277778</td>
<td>25.0</td>
<td>37.0</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34927</td>
<td>34927</td>
<td>97420</td>
<td>Sainte-Suzanne</td>
<td>7827.0</td>
<td>23118.0</td>
<td>15110.666667</td>
<td>26.0</td>
<td>38.0</td>
<td>53.0</td>
<td>39.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34928</td>
<td>34928</td>
<td>97421</td>
<td>Salazie</td>
<td>2358.0</td>
<td>6967.0</td>
<td>11280.937500</td>
<td>12.0</td>
<td>58.0</td>
<td>NaN</td>
<td>63.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34929</td>
<td>34929</td>
<td>97422</td>
<td>Le Tampon</td>
<td>27916.0</td>
<td>73468.5</td>
<td>14243.809524</td>
<td>25.0</td>
<td>41.0</td>
<td>56.0</td>
<td>45.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34930</td>
<td>34930</td>
<td>97423</td>
<td>Les Trois-Bassins</td>
<td>2386.0</td>
<td>7105.0</td>
<td>14031.785714</td>
<td>23.0</td>
<td>42.0</td>
<td>NaN</td>
<td>42.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34931</td>
<td>34931</td>
<td>97424</td>
<td>Cilaos</td>
<td>2038.0</td>
<td>5603.0</td>
<td>12034.375000</td>
<td>15.0</td>
<td>53.0</td>
<td>NaN</td>
<td>60.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>97</td>
</tr>
</tbody>
</table>

<p>61 rows × 45 columns</p>
</div>
</div>
</div>
</div>
<p>It is surprising to see that Paris, Lyon, and Marseille are present in the communal statistics dataset but not in the emissions dataset. To understand why, let’s search in our emissions data for observations related to Marseille:</p>
<div id="49b22184" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="49b22184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="49b22184-1"><a href="#49b22184-1" aria-hidden="true" tabindex="-1"></a>emissions.loc[emissions[<span class="st">"Commune"</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.contains(<span class="st">"MARSEILLE"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>This is because the Ademe emissions dataset provides information on districts in the three largest cities, whereas the Insee dataset does not have this breakdown.</p>
</section>
<section id="inner-join" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="inner-join"><span class="header-section-number">5.2.3</span> <em>Inner join</em></h3>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/inner.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/inner.png" class="img-fluid"></a></p>
<p>This is the dataset where the keys are found at the intersection of the two tables.</p>
<div id="8b4d1d0c" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="8b4d1d0c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8b4d1d0c-1"><a href="#8b4d1d0c-1" aria-hidden="true" tabindex="-1"></a>inner_merged <span class="op">=</span> emissions.merge(</span>
<span id="8b4d1d0c-2"><a href="#8b4d1d0c-2" aria-hidden="true" tabindex="-1"></a>    filosofi, left_on<span class="op">=</span>[<span class="st">"INSEE commune"</span>, <span class="st">"dep"</span>], right_on<span class="op">=</span>[<span class="st">"CODGEO"</span>, <span class="st">"dep"</span>], how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="8b4d1d0c-3"><a href="#8b4d1d0c-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="8b4d1d0c-4"><a href="#8b4d1d0c-4" aria-hidden="true" tabindex="-1"></a>inner_merged.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPEN16</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>...</td>
<td>27.0</td>
<td>8.8</td>
<td>6.9</td>
<td>2.8</td>
<td>2.1</td>
<td>2.0</td>
<td>-15.7</td>
<td>10457.083333</td>
<td>33880.555556</td>
<td>3.239962</td>
</tr>
</tbody>
</table>

<p>3 rows × 44 columns</p>
</div>
</div>
</div>
</div>
<p>In SQL, this would be:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> emissions</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> filosofi</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> emissions.`INSEE commune` <span class="op">=</span> filosofi.CODGEO</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> emissions.dep <span class="op">=</span> filosofi.dep;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The number of rows in our dataset can be compared to the left and right datasets:</p>
<div id="fe3915ba" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="fe3915ba"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fe3915ba-1"><a href="#fe3915ba-1" aria-hidden="true" tabindex="-1"></a>inner_merged.shape[<span class="dv">0</span>] <span class="op">==</span> (left_merged.shape[<span class="dv">0</span>] <span class="op">-</span> left_merged[<span class="st">"id_right"</span>].isna().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>True</code></pre>
</div>
</div>
<div id="88b41f41" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="88b41f41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="88b41f41-1"><a href="#88b41f41-1" aria-hidden="true" tabindex="-1"></a>inner_merged.shape[<span class="dv">0</span>] <span class="op">==</span> (right_merged.shape[<span class="dv">0</span>] <span class="op">-</span> right_merged[<span class="st">"id_left"</span>].isna().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="full-join" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="full-join"><span class="header-section-number">5.2.4</span> <em>Full join</em></h3>
<p>The full join is a pivot to the left and then to the right for the information that was not found.</p>
<p><a href="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/full_join.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="https://minio.lab.sspcloud.fr/lgaliana/python-ENSAE/inputs/merge_pandas/full_join.png" class="img-fluid"></a></p>
<div id="9bb6b449" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="9bb6b449"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="9bb6b449-1"><a href="#9bb6b449-1" aria-hidden="true" tabindex="-1"></a>full_merged <span class="op">=</span> emissions.merge(</span>
<span id="9bb6b449-2"><a href="#9bb6b449-2" aria-hidden="true" tabindex="-1"></a>    filosofi, left_on<span class="op">=</span>[<span class="st">"INSEE commune"</span>, <span class="st">"dep"</span>], right_on<span class="op">=</span>[<span class="st">"CODGEO"</span>, <span class="st">"dep"</span>], how<span class="op">=</span><span class="st">"outer"</span></span>
<span id="9bb6b449-3"><a href="#9bb6b449-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="9bb6b449-4"><a href="#9bb6b449-4" aria-hidden="true" tabindex="-1"></a>full_merged.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPEN16</th>
<th data-quarto-table-cell-role="th">PPAT16</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.0</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>...</td>
<td>27.0</td>
<td>8.8</td>
<td>6.9</td>
<td>2.8</td>
<td>2.1</td>
<td>2.0</td>
<td>-15.7</td>
<td>10457.083333</td>
<td>33880.555556</td>
<td>3.239962</td>
</tr>
</tbody>
</table>

<p>3 rows × 44 columns</p>
</div>
</div>
</div>
</div>
<p>As usual, the translation to SQL is almost immediate:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> emissions</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FULL</span> <span class="kw">OUTER</span> <span class="kw">JOIN</span> filosofi</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> emissions.`INSEE commune` <span class="op">=</span> filosofi.CODGEO</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> emissions.dep <span class="op">=</span> filosofi.dep;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This time, we have a combination of our three initial datasets:</p>
<ul>
<li>The inner join;</li>
<li>The left join on observations without the right key;</li>
<li>The right join on observations without the left key;</li>
</ul>
<div id="a54a42a4" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="a54a42a4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="a54a42a4-1"><a href="#a54a42a4-1" aria-hidden="true" tabindex="-1"></a>(full_merged[<span class="st">"id_left"</span>].isna().<span class="bu">sum</span>() <span class="op">+</span> full_merged[<span class="st">"id_right"</span>].isna().<span class="bu">sum</span>()) <span class="op">==</span> (</span>
<span id="a54a42a4-2"><a href="#a54a42a4-2" aria-hidden="true" tabindex="-1"></a>    left_merged[<span class="st">"id_right"</span>].isna().<span class="bu">sum</span>() <span class="op">+</span> right_merged[<span class="st">"id_left"</span>].isna().<span class="bu">sum</span>()</span>
<span id="a54a42a4-3"><a href="#a54a42a4-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="in-summary" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="in-summary"><span class="header-section-number">5.2.5</span> In summary</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://external-preview.redd.it/yOLzCR0qSzul2WpjQorxINB0xpU3_N9twmFVsgbGJwQ.jpg?auto=webp&amp;s=4feedc91302ba635b3028a21b98d047def5cdc2b" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="https://external-preview.redd.it/yOLzCR0qSzul2WpjQorxINB0xpU3_N9twmFVsgbGJwQ.jpg?auto=webp&amp;s=4feedc91302ba635b3028a21b98d047def5cdc2b" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</section>
</section>
<section id="examples-of-identifiers-in-french-data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="examples-of-identifiers-in-french-data"><span class="header-section-number">5.3</span> Examples of identifiers in French data</h2>
<section id="the-official-geographic-code-cog-the-identifier-for-geographic-data" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="the-official-geographic-code-cog-the-identifier-for-geographic-data"><span class="header-section-number">5.3.1</span> The Official Geographic Code (COG): The identifier for geographic data</h3>
<p>For geographic data, there are many identifiers depending on the study problem.
Among the main needs is the ability to match geographic data using a common administrative identifier. For example, associating two datasets at the municipal level.</p>
<p>For this, the reference identifier is the Insee code, derived from the <a href="https://www.insee.fr/fr/information/2560452">Official Geographic Code (COG)</a>, which we have been using since the last chapter and will extensively use throughout the different chapters of this course.
Given that the administrative geography is constantly evolving, the Insee code database is a living base. The Insee website and APIs provide access to the post-war historical data for long-term geographic analysis.</p>
<p>Postal codes cannot be considered as an identifier: they can group several municipalities or, conversely, one municipality can have several postal codes. It is a system managed by La Poste that was not designed for statistical analysis.</p>
<p>To illustrate the problem, from the data provided by La Poste, we can see that postal code 11420 corresponds to 11 municipalities:</p>
<div id="8036d4bc" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="8036d4bc"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8036d4bc-1"><a href="#8036d4bc-1" aria-hidden="true" tabindex="-1"></a>codes_postaux <span class="op">=</span> pd.read_csv(</span>
<span id="8036d4bc-2"><a href="#8036d4bc-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://datanova.laposte.fr/data-fair/api/v1/datasets/laposte-hexasmal/raw"</span>,</span>
<span id="8036d4bc-3"><a href="#8036d4bc-3" aria-hidden="true" tabindex="-1"></a>    sep<span class="op">=</span><span class="st">";"</span>,</span>
<span id="8036d4bc-4"><a href="#8036d4bc-4" aria-hidden="true" tabindex="-1"></a>    encoding<span class="op">=</span><span class="st">"latin1"</span>,</span>
<span id="8036d4bc-5"><a href="#8036d4bc-5" aria-hidden="true" tabindex="-1"></a>    dtype<span class="op">=</span>{<span class="st">"Code_postal"</span>: <span class="st">"str"</span>, <span class="st">"#Code_commune_INSEE"</span>: <span class="st">"str"</span>},</span>
<span id="8036d4bc-6"><a href="#8036d4bc-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="8036d4bc-7"><a href="#8036d4bc-7" aria-hidden="true" tabindex="-1"></a>codes_postaux.loc[codes_postaux[<span class="st">"Code_postal"</span>] <span class="op">==</span> <span class="st">"11420"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">#Code_commune_INSEE</th>
<th data-quarto-table-cell-role="th">Nom_de_la_commune</th>
<th data-quarto-table-cell-role="th">Code_postal</th>
<th data-quarto-table-cell-role="th">Libellé_d_acheminement</th>
<th data-quarto-table-cell-role="th">Ligne_5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3921</td>
<td>11033</td>
<td>BELPECH</td>
<td>11420</td>
<td>BELPECH</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3944</td>
<td>11057</td>
<td>CAHUZAC</td>
<td>11420</td>
<td>CAHUZAC</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4080</td>
<td>11184</td>
<td>LAFAGE</td>
<td>11420</td>
<td>LAFAGE</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4124</td>
<td>11226</td>
<td>MAYREVILLE</td>
<td>11420</td>
<td>MAYREVILLE</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4134</td>
<td>11236</td>
<td>MOLANDIER</td>
<td>11420</td>
<td>MOLANDIER</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4176</td>
<td>11277</td>
<td>PECHARIC ET LE PY</td>
<td>11420</td>
<td>PECHARIC ET LE PY</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4177</td>
<td>11278</td>
<td>PECH LUNA</td>
<td>11420</td>
<td>PECH LUNA</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4182</td>
<td>11283</td>
<td>PEYREFITTE SUR L HERS</td>
<td>11420</td>
<td>PEYREFITTE SUR L HERS</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4189</td>
<td>11290</td>
<td>PLAIGNE</td>
<td>11420</td>
<td>PLAIGNE</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4264</td>
<td>11365</td>
<td>ST SERNIN</td>
<td>11420</td>
<td>ST SERNIN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4317</td>
<td>11419</td>
<td>VILLAUTOU</td>
<td>11420</td>
<td>VILLAUTOU</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Anticipating on the skills developed in the upcoming chapters, we can represent the problem cartographically by taking the example of the Aude department. The code to produce the map of commune codes is given as is, not developed, as it uses concepts and libraries that will be presented in the next chapter:</p>
<div id="36732e96" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="36732e96"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="36732e96-1"><a href="#36732e96-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cartiflette <span class="im">import</span> carti_download</span>
<span id="36732e96-2"><a href="#36732e96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="36732e96-3"><a href="#36732e96-3" aria-hidden="true" tabindex="-1"></a>shp_communes <span class="op">=</span> carti_download(</span>
<span id="36732e96-4"><a href="#36732e96-4" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>[<span class="st">"11"</span>],</span>
<span id="36732e96-5"><a href="#36732e96-5" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span><span class="dv">4326</span>,</span>
<span id="36732e96-6"><a href="#36732e96-6" aria-hidden="true" tabindex="-1"></a>    borders<span class="op">=</span><span class="st">"COMMUNE"</span>,</span>
<span id="36732e96-7"><a href="#36732e96-7" aria-hidden="true" tabindex="-1"></a>    simplification<span class="op">=</span><span class="dv">50</span>,</span>
<span id="36732e96-8"><a href="#36732e96-8" aria-hidden="true" tabindex="-1"></a>    filter_by<span class="op">=</span><span class="st">"DEPARTEMENT"</span>,</span>
<span id="36732e96-9"><a href="#36732e96-9" aria-hidden="true" tabindex="-1"></a>    source<span class="op">=</span><span class="st">"EXPRESS-COG-CARTO-TERRITOIRE"</span>,</span>
<span id="36732e96-10"><a href="#36732e96-10" aria-hidden="true" tabindex="-1"></a>    year<span class="op">=</span><span class="dv">2022</span>,</span>
<a class="code-annotation-anchor" data-target-cell="36732e96" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="36732e96-11" class="code-annotation-target"><a href="#36732e96-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="36732e96-12"><a href="#36732e96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="36732e96-13"><a href="#36732e96-13" aria-hidden="true" tabindex="-1"></a>codes_postaux11 <span class="op">=</span> shp_communes.merge(</span>
<span id="36732e96-14"><a href="#36732e96-14" aria-hidden="true" tabindex="-1"></a>    codes_postaux, left_on<span class="op">=</span><span class="st">"INSEE_COM"</span>, right_on<span class="op">=</span><span class="st">"#Code_commune_INSEE"</span></span>
<a class="code-annotation-anchor" data-target-cell="36732e96" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="36732e96-15" class="code-annotation-target"><a href="#36732e96-15" aria-hidden="true" tabindex="-1"></a>)</span>
<a class="code-annotation-anchor" data-target-cell="36732e96" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="36732e96-16" class="code-annotation-target"><a href="#36732e96-16" aria-hidden="true" tabindex="-1"></a>codes_postaux11 <span class="op">=</span> codes_postaux11.dissolve(by<span class="op">=</span><span class="st">"Code_postal"</span>)</span>
<span id="36732e96-17"><a href="#36732e96-17" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="36732e96" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="36732e96-18" class="code-annotation-target"><a href="#36732e96-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Map</span></span>
<span id="36732e96-19"><a href="#36732e96-19" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> shp_communes.plot(color<span class="op">=</span><span class="st">"white"</span>, edgecolor<span class="op">=</span><span class="st">"blue"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="36732e96-20"><a href="#36732e96-20" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> codes_postaux11.plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">"none"</span>, edgecolor<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="36732e96-21"><a href="#36732e96-21" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="36732e96" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="36732e96" data-code-lines="11" data-code-annotation="1">Downloading the official contours of Aude produced by IGN using the <a href="https://github.com/InseeFrLab/cartiflette"><code>cartiflette</code></a> library</span>
</dd>
<dt data-target-cell="36732e96" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="36732e96" data-code-lines="15" data-code-annotation="2">Joining using the commune code between the two data sources</span>
</dd>
<dt data-target-cell="36732e96" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="36732e96" data-code-lines="16" data-code-annotation="3">Aggregating the geometry at the postal code level</span>
</dd>
<dt data-target-cell="36732e96" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="36732e96" data-code-lines="18" data-code-annotation="4">Creating a map from our two layers</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="02_pandas_suite_files/figure-html/cell-53-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" data-glightbox="description: .lightbox-desc-11" title="Geography of postal codes and municipalities in Aude (11)"><img src="02_pandas_suite_files/figure-html/cell-53-output-1.png" width="536" height="389" alt="Geography of postal codes and municipalities in Aude (11)" class="figure-img"></a></p>
<figcaption>Geography of postal codes and municipalities in Aude (11)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sirene-the-identifier-in-business-data" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="sirene-the-identifier-in-business-data"><span class="header-section-number">5.3.2</span> Sirene: the identifier in business data</h3>
<p>To connect French business microdata, there is a unique identification number: the <a href="https://entreprendre.service-public.fr/vosdroits/F32135">Siren number</a>. It is an identification number in a legal business directory essential for all legal, fiscal, and other procedures. For companies that have multiple establishments—for example, in several cities—there is a derived identifier called the <a href="https://www.economie.gouv.fr/cedef/numero-siret">Siret</a>: the 9 digits of the Siren number are followed by 5 establishment identification digits. Moreover, public administrations are also concerned with the Siren number: being involved in market operations (purchasing equipment, renting goods, etc.), they also have a Siren identifier. As they are registered in legal directories whose information is public, the Siren numbers and the associated company names are available in open data, for example, on <a href="https://annuaire-entreprises.data.gouv.fr/">annuaire-entreprises.data.gouv.fr/</a> for occasional searches, or on <a href="https://www.data.gouv.fr/fr/datasets/base-sirene-des-entreprises-et-de-leurs-etablissements-siren-siret/">data.gouv.fr</a>.</p>
<p>This Sirene database is a treasure trove of information, sometimes amusing, about French companies. For example, the site <a href="https://tif.hair/">tif.hair/</a> cataloged the proportion of hair salons with puns in their names. When an entrepreneur declares the creation of a business, they receive a Siren number and an activity code (the <a href="https://entreprendre.service-public.fr/vosdroits/F33050">APE code</a>) related to the description of their business activity. This code allows the classification of a business activity in the <a href="https://www.insee.fr/fr/information/2406147">French Classification of Activities (NAF)</a>, which will be used by Insee for the publication of sectoral statistics. In the case of hairdressers, the code in the NAF is <a href="https://www.insee.fr/fr/metadonnees/nafr2/sousClasse/96.02A?champRecherche=false">96.02A</a>. From the open data available, it is possible, in a few lines of <code>Python</code>, to get the list of all hairdressers and then explore this data (the subject of the next optional exercise).</p>
<p>The following optional exercise suggests replicating, in a simplified manner, the survey done by <a href="https://tif.hair/">tif.hair/</a> on puns in hair salon names. It allows practicing some text manipulation methods, ahead of the chapter dedicated to <a href="../../content/manipulation/04b_regex_TP.html">regular expressions</a>.</p>
<p>Since the dataset of all companies is quite large (around 4GB in CSV after decompression), it is more practical to use a dataset in <code>Parquet</code> format, which is more optimized (more details on this format in the <a href="../../content/modern-ds/s3.html">advanced chapter</a> dedicated to it).</p>
<p>To read this type of file optimally, it is recommended to use the <code>DuckDB</code> library, which allows consuming only the necessary data instead of downloading the entire file to read only a part of it as would be the case with <code>Pandas</code> (see the end of this chapter, section “Beyond <code>Pandas</code>”). The following SQL query translates into natural language as: <em>“From the <code>Parquet</code> file, I only want a few columns of the file for hairdressers (APE: 96.02A) whose business name (<code>denominationUsuelleEtablissement</code>) is provided”</em>:</p>
<div id="c5b75c3c" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="c5b75c3c"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="c5b75c3c-1"><a href="#c5b75c3c-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="c5b75c3c-2"><a href="#c5b75c3c-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="c5b75c3c-3"><a href="#c5b75c3c-3" aria-hidden="true" tabindex="-1"></a>coiffeurs <span class="op">=</span> duckdb.sql(</span>
<span id="c5b75c3c-4"><a href="#c5b75c3c-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="c5b75c3c-5"><a href="#c5b75c3c-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="c5b75c3c-6"><a href="#c5b75c3c-6" aria-hidden="true" tabindex="-1"></a><span class="st">    siren, siret, dateDebut, enseigne1Etablissement, activitePrincipaleEtablissement, denominationUsuelleEtablissement</span></span>
<span id="c5b75c3c-7"><a href="#c5b75c3c-7" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="c5b75c3c-8"><a href="#c5b75c3c-8" aria-hidden="true" tabindex="-1"></a><span class="st">    read_parquet('https://minio.lab.sspcloud.fr/lgaliana/data/sirene2024.parquet')</span></span>
<span id="c5b75c3c-9"><a href="#c5b75c3c-9" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE</span></span>
<span id="c5b75c3c-10"><a href="#c5b75c3c-10" aria-hidden="true" tabindex="-1"></a><span class="st">    activitePrincipaleEtablissement == '96.02A'</span></span>
<span id="c5b75c3c-11"><a href="#c5b75c3c-11" aria-hidden="true" tabindex="-1"></a><span class="st">    AND</span></span>
<span id="c5b75c3c-12"><a href="#c5b75c3c-12" aria-hidden="true" tabindex="-1"></a><span class="st">    denominationUsuelleEtablissement IS NOT NULL</span></span>
<span id="c5b75c3c-13"><a href="#c5b75c3c-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="c5b75c3c-14"><a href="#c5b75c3c-14" aria-hidden="true" tabindex="-1"></a>)</span>
<a class="code-annotation-anchor" data-target-cell="c5b75c3c" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="c5b75c3c-15" class="code-annotation-target"><a href="#c5b75c3c-15" aria-hidden="true" tabindex="-1"></a>coiffeurs <span class="op">=</span> coiffeurs.df()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="c5b75c3c" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="c5b75c3c" data-code-lines="15" data-code-annotation="1">Convert the DuckDB dataframe to a Pandas DataFrame.</span>
</dd>
</dl>
</div>
</div>
<div id="74ac8d28" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="74ac8d28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="74ac8d28-1"><a href="#74ac8d28-1" aria-hidden="true" tabindex="-1"></a>coiffeurs.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">siren</th>
<th data-quarto-table-cell-role="th">siret</th>
<th data-quarto-table-cell-role="th">dateDebut</th>
<th data-quarto-table-cell-role="th">enseigne1Etablissement</th>
<th data-quarto-table-cell-role="th">activitePrincipaleEtablissement</th>
<th data-quarto-table-cell-role="th">denominationUsuelleEtablissement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>024050379</td>
<td>02405037900023</td>
<td>2016-01-14</td>
<td>None</td>
<td>96.02A</td>
<td>SOPHA COIFFURE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>024076481</td>
<td>02407648100019</td>
<td>2017-07-17</td>
<td>None</td>
<td>96.02A</td>
<td>SAF COIFFURE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>047142872</td>
<td>04714287200036</td>
<td>2011-07-31</td>
<td>None</td>
<td>96.02A</td>
<td>JENNY</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional Exercise: Punny Hairdressers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In this exercise, we will consider only the variable <code>denominationUsuelleEtablissement</code>.</p>
<ol type="1">
<li>In this dataset, <code>[ND]</code> is a code for missing value. Since <code>Python</code> has no reason to know this a priori and therefore didn’t interpret these values as missing, use the <code>replace</code> method to replace <code>[ND]</code> with an empty text field. Also, recode missing values as an empty text field to avoid future errors related to the inability to apply certain text methods to missing values.</li>
<li>Search for all occurrences where the term <code>tif</code> appears, paying attention to the capitalization of the variable. Look at some observations.</li>
<li>Using <a href="https://stackoverflow.com/a/23996414/9197726">this example</a>, normalize the names of the salons by removing special characters and count the most frequent puns.</li>
</ol>
</div>
</div>
</div>
<p>With question 2, we find a list of quite imaginative puns based on the term <code>tif</code></p>
<div id="5361ac13" class="cell" data-execution_count="57">
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>"ESTHETIFF'S, INSTANT CREA'TIF, SO BEAUTIFUL HAIR / NAIL, A C TIF, TIFANNY COIFFURE, S'TIFANY, QUALITA' TIFF, STEF TOUS TIFS, ESPACE CREATIF, IMAGINA'TIF"</code></pre>
</div>
</div>
<div id="fa5ddbd1" class="cell" data-execution_count="58">
<script type="ojs-define">{"contents": [{"name": "coiffeurs", "value": {"siren": ["305078503", "307197160", "307241158", "309994028", "316081413", "316584390", "320783780", "324565431", "325016277", "325155653", "325550614", "326098571", "326808995", "327040275", "327051678", "328844089", "330071663", "332034503", "332044056", "334790920", "334790920", "335238143", "337484026", "339025561", "339492175", "340155795", "340530179", "341260024", "343008736", "343249785", "343249785", "343793956", "343956777", "344534425", "347438038", "347930257", "348203894", "348203894", "349177915", "350824942", "350945366", "351405535", "352390512", "377612734", "378231401", "378713093", "378713093", "378844104", "379175896", "379489685", "381307792", "383079126", "383102001", "383824224", "384763298", "384934170", "384955084", "385000930", "388170391", "388232761", "388656324", "388868440", "389145764", "389550880", "390666881", "390666881", "390929701", "391090842", "391090842", "391974037", "393094305", "393300108", "393316872", "393986195", "394418115", "394621726", "394765655", "394765655", "394880421", "395306590", "397764275", "397920844", "398415976", "398497040", "398742965", "399027234", "399104884", "399104884", "399104884", "399241280", "399241280", "399300268", "399743905", "400149217", "400149217", "400600722", "400658548", "402239719", "402361794", "402427405", "402941694", "402941694", "403244411", "404738353", "408402543", "408545135", "409684222", "409751237", "411598733", "411811094", "412661761", "412967143", "413151168", "414316448", "414354829", "414550657", "415090828", "415150309", "415272806", "419453568", "419453568", "420895302", "420947236", "420982175", "420982175", "420982175", "421064809", "421380544", "422319483", "422348052", "422357970", "422564120", "422865717", "422865717", "422955815", "422991836", "423123280", "423126317", "423126317", "424352318", "424662948", "428080394", "428964654", "429446412", "429617723", "429818388", "429884836", "430003756", "430060368", "431427871", "432093854", "432175131", "432575298", "433711744", "433756830", "433756830", "433756830", "433816071", "433866738", "434194510", "435382254", "437866031", "438312191", "438407660", "438737272", "438809303", "438903973", "439070434", "439084575", "439411000", "439482704", "440443885", "441107646", "441390820", "441390820", "441407525", "442123998", "442215513", "442463311", "443086061", "443151881", "443157458", "443510078", "443514054", "443514054", "443767280", "443806864", "444127583", "444330203", "444415749", "444688733", "444909410", "445297930", "447601022", "447848946", "448608570", "448629022", "448793026", "448952333", "448957001", "449839265", "449840495", "449843762", "450210554", "450245170", "450259213", "450281639", "450347307", "450436225", "450559380", "450570270", "450570700", "450627120", "450668918", "450679931", "450967070", "451132195", "451149769", "451153886", "451303945", "451754428", "451917595", "452035314", "452280035", "452570484", "452616022", "452678584", "452769219", "452815566", "452936743", "452936743", "452981194", "453061269", "453137598", "453137598", "453290512", "453410813", "453904070", "453930927", "477489389", "477734479", "477764252", "477764252", "478003916", "478060577", "478281926", "478632284", "478632284", "478634116", "478666621", "478681364", "478681364", "478799877", "479046542", "479046542", "480076934", "480345214", "480408897", "480568112", "480606979", "480985787", "481157741", "481288058", "481379121", "481379121", "481554673", "481743425", "481743425", "481743425", "482422466", "482422466", "482601242", "482750072", "482893120", "482929114", "483367694", "483606083", "483799284", "484176524", "484389234", "484613906", "484682190", "485094122", "485100283", "485399646", "487428641", "487428641", "488220898", "488220898", "488343187", "488647512", "488647512", "489061135", "489061135", "489277475", "489423426", "489766840", "489802884", "489802884", "490029139", "490039617", "490103694", "490266921", "490342979", "490426251", "490587524", "490587524", "490857356", "491153243", "491266599", "491323705", "491363925", "491454237", "491694733", "491821542", "491897518", "492000849", "492137161", "492288980", "492676861", "492805122", "493035075", "493104665", "493467856", "493520837", "493618276", "493949648", "494106321", "494214471", "494293608", "494431901", "494532641", "494791551", "494810724", "495099228", "497533604", "497554105", "497610337", "497754432", "497817650", "498006691", "498053230", "498534742", "498745066", "498860568", "499155844", "499477859", "499541670", "499678522", "499680841", "499744381", "499744381", "499794311", "499921294", "499956910", "499971570", "500495361", "500495783", "500610092", "500680376", "500755095", "501104632", "501284608", "501306237", "501306237", "501321509", "501321905", "501423651", "501462618", "501462618", "501503841", "501523369", "501529333", "501531552", "501616775", "501616775", "501792337", "501874044", "501898019", "501928113", "501928113", "502112766", "502497142", "502557028", "502615974", "502727787", "502727787", "502804925", "503172561", "503264475", "503363251", "503638322", "503638322", "504161043", "504287905", "504489246", "504748245", "504785924", "507438356", "507675767", "507697225", "507700284", "507801702", "507899532", "508005048", "508097276", "508164860", "508166675", "508183548", "508189073", "508295482", "508295482", "508333713", "508388113", "508523784", "508563772", "508982261", "509289146", "509940854", "510024003", "510125305", "510157753", "510377815", "510666282", "510756083", "510790777", "511047201", "511294118", "511322687", "511431249", "511451197", "511562209", "511649170", "511672677", "511736779", "511934523", "512159575", "512430273", "512762907", "513230979", "513450908", "513450908", "513450908", "513594366", "513657809", "513815233", "513840595", "513875146", "513875146", "514124742", "514128248", "514632462", "514664382", "515202323", "515254431", "517501557", "517507463", "517787990", "517810354", "517964458", "518492277", "518574710", "519015671", "519822290", "520116278", "520242405", "520622127", "520622127", "520622127", "520622846", "520706011", "520733486", "520733486", "520841727", "520892118", "521105619", "521299081", "521407429", "521415372", "521831487", "521831487", "521855791", "522170935", "522491281", "522522218", "522527993", "522830272", "523210243", "523362986", "523452019", "523800571", "523868966", "524033057", "524060837", "524137429", "524191152", "524195476", "524195476", "524267960", "524293586", "524313756", "524598299", "524598299", "524795994", "524914470", "525276762", "525291498", "525347274", "525347274", "525391595", "525392957", "527478770", "527506398", "527554646", "527560981", "527611479", "527714414", "527740427", "527740427", "527878979", "527982268", "527988679", "528048028", "528121338", "528152820", "528257728", "528258247", "528258247", "528313935", "528370612", "528379993", "528442437", "528442437", "528568959", "528766694", "528766694", "528797129", "528801079", "528927114", "529025116", "529038879", "529038879", "529102477", "529102477", "529104846", "529104846", "529157356", "529157356", "529157356", "529157356", "529530867", "529530867", "529530867", "529544256", "529659328", "529659328", "529809840", "529825051", "529844102", "529846701", "530079763", "530166172", "530166172", "530209410", "530209410", "530209410", "530483437", "530483437", "530615699", "530734987", "530767946", "530778943", "530995406", "531037307", "531202059", "531347730", "531347730", "531380749", "531441624", "531494011", "531494011", "531495232", "531495232", "531505550", "531567261", "531661627", "531689362", "531748887", "531895480", "531895480", "531966398", "531966398", "531966398", "532041654", "532090628", "532092012", "532185972", "532230364", "532230364", "532298866", "532341351", "532442654", "532462363", "532482015", "532551488", "532555521", "532555521", "532571064", "532601283", "532810850", "532838158", "532841558", "532934940", "533049540", "533075990", "533115127", "533115127", "533154126", "533314415", "533428843", "533475901", "533515458", "533531695", "533545109", "533547253", "533547253", "533550638", "533670477", "533670477", "533673505", "533796892", "533796892", "534026257", "534036330", "534037585", "534037585", "534227624", "534267471", "534296223", "534374038", "534374038", "534398417", "534501606", "534513718", "534638168", "534662143", "534663059", "534736921", "534758032", "534758032", "534964325", "535096846", "535104947", "535159156", "535218499", "535371389", "537395600", "537426363", "537444390", "537453490", "537516874", "537521841", "537588329", "537637993", "537637993", "537775827", "538009341", "538127507", "538127507", "538302183", "538318429", "538318429", "538354788", "538364241", "538385584", "538385584", "538414889", "538481052", "538644238", "538707514", "538795980", "538857707", "539141168", "539304311", "539378349", "539482687", "539482687", "539625731", "539738732", "539775973", "540047719", "749810289", "749813432", "750188831", "750188831", "750278145", "750333601", "750376253", "750640724", "750652653", "750652653", "750652653", "750718835", "750749392", "750866162", "750872830", "750915316", "750959785", "750997504", "751250275", "751250275", "751381211", "751453713", "751758970", "751806753", "751881061", "751948605", "752016626", "752024596", "752030759", "752030759", "752064410", "752085639", "752111252", "752122705", "752381277", "752396515", "752534602", "752552752", "752623462", "752623462", "752755900", "752770891", "752777433", "752888701", "752907519", "752939769", "752939769", "752939769", "753027630", "753035872", "753107242", "753118645", "753196633", "753196633", "753268408", "753342070", "753428242", "753485119", "753485119", "753518836", "753518836", "753519552", "753579291", "753598556", "753598556", "753697390", "753831189", "753868488", "753868488", "753871433", "753891266", "753893098", "753929082", "753956325", "753988633", "753988633", "753988633", "753988633", "753988633", "753993856", "753993856", "754012821", "754012821", "754077923", "788441343", "788483402", "788519692", "788519692", "788520476", "788520476", "788641652", "788670115", "788758936", "788812964", "788841633", "788993947", "789020153", "789043791", "789071123", "789083706", "789083706", "789164456", "789226339", "789231008", "789310190", "789357282", "789463015", "789608742", "789658150", "789659059", "789666237", "789856739", "789947249", "789980422", "790036768", "790104467", "790323331", "790377915", "790400261", "790470728", "790506570", "790506570", "790536817", "790540009", "790785521", "790788152", "790878409", "790908701", "791028004", "791112881", "791150436", "791180268", "791441553", "791542285", "791548779", "791553555", "791571995", "791571995", "791786106", "791934706", "791934706", "792122848", "792122848", "792136806", "792214421", "792274169", "792339012", "792434805", "792533911", "792651218", "792677049", "792677049", "792684367", "792684367", "792726622", "792835308", "792916512", "792986200", "792986200", "793008012", "793073685", "793143389", "793203258", "793297334", "793297334", "793356478", "793374232", "793374232", "793567942", "793656851", "793656851", "793831884", "793915844", "793915844", "794099655", "794126904", "794143644", "794192849", "794208918", "794280685", "794296988", "794296988", "794312405", "794340018", "794391292", "794458984", "794458984", "794458984", "794497024", "794497024", "794517508", "794517508", "794517508", "794640193", "794779223", "794878702", "794978627", "794978627", "795048594", "795048594", "795084714", "795112226", "795149962", "795149962", "795162676", "795218817", "795306711", "795341650", "795341650", "795341650", "795342963", "797434040", "797436730", "797436730", "797483914", "797503307", "797584356", "797589389", "797596681", "797615275", "797623014", "797623014", "797623014", "797676640", "797699584", "797712593", "797736949", "797752813", "797811619", "797844487", "797844487", "797870854", "798046116", "798054268", "798135984", "798161576", "798265666", "798330205", "798369765", "798448700", "798448700", "798464145", "798815577", "798965950", "799016092", "799076328", "799087739", "799149802", "799149802", "799181383", "799392733", "799483862", "799532627", "799578331", "799707005", "799710322", "799719224", "800037764", "800066433", "800066433", "800107682", "800146276", "800247314", "800480477", "800480477", "800480477", "800540189", "800648644", "800648644", "800664542", "800690216", "800720872", "800777864", "800901001", "800947657", "800947657", "801054131", "801054131", "801056920", "801205956", "801205956", "801223124", "801260357", "801260357", "801359290", "801415308", "801531260", "801531260", "801531260", "801573320", "801653080", "801667163", "801732850", "801732850", "801853904", "801909391", "801909391", "801974957", "802064345", "802089599", "802108753", "802438853", "802482539", "802632596", "802857789", "802857789", "802874479", "802909564", "802931774", "803046614", "803091016", "803091016", "803093061", "803195320", "803444611", "803572163", "803714195", "803720317", "803720317", "803753813", "803813385", "803813385", "803883388", "804012730", "804045698", "804060408", "804095677", "804140382", "804200137", "804208486", "804412427", "804443158", "804443158", "804564656", "804636504", "804655561", "804693141", "804880425", "804992121", "805128824", "805152444", "805154804", "805220126", "805259215", "805322757", "805322757", "807423934", "807504691", "807550405", "807550405", "807550405", "807557301", "807588553", "807588553", "807589247", "807749676", "807826599", "807826599", "807847637", "808047096", "808124721", "808145072", "808244503", "808258750", "808263735", "808263735", "808317770", "808355960", "808437438", "808492441", "808536346", "808846224", "809013402", "809036510", "809113640", "809143530", "809198146", "809322597", "809370836", "809565195", "809680408", "809743602", "809743602", "809743602", "809764830", "809764830", "809774706", "809837602", "809837602", "809849870", "809849870", "809879588", "809931918", "810109991", "810136663", "810136663", "810152835", "810204388", "810227686", "810292433", "810296400", "810481887", "810536714", "810626671", "810684340", "810714196", "810714196", "810724807", "810799312", "810832006", "810837914", "811177476", "811268010", "811436799", "811508183", "811543024", "811646173", "811667369", "811667369", "811746387", "811851468", "811851468", "811888361", "812054260", "812054260", "812181592", "812243541", "812276400", "812386522", "812571610", "812713873", "812724920", "812749752", "812836880", "812838431", "812859957", "813502531", "813506508", "813506508", "813630258", "813780764", "813828860", "813851532", "813873841", "813888922", "813937034", "814050266", "814218392", "814318572", "814431466", "814504395", "814570420", "814670469", "814772489", "814902342", "815014246", "815014246", "815112396", "815112396", "815359633", "817424088", "817436561", "817446412", "817520851", "817589203", "817647050", "817757123", "817760382", "817810427", "817822711", "818248049", "818384273", "818654261", "819159104", "819477035", "819691817", "819911405", "820049351", "820182236", "820417111", "820533578", "820533578", "820533578", "820599645", "820614626", "820614626", "820618445", "820621027", "820636694", "820636694", "820636694", "820935773", "820935773", "820944221", "820956506", "821315868", "821317427", "821365012", "821414133", "821414133", "821416401", "821727708", "821731940", "821784568", "821784568", "821883071", "822112967", "822112967", "822522538", "822522538", "822545638", "822545810", "822601472", "822720587", "822803227", "823070990", "823219829", "823252135", "823410774", "823505409", "823505409", "823505409", "823942834", "823986484", "823986484", "824195028", "824196158", "824196158", "824217418", "824217418", "824303747", "824347959", "824720346", "824751747", "824840375", "824840375", "824915250", "825076029", "825253933", "825265218", "827442773", "827587627", "827779471", "827907783", "828281881", "828281881", "828328971", "828366542", "828526319", "828758375", "828786921", "828798686", "828897785", "829000009", "829149350", "829409721", "829410059", "829430313", "829430313", "829456367", "829456367", "829487396", "829575513", "829597798", "829621838", "829626712", "829658269", "829716174", "829918036", "830234126", "830258786", "830528980", "830529269", "830552295", "830594321", "830621777", "830900676", "831040266", "831377684", "831485610", "831485610", "831840814", "832254684", "832265821", "832296172", "832305833", "832353411", "832357347", "832822027", "832862809", "832943112", "832943112", "832943112", "832992812", "833041593", "833365042", "833492564", "833642564", "833709801", "833709801", "834167041", "834409526", "834409526", "834825697", "834844284", "835047119", "835252537", "835309618", "837512250", "838130359", "838455442", "838755908", "838755908", "838755908", "838937894", "838955680", "839029105", "839125804", "839437126", "839535911", "839546942", "839546942", "839596939", "839954450", "840204812", "840238810", "840770440", "840960652", "841040470", "841159445", "841168636", "841169402", "841288871", "841613888", "841867195", "841965403", "842170680", "842278137", "842278137", "842396376", "842412272", "842447591", "843030669", "843324195", "843359035", "843701194", "843777467", "843803099", "844175703", "844188524", "844374298", "844459941", "844459941", "844718957", "845156132", "845402577", "845402577", "847537461", "847604154", "847689791", "847689791", "847689791", "847712395", "847881851", "847928041", "848090429", "848186318", "848226411", "848433496", "848439337", "848782371", "849247267", "849555743", "849712765", "849735592", "849735592", "850036377", "850862491", "851145979", "851358705", "851474981", "851498048", "851547489", "851728345", "852161249", "852501782", "852871599", "852871599", "852973502", "853126795", "853202984", "853215762", "853880920", "877538926", "877805762", "877860270", "877992743", "878014398", "878055383", "878384742", "878556166", "878633064", "878964139", "879071850", "879363216", "879363216", "879363216", "879586451", "879711646", "879889566", "879957298", "880798723", "880798723", "880893938", "880972708", "880996046", "881297790", "881393706", "881393706", "881628317", "881656383", "881687271", "882425143", "882764756", "882998768", "883121584", "883384505", "883384505", "884028960", "884037532", "884049776", "884306101", "884431339", "885061341", "887508802", "887508802", "887964419", "888198496", "888208402", "888621588", "888755428", "888783925", "888828043", "889019055", "889019055", "889019055", "889324893", "889352282", "889564696", "889813648", "889813648", "889813648", "889901146", "889954681", "890032212", "890130719", "890410350", "891406316", "891550360", "892221979", "892221979", "892802984", "893622845", "893736082", "894273978", "894365691", "894760198", "894760198", "894839794", "895212272", "895212272", "895235513", "897418414", "898882956", "899295695", "899743892", "900881632", "901304774", "901430439", "901719021", "903567667", "903781615", "904444536", "904570769", "904570769", "904801115", "904977196", "907509723", "907570071", "907919559", "908873698", "908893407", "909864845", "910255462", "910313691", "910395482", "910602796", "911036499", "911104552", "911425593", "911460640", "911805273", "911876209", "911974384", "912114733", "912313269", "912800000", "913693651", "913768438", "913882718", "914025663", "914513783", "914854245", "915115158", "917477093", "917811762", "918432642", "918500349", "918816331", "918913716", "919401430", "919529891", "919578336", "919597088", "919689646", "919919415", "920043106", "920198033", "920315488", "920547585", "920711280", "920899556", "921102802", "921198743", "921755518", "922383252", "947957320", "948018833", "948233853", "948234356", "948253109", "948870589", "949500706", "949650667", "949747521", "950772996", "951344241", "951375864", "952894251", "953302148", "953448842", "953768942", "954000188", "977500560", "977678903", "978104198", "978407583", "978496990", "979284676", "979786399", "979831021", "980257943", "980293526", "980524144"], "siret": ["30507850300029", "30719716000061", "30724115800046", "30999402800020", "31608141300015", "31658439000033", "32078378000044", "32456543100057", "32501627700049", "32515565300034", "32555061400029", "32609857100028", "32680899500038", "32704027500031", "32705167800040", "32884408900032", "33007166300026", "33203450300026", "33204405600049", "33479092000022", "33479092000030", "33523814300010", "33748402600022", "33902556100061", "33949217500023", "34015579500032", "34053017900035", "34126002400037", "34300873600013", "34324978500035", "34324978500043", "34379395600032", "34395677700035", "34453442500022", "34743803800031", "34793025700030", "34820389400020", "34820389400038", "34917791500015", "35082494200055", "35094536600010", "35140553500045", "35239051200023", "37761273400022", "37823140100043", "37871309300045", "37871309300052", "37884410400026", "37917589600016", "37948968500030", "38130779200048", "38307912600074", "38310200100021", "38382422400026", "38476329800039", "38493417000018", "38495508400031", "38500093000029", "38817039100022", "38823276100030", "38865632400026", "38886844000032", "38914576400020", "38955088000063", "39066688100037", "39066688100045", "39092970100022", "39109084200033", "39109084200041", "39197403700023", "39309430500017", "39330010800023", "39331687200026", "39398619500039", "39441811500025", "39462172600030", "39476565500029", "39476565500037", "39488042100059", "39530659000013", "39776427500020", "39792084400032", "39841597600024", "39849704000012", "39874296500021", "39902723400067", "39910488400057", "39910488400065", "39910488400073", "39924128000045", "39924128000052", "39930026800030", "39974390500016", "40014921700020", "40014921700038", "40060072200021", "40065854800047", "40223971900022", "40236179400025", "40242740500012", "40294169400018", "40294169400026", "40324441100035", "40473835300030", "40840254300024", "40854513500019", "40968422200022", "40975123700044", "41159873300045", "41181109400027", "41266176100038", "41296714300022", "41315116800023", "41431644800037", "41435482900015", "41455065700020", "41509082800013", "41515030900037", "41527280600043", "41945356800026", "41945356800034", "42089530200032", "42094723600048", "42098217500028", "42098217500044", "42098217500051", "42106480900047", "42138054400039", "42231948300059", "42234805200024", "42235797000025", "42256412000026", "42286571700033", "42286571700041", "42295581500028", "42299183600038", "42312328000020", "42312631700035", "42312631700043", "42435231800028", "42466294800035", "42808039400029", "42896465400027", "42944641200018", "42961772300037", "42981838800010", "42988483600033", "43000375600037", "43006036800023", "43142787100048", "43209385400037", "43217513100023", "43257529800018", "43371174400022", "43375683000033", "43375683000041", "43375683000058", "43381607100024", "43386673800027", "43419451000021", "43538225400033", "43786603100010", "43831219100028", "43840766000010", "43873727200023", "43880930300037", "43890397300024", "43907043400030", "43908457500026", "43941100000029", "43948270400020", "44044388500031", "44110764600024", "44139082000013", "44139082000021", "44140752500035", "44212399800027", "44221551300031", "44246331100021", "44308606100027", "44315188100036", "44315745800029", "44351007800027", "44351405400040", "44351405400057", "44376728000029", "44380686400031", "44412758300037", "44433020300027", "44441574900027", "44468873300021", "44490941000029", "44529793000023", "44760102200026", "44784894600029", "44860857000025", "44862902200022", "44879302600023", "44895233300012", "44895700100036", "44983926500021", "44984049500021", "44984376200021", "45021055400025", "45024517000029", "45025921300020", "45028163900010", "45034730700032", "45043622500038", "45055938000032", "45057027000022", "45057070000028", "45062712000022", "45066891800029", "45067993100029", "45096707000019", "45113219500038", "45114976900023", "45115388600028", "45130394500021", "45175442800022", "45191759500030", "45203531400023", "45228003500018", "45257048400025", "45261602200045", "45267858400049", "45276921900018", "45281556600024", "45293674300031", "45293674300049", "45298119400023", "45306126900040", "45313759800026", "45313759800034", "45329051200020", "45341081300027", "45390407000027", "45393092700034", "47748938900023", "47773447900017", "47776425200029", "47776425200037", "47800391600010", "47806057700028", "47828192600020", "47863228400012", "47863228400020", "47863411600022", "47866662100022", "47868136400012", "47868136400020", "47879987700012", "47904654200045", "47904654200052", "48007693400045", "48034521400021", "48040889700035", "48056811200027", "48060697900031", "48098578700039", "48115774100036", "48128805800037", "48137912100025", "48137912100033", "48155467300014", "48174342500029", "48174342500037", "48174342500045", "48242246600037", "48242246600045", "48260124200043", "48275007200043", "48289312000030", "48292911400023", "48336769400021", "48360608300028", "48379928400052", "48417652400037", "48438923400036", "48461390600011", "48468219000026", "48509412200036", "48510028300020", "48539964600028", "48742864100038", "48742864100046", "48822089800024", "48822089800032", "48834318700032", "48864751200018", "48864751200026", "48906113500021", "48906113500039", "48927747500013", "48942342600027", "48976684000024", "48980288400028", "48980288400036", "49002913900022", "49003961700025", "49010369400025", "49026692100058", "49034297900021", "49042625100024", "49058752400037", "49058752400045", "49085735600037", "49115324300036", "49126659900027", "49132370500021", "49136392500034", "49145423700026", "49169473300024", "49182154200025", "49189751800024", "49200084900025", "49213716100039", "49228898000021", "49267686100023", "49280512200024", "49303507500032", "49310466500028", "49346785600024", "49352083700029", "49361827600015", "49394964800023", "49410632100024", "49421447100026", "49429360800027", "49443190100037", "49453264100029", "49479155100034", "49481072400018", "49509922800035", "49753360400029", "49755410500047", "49761033700022", "49775443200027", "49781765000029", "49800669100014", "49805323000013", "49853474200024", "49874506600023", "49886056800027", "49915584400024", "49947785900049", "49954167000026", "49967852200024", "49968084100024", "49974438100033", "49974438100041", "49979431100021", "49992129400017", "49995691000024", "49997157000035", "50049536100031", "50049578300028", "50061009200024", "50068037600034", "50075509500022", "50110463200028", "50128460800038", "50130623700014", "50130623700022", "50132150900025", "50132190500017", "50142365100022", "50146261800023", "50146261800031", "50150384100022", "50152336900020", "50152933300053", "50153155200021", "50161677500034", "50161677500042", "50179233700021", "50187404400032", "50189801900028", "50192811300023", "50192811300031", "50211276600022", "50249714200021", "50255702800052", "50261597400024", "50272778700033", "50272778700041", "50280492500027", "50317256100022", "50326447500032", "50336325100029", "50363832200035", "50363832200043", "50416104300022", "50428790500021", "50448924600026", "50474824500025", "50478592400029", "50743835600028", "50767576700028", "50769722500021", "50770028400023", "50780170200022", "50789953200026", "50800504800022", "50809727600028", "50816486000027", "50816667500027", "50818354800033", "50818907300028", "50829548200022", "50829548200048", "50833371300032", "50838811300021", "50852378400025", "50856377200013", "50898226100028", "50928914600029", "50994085400029", "51002400300020", "51012530500027", "51015775300029", "51037781500020", "51066628200049", "51075608300026", "51079077700021", "51104720100013", "51129411800027", "51132268700027", "51143124900024", "51145119700020", "51156220900029", "51164917000020", "51167267700024", "51173677900022", "51193452300024", "51215957500038", "51243027300023", "51276290700032", "51323097900033", "51345090800027", "51345090800035", "51345090800043", "51359436600025", "51365780900028", "51381523300020", "51384059500013", "51387514600039", "51387514600047", "51412474200024", "51412824800010", "51463246200024", "51466438200025", "51520232300041", "51525443100023", "51750155700022", "51750746300027", "51778799000012", "51781035400020", "51796445800023", "51849227700018", "51857471000027", "51901567100026", "51982229000028", "52011627800026", "52024240500014", "52062212700022", "52062212700030", "52062212700048", "52062284600027", "52070601100027", "52073348600028", "52073348600036", "52084172700024", "52089211800032", "52110561900022", "52129908100021", "52140742900013", "52141537200023", "52183148700025", "52183148700033", "52185579100013", "52217093500020", "52249128100021", "52252221800026", "52252799300029", "52283027200020", "52321024300029", "52336298600029", "52345201900012", "52380057100029", "52386896600020", "52403305700026", "52406083700027", "52413742900022", "52419115200023", "52419547600022", "52419547600030", "52426796000036", "52429358600029", "52431375600024", "52459829900013", "52459829900021", "52479599400028", "52491447000025", "52527676200016", "52529149800026", "52534727400017", "52534727400025", "52539159500036", "52539295700029", "52747877000011", "52750639800017", "52755464600028", "52756098100021", "52761147900017", "52771441400028", "52774042700010", "52774042700028", "52787897900014", "52798226800015", "52798867900017", "52804802800013", "52812133800016", "52815282000015", "52825772800014", "52825824700014", "52825824700022", "52831393500017", "52837061200012", "52837999300025", "52844243700026", "52844243700034", "52856895900019", "52876669400012", "52876669400020", "52879712900012", "52880107900013", "52892711400017", "52902511600011", "52903887900019", "52903887900027", "52910247700013", "52910247700021", "52910484600025", "52910484600033", "52915735600013", "52915735600021", "52915735600039", "52915735600047", "52953086700017", "52953086700025", "52953086700033", "52954425600017", "52965932800015", "52965932800023", "52980984000026", "52982505100012", "52984410200028", "52984670100017", "53007976300013", "53016617200011", "53016617200029", "53020941000014", "53020941000022", "53020941000030", "53048343700014", "53048343700022", "53061569900010", "53073498700015", "53076794600011", "53077894300015", "53099540600010", "53103730700018", "53120205900014", "53134773000016", "53134773000024", "53138074900014", "53144162400016", "53149401100012", "53149401100020", "53149523200013", "53149523200021", "53150555000016", "53156726100015", "53166162700012", "53168936200014", "53174888700019", "53189548000014", "53189548000022", "53196639800012", "53196639800020", "53196639800038", "53204165400015", "53209062800027", "53209201200014", "53218597200017", "53223036400012", "53223036400020", "53229886600015", "53234135100015", "53244265400028", "53246236300021", "53248201500015", "53255148800010", "53255552100014", "53255552100022", "53257106400015", "53260128300023", "53281085000018", "53283815800022", "53284155800010", "53293494000042", "53304954000032", "53307599000028", "53311512700011", "53311512700029", "53315412600023", "53331441500019", "53342884300015", "53347590100013", "53351545800016", "53353169500013", "53354510900019", "53354725300013", "53354725300021", "53355063800019", "53367047700033", "53367047700041", "53367350500012", "53379689200016", "53379689200032", "53402625700012", "53403633000023", "53403758500013", "53403758500021", "53422762400010", "53426747100017", "53429622300017", "53437403800014", "53437403800022", "53439841700020", "53450160600014", "53451371800013", "53463816800029", "53466214300013", "53466305900010", "53473692100014", "53475803200013", "53475803200021", "53496432500011", "53509684600014", "53510494700010", "53515915600020", "53521849900015", "53537138900011", "53739560000019", "53742636300017", "53744439000018", "53745349000014", "53751687400014", "53752184100016", "53758832900012", "53763799300024", "53763799300032", "53777582700018", "53800934100016", "53812750700019", "53812750700027", "53830218300016", "53831842900015", "53831842900023", "53835478800019", "53836424100017", "53838558400015", "53838558400023", "53841488900013", "53848105200024", "53864423800015", "53870751400013", "53879598000019", "53885770700011", "53914116800010", "53930431100019", "53937834900010", "53948268700016", "53948268700024", "53962573100010", "53973873200012", "53977597300016", "54004771900013", "74981028900019", "74981343200012", "75018883100010", "75018883100028", "75027814500016", "75033360100029", "75037625300019", "75064072400043", "75065265300015", "75065265300023", "75065265300031", "75071883500010", "75074939200015", "75086616200019", "75087283000013", "75091531600012", "75095978500015", "75099750400014", "75125027500037", "75125027500045", "75138121100018", "75145371300016", "75175897000014", "75180675300016", "75188106100012", "75194860500058", "75201662600018", "75202459600021", "75203075900027", "75203075900035", "75206441000018", "75208563900017", "75211125200025", "75212270500011", "75238127700017", "75239651500013", "75253460200012", "75255275200012", "75262346200013", "75262346200021", "75275590000012", "75277089100014", "75277743300018", "75288870100014", "75290751900017", "75293976900010", "75293976900028", "75293976900036", "75302763000015", "75303587200013", "75310724200012", "75311864500021", "75319663300014", "75319663300022", "75326840800014", "75334207000012", "75342824200014", "75348511900014", "75348511900022", "75351883600014", "75351883600022", "75351955200016", "75357929100018", "75359855600011", "75359855600029", "75369739000015", "75383118900018", "75386848800028", "75386848800036", "75387143300011", "75389126600029", "75389309800016", "75392908200026", "75395632500017", "75398863300016", "75398863300032", "75398863300040", "75398863300057", "75398863300065", "75399385600016", "75399385600024", "75401282100015", "75401282100023", "75407792300011", "78844134300019", "78848340200012", "78851969200016", "78851969200024", "78852047600029", "78852047600037", "78864165200011", "78867011500013", "78875893600017", "78881296400013", "78884163300019", "78899394700019", "78902015300019", "78904379100019", "78907112300010", "78908370600018", "78908370600026", "78916445600012", "78922633900016", "78923100800010", "78931019000010", "78935728200019", "78946301500014", "78960874200019", "78965815000014", "78965905900016", "78966623700019", "78985673900014", "78994724900015", "78998042200016", "79003676800014", "79010446700010", "79032333100013", "79037791500018", "79040026100018", "79047072800011", "79050657000015", "79050657000023", "79053681700014", "79054000900012", "79078552100028", "79078815200011", "79087840900016", "79090870100010", "79102800400012", "79111288100010", "79115043600016", "79118026800017", "79144155300017", "79154228500014", "79154877900010", "79155355500016", "79157199500012", "79157199500020", "79178610600017", "79193470600023", "79193470600031", "79212284800015", "79212284800023", "79213680600017", "79221442100010", "79227416900012", "79233901200025", "79243480500026", "79253391100014", "79265121800010", "79267704900019", "79267704900027", "79268436700016", "79268436700024", "79272662200014", "79283530800018", "79291651200017", "79298620000022", "79298620000030", "79300801200015", "79307368500018", "79314338900013", "79320325800017", "79329733400013", "79329733400021", "79335647800016", "79337423200015", "79337423200023", "79356794200016", "79365685100011", "79365685100029", "79383188400010", "79391584400013", "79391584400021", "79409965500019", "79412690400018", "79414364400019", "79419284900014", "79420891800019", "79428068500015", "79429698800023", "79429698800049", "79431240500010", "79434001800017", "79439129200016", "79445898400018", "79445898400026", "79445898400034", "79449702400024", "79449702400032", "79451750800014", "79451750800022", "79451750800030", "79464019300015", "79477922300013", "79487870200016", "79497862700014", "79497862700022", "79504859400019", "79504859400027", "79508471400018", "79511222600035", "79514996200016", "79514996200024", "79516267600014", "79521881700018", "79530671100016", "79534165000013", "79534165000021", "79534165000039", "79534296300019", "79743404000011", "79743673000015", "79743673000023", "79748391400017", "79750330700010", "79758435600019", "79758938900015", "79759668100016", "79761527500014", "79762301400017", "79762301400025", "79762301400033", "79767664000023", "79769958400018", "79771259300012", "79773694900018", "79775281300015", "79781161900023", "79784448700026", "79784448700034", "79787085400016", "79804611600017", "79805426800015", "79813598400010", "79816157600011", "79826566600015", "79833020500013", "79836976500010", "79844870000012", "79844870000020", "79846414500019", "79881557700019", "79896595000016", "79901609200014", "79907632800019", "79908773900014", "79914980200016", "79914980200024", "79918138300024", "79939273300017", "79948386200014", "79953262700012", "79957833100016", "79970700500010", "79971032200014", "79971922400013", "80003776400019", "80006643300015", "80006643300023", "80010768200018", "80014627600012", "80024731400019", "80048047700010", "80048047700028", "80048047700036", "80054018900027", "80064864400014", "80064864400022", "80066454200019", "80069021600018", "80072087200012", "80077786400011", "80090100100019", "80094765700014", "80094765700022", "80105413100017", "80105413100025", "80105692000011", "80120595600015", "80120595600023", "80122312400018", "80126035700018", "80126035700026", "80135929000013", "80141530800023", "80153126000017", "80153126000025", "80153126000033", "80157332000018", "80165308000011", "80166716300019", "80173285000012", "80173285000020", "80185390400010", "80190939100014", "80190939100022", "80197495700012", "80206434500027", "80208959900012", "80210875300012", "80243885300011", "80248253900011", "80263259600010", "80285778900019", "80285778900027", "80287447900016", "80290956400014", "80293177400011", "80304661400019", "80309101600029", "80309101600037", "80309306100015", "80319532000012", "80344461100013", "80357216300019", "80371419500028", "80372031700012", "80372031700020", "80375381300028", "80381338500017", "80381338500025", "80388338800016", "80401273000011", "80404569800011", "80406040800015", "80409567700014", "80414038200016", "80420013700011", "80420848600014", "80441242700010", "80444315800014", "80444315800022", "80456465600010", "80463650400016", "80465556100020", "80469314100017", "80488042500017", "80499212100017", "80512882400010", "80515244400016", "80515480400019", "80522012600017", "80525921500012", "80532275700016", "80532275700024", "80742393400015", "80750469100013", "80755040500011", "80755040500029", "80755040500037", "80755730100015", "80758855300014", "80758855300022", "80758924700012", "80774967600019", "80782659900019", "80782659900027", "80784763700020", "80804709600025", "80812472100032", "80814507200019", "80824450300013", "80825875000013", "80826373500017", "80826373500033", "80831777000010", "80835596000010", "80843743800019", "80849244100015", "80853634600014", "80884622400018", "80901340200015", "80903651000018", "80911364000019", "80914353000016", "80919814600015", "80932259700018", "80937083600029", "80956519500017", "80968040800022", "80974360200017", "80974360200025", "80974360200033", "80976483000018", "80976483000026", "80977470600018", "80983760200014", "80983760200030", "80984987000013", "80984987000021", "80987958800014", "80993191800019", "81010999100010", "81013666300012", "81013666300020", "81015283500015", "81020438800013", "81022768600013", "81029243300010", "81029640000015", "81048188700026", "81053671400019", "81062667100012", "81068434000013", "81071419600013", "81071419600021", "81072480700013", "81079931200014", "81083200600011", "81083791400011", "81117747600017", "81126801000014", "81143679900027", "81150818300019", "81154302400012", "81164617300013", "81166736900011", "81166736900029", "81174638700026", "81185146800017", "81185146800025", "81188836100011", "81205426000011", "81205426000029", "81218159200021", "81224354100016", "81227640000015", "81238652200013", "81257161000011", "81271387300014", "81272492000010", "81274975200018", "81283688000011", "81283843100011", "81285995700035", "81350253100011", "81350650800015", "81350650800023", "81363025800016", "81378076400011", "81382886000011", "81385153200016", "81387384100015", "81388892200016", "81393703400011", "81405026600018", "81421839200011", "81431857200017", "81443146600030", "81450439500017", "81457042000012", "81467046900018", "81477248900013", "81490234200017", "81501424600012", "81501424600020", "81511239600016", "81511239600024", "81535963300014", "81742408800018", "81743656100010", "81744641200022", "81752085100012", "81758920300014", "81764705000019", "81775712300010", "81776038200017", "81781042700010", "81782271100013", "81824804900012", "81838427300012", "81865426100010", "81915910400010", "81947703500011", "81969181700012", "81991140500010", "82004935100019", "82018223600019", "82041711100011", "82053357800010", "82053357800028", "82053357800036", "82059964500018", "82061462600019", "82061462600027", "82061844500010", "82062102700011", "82063669400011", "82063669400029", "82063669400037", "82093577300011", "82093577300029", "82094422100028", "82095650600019", "82131586800017", "82131742700028", "82136501200011", "82141413300016", "82141413300024", "82141640100015", "82172770800017", "82173194000010", "82178456800015", "82178456800023", "82188307100010", "82211296700010", "82211296700028", "82252253800013", "82252253800021", "82254563800022", "82254581000019", "82260147200019", "82272058700010", "82280322700013", "82307099000010", "82321982900012", "82325213500012", "82341077400017", "82350540900016", "82350540900024", "82350540900032", "82394283400016", "82398648400017", "82398648400025", "82419502800017", "82419615800011", "82419615800029", "82421741800014", "82421741800022", "82430374700011", "82434795900010", "82472034600017", "82475174700018", "82484037500011", "82484037500029", "82491525000016", "82507602900016", "82525393300022", "82526521800016", "82744277300012", "82758762700015", "82777947100016", "82790778300019", "82828188100015", "82828188100023", "82832897100019", "82836654200011", "82852631900011", "82875837500012", "82878692100019", "82879868600022", "82889778500014", "82900000900011", "82914935000011", "82940972100018", "82941005900010", "82943031300017", "82943031300025", "82945636700012", "82945636700020", "82948739600014", "82957551300017", "82959779800018", "82962183800012", "82962671200014", "82965826900024", "82971617400026", "82991803600015", "83023412600019", "83025878600011", "83052898000022", "83052926900011", "83055229500016", "83059432100010", "83062177700010", "83090067600016", "83104026600015", "83137768400012", "83148561000016", "83148561000024", "83184081400014", "83225468400018", "83226582100013", "83229617200014", "83230583300010", "83235341100016", "83235734700018", "83282202700013", "83286280900015", "83294311200017", "83294311200025", "83294311200033", "83299281200012", "83304159300017", "83336504200013", "83349256400012", "83364256400011", "83370980100017", "83370980100025", "83416704100013", "83440952600011", "83440952600029", "83482569700016", "83484428400010", "83504711900010", "83525253700013", "83530961800014", "83751225000015", "83813035900014", "83845544200015", "83875590800012", "83875590800020", "83875590800038", "83893789400015", "83895568000015", "83902910500013", "83912580400014", "83943712600015", "83953591100029", "83954694200013", "83954694200021", "83959693900018", "83995445000012", "84020481200019", "84023881000013", "84077044000013", "84096065200013", "84104047000020", "84115944500011", "84116863600014", "84116940200010", "84128887100012", "84161388800012", "84186719500015", "84196540300014", "84217068000024", "84227813700018", "84227813700026", "84239637600019", "84241227200010", "84244759100012", "84303066900017", "84332419500018", "84335903500014", "84370119400014", "84377746700013", "84380309900012", "84417570300017", "84418852400012", "84437429800017", "84445994100010", "84445994100028", "84471895700013", "84515613200027", "84540257700017", "84540257700025", "84753746100018", "84760415400017", "84768979100014", "84768979100022", "84768979100030", "84771239500015", "84788185100012", "84792804100015", "84809042900012", "84818631800012", "84822641100017", "84843349600017", "84843933700017", "84878237100019", "84924726700024", "84955574300012", "84971276500015", "84973559200016", "84973559200024", "85003637700024", "85086249100014", "85114597900015", "85135870500016", "85147498100012", "85149804800012", "85154748900019", "85172834500014", "85216124900010", "85250178200019", "85287159900019", "85287159900027", "85297350200010", "85312679500014", "85320298400011", "85321576200016", "85388092000014", "87753892600016", "87780576200011", "87786027000017", "87799274300014", "87801439800019", "87805538300011", "87838474200010", "87855616600014", "87863306400018", "87896413900017", "87907185000017", "87936321600018", "87936321600026", "87936321600034", "87958645100012", "87971164600015", "87988956600011", "87995729800018", "88079872300016", "88079872300024", "88089393800022", "88097270800015", "88099604600012", "88129779000019", "88139370600018", "88139370600026", "88162831700011", "88165638300018", "88168727100026", "88242514300014", "88276475600012", "88299876800015", "88312158400014", "88338450500011", "88338450500029", "88402896000018", "88403753200014", "88404977600013", "88430610100012", "88443133900016", "88506134100016", "88750880200014", "88750880200022", "88796441900014", "88819849600018", "88820840200014", "88862158800019", "88875542800016", "88878392500017", "88882804300016", "88901905500017", "88901905500025", "88901905500033", "88932489300011", "88935228200012", "88956469600017", "88981364800017", "88981364800025", "88981364800033", "88990114600015", "88995468100017", "89003221200015", "89013071900010", "89041035000015", "89140631600010", "89155036000020", "89222197900016", "89222197900024", "89280298400013", "89362284500012", "89373608200015", "89427397800011", "89436569100019", "89476019800016", "89476019800024", "89483979400019", "89521227200010", "89521227200028", "89523551300010", "89741841400016", "89888295600011", "89929569500014", "89974389200015", "90088163200013", "90130477400010", "90143043900017", "90171902100015", "90356766700014", "90378161500013", "90444453600026", "90457076900011", "90457076900029", "90480111500018", "90497719600016", "90750972300017", "90757007100015", "90791955900019", "90887369800017", "90889340700019", "90986484500013", "91025546200012", "91031369100016", "91039548200011", "91060279600013", "91103649900018", "91110455200011", "91142559300017", "91146064000012", "91180527300016", "91187620900014", "91197438400016", "91211473300021", "91231326900017", "91280000000016", "91369365100014", "91376843800016", "91388271800012", "91402566300024", "91451378300011", "91485424500018", "91511515800015", "91747709300012", "91781176200017", "91843264200018", "91850034900017", "91881633100014", "91891371600018", "91940143000013", "91952989100013", "91957833600019", "91959708800013", "91968964600017", "91991941500019", "92004310600011", "92019803300010", "92031548800014", "92054758500017", "92071128000015", "92089955600012", "92110280200011", "92119874300020", "92175551800013", "92238325200025", "94795732000015", "94801883300012", "94823385300019", "94823435600012", "94825310900011", "94887058900017", "94950070600013", "94965066700015", "94974752100019", "95077299600019", "95134424100017", "95137586400018", "95289425100018", "95330214800010", "95344884200013", "95376894200013", "95400018800019", "97750056000015", "97767890300013", "97810419800012", "97840758300019", "97849699000018", "97928467600017", "97978639900019", "97983102100014", "98025794300012", "98029352600011", "98052414400014"], "dateDebut": [1538265600000, 1488240000000, 1448841600000, 1567209600000, 1298851200000, 1498780800000, 1551398400000, 1388534400000, 1483142400000, 1482710400000, 1640908800000, 1449532800000, 1580428800000, 1459468800000, 1306800000000, 1451606400000, 1483228800000, 1640908800000, 1640908800000, 1346457600000, 1625011200000, 1693526400000, 1321315200000, 1391558400000, 1528675200000, 1483228800000, 1688169600000, 1431648000000, 1640908800000, 1320105600000, 1605139200000, 1538265600000, 1688947200000, 1349049600000, 1451520000000, 1572825600000, 1664064000000, 1664064000000, 1545436800000, 1316044800000, 1358985600000, 1698710400000, 1415750400000, 1317427200000, 1341878400000, 1451606400000, 1572480000000, 1527638400000, 1539043200000, 1469664000000, 1548633600000, 1384214400000, 1534723200000, 1649116800000, 1509494400000, 1314835200000, 1508371200000, 1596153600000, 1617667200000, 1632960000000, 1417392000000, 1680307200000, 1528070400000, 1525132800000, 1435708800000, 1435708800000, 1485907200000, 1498780800000, 1680220800000, 1325376000000, 1533513600000, 1669766400000, 1283299200000, 1377907200000, 1387065600000, 1451606400000, 1577750400000, 1578268800000, 1648684800000, 1569283200000, 1485820800000, 1569801600000, 1236988800000, 1328572800000, 1325289600000, 1330041600000, 1443225600000, 1567296000000, 1567296000000, 1343779200000, 1309564800000, 1330128000000, 1625616000000, 1483401600000, 1483401600000, 1591142400000, 1426464000000, 1686355200000, 1554076800000, 1396828800000, 1425254400000, 1425254400000, 1299801600000, 1645142400000, 1490918400000, 1488585600000, 1454198400000, 1451865600000, 1618185600000, 1317427200000, 1519776000000, 1685577600000, 1454025600000, 1475280000000, 1620259200000, 1606521600000, 1519689600000, 1271116800000, 1538956800000, 1564963200000, 1564963200000, 1661990400000, 1463011200000, 1412640000000, 1595376000000, 1661990400000, 1493683200000, 1559606400000, 1546214400000, 1438387200000, 1317427200000, 1410739200000, 1583452800000, 1583452800000, 1597622400000, 1433116800000, 1491004800000, 1648684800000, 1648684800000, 1295740800000, 1651363200000, 1302825600000, 1362355200000, 1519430400000, 1443657600000, 1654041600000, 1640908800000, 1554076800000, 1302048000000, 1609372800000, 1625875200000, 1511827200000, 1653782400000, 1388448000000, 1335312000000, 1598918400000, 1598918400000, 1435622400000, 1609459200000, 1654041600000, 1478131200000, 1614556800000, 1612137600000, 1356912000000, 1569888000000, 1491264000000, 1690848000000, 1464048000000, 1669075200000, 1506902400000, 1522454400000, 1609718400000, 1577836800000, 1491004800000, 1696118400000, 1625097600000, 1367280000000, 1351728000000, 1606780800000, 1456790400000, 1372636800000, 1543622400000, 1336003200000, 1600905600000, 1600905600000, 1488326400000, 1546214400000, 1609459200000, 1325635200000, 1432166400000, 1537747200000, 1425168000000, 1601510400000, 1514073600000, 1451174400000, 1462752000000, 1420070400000, 1633046400000, 1373328000000, 1640908800000, 1655942400000, 1334188800000, 1412121600000, 1416787200000, 1609804800000, 1694736000000, 1451520000000, 1543536000000, 1414368000000, 1559520000000, 1528848000000, 1451606400000, 1486512000000, 1666310400000, 1496188800000, 1672444800000, 1496448000000, 1349827200000, 1662422400000, 1473897600000, 1451606400000, 1641168000000, 1535673600000, 1513209600000, 1362700800000, 1661212800000, 1589241600000, 1670976000000, 1637971200000, 1338508800000, 1614470400000, 1403568000000, 1477958400000, 1593216000000, 1593216000000, 1456790400000, 1508025600000, 1417392000000, 1589155200000, 1452470400000, 1493683200000, 1396310400000, 1423180800000, 1399852800000, 1572480000000, 1487289600000, 1361923200000, 1361923200000, 1479686400000, 1653955200000, 1690329600000, 1640908800000, 1424649600000, 1535760000000, 1535760000000, 1596240000000, 1427760000000, 1523664000000, 1561852800000, 1560816000000, 1638230400000, 1625529600000, 1578614400000, 1600041600000, 1600041600000, 1330041600000, 1354147200000, 1546819200000, 1546819200000, 1382400000000, 1659225600000, 1564531200000, 1417305600000, 1425427200000, 1475280000000, 1690848000000, 1604102400000, 1536192000000, 1596153600000, 1609718400000, 1577836800000, 1696204800000, 1696550400000, 1422748800000, 1535587200000, 1539129600000, 1601510400000, 1594339200000, 1594339200000, 1380585600000, 1676246400000, 1676246400000, 1656633600000, 1656633600000, 1199145600000, 1633478400000, 1474416000000, 1617235200000, 1617235200000, 1354233600000, 1410739200000, 1561939200000, 1635638400000, 1541116800000, 1543622400000, 1487289600000, 1505520000000, 1623628800000, 1561939200000, 1415059200000, 1501459200000, 1604188800000, 1551398400000, 1661212800000, 1538352000000, 1575244800000, 1659225600000, 1580342400000, 1648771200000, 1409529600000, 1653696000000, 1635811200000, 1397606400000, 1637712000000, 1684972800000, 1578873600000, 1630454400000, 1580515200000, 1506988800000, 1400889600000, 1569024000000, 1646697600000, 1630454400000, 1696291200000, 1454198400000, 1315699200000, 1640995200000, 1448928000000, 1304208000000, 1520467200000, 1577664000000, 1479513600000, 1481587200000, 1659225600000, 1484438400000, 1515974400000, 1546214400000, 1359676800000, 1272672000000, 1565654400000, 1685145600000, 1685145600000, 1594771200000, 1605571200000, 1604188800000, 1556755200000, 1389571200000, 1598486400000, 1613606400000, 1558137600000, 1551139200000, 1496188800000, 1388448000000, 1512086400000, 1604275200000, 1553817600000, 1598918400000, 1501027200000, 1568678400000, 1568678400000, 1569801600000, 1664582400000, 1609372800000, 1535414400000, 1405382400000, 1405382400000, 1265328000000, 1632700800000, 1491004800000, 1483142400000, 1508112000000, 1569369600000, 1503360000000, 1658448000000, 1543622400000, 1501545600000, 1501545600000, 1692230400000, 1427846400000, 1354320000000, 1483228800000, 1562889600000, 1700006400000, 1404172800000, 1427932800000, 1409443200000, 1341100800000, 1283299200000, 1480464000000, 1314748800000, 1569888000000, 1321574400000, 1386806400000, 1635811200000, 1473638400000, 1640908800000, 1490572800000, 1654214400000, 1451520000000, 1471219200000, 1455840000000, 1644537600000, 1491004800000, 1364774400000, 1362096000000, 1380585600000, 1646006400000, 1293753600000, 1684454400000, 1519862400000, 1295222400000, 1485648000000, 1519776000000, 1634169600000, 1656979200000, 1568073600000, 1238544000000, 1354665600000, 1488326400000, 1475193600000, 1478044800000, 1504137600000, 1398816000000, 1613520000000, 1452211200000, 1565827200000, 1672444800000, 1555286400000, 1634342400000, 1448928000000, 1399680000000, 1568073600000, 1568073600000, 1605830400000, 1404086400000, 1453075200000, 1536278400000, 1580774400000, 1625097600000, 1610409600000, 1640908800000, 1419811200000, 1498867200000, 1619049600000, 1522454400000, 1404518400000, 1412121600000, 1593388800000, 1401494400000, 1458086400000, 1527033600000, 1646092800000, 1548979200000, 1577750400000, 1358208000000, 1354233600000, 1390003200000, 1634342400000, 1634342400000, 1618963200000, 1633996800000, 1502841600000, 1522454400000, 1433376000000, 1515369600000, 1451520000000, 1335744000000, 1293840000000, 1609372800000, 1399593600000, 1586995200000, 1488153600000, 1349049600000, 1485734400000, 1467331200000, 1693526400000, 1415836800000, 1335916800000, 1330300800000, 1536710400000, 1428192000000, 1696291200000, 1367280000000, 1630454400000, 1694044800000, 1693526400000, 1397606400000, 1422144000000, 1529625600000, 1363305600000, 1399334400000, 1673481600000, 1673481600000, 1681257600000, 1433116800000, 1364774400000, 1398902400000, 1664582400000, 1664582400000, 1363564800000, 1404172800000, 1287100800000, 1289088000000, 1579046400000, 1575244800000, 1305590400000, 1609372800000, 1331510400000, 1331510400000, 1291852800000, 1364688000000, 1389225600000, 1288742400000, 1346457600000, 1286928000000, 1288569600000, 1569888000000, 1569888000000, 1348531200000, 1598918400000, 1425081600000, 1640649600000, 1640649600000, 1478390400000, 1319932800000, 1319932800000, 1318982400000, 1290816000000, 1493510400000, 1609372800000, 1350950400000, 1356998400000, 1648598400000, 1648598400000, 1473811200000, 1553817600000, 1371168000000, 1470096000000, 1526342400000, 1585785600000, 1312156800000, 1331251200000, 1335916800000, 1301011200000, 1468281600000, 1468281600000, 1637798400000, 1444262400000, 1379376000000, 1575072000000, 1363046400000, 1358467200000, 1697068800000, 1506816000000, 1592611200000, 1592611200000, 1338508800000, 1438300800000, 1298332800000, 1299024000000, 1325289600000, 1569801600000, 1297641600000, 1346371200000, 1524182400000, 1349049600000, 1349049600000, 1309478400000, 1666915200000, 1572566400000, 1572566400000, 1404172800000, 1404172800000, 1576627200000, 1304899200000, 1307404800000, 1302566400000, 1640822400000, 1347494400000, 1383782400000, 1510531200000, 1524441600000, 1524441600000, 1417305600000, 1488240000000, 1475193600000, 1393545600000, 1332288000000, 1396224000000, 1301616000000, 1406764800000, 1443657600000, 1377907200000, 1306886400000, 1427760000000, 1456704000000, 1456704000000, 1498780800000, 1467331200000, 1307404800000, 1695945600000, 1306454400000, 1664928000000, 1685491200000, 1338336000000, 1556755200000, 1556755200000, 1493683200000, 1384041600000, 1309478400000, 1520208000000, 1609372800000, 1514764800000, 1522108800000, 1633046400000, 1686096000000, 1493164800000, 1643760000000, 1646611200000, 1309478400000, 1451606400000, 1451606400000, 1319414400000, 1488672000000, 1575158400000, 1575158400000, 1514678400000, 1314230400000, 1314316800000, 1524009600000, 1609459200000, 1572912000000, 1315785600000, 1451520000000, 1697414400000, 1362441600000, 1459382400000, 1361145600000, 1318291200000, 1577750400000, 1506211200000, 1342396800000, 1360454400000, 1577750400000, 1588291200000, 1317427200000, 1346457600000, 1373241600000, 1335744000000, 1341187200000, 1567468800000, 1318809600000, 1330300800000, 1620777600000, 1638316800000, 1322697600000, 1387497600000, 1474848000000, 1507334400000, 1510099200000, 1371772800000, 1640908800000, 1322697600000, 1323043200000, 1375315200000, 1606521600000, 1548892800000, 1546300800000, 1414713600000, 1325376000000, 1622419200000, 1415059200000, 1519776000000, 1491868800000, 1609372800000, 1372032000000, 1377648000000, 1388448000000, 1363824000000, 1548979200000, 1406764800000, 1514764800000, 1328054400000, 1634688000000, 1634688000000, 1378857600000, 1476230400000, 1404086400000, 1620086400000, 1420848000000, 1463702400000, 1491782400000, 1629936000000, 1359244800000, 1597708800000, 1334102400000, 1333238400000, 1430438400000, 1347321600000, 1580515200000, 1675209600000, 1335916800000, 1601683200000, 1443571200000, 1483142400000, 1496707200000, 1498867200000, 1426636800000, 1640908800000, 1414800000000, 1522454400000, 1338508800000, 1364860800000, 1451520000000, 1333238400000, 1645401600000, 1351641600000, 1341878400000, 1341100800000, 1496793600000, 1656633600000, 1343779200000, 1342137600000, 1467676800000, 1377993600000, 1345507200000, 1401667200000, 1430611200000, 1679356800000, 1534550400000, 1346457600000, 1346457600000, 1483142400000, 1447545600000, 1447545600000, 1443657600000, 1388448000000, 1346457600000, 1624838400000, 1624838400000, 1370044800000, 1488844800000, 1346457600000, 1472688000000, 1481155200000, 1537401600000, 1647302400000, 1461974400000, 1575504000000, 1575504000000, 1617148800000, 1653955200000, 1350345600000, 1672617600000, 1430352000000, 1372204800000, 1425945600000, 1459468800000, 1524182400000, 1524182400000, 1378771200000, 1378771200000, 1361318400000, 1361318400000, 1431648000000, 1349049600000, 1459382400000, 1629763200000, 1629763200000, 1607904000000, 1607904000000, 1368403200000, 1360022400000, 1367366400000, 1350432000000, 1349049600000, 1398902400000, 1401494400000, 1377648000000, 1388448000000, 1467331200000, 1509408000000, 1402272000000, 1354320000000, 1682553600000, 1410480000000, 1351728000000, 1392681600000, 1355529600000, 1372636800000, 1384041600000, 1354579200000, 1357516800000, 1383523200000, 1395187200000, 1494547200000, 1670544000000, 1619395200000, 1564617600000, 1625702400000, 1686268800000, 1441065600000, 1535932800000, 1360281600000, 1358380800000, 1528675200000, 1483142400000, 1385078400000, 1393632000000, 1361318400000, 1469923200000, 1619740800000, 1469404800000, 1554076800000, 1387065600000, 1688169600000, 1380672000000, 1696550400000, 1696550400000, 1369094400000, 1509494400000, 1509494400000, 1676505600000, 1676505600000, 1483142400000, 1364860800000, 1365120000000, 1642982400000, 1672444800000, 1397606400000, 1388448000000, 1379289600000, 1393632000000, 1379376000000, 1413849600000, 1365120000000, 1548979200000, 1367452800000, 1498867200000, 1498867200000, 1436918400000, 1639440000000, 1472601600000, 1434412800000, 1674864000000, 1674864000000, 1609372800000, 1635724800000, 1635724800000, 1371081600000, 1569283200000, 1598486400000, 1372636800000, 1463011200000, 1463011200000, 1538524800000, 1677628800000, 1374451200000, 1429833600000, 1377907200000, 1675209600000, 1569888000000, 1569888000000, 1375488000000, 1402963200000, 1375315200000, 1397692800000, 1435795200000, 1435795200000, 1529539200000, 1529539200000, 1392336000000, 1433030400000, 1679443200000, 1409529600000, 1375315200000, 1494979200000, 1546387200000, 1546387200000, 1401062400000, 1449446400000, 1585612800000, 1666828800000, 1525132800000, 1617235200000, 1380326400000, 1688083200000, 1379462400000, 1390867200000, 1614556800000, 1614556800000, 1439251200000, 1377993600000, 1391212800000, 1443571200000, 1380585600000, 1443571200000, 1567296000000, 1438387200000, 1380585600000, 1681344000000, 1401580800000, 1514764800000, 1514764800000, 1641254400000, 1496188800000, 1443571200000, 1382486400000, 1443657600000, 1679875200000, 1648771200000, 1648771200000, 1383523200000, 1381968000000, 1380585600000, 1383350400000, 1440201600000, 1383523200000, 1383350400000, 1386892800000, 1448496000000, 1643673600000, 1384041600000, 1385856000000, 1577750400000, 1440028800000, 1448928000000, 1474329600000, 1615161600000, 1615161600000, 1566864000000, 1680220800000, 1412121600000, 1559347200000, 1427932800000, 1439856000000, 1459468800000, 1391212800000, 1411689600000, 1441065600000, 1441065600000, 1396224000000, 1483142400000, 1664496000000, 1486684800000, 1544054400000, 1544054400000, 1674950400000, 1597881600000, 1668384000000, 1416441600000, 1556668800000, 1417392000000, 1432684800000, 1500249600000, 1466899200000, 1466899200000, 1425859200000, 1484870400000, 1396310400000, 1539561600000, 1539561600000, 1577750400000, 1465603200000, 1465603200000, 1544745600000, 1387152000000, 1454889600000, 1537747200000, 1537747200000, 1425945600000, 1506816000000, 1396224000000, 1606780800000, 1606780800000, 1602633600000, 1675123200000, 1543622400000, 1398988800000, 1659916800000, 1401753600000, 1422662400000, 1576713600000, 1401580800000, 1436486400000, 1425513600000, 1472688000000, 1441065600000, 1650499200000, 1640908800000, 1404172800000, 1501891200000, 1653868800000, 1514764800000, 1582934400000, 1438387200000, 1575072000000, 1522540800000, 1621555200000, 1621555200000, 1629763200000, 1516752000000, 1516752000000, 1451520000000, 1406505600000, 1582848000000, 1534118400000, 1403654400000, 1577750400000, 1422748800000, 1506729600000, 1435536000000, 1650412800000, 1650412800000, 1540425600000, 1413158400000, 1604188800000, 1413331200000, 1608249600000, 1633910400000, 1412208000000, 1545350400000, 1466467200000, 1438300800000, 1413244800000, 1470009600000, 1470009600000, 1416873600000, 1442793600000, 1480550400000, 1533081600000, 1533081600000, 1417392000000, 1452556800000, 1488499200000, 1415750400000, 1416441600000, 1505433600000, 1505433600000, 1627776000000, 1551744000000, 1701043200000, 1497830400000, 1454198400000, 1509408000000, 1614556800000, 1614556800000, 1417392000000, 1420070400000, 1609372800000, 1419033600000, 1418688000000, 1577750400000, 1551312000000, 1528675200000, 1577750400000, 1596585600000, 1545350400000, 1422748800000, 1577750400000, 1514764800000, 1542412800000, 1446163200000, 1648771200000, 1648771200000, 1514764800000, 1514764800000, 1425168000000, 1509148800000, 1685404800000, 1656633600000, 1690848000000, 1428192000000, 1425340800000, 1506384000000, 1516924800000, 1570233600000, 1443657600000, 1428883200000, 1593475200000, 1467676800000, 1501459200000, 1682899200000, 1465516800000, 1546214400000, 1664496000000, 1527552000000, 1527552000000, 1424044800000, 1483142400000, 1514505600000, 1429056000000, 1542844800000, 1633046400000, 1664582400000, 1451520000000, 1630368000000, 1548374400000, 1486944000000, 1551657600000, 1589414400000, 1470096000000, 1470096000000, 1433548800000, 1630454400000, 1630454400000, 1625097600000, 1439164800000, 1522454400000, 1441065600000, 1438387200000, 1527724800000, 1438387200000, 1440374400000, 1595203200000, 1609459200000, 1465603200000, 1473033600000, 1483488000000, 1483488000000, 1495756800000, 1561248000000, 1445299200000, 1443657600000, 1514678400000, 1601251200000, 1441929600000, 1446336000000, 1464652800000, 1467676800000, 1619827200000, 1492992000000, 1446508800000, 1506297600000, 1541548800000, 1631664000000, 1598918400000, 1598918400000, 1556150400000, 1556150400000, 1482019200000, 1449187200000, 1501632000000, 1451606400000, 1609372800000, 1599004800000, 1541635200000, 1553558400000, 1452816000000, 1544486400000, 1457222400000, 1617148800000, 1455580800000, 1630368000000, 1459468800000, 1506729600000, 1662422400000, 1546214400000, 1501545600000, 1464739200000, 1597795200000, 1531180800000, 1674604800000, 1674604800000, 1491004800000, 1548979200000, 1658793600000, 1472688000000, 1687478400000, 1486339200000, 1502841600000, 1551312000000, 1689552000000, 1689552000000, 1525219200000, 1606780800000, 1630368000000, 1470009600000, 1485648000000, 1546300800000, 1668729600000, 1467331200000, 1490918400000, 1470009600000, 1483228800000, 1483228800000, 1577664000000, 1643760000000, 1643760000000, 1477958400000, 1684281600000, 1556668800000, 1484352000000, 1514678400000, 1490832000000, 1609372800000, 1690243200000, 1609372800000, 1479168000000, 1477958400000, 1489968000000, 1537142400000, 1537142400000, 1481155200000, 1504569600000, 1664582400000, 1491350400000, 1548028800000, 1548028800000, 1515974400000, 1654473600000, 1497830400000, 1483315200000, 1483315200000, 1554076800000, 1522195200000, 1599955200000, 1531699200000, 1483228800000, 1671494400000, 1601424000000, 1533081600000, 1486598400000, 1488326400000, 1638403200000, 1491004800000, 1491004800000, 1489104000000, 1493164800000, 1491177600000, 1501459200000, 1510876800000, 1493596800000, 1579219200000, 1491955200000, 1498867200000, 1491004800000, 1491004800000, 1664582400000, 1664582400000, 1603065600000, 1629158400000, 1610323200000, 1498780800000, 1575158400000, 1491004800000, 1496016000000, 1604966400000, 1569888000000, 1498003200000, 1498867200000, 1501545600000, 1529366400000, 1496275200000, 1553904000000, 1501545600000, 1496707200000, 1609372800000, 1498867200000, 1504224000000, 1646092800000, 1646092800000, 1509580800000, 1506816000000, 1506816000000, 1506902400000, 1575158400000, 1506988800000, 1511136000000, 1609372800000, 1508889600000, 1509580800000, 1683590400000, 1684886400000, 1654041600000, 1509580800000, 1510876800000, 1512086400000, 1688774400000, 1530403200000, 1569801600000, 1671408000000, 1533081600000, 1533081600000, 1517443200000, 1569628800000, 1517443200000, 1638316800000, 1517443200000, 1520208000000, 1519862400000, 1523404800000, 1547424000000, 1596240000000, 1668038400000, 1535500800000, 1529884800000, 1526601600000, 1672444800000, 1541980800000, 1567296000000, 1681862400000, 1681862400000, 1637193600000, 1533600000000, 1552608000000, 1530403200000, 1530403200000, 1661990400000, 1535673600000, 1555545600000, 1530403200000, 1533081600000, 1678147200000, 1535760000000, 1536019200000, 1627948800000, 1593561600000, 1608076800000, 1608076800000, 1538352000000, 1621296000000, 1538352000000, 1609372800000, 1627776000000, 1540857600000, 1598918400000, 1685577600000, 1542067200000, 1543622400000, 1566518400000, 1546300800000, 1556668800000, 1609459200000, 1546300800000, 1633046400000, 1639785600000, 1639785600000, 1548979200000, 1548979200000, 1583020800000, 1660089600000, 1660089600000, 1547424000000, 1548979200000, 1548979200000, 1556755200000, 1651363200000, 1559606400000, 1551657600000, 1550534400000, 1549670400000, 1638230400000, 1593388800000, 1557360000000, 1595376000000, 1595376000000, 1661990400000, 1602547200000, 1559606400000, 1562025600000, 1560124800000, 1562025600000, 1561939200000, 1571616000000, 1634515200000, 1564617600000, 1670803200000, 1670803200000, 1566172800000, 1567296000000, 1632700800000, 1568678400000, 1640908800000, 1569888000000, 1593129600000, 1572566400000, 1617235200000, 1571011200000, 1640908800000, 1572566400000, 1570579200000, 1572825600000, 1656547200000, 1573776000000, 1605139200000, 1683676800000, 1683676800000, 1648684800000, 1575244800000, 1640908800000, 1576713600000, 1583193600000, 1580515200000, 1618790400000, 1620000000000, 1578355200000, 1577923200000, 1597363200000, 1597363200000, 1583712000000, 1589155200000, 1584230400000, 1593475200000, 1589241600000, 1589155200000, 1680220800000, 1672099200000, 1616803200000, 1597708800000, 1630454400000, 1635292800000, 1593561600000, 1640908800000, 1593475200000, 1602806400000, 1602806400000, 1597017600000, 1639353600000, 1643673600000, 1628121600000, 1601510400000, 1629072000000, 1646092800000, 1605139200000, 1654041600000, 1654041600000, 1600646400000, 1640908800000, 1610150400000, 1605139200000, 1638748800000, 1638748800000, 1609459200000, 1629072000000, 1643932800000, 1670198400000, 1606780800000, 1606780800000, 1607904000000, 1613433600000, 1671148800000, 1612137600000, 1622419200000, 1614556800000, 1618185600000, 1699228800000, 1577836800000, 1577836800000, 1617235200000, 1630627200000, 1630627200000, 1617235200000, 1614902400000, 1614556800000, 1623715200000, 1620086400000, 1626220800000, 1623628800000, 1627689600000, 1626825600000, 1632096000000, 1635724800000, 1636329600000, 1633046400000, 1633046400000, 1635724800000, 1633910400000, 1633046400000, 1638316800000, 1638835200000, 1675209600000, 1693267200000, 1643673600000, 1696809600000, 1646092800000, 1646006400000, 1700092800000, 1642377600000, 1692662400000, 1647388800000, 1648771200000, 1648771200000, 1648512000000, 1641772800000, 1661990400000, 1649376000000, 1651363200000, 1652918400000, 1653868800000, 1651449600000, 1677628800000, 1656633600000, 1664582400000, 1655078400000, 1663804800000, 1658793600000, 1661990400000, 1657497600000, 1664582400000, 1661990400000, 1664755200000, 1664582400000, 1662336000000, 1664582400000, 1663718400000, 1667347200000, 1664236800000, 1667260800000, 1665360000000, 1666569600000, 1667260800000, 1667779200000, 1668556800000, 1669852800000, 1675296000000, 1675209600000, 1674518400000, 1675209600000, 1673827200000, 1672704000000, 1672272000000, 1688083200000, 1677628800000, 1680307200000, 1680307200000, 1680307200000, 1680739200000, 1680739200000, 1685059200000, 1686528000000, 1687219200000, 1689206400000, 1686096000000, 1688515200000, 1689033600000, 1693526400000, 1693526400000, 1690848000000, 1696204800000, 1696204800000, 1696204800000, 1696377600000, 1697414400000, 1696464000000], "enseigne1Etablissement": [null, "SUPER AC TIFF", "SYMPA'TIFS", "DIMINU'TIF", null, null, "ACTIF NEUF COIFFURE", null, null, "CREATIFS", null, null, "INFINI-TIF", null, "CREA'TIF", "CREA TIF COIFFURE", null, "COIFFURE A DOMICILE", null, null, null, null, null, "MAXITIF S", null, "LA BOITE A TIFS", null, "COIF' TIF", "TIF'ALINE", null, null, "INOVA'TIF", null, null, "TIFFANNIE COIFFURE", null, "ODILE COUP'TIFS", "ODILE COUP'TIFS", null, null, "COIFFURE ISATIFS", null, "CREA TIF", "DIMINU-TIFS", "SYMPATIF", null, null, "TIFF-YZA", null, null, null, "GRAFFI.TIF", "CLAFOU'TIFS", null, null, "DIMINU'TIFS", null, null, null, "ALTERNA'TIFFS", "YSATIF", "ATELIR CREA'TIF", "CREATIF-CONCEPT STORE", null, null, null, null, "COUP'TIF", "COUP'TIF", null, "MISS CREATIF", "TIF'FANNY COIFFURE", "IMAGI'NATH'TIF", "SALON COUP'TIFF", "IMAGINA TIF COIFFURE", null, "SCISSORS", null, "ATTENT'TIFS", "IMAGINA'TIF", null, null, null, null, null, "CRAZI TIFS", "CHRIS'TIF", "CHRIS'TIF COIFFURE'", "CHRIS'TIF COIFFURE'", "SERINY'TIFS COIFFURE", "SERINY'TIFS COIFFURE", null, "EVOLU'TIFS", "CREATIF", "CREATIF", null, null, null, null, "DIMINU'TIFS", null, null, "SALON IMAGINA'TIFFS", null, null, "SALON JACQUES ET YVETTE", "CREA'TIF COIFFURE", "A.C. TIF COIFFURE / PERRUQUIER", null, "TIFF ET TEA", null, "LIBER'TIFS", null, null, "CREA TIFS COIFFURE", "INFINI'TIF", "EVOLU'TIF", "DIMINU-TIF", null, null, null, "BEAUTIFUL PEOPLE COIFFURE", null, "COUP'TIFS", null, null, "STYLE QREATIFS", null, "AC'TIF COIFFURE", null, null, "ELIE'TIFF", "ACTIF COIFFURE", "ACTIF COIFFURE", null, "PERFEC'TIF", "CREA'TIF SALON", null, null, "IMAGINA'TIF", null, null, null, null, null, "DIMINUTIF COIFFURE", null, "POSI'TIF MASSAGE", "CAPTIFSALON", "ESPRIT CREA'TIF", "REFLETS D'AME", null, "CREA'TIFS COIFFURE", null, null, null, null, null, "LA BOITE A TIFS", null, null, null, null, null, "TIFF ON LINE", null, "IMAGINA'TIF", "NOUVEL HAIR", "IMAGINATIF", "COLOR CREA'TIFS", null, "DIMINU'TIF", null, null, null, null, null, null, "BEA'TIF", null, null, "L'ESPACE A TIFS", null, null, null, null, "BOITE A TIF", "MINA TIFS COIFF", "CREA'TIFS JOSELITA", null, null, null, "POSI'TIF", "AUTHEN'TIF", null, "CREATIF", "LISS' TIF", null, null, "BIOTIFUL HAIR", null, null, null, "CREA'TIFS", null, null, null, "KREATIFS", null, null, "S'TIFANY", null, "KOUPTOUTIF", null, "CREA TIF LORENA", "AC'TIF COIFFURE", "INFINI TIF", "SALON DEFINITIF", null, null, "CAP TIF", null, null, null, null, null, "SYMPA'TIF", null, "BEAUTY ACCESS BY MANZIA TIFS", null, null, null, null, null, null, "NATH'COIFFURE", "SYMPATIFS", "INSTINCTIF", "CREA'TIFS 1 - CREA'TIFS 2 - CREA'TIFS", null, null, null, null, null, null, "CREA'TIF", null, null, null, null, null, null, null, null, "STYLE' TIF", "ART STYLE BEAUTE ASB", "INFINI'TIF", null, null, null, "CREATIF", null, "SELEC'TIFS", null, null, "NAI COIFFURE", "CREATIF HAIR", "CREATIF HAIR", "CREATIF HAIR", null, "INVEN'TIFS", "TIFFANY'S COIFFURE", "CAPE'TIF", null, null, "INSTINC'TIF", "NAT TIF", "INSTINCT'TIF", null, "CREA TIFS", "CREA TIF", "POLLIATIF", "LIL ' O ' TIF BY NANY TATTOO", "COMPETI-TIFF", null, null, null, null, null, null, null, null, null, null, "CREATIF", "ATTEN'TIF", "L'INDIKA'TIF", "PORTE . A . TIF.COIFFURE A DOMICILE", "PORTE . A . TIF.COIFFURE A DOMICILE", "SALON C'TIF HAIR", "EVOLU'TIF", null, null, null, "IMAGINATIFF'", null, null, "KREA'TIFS", null, null, null, null, null, "LIBER'TIF", "ROCK'N'TIFF", "INSTINC'TIF", "CREA'TIF", null, null, "TIC'TAC'TIFS", "LM CREATIF COIFFURE MIXTE", "ATTRAC'TIF", null, null, "TIF ET COMPAGNIE", null, "IMAGINATIF", null, null, "FOLGA'TIF", null, null, null, null, null, "AMBIANCE TIF COIFFURE", "BIOTIFUL HAIR", null, "TIFS A DOM", "IMAGINA'TIF", null, "TIFS  CO", null, "L-B COIFFURE", "FAUDRA TIF HAIR", null, null, "LE COUPT'TIF", null, null, null, null, null, null, null, null, null, "EVA' TIF", null, null, null, null, null, "TIF'ANNICK", null, null, null, null, null, null, null, null, null, null, null, null, null, null, "ALEXIA COIFFURE - TIFF EN FOLIE", null, null, null, null, null, "DIVINYTIF", null, null, null, null, null, "FLO CREA TIFS", null, null, null, null, null, null, "NEW'TIF", "INVENTIF", null, null, null, null, "KREATIFS COIFFURE", "CELI'TIFF", null, "SALON LIFT'TIFF", "SCULP'TIF", null, null, null, null, null, null, "CELINE CREA'TIF", "KREA TIF COIFFURE", null, null, "ESTHETIF", null, null, "AIR CREA'TIF", null, null, "INTUITIF'S", null, null, "INSTANT CREA'TIF", "DIMINUTIF", "ESPACE CREATIF", "EVOLU'TIF", null, "MIMI CREATIF", null, null, null, "HAIR CREATIF", null, null, "ACTIF", "C INSTINC TIF", "C INSTINC TIF", "C INSTINC TIF", "ABSOLU'TIFS", null, null, null, null, null, null, null, null, "FAUDRA'TIF'HAIR", "HELITIF", null, "EXPERT'TIFS", null, "RELOOK TIF", null, null, "INFINI'TIFF", null, null, "INSTINCTIF COIFFURE", null, null, "COLOR TIFF", "COLOR TIFF", "COLOR TIFF", null, "L'ATELIER DU TIFF", null, null, null, null, null, null, "SO BEAUTIFUL COIFFURE", null, null, null, "MISSTIF", null, null, null, null, null, null, null, null, null, null, null, "LIBER'TIF", "LIBER'TIF", "AD'I'TIF COIFFURE", null, null, "MINATIF", null, null, null, null, null, null, null, null, "EXOS'TIF", "EXOS'TIF", null, null, null, null, "TIF & TOI", null, "DIMINU TIF", null, "TIF'CREATION", "TIF'CREATION", null, null, "TIF ET TIF ET COLEGRAM", "INFINI'TIFS", null, null, null, "SEDUC'TIF", null, null, null, "PRO DU TIF", null, null, null, null, null, null, null, null, "EVOLUTIF", null, null, "EVOLU'TIF", "EVOLU'TIF", "BE BEAUTIFUL", "BE BEAUTIFUL", null, null, null, null, null, null, null, "BEA'TIF", null, "EVA CREATIF", null, null, "CREA 'TIF ONGLE", null, "CREA TIF", null, null, "LAETIFF'COIFFURE", "LAETIFF'COIFFURE", "LAETIFF'COIFFURE", "INFINI'TIFS", "INFINI'TIFS", null, null, null, null, null, "INTUIT'TIF COIFFURE", "VERONI TIF", null, null, "EVOLU TIF", "COIF'CREATIF", "ARTISTIF", "ARTISTIF", "INTUITIFS", "INTUITIFS", null, "INFINI TIFS", null, null, "CREA'TIFF", null, null, null, null, null, "INTUI'TIF COIFFURE", null, "COIFF CREATIF", null, null, "LA BOITE A TIF", null, null, "SMILE CREA TIFF", "LE DIMINU'TIF", null, null, "TIF & CO", "TIF & CO", "REFLET CREATIF", "CREA'TIF", "ATTRAC'TIF COIFFURE A DOMICILE", null, null, null, null, null, null, null, null, null, null, null, null, null, "MAXIMILIEN", null, "NICE AND BEAUTIFUL", null, "CREA'TIFS", "CREA'TIFS", "ADDICT TIF", null, null, null, "ATTRAC'TIFS", null, null, "ANO' TIFS", null, null, null, null, null, null, "ATTRAC TIF", null, "IMAGINA'TIF", "EMBELLI'TIF", null, "INVENTIF", "INVENTIF", null, "POSI'TIFS COIFFURE A DOMICILE", "DIMINU-TIFS", "ABSOLU TIFS", null, null, "DYNAMI' TIF", "MARY CREA TIF'", null, null, null, null, null, null, null, null, null, null, null, null, null, "AC'TIFS", "A.T.TIFS", null, null, null, null, null, null, "BEAUTIFUL GARDEN", "COIN EMOTIFF", null, null, null, null, null, "FRANCESCA CREA TIF", null, "L'ATELIER CREA'TIF", null, null, "RETROACTIF", null, null, null, null, null, null, null, null, null, null, null, null, "INFINI'TIF", null, null, null, null, "INFINITIF COIFFURE", "INFINITIF COIFFURE", null, null, null, null, "INSTINC'TIF", "CREA'TIF", null, null, null, null, null, "JENY STUDIO CREA TIF", "LES CISEAUX CREA'TIFS", "CREA'TIF BEAUTE", null, "CREA'TIF COIFFURE", "CREA'TIF COIFFURE", null, "INFINI'TIFF", "INFINI'TIFF", null, "ARTISTE CREA'TIF", "DELFINY TIFF COIFFURE", null, null, null, null, null, null, "ELI'TIF", null, "ADMIRATIFS", "CREATIF COIFFURE", "CREATIF COIFFURE", null, null, null, "EMO'TIF", "EMO'TIF", "TIFFANY", "TIFFANY", null, null, "TIF'AND GEL", "TIF'AND GEL", null, null, null, null, "L'ART DES TIFS", null, null, null, null, null, null, null, null, null, null, null, null, null, null, "ACTIF COIFFURE", null, null, null, null, null, null, null, "AMETIFS", "COUP'TIFF92", null, "COIFFEUSE A DOMICILE", null, null, null, "EVOLU TIF", "EVOLU TIF", null, null, "MO'TIFF", null, "COLORA'TIF", "INTUI'TIF", null, "COIFFEUSE A DOMICILE", "MISS TIFS", null, "MOKATIF'S", null, null, null, "CREA'TIF", null, null, null, null, null, null, null, "INTUI'TIF", "SUBLIM TIFF", null, "TIFF ANNE", null, null, "ACTIF COIFFURE", null, "AFFINI'TIF", "ZENI'TIF", "BIO TIF FOULE", "INOVA'TIF", null, "POSI TIF COIFFURE", "POSI TIF COIFFURE", null, null, null, "IMAGINA'TIF", null, null, null, null, null, null, "JULY CREA'TIFF", null, null, null, "DALLAS'TIFFS", "DALLAS'TIFFS", null, "BELV HAIR TIF", null, "FUHR'TIFF", null, null, null, null, "CO TIF", "SYMPAT'TIFS", "SYMPAT'TIFS", null, null, null, null, null, null, "JUSTIF D COIFF", null, null, "EVOLUTIF", null, null, null, "CREA'TIFS NAILS", "ARTIFICE COIFF", null, null, null, "TIFF&CO", null, null, null, null, null, null, null, null, "DEFINI'TIF", null, null, "ADMIRA'TIFS", null, null, null, null, null, null, "EMOTIF COIFFURE", "EMOTIIF COIFFURE", "POISYTIF", null, null, null, null, null, null, "COIFFURE EVOLUTIF", null, null, "DEFINI'TIF", null, null, null, null, null, "CREA'TIFS & ONGLES", "CREA'TIFS & ONGLES", "CREA'TIFS & ONGLES", null, null, null, null, null, null, null, null, "MOBIL'TIFS", null, null, "INFINI'TIF", null, null, "MISSTIF COIFFURE", "MANIA TIF", null, null, "IMAGINATIF", null, null, "COLORA'TIF COIFFURE", "TIF'  EN MELEE", "COUPE TIFF", "FASHION AND CREA'TIFF", "FASHION AND CREA'TIFF", null, null, null, null, null, "MOTIF COIFFURE", null, null, null, "COUPE'TIF", "COUPE'TIF", null, null, null, null, null, null, null, null, null, null, null, null, null, "ABSOLU'TIFS", null, null, null, null, "FAMILY'TIFS", null, null, null, null, null, null, "LA FIRME A TIFS'", null, null, null, null, null, "L'ATELIER TIF & CO", null, null, "DIMINU'TIF", "DIMINUTIF", "DIMINUTIF", "INSTINCT.TIF'", null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, "REVELA'TIF", null, "MISS'TIF", null, null, null, "REACTIF", "REACTIF", "L'ATELIER CREA-TIF BEAUTE", "ADDICTIF' COIFFURE", "SYMPA'TIFS", "GRAFFI TIFS", null, null, "ACTIFF'S COIFFURE", null, null, null, null, null, null, null, "LOOK A TIFS", null, null, null, null, null, "MANIA'TIF", null, null, null, null, null, null, null, null, null, null, null, "ADDIC'TIF", null, null, null, null, null, null, null, "ATTRAC'TIFS", null, "LA BOITE A TIF'S", "LA BOITE A TIF'S", null, null, null, "COIFFURE A DOMICILE", "SCULP'TIF", null, null, "SUBLIM TIFF'", "SALON CREATIF", "ATTRAC'TIFF", null, "DIMINUTIF", "INSTINC'TIF", null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, "L'INSTINCT CREATIF", "CREATIF' COIFFURE", "CREATIF'", null, null, null, null, null, null, "CARRE TIF", "CARRE TIF", null, null, null, null, null, null, null, "INSTINC TIF MC", null, "AINSI SOIT TIFF", null, null, "ATELIER CREA'TIF", null, null, null, "PHILCREA'TIF", "PHILCREA'TIF", null, "A TEMPS TIF COIFFURE", null, null, null, "INVEN'TIF", null, null, "EVOLU'TIF", null, null, null, null, null, null, null, null, "ESPACE CREA' TIF", null, null, "CHEZ LE COUPE TIF'", null, null, null, null, "INTUI'TIFS", null, null, null, null, null, null, null, null, null, "SEV CREA TIFS", null, "CREATIF 94", null, "UN VENT'TIF", null, null, null, "QUALITA'TIF", null, "CREATIFF COIFFURE", "CREA'TIF 92", "COUPE'TIF", null, null, "MO TIF", null, null, null, "CREATIF'HAIR C", null, null, null, null, "EVOLU'TIFS", "EVOLU'TIFS", "AJUST'TIF", "CREA'TIF'DOMICILE", null, null, null, "INSTINC'TIF65", "INSTINC'TIF65", null, "CREA TIF", "COIFFURE DIMINU'TIFS", "COIFFURE INSTINC'TIF", "UN HAIR CREATIF", null, null, null, "A TRAC TIF", "EVOLUTIF", null, null, "ELO'TIFS", null, null, null, null, "ESPACE CREATIF", null, null, null, null, "ADMIRA TIF COIFFURE", "EXAUCE'TIF", null, null, null, null, null, null, null, null, null, null, null, null, null, null, "STEF' TIF COIFFURE", "C'DUC'TIFS", null, null, null, null, null, null, "FANTAS'TIF", null, null, "LENO'TIFS", "GRAPHY'TIFS", null, null, "IMAGINA'TIF", null, "OBJECTIF COIFFURE", "INFINITIFS", "COUPE-TIF", null, null, null, null, "ATRAK TIFS", "L'INSTANTIFS", null, null, "ALEXIA CREA'TIF", "ALEXIA CREA'TIF", null, null, null, null, null, null, null, "EVOLUTIF", "CREATIF", null, null, null, null, null, null, null, "CED'A TIF", null, null, null, "OBJEC'TIF COIFFEUR", "DIMINU'TIFS", null, null, null, null, "INSTINC'TIFS", null, null, null, "LA BULLE DE TIF", "LA BULLE DE TIF", "CHIC'TIF", null, null, null, null, null, null, null, null, null, "TIFFANYECO", null, null, "CREA'TIF", null, null, "CREATIFF HB", "AC'TIF", null, null, null, null, "L'HAIR CREATIF", null, null, null, "VIVA LA VIE BY IMAGINA'TIF", null, null, null, null, null, null, null, null, null, null, null, null, "AC'TIF COIFFURE", null, null, null, null, null, null, null, null, "SYMPA'TIFS BY ANNE", null, null, null, "FA'MILIE TIFS", null, null, null, null, "INSTINCT'TIF", null, null, "DIMINU'TIF", "NAT'TIFFS COIFFURE", null, null, null, "POSITIF", null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, "BEAUTIFUL BY SD", "LES CISEAUX CREATIFS", null, "KALITAT'TIF", "FLO CREA'TIF", null, "SYMPA'TIF", null, null, "CREA'TIFS", "CREA'TIFS", null, null, null, "10 MINU TIF", null, null, null, "COLOR'TIF", null, null, null, "C.CREA'TIF", null, null, null, null, "KENZ'CREATIF", "KENZ'CREATIF", "KENZ'CREATIF", null, "ABRARACOUR 'TIFS", null, null, "SALON REWELLATIF", "SALON REWELLATIF", null, null, null, "AUX SYMPA'TIFS", null, null, null, "L'ATELIER CREATIF", null, "SYMPA'TIFS COIFFURE", "LE SALON 136", null, null, "SALON ART'TIFS", "SALON ART'TIFS", "KAPTIF", "MYLTIFF", null, null, null, "DIAMAN'TIFF", null, null, null, "RELOOK TIF", null, null, "CATH'TIFF", null, null, null, null, null, null, null, null, null, null, null, "ESPRIT CREA'TIF", "LE TIF BARBER DE CARO", null, null, "CAP'TIF 974", null, "SALON CREATIFS", null, null, null, null, null, "COCOTIF", null, "INSTINC'TIF", "INSTINC'TIF", null, null, null, null, null, "SYMPA ' TIFS", "KREA'TIFS", null, null, null, "BIO'TIF", "UN BRIN CREA'TIF", null, null, null, null, null, null, null, "CREA...TIF", "ABLA-TIFS", "COUP' TIF", null, null, null, null, null, "INFINI-TIFS", "HAIR & BARBER", null, "TERRE COLOREE", null, null, null, null, null, "L'ESCALE DE TIF'", "TIFS EN L'HAIR", null, null, null, null, "NATIF - SAVONS D'AURIERA", null, null, "CREA'TIF JULIE", "IMAGINATIF", null, null, "HAM'N TES TIFS", "ELODIE EVOLU'TIFS", null, null, null, "SO CREATIF'S", "LA BOITE A TIFS", "BEAUTIFUL HAIR", null, "COIFFURE CREA'TIF", null, null, null, null, null, "ANA' TIFF", null, "LE COCON DE TIFFANY", "ATTRACTIF", null, "ADDIC'TIF COIFFURE", null, "EVOLU'TIF", null, null, null, "CREA TIF", null, null, null, null, null, null, null, "MISTER'TIF", null, null, null, null, null, null, null, null, null, null, null, "ESPACE CREATIF"], "activitePrincipaleEtablissement": ["96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A", "96.02A"], "denominationUsuelleEtablissement": ["BRI'TIF", "SUPER AC TIFF", "SYMPA'TIFS", "DIMINU'TIF", "DIMINU'TIF COIFFURE", "EXO TIF", "ACTIF NEUF COIFFURE", "PORTE ATIF", "BEAUTIFUL KRYSTAL", "CREATIFS", "MOTIF'S COIFFURE", "DOMI TIF", "INFINI-TIF", "PATOU'TIF", "CREA'TIF", "CREA TIF COIFFURE", "TIF TIF ET COLEGRAMM", "BOITE A TIFS", "LIBER-TIFS", "SOS TIFS", "SOS TIFS", "MOD TIFE", "OBJECTIF BEAUTE", "MAXITIF S", "INFINI TIFS", "LA BOITE A TIFS", "TIF MEN", "COIF' TIF", "TIF'ALINE", "IMAGINA'TIF", "IMAGINA'TIF", "INOVA'TIF", "INFINI TIFS", "TIF A DOM", "TIFFANNIE COIFFURE", "TIFS'FANNY", "ODILE COUP'TIFS", "ODILE COUP'TIFS", "TIFF 2000", "TIFANNIE", "ISATIFS", "CREA'TIFFS", "CREA TIF", "DIMINU-TIFS", "SYMPATIF", "TIF 2000", "TIF 2000", "TIFF-YZA", "DIMINUTIF", "DIMINUTIF", "GENAC TIF", "GRAFFI.TIF", "CLAFOU'TIFS", "VAL TIF COIFF", "FAUDRA TIF'HAIR", "DIMINU'TIFS", "CREA'TIF DIFFUSION", "RECREA'TIFS", "TIFFI'S COIFFURE", "ALTERNA TIFFS", "YSATIF", "ATELIER CREATIF", "CREATIF-CONCEPT STORE", "NATTIF ' S", "COUPETIF21", "COUPETIF21", "DIMINUT'TIF", "COUP'TIF", "COUP'TIF", "MO'TIFS COIFFURE", "MISS CREATIF", "TIF'FANNY COIFFURE", "IMAGI'NATH'TIF", "SALON COUP'TIFF", "IMAGINA TIF COIFFURE", "EVOLU'TIFS", "MEDIA' TIF", "MEDIATIFS", "ATTENT'TIFS", "IMAGINA'TIF", "KATIF SOINS CAPILLAIRES", "ESPACE TIFOLIE S", "NATH'TIF", "COIFF'TIF", "EVOLU'TIFF", "CRAZY TIFS", "CHRIS'TIF", "CHRIS'TIF COIFFURE", "CHRIS'TIF COIFFURE", "SERINY'TIFS COIFFURE", "SERINY'TIFS COIFFURE", "ACTIF'R COIFFURE A DOMICILE", "EVOLU'TIFS", "CREATIF", "CREATIF", "TIF'ANNE", "COUP'TIF A DOMICILE", "SALON CREATIFF", "ABSOLU'TIFS", "DIMINU'TIFS", "CREA-TIFS", "CREA-TIFS", "SALON IMAGINA'TIFFS", "CREA-TIFS", "JANI'TIFS", "ART TIFFS", "CREA'TIF COIFFURE", "A C TIF", "VIRGINIE TIFS", "TIFF ET TEA", "LISA'TIF", "LIBER'TIFS", "EVOLUTIF", "CREA'TIF COIFFURE", "CREA TIFS COIFFURE", "INFINI'TIF", "EVOLU'TIF", "DIMINU-TIF", "CASA'TIF", "ISATIFF", "ISATIFF", "BEAUTIFUL PEOPLE COIFFURE", "DIMINUTIF", "COUP'TIFS", "COUP'TIFS", "COUP'TIFS", "STYLE QREATIFS", "FLO CREA-TIFS", "AC'TIF COIFFURE", "YSA'TIFS", "AC'TIF COIFFURE", "ELIE'TIFF", "ACTIF COIFFURE", "ACTIF COIFFURE", "CELOR-TIF", "PERFEC'TIF", "CREA'TIF SALON", "LA TIFFERIE", "LA TIFFERIE", "IMAGINA'TIF", "TIF HAIR", "SALON CREATIF ISABELLE", "VITALY TIF", "FACE'TIF", "IMAGINA'TIF", "DIMINUTIF COIFFURE", "TOR'TIF - ART.COM", "POSI'TIF MASSAGE", "CAPTIFSALON", "ESPRIT CREA'TIF", "PATIFS", "SALON INTUITIF'S", "CREA'TIFS COIFFURE", "AC'TIF COIFFURE", "LA BOITE A TIFF", "LA BOITE A TIFF", "LA BOITE A TIFF", "BIOTIFUL-HAIR", "LA BOITE A TIFS", "AKTIFS COIFFURE", "BRI TIFF", "INFINI'TIF", "ACTIF COIFFURE", "G.T. TIFS", "TIFF ON LINE", "SALON INFINI'TIF", "IMAGINA'TIF", "RABOTIF'S COIFFURE", "IMAGINATIF", "COLOR CREA'TIFS", "CREA'TIF' COIFFURE", "DIMINU'TIF", "IMAGINA'TIFS", "BEA COMBAT'TIF", "BEA COMBATIF", "SUP HAIR TIFS", "NAT A TIF", "TIFS DES ANNEES FOLLE", "BEA'TIF", "LA BOITE A TIF", "TIF'FANY COIFFURE", "L'ESPACE A TIFS", "CELI'TIF", "TIFFANY COIFFURE A DOMICILE", "TIFFANY COIFFURE A DOMICILE", "AU DIMINU' TIF", "BOITE A TIF", "MINA TIFS COIFF", "CREA'TIFS JOSELITA", "NA'T'AILLE TES TIFS", "CAROLE CREA'TIFS", "SYMPA' TIF", "POSI'TIF", "AUTHEN'TIF", "SOAN TIFF", "CREATIF", "LISS' TIF", "REAC'TIF COIFFURE BY LAETITIA", "INTUI'TIF", "BIOTIFUL HAIR", "PADDY TIF S", "EVOLU TIFS", "SYMPA'TIF", "CREA'TIFS", "MODULA' TIFS", "INSTINC'TIFS", "CREA-TIFS", "KREATIFS", "DELPHINI TIFS", "DIMINU'TIFF", "S'TIFANY", "TIFANY", "KOUPTOUTIF", "MAUD'TIF", "CREA TIF LORENA", "AC'TIF COIFFURE", "INFINI TIF", "SALON DEFINITIF", "COIFFURE EVOLU'TIFF", "FAMILY TIF", "CAP TIF", "BOUT'TIFS", "CELTIF", "BARB A TIFS", "AIR LIBER'TIF", "CREA'TIFS", "SYMPA'TIF", "LA BOITE A TIFS DE GUIPAVAS", "BEAUTY ACCESS BY MANZIA TIFS", "BEAUTIFUL HAIR", "BEAUTIFUL HAIR", "REBEL A TIFF", "SENS ET TIFS", "CREA TIFS", "CREA TIFS", "NAT'TIF", "SYMPATIFS", "INSTINCTIF", "CREA'TIFS 1 - CREA'TIFS 2 - CREA'TIFS", "REC TIFS", "LOOK CREA TIF", "LILOU CREA'TIF", "LILOU CREA'TIF", "CREA'TIF", "C. CREA'TIF", "CREA'TIF", "TIFANNY COIFFURE", "TIFFANY COIFFURE", "CREA'TIF MAGALI", "GRAFFY'TIFF", "EI RINFRAY - TIFF-MEN", "TIFF-MEN", "KERROUE TIF", "STYLE' TIF", "STYLE' TIF", "FUGITIFF S", "INFINI'TIF", "CREA'TIFF", "VIRGINIE TIF", "CC TIF", "CREATIF", "COUP'TIF", "SELEC'TIFS", "IMAGINA'TIF", "IMAGINA'TIF", "STIF COIFFURE", "CREATIF HAIR", "CREATIF HAIR", "CREATIF HAIR", "INVEN'TIFS", "INVEN'TIFS", "TIFFANY'S", "CAPE'TIF", "CAP TIF", "C CREA'TIF", "INSTINC'TIF", "NAT TIF", "INSTINCT'TIF", "M'BLOTZ TIFF'S", "CREA TIFS", "CREA TIF", "POLLIATIF", "LIL ' O ' TIF BY NANY TATTOO", "COMPETI-TIFF", "DIMINUT TIF", "DELFINI'TIF", "DELFINI'TIF", "ARTIF", "BIOTIF HOME", "SIMPLICY'TIF", "EMBELLITIF", "EMBELLITIF", "CREA'TIFF COIFFURE", "CREA'TIFF COIFFURE", "CREATIF", "ATTEN'TIF", "L'INDIKA'TIF COIFFURE", "PORTE . A . TIF. COIFFURE A DOMICILE", "PORTE . A . TIF.COIFFURE A DOMICILE", "SALON C'TIF HAIR", "EVOLU'TIF", "L'ART CREA'TIF", "SERENI'TIF", "M T TIFS", "IMAGINATIFF'", "VALY TIF", "VALY TIF", "KREA'TIFS", "IMAGINA'TIF", "ABSOLU TIF", "INFINI'TIFS", "TIF'N COIFFURE", "LES TIFS DE DELPHINE", "LIBER'TIF", "ROCK'N'TIFF", "INSTINC'TIF", "CREA'TIF", "EVOLU TIFF CREATION", "LANCREATIF COIFFURE", "TIC'TAC'TIFS", "LM CREATIF COIFFURE MIXTE", "ATTRAC'TIF", "MANU'TIFF", "LIBER ' TIF", "TIF ET COMPAGNIE", "TIFF DOMICILE", "IMAGINATIF", "MIL' TIF", "POSI'TIFS", "FOLGA'TIF", "VIA' TIF", "COCO'TIF", "ALLO !TIFS", "CREA'TIF", "JESS INNOVA'TIFS", "AMBIANCE TIF COIFFURE", "BIOTIFUL HAIR", "IMAGINA'TIF", "TIFS A DOM", "IMAGINA'TIF", "DISTINC'TIF COIFFURE", "TIFS  CO", "IMAGINA'TIF", "RECREA'TIF", "FAUDRA TIF HAIR", "CREA TIFS", "LAETIF COIFFURE", "LE COUP'TIF / MME DUMONT EMILIE", "MY'TIF", "COMMUNICA'TIF", "OBJEC'TIF BIEN-ETRE", "OBJEC'TIF BIEN-ETRE", "EVOLU'TIF", "COLOR'A TIF", "VALI'TIFS", "POSI ' TIF", "KATE TIF", "EVA' TIF", "KARIN'CREATIF", "LA CLE A TIF", "EMMAGINA'TIF", "ADMIRA'TIF", "ADORA TIFF", "TIF'ANNICK", "CREA'TIF", "INTUI'TIF", "TOUTENTIF", "A L EAU TIF", "IMAGINA'TIF", "IMAGINA'TIF", "CREATIF", "DOMI' TIF", "INFINI TIFS", "ABSOLUTIF", "CREATIFS A DOMICILE", "CREATIFS A DOMICILE", "CINDY CREATIF", "ADDICTIF COIFFURE", "ALEXIA COIFFURE - TIFF EN FOLIE", "INSTANT'TIF", "INSTANT'TIF", "DRINE'TIFS", "AURE LIE TIFS", "MISSTIF . COIFFURE", "DIVINYTIF", "TIF'FANY", "TIF'FANY", "CREA TIFF", "FUR-TIF", "ART'TIF", "FLO CREA TIFS", "NEW TIF", "NEW TIF", "COIFFURE KIKA TIF'", "MB CREA-TIFS", "ADMIRA TIFS COIFFURE CHRISTINE", "ABSOLU TIF", "NEW'TIF", "INVENTIF", "EMILIECREA TIF", "DIMINUTIF'", "KALI'TIF & ONGLES D'OR", "DIMINUTIFS COIFFURE", "KREATIFS COIFFURE", "CELI'TIFF", "BIOTIF' FULL COIFFURE", "SALON LIFT'TIFF", "SCULP'TIF", "ME-TIFF -INSTITUT DE BEAUTE HOLIDAYS", "EJ'TIFS", "COIFF'TOUS TIFS", "COIFF TOUT TIFS", "CREA' TIFS COIFFURE A DOMICILE", "TIF FOR TWO", "CELINE CREA'TIF", "KREA TIF COIFFURE", "INSTINC TIF COIFFURE", "EXCEL'TIF", "ESTHETIF", "CREA TIFS COIFFURE", "AC TIFS COIFFURE A DOMICILE", "AIR CREA'TIF", "ELAS' TIFF", "CREA'TIFS", "INTUITIF'S", "CREA'TIF MODE", "COCOTIFS", "INSTANT CREA'TIF", "DIMINUTIF", "ESPACE CREATIF", "EVOLU'TIF", "CREA TIFS COIFFURE", "MIMI CREATIF", "CREATIF COIFFURE", "TIFADOM COIFFURE", "MISS TIF", "HAIR CREATIF", "LIBERTIF COIFFURE", "L'INSTANT TIFS", "ACTIF", "C INSTINC TIF", "C INSTINC TIF", "C INSTINC TIF", "ABSOLU'TIFS", "LES GOURMANDISES DE CRE@TIF'", "DEODA TIF", "DIMINU TIF", "BEAUTIFUL COIFFURE", "BEAUTIFUL COIFFURE", "ATELIER DU TIF", "ARTIFFICE", "ANA' TIF", "FAUDRA'TIF'HAIR", "HELITIF", "SEDUC'TIF", "EXPERT'TIFS", "MILIE' TIF", "RELOOK TIF", "TIF 64", "SO MAN SO WOMAN SO BEAUTIFUL", "INFINI'TIFF", "INFINI TIFFS", "TIF COOL LUCIE", "INSTINCTIF COIFFURE", "CO' LAURA' TIF", "M A SCULP TIF S", "COLOR TIFF", "COLOR TIFF", "COLOR TIFF", "POSI'TIF", "L'ATELIER DU TIFF", "DIMINU'TIF", "DIMINU'TIF", "DIMINUTIF' COIFFURE A DOMICILE", "DIMINU' TIF", "COUPE'TIF", "MAI'TIFS", "SO BEAUTIFUL COIFFURE", "G ART TIFF", "COIFS AND TIFF", "COIFS AND TIFF", "EURL MISSTIF", "DIMINU'TIFF", "NANA'TIF", "LAUR'TIF", "SALON CAPTIF", "IMAGINA TIF", "INFINITIF'S", "EVOLUTIF", "SAINT TIF", "STEF TOUS TIFS", "AQUATIFS LA BAIE", "SYMPATIFS", "LIBER'TIF", "LIBER'TIF", "AD'I'TIF COIFFURE", "TIFF' FOU", "TIFF' FOU", "MINATIF", "MO'TIF COIFFURE", "CHRIS TIF", "CATH'TIF", "CATH'TIF", "ATLAN TIF", "CATH TIFS", "DIMINU'TIF", "ANGE CREATIF", "EXOS'TIF", "EXOS'TIF", "CAP'TIFS", "CREA'TIFF PAR MELANIE", "IMPERA'TIF", "MY TIFF", "TIF & TOI", "IMAGINA'TIFS COIFFURE", "DIMINU TIF", "MARYTIFF", "TIF'CREATION", "TIF'CREATION", "JETIF HAIR", "JENNY TIFF", "TIF ET TIF ET COLEGRAM", "INFINI'TIFS", "LA BOITE A TIFF'", "CREA'TIF COIFFURE", "ALTERNATIFF", "SEDUC'TIF", "SEDUC'TIF", "INSTINCTIF COIFFURE", "ALTERNATIF", "PRO DU TIF", "ADITIF", "ADITIF", "CHRIS'MISS TIFS'", "TIFANY", "TIFANY", "DUO CREA'TIF", "AR'TIFICE COIFFURE", "CREA TIFF COIFFURE", "EVOLUTIF", "DIMINU TIF", "DIMINU TIF", "EVOLU'TIF", "EVOLU'TIF", "BE BEAUTIFUL", "BE BEAUTIFUL", "MISS TIF DELPHINE COIFFURE A DOMICILE", "MISS TIF DELPHINE COIFFURE A DOMICILE", "MISS TIF DELPHINE COIFFURE A DOMICILE", "MISS TIF DELPHINE COIFFURE A DOMICILE", "TIFF ET TIPS", "TIFF ET TIPS", "TIFF ET TIPS", "BEA'TIF", "EVA CREATIF'", "EVA CREATIF", "ROCK AND TIF", "HAIR'CREATIF", "CREA 'TIF ONGLE", "REGARD EVOLUTIF", "CREA TIF", "CREA-TIFF", "CREA-TIFF", "LAETIFF'COIFFURE", "LAETIFF'COIFFURE", "LAETIFF'COIFFURE", "INFINI'TIFS", "INFINI'TIFS", "AC TIF COIFFURE", "SYL'TIF", "C'TIF", "SANDRINE CREA TIFS", "COUP TIF", "INTUIT'TIF COIFFURE", "VERONI TIF", "SYLVIE'TIF", "SYLVIE'TIF", "EVOLU TIF", "COIF'CREATIF", "ARTISTIF", "ARTISTIF", "INTUITIFS", "INTUITIFS", "EVOLU.TIFS", "INFINI TIFS", "CREATIF", "ACTIFF", "CREA'TIFF", "CREA TIF MARION", "CREA TIF MARION", "K TIFF", "K TIFF", "K TIFF", "INTUI'TIF COIFFURE", "SYMPA'TIF", "COIFF CREATIF", "SARL EVOLU'TIF", "LA BOITE A TIF", "LA BOITE A TIF", "OBJEC'TIF COIFFURE", "AK'TIF", "SMILE CREA TIFF", "LE DIMINU'TIF", "MA BOITE A TIF", "HAIR CREA' TIF", "TIF & CO", "TIF & CO", "REFLET CREATIF", "CREA'TIF", "ATTRAC'TIF COIFFURE A DOMICILE", "MAI-TIFS", "COUPE TIFF A DOMICILE", "ACTIF COIFF'", "L'IMAGINA'TIFS", "CREA TIF COIFFURE", "INFINI'TIF", "INFINI'TIF", "POSI'TIF COIFFURE", "ATTRAC'TIF", "KRIS'TIF", "NAT'TIF", "RELA'TIF", "ATTRAC' TIFS COIFFURE", "COIFFURE SENS & TIFF SARL", "NICE AND BEAUTIFUL", "NICE AND BEAUTIFUL", "TIF'HAIR", "CREA'TIFS", "CREA'TIFS", "ADDICT TIF", "A L'INFINI'TIF", "A L'INFINI'TIF", "DETEC'TIF", "ATTRAC'TIFS", "INOV LAETIFS", "INOV LAETIFS", "ANO' TIFS", "IMPRO'TIFS", "DIMINU' TIF", "ENERGIE TIF'", "ENERGIE TIF'", "HAIR CREATIF", "HARMO TIFS", "ATTRAC TIF", "NATIF CREATION", "IMAGINA'TIF", "EMBELLI'TIF", "INSTINC'TIF", "INVENTIF.COIFFURE", "INVENTIF.COIFFURE", "SYMPA'TIF", "POSI'TIFS COIFFURE A DOMICILE", "DIMINU-TIFS", "ABSOLU TIFS", "CHRISTELLE CREA TIF", "APART TIF", "DYNAMI' TIF", "MARY CREA TIF'", "CREA TIF NAIL", "LAETIF CREATION", "INFINI'TIFFS", "DIRECT'TIF COIFFURE", "CREATIF COIFFURE", "ESTHE'TIFFS", "ESTHETIFF'S", "COIFFURE REVELATIF", "LIBER TIF", "EIRL CREATIF LIU", "EIRL CREATIF LIU", "TIFFANY'S BEAUTY", "AC'TIFS COIFFURE ESTHETIQUE", "AC'TIFS", "A.T. TIFS", "PASCAL'TIF", "SYMPATIF", "SYMPATIF", "KAREN KREATIF HAIR", "COUPE TIF'S VANES'S", "SYMP' A TIF", "BEAUTIFUL GARDEN", "COIN EMO TIFF", "DIVIN'IN'TIF", "ATTRAC TIFS COIFFURE A DOMICILE", "KS TIFF COIFFURE A DOMICILE", "O MEGA TIFF", "CREA TIF", "FRANCESCA CREA TIF", "MOBIL'TIF64", "L'ATELIER CREA'TIF", "SALON REVELA-TIFS", "NANOO CREA TIF", "RETROACTIF", "INFINI TIFS", "COLORAC'TIF", "COLORAC'TIF", "SANDY CREA'TIF", "ADMIRA TIF COIFFURE", "CELY'TIF", "BE' TIF", "ZENATIFS", "ZENATIFS", "ZENATIFS", "IMAGINA'TIF", "EVOLU-TIF", "INFINI'TIF", "ANGIE TIF", "IMAGINA'TIF", "HAIR DREAM TIF'S", "BEAUTIFUL STUDIO", "INFINITIF COIFFURE", "INFINITIF COIFFURE", "INFINI'TIFS", "SO BEAUTIFUL HAIR / NAIL", "CREA'TIF", "COUPE TIFJESS", "INSTINC'TIF", "CREA'TIF", "ENYGMA TIF", "BETIF", "CAPRICE DE TIFS", "CAPRICE DE TIFS", "SONIA CREATIF", "JS CREA TIF", "LES CISEAUX CREA'TIFS", "CREA'TIF BEAUTE", "EMO'TIFS", "CREA'TIF COIFFURE", "CREA'TIF COIFFURE", "MISSTIF'RED", "INFINI'TIFF", "INFINI'TIFF", "MO'TIF", "ARTISTE CREA'TIF", "DELFINY TIFF COIFFURE", "MEL CREATIF", "INES'TIF", "NANA POSITIFF'S", "NANA POSITIFF'S", "NANA POSITIFF'S", "LAET ' TIF", "ELI'TIF", "NL CREA'TIF", "ADMIRATIFS", "CREATIF COIFFURE", "CREATIF COIFFURE", "MY BIOTIFUL SALON", "FORMATIF", "CREA'TIF", "EMO'TIF", "EMO'TIF", "TIFFANY", "TIFFANY", "MURIEL DIMINU'TIFS", "COUP'TIFS", "TIF'AND GEL", "TIF'AND GEL", "TIFF'ANA", "AC TIF", "CRAZY TIFF", "CRAZY TIFF", "L'ART DES TIFS", "CREA'TIF", "INSTINC'TIF", "CREA'TIF NAILS", "L M CREATIF COIFFURE A DOMICILE", "ADDITIF COIFFURE", "ADDITIF COIFFURE", "ADDITIF COIFFURE", "ADDITIF COIFFURE", "ADDITIF COIFFURE", "CREA'TIF COIFFURE", "CREA'TIF COIFFURE", "INSTINC'TIF COIFFURE ANNE-SOPHIE", "INSTINC'TIF COIFFURE ANNE-SOPHIE", "M...L'ATTRAC'TIF", "ACTIF COIFFURE", "QUALITA' TIFF", "IMAGINA'TIFS", "IMAGINA'TIFS", "VIC TIF", "VIC TIF", "SYMPA TIF", "TIF' A CARO", "AMETIFS", "COUP'TIFF92", "CONSEIL CREA TIF", "CREA'TIF COIFFURE", "LIBERTIF S", "INSTINC'TIF", "M  TES TIF'S ", "EVOLU TIF", "EVOLU TIF", "CRIS TIF", "TIF TIF ET COLEGRAM", "MO'TIFF", "RUBIS CRE A TIFS", "COLORA'TIF", "INTUI'TIF", "BIOTIFUL", "FANNY'TIFS, COIFFEUSE A DOMICILE", "MISS TIFS", "EIRL HADJ-SAFI COUP'TIFS", "MOKATIF'S", "VALARIE TIF", "MOUNIC TIF", "KALITIF", "CREA'TIF", "LE GARAGE A TIFS", "MISSTIFF", "ATRACK' TIF", "LILOU'TIFF", "LA BRIGADE DU TIF", "LA BRIGADE DU TIF", "INTIMY'TIF COIFFURE A DOMICILE", "INTUI'TIF", "SUBLIM TIFF", "AURELIE CREA'TIF", "TIFF ANNE", "CREA'TIFF COIFFURE", "ABRAKADATIF", "ACTIF COIFFURE", "IMA' GINA' TIF", "AFFINI'TIF", "ZENI'TIF - LA FEMME A BARBES", "BIO TIF FOULE", "INOVA'TIF", "L'ATELIER CREA'TIF", "POSI TIF COIFFURE", "POSI TIF COIFFURE", "BEAUTIFUL COIFFURE", "CLO'TIF", "CLO'TIF", "IMAGINA'TIF", "IMAGINA'TIF", "DIMINU-TIF", "PERFECT'TIFF", "SYMPA'TIFS", "HAIR CREA TIF'", "BEAUTIFUL HAIR NAILS MARINE", "JULY CREA'TIFF", "POSI'TIF JESS COIFFURE", "BEAUTIFUL COLORS", "BEAUTIFUL COLORS", "DALLAST'TIFFS", "DALLAST'TIFFS", "ATTRAC'TIF", "BLEV HAIR TIF", "ART'CREA'TIF", "FUHR'TIFF", "FUHR'TIFF", "FAU TIF' HAIR", "ACTIF COIFF", "ATTRAC'TIF", "CO TIF", "SYMPAT'TIFS", "SYM PAT'TIFS COIFFURE", "MISS ' TIF", "TIF'ERRANCE", "TIF'ERRANCE", "VIR CREA ' TIF", "NEW CONCEPT ' TIF", "NEW CONCEPT ' TIF", "JUSTIF D COIFF", "CREA'TIFS COIFFURE A DOMICILIE", "CREA'TIFS COIFFURE A DOMICILIE", "EVOLUTIF", "CREA TIF", "ARTIST'TIF", "INSTINC'TIF", "CREA'TIFS NAILS", "ARTIFICE COIFF", "AC'TIF COIFFURE", "AC'TIF COIFFURE", "ACTIFF COIFFURE", "TIFF&CO", "L'INSTANT CREATIF", "NAT TIF CREATION", "NAT TIF CREATION", "NAT TIF CREATION", "CREA'TIF COIFFURE", "CREA'TIF COIFFURE", "DEFINI'TIF", "DEFINI'TIF", "DEFINI'TIF", "MAE CREA TIF", "SELEC'TIF", "ADMIRA'TIFS", "POSITIF COIFFURE", "POSITIF COIFFURE", "AMELIE TIF", "AMELIE TIF", "SO'CREA'TIFF'", "A BEAUTIFUL DAY BY MYLENE", "EMOTIF COIFFURE SCHALLER CHARLINE", "EMOTIF COIFFURE SCHALLER CHARLINE", "POISYTIF", "MISTER' TIF", "DIMINU'TIF", "EVOLU'TIF", "EVOLU'TIF", "EVOLU'TIF", "EMOTIFF'' COIFFURE A DOMICILE", "COIFFURE EVOLUTIF", "DIMINU ' TIFS COIFFURE", "DIMINU ' TIFS COIFFURE", "DEFINI'TIF", "CREA TIF' COIFFURE", "M'TIF'S", "LES CISEAUX CREATIFS", "SYMPATIF'S", "ILLUMINA'TIF", "CREA'TIFS & ONGLES", "CREA'TIFS & ONGLES", "CREA'TIFS & ONGLES", "IMAGINATIF", "SYMPA ' TIF", "NA'TIF", "CARO'TIFS", "AMIE'TIFF", "#NOSTIFS", "COUP'TIFS", "COUP'TIFS", "MOBIL'TIFS", "NAT'TIF", "GLADYS CREA TIF", "INFINI'TIF", "CREATIF'C", "INSTINCTIF", "MISSTIF COIFFURE", "MANIA TIF BRAY DUNES", "ADDICT'TIFS", "CREA'TIFS", "IMAGINATIF", "AC'TIF", "CINE'TIFS", "COLORA'TIF COIFFURE", "TIF'  EN MELEE", "COUPE TIFF", "FASHION AND CREA'TIFF", "FASHION AND CREA'TIFF", "TIFFANY", "CREATIF COIFFURE", "POSI'TIF", "CREA'TIF COIFFURE", "ALTERNATIF", "MOTIF COIFFURE", "CREA TIFF", "CREA TIF", "CORRECT - TIF", "COUPE'TIF", "COUPE'TIF", "EXPLETIF", "IMAGINA'TIF", "IMAGINA'TIF", "INTUI'TIF DIFFUSION", "INTUI'TIF DIFFUSION", "INTUI'TIF DIFFUSION", "BEAUTIFUL BY CIAA", "CREA TIFF", "CREA TIFF", "DEBO TIFS", "POSITIFS COIFFURE", "LOIC'TIF", "MILY TIFF", "ABSOLU'TIFS", "INFINI'TIF", "INFINI'TIF", "LIBERA TIF COIFFURE", "LIBERA TIF COIFFURE", "FAMILY'TIFS", "CREATIF", "CREA'TIF", "LOKY'TIF", "POS YTIF", "POS YTIF", "TIF'FEN", "LA FIRME A TIFS'", "CREA'TIF", "CREA'TIF", "CREA'TIF", "CELI'TIFS", "NINI'TIF", "L'ATELIER TIF & CO", "ELO'TIF", "ELO'TIF", "DIMINU'TIF", "DIMINUTIF", "DIMINUTIF", "INSTINCT.TIF'", "CREA'TIF", "TIF' D'OR", "CATHY MT - TIFS", "SEDUCTIF", "EFFET TIF", "CREATIFF'COIFFURE", "ABRARACOUR TIF", "ABRARACOUR TIF", "CREATIFFS COIFFURE", "CREATIF", "FLO CREATIF", "CATOU'TIFS", "RELOOK'TIF", "RELOOK'TIF", "SEDUC'TIF", "ELOCREA'TIF", "REVELA'TIF", "SO CREA'TIFS", "MISS'TIF", "ATELIER CREA'TIF", "ATELIER CREA'TIF", "CK'TIF", "REACTIF", "REACTIF", "L'ATELIER CREA-TIF BEAUTE", "ADDICTIF' COIFFURE", "SYMPA'TIFS", "GRAFFI TIFS", "TIFF TIFF ET KOLEGRAMM", "ZEN'I'TIF", "ACTIFF'COIFFURE", "TIF O TAF KOIF", "INFINI ' TIF", "LIBERTIF'S", "LIBERTIF'S", "SA CREA'TIF", "JENNY'TIF", "RE CREATIF", "LOOK A TIFS", "INFINI'TIF", "L'ATELIER CREA'TIF", "ELITIFF", "IMAGINA' TIF", "LAE'TIFS", "MANIA'TIF", "IMAGINATIF S", "VIRGINIE TIFS", "VIRGINIE TIFS", "TIF'FANNY", "IMAGINA TIF'S COIFFURE", "BHOTI TIFF", "BHOTI TIFF", "BHOTI TIFF", "AC'TIF", "GRAMATIF", "GRAMATIF", "ADDIC'TIF", "CREA TIF PAIN ANGELIQUE", "AD' Y' TIFF", "AD' Y' TIFF", "COIFFURE TIFF'", "IMAGINA'TIFF", "COUP'TIFF", "CAP'TIFS", "ATTRAC'TIFS", "ACTIF COIFFURE", "LA BOITE A TIF'S", "LA BOITE A TIF'S", "L'ESTANG TIF", "MO ' TIF", "MELI TIFF'", "NAT' TIF", "SCULP'TIF", "ATRAC'TIFF COIFFURE", "COIFFURE EVOLUTIFS", "SUBLIM TIFF'", "SALON CREATIF", "ATTRAC'TIFF", "STYLE DEFINI'TIF", "DIMINUTIF", "INSTINC'TIF", "REAC TIF", "INFINI TIF", "ECLAT TIF", "ECLAT TIF", "ECLAT TIF", "BIOTIFUL COIFFURE", "BIOTIFUL COIFFURE", "NOGOTIF ANGELIQUE COIFFURE", "BY TIFFANY", "BY TIFFANY COIFFURE", "L'HAIR FESTIF", "L'HAIR FESTIF", "CAP'N'TIF", "L'ATELIER CREA TIF", "MAE-CREA'TIF", "FAUT TIF HAIR", "FAUT TIF HAIR", "L'INSTINCT CREATIF", "CREATIF' COIFFURE", "CREATIF'", "IMPERA'TIF HOMME", "OBJEC'TIF COIFFURE", "CREA'TIF", "CREA'TIF TENDANCE", "L'ARRET CREATIF", "ATTRAC'TIF", "CARRE TIF", "CARRE TIF", "LA TIFF", "LA TIF SIRENE", "MISS TIFS", "COUPE TIF", "ESTHE'TIFF", "CREA'TIF", "LES CISEAUX CREATIFS A DOMICILE", "INSTINC TIF MC", "TIFF'ANY", "AINSI SOIT TIFF", "LES PINCEAUX CREATIFS", "LES PINCEAUX CREATIFS", "ATELIER CREA'TIF", "ALTITIF'", "ALTITIF'", "FAUDRA'TIFF'HAIR", "PHILCREA'TIF", "PHILCREA'TIF", "CAP TIFS", "A TEMPS TIF COIFFURE", "CO TIF", "TIFF 2000", "TIF'N", "INVEN'TIF", "FANY TIFS", "POSI'TIFS", "EVOLU'TIF", "HAIR CREATIF'", "L'ARTIS'TIF", "OBJECTIF BEAUTE", "CREA'TIF COIFFURE", "CREA'TIF COIFFURE", "INSTINC'TIF", "INGENU'TIF", "SYMPATIF COIFFURE", "ESPACE CREA' TIF", "IMAGINA'TIF", "ADDICT'TIF", "CHEZ LE COUPE TIF'", "CREA ' TIF COIFFURE", "ELFYTIF", "COUPE TIFF", "BEAUTIFUL R", "INTUI'TIFS", "INFINITIF", "BEAUTIFUL HAIR", "ABSOLUTIF", "BEAUTIFUL COIFFURE", "FUGITIF S", "FUGITIF S", "ADMIRA TIF", "ADMIRA TIF", "TIFF'EUR BY SANDRINE", "SEV CREA TIFS", "LIBER'TIF", "CREATIF", "AUX TIFS HEUREUX", "UN VENT'TIF", "OBJECTIF BEAUTE", "DIMINU'TIF", "BEAUTIFUL HAIR AND NAILS", "QUALITA'TIF", "LISA'TIF", "CREATIFF COIFFURE", "CREA'TIF 92", "COUPE'TIF", "CRE@'TIF", "DELPHINI'TIF", "MO TIF", "ACTIF COIFFURE", "CREA TIF LOOK", "NA TIFS", "CREATIF'HAIR C", "TIFF' COIFFURE", "TIFF' COIFFURE", "TIFF' COIFFURE", "AC'TIF COIFFURE", "EVOLU'TIFS", "EVOLU'TIFS", "AJUST'TIF", "CREA'TIF'DOMICILE", "AC'TIF COIFFURE MANON", "AC'TIF COIFFURE MANON", "AC'TIF COIFFURE MANON", "INSTINC'TIF65", "INSTINC'TIF65", "EDITIF'S", "CREA TIF", "COIFFURE DIMINU'TIFS", "COIFFURE INSTINC'TIF", "UN HAIR CREATIF", "AURELIE CREA'TIF", "AURELIE CREA'TIF", "NATIF 95", "A TRAC TIF", "EVOLUTIF", "C CREA'TIF", "C CREA'TIF", "ELO'TIFS", "BIOTIFUL HAIR", "BIOTIFUL HAIR", "BARBOTIFF", "BARBOTIFF", "ESPACE CREATIF", "BETTY CREA'TIFF", "COUPETIF 77", "IMAGINATIF (COLOMBE TYPHANIE)", "LOLO'TIF", "ADMIRA TIF COIFFURE", "EXAUCE'TIF", "CREA'TIF", "TIFFANY'S HAIR", "HAIR CREA TIFF", "HAIR CREA TIFF", "HAIR CREA TIFF", "CREA'TIF INSTITUT ET COIFFURE", "CREA'TIFF", "CREA'TIFF", "TIFANY COIFFURE A DOMICILE", "ESPRIT CREATIF", "ESPRIT CREATIF", "AFFEC'TIFS COIFFURE", "AFFEC'TIFS COIFFURE", "D. MEL'TIF", "STEF' TIF COIFFURE", "C'DUC'TIFS", "INVEN'TIF", "SEDUC'TIFF", "SEDUC'TIFF", "BEAUTIFUL COIFFURE", "MANUE TIFF", "ELEGANCE COIFF'TIFF A DOMICILE", "FANTAS'TIF", "LA TIF A QUEEN", "POSI'TIF", "LENO'TIFS", "GRAPHY'TIFS", "M & M CREATIF", "M & M CREATIF", "IMAGINA'TIF", "INTUI'TIF", "OBJECTIF COIFFURE", "INFINITIFS", "COUPE-TIF", "SYMPA'TIF", "POSI'TIFS COIFFURE", "L ATELIER DES TIFS", "REFLET CREATIF", "ATRAK TIFS", "L'INSTANTIFS", "CREATIF DOMICILE", "CREATIF DOMICILE", "ALEXIA CREA'TIF", "ALEXIA CREA'TIF", "SYBEL'ART COIFFURE / OBJECTIF CRAZY", "ARTIST TIF", "CREATIF COIFFURE", "TIFFS ART", "STYLE CREA'TIF", "INFINI'TIFS", "JK CREA'TIF", "EVOLUTIF", "CREATIF", "INSTINC'TIF", "ATELIER CREA-TIFS", "STYL CREA TIF", "LES P'TIOTS LOUS'TIF", "ADDIC'TIF", "IMAGINA'TIF", "IMAGINA'TIFF", "CED'A TIF", "MCE-TIFS", "CREATIF COIFFURE", "CREATIF COIFFURE", "OBJEC'TIF COIFFEUR", "DIMINU'TIFS", "TIFFANY COIFFURE", "EVOLU'TIF", "EVOLU'TIF COIFFURE", "AQUA TIF COIFFURE", "INSTINC'TIFS", "TIFF BY AURORE", "L ATELIER CLE A TIF", "TIF'FANY COIFFURE", "LA BULLE DE TIF", "LA BULLE DE TIF", "CHIC'TIF", "LE SALON CREA'TIFS", "SO CREATIF HARMONY", "SALON BEAUZETIF", "NATH ACTIFF", "SHERRY TIF'S COIFFURE", "SHERRY TIF'S", "LYDIE TIFS", "TIF'FLO", "TIF'FLO", "ROSSERO TIFFANY", "TIF' R", "KREA'TIF", "CREA'TIF", "CAP TIF'", "LS CREA'TIF", "CREATIFF HB", "AC'TIF", "COOL TIFF", "COOL TIFF", "COOL TIFF", "L APPART A TIFS", "L'HAIR CREATIF", "TIFFANIE COIFFURE", "ADMIRA'TIF COIF", "TIFS'FANNY", "VIVA LA VIE BY IMAGINA'TIF", "ADDIC'TIFF", "ADDIC'TIFF", "TIF'HAIIR", "L'INSTANT CREATIF", "FIFTIF BARBER", "CAP TIF", "B TIFF", "ANA'TIF COIFFURE", "TIFFANY COIFFURE", "AROMA TIFF", "CREATIF COIFFURE", "INVEN'TIF", "AC'TIF COIFFURE", "TIF'N COIFFURE", "INFINI'TIFS", "COCOON BUS BY JALEN TIFF", "CREATIF STUDIO", "OBJECT TIFF COIFFURE A DOMICILE", "OBJECT TIFF COIFFURE A DOMICILE", "CREA' TIFS & NAILS", "LAURE CREA'TIF", "SYMPA'TIFS BY ANNE", "COEUR A TIFS", "TIFFANY COIF'", "CREATIF COIFFURE", "FA'MILIE TIFS", "CO'LAUR ATIF", "FLO CREA'TIFF", "MAYON CREA TIFS", "CISEAUX CREA'TIFF'", "INSTINCT'TIF", "CREATIF' BEAUTY", "CREATIF' BEAUTY", "DIMINU'TIF", "NAT'TIFFS COIFFURE", "C'CREATIF", "C'CREATIF", "LIBERT'TIFS", "POSITIF COIFFURE", "FUGI TIF", "FUGI TIF", "FUGI TIF", "BOIT'A TIF", "LES CISEAUX CREATIFS", "GENAC TIF", "CREA 'TIF", "SATIF'ACTION", "PRIVA' TIFS COIFFURE ET BIEN ETRE", "MAGNY'TIF", "L'INSTANT TIFS", "INFINITIF'S", "ARTIFIC'ELLES", "SOTIFF", "ADDICT TIFFANY COIFFURE", "AMEL'TIF", "AMEL'TIF", "BEAUTIFUL HAIR", "BEAUTIFUL BY SD", "LES CISEAUX CREATIFS", "COIF'MAY TIFS", "KALITAT'TIF", "FLO CREA'TIF", "BEAUTIFUL STYLE", "SYMPA'TIF", "LOVELY CREA TIF", "DIMINU'TIFS", "CREA'TIFS", "CREA'TIFS", "CAPTIFF CAPSUN", "CO NI TIFF", "EXPERTIF BY NAT", "10 MINU TIF", "SO'TIF", "ECO TIFS", "KAP'TIF", "COLOR'TIF", "AC'TIF", "KIFF T TIFF", "TIFF' TI COIFFURE A DOMICILE", "C.CREA'TIF", "ALEX.TIFF", "VAL TIF'", "DREAM'S CUT BY TIFF", "INNOV'TIF", "KENZ'CREATIF", "KENZ'CREATIF", "KENZ'CREATIF", "COUP-TIF", "ABRARACOUR 'TIFS", "ATOUTIFS", "C CREATIF", "SALON REWELLATIF", "SALON REWELLATIF", "RESTROSPEC'TIFF", "O'ZE TIF", "DJEBARBTIF", "AUX SYMPA'TIFS", "INDIC' A TIF", "INDIC' A TIF", "ESTEAM'TIF", "L'ATELIER CREATIF", "BARB'A'TIFF", "SYMPA' TIFS COIFFURE", "GARCIA TIFFANY", "SYMPATIFS", "BEAUTIFUL ZEN", "SALON ART'TIFS", "SALON ART'TIFS", "KAPTIF", "MYLTIFF", "CREA'S TIFF BY CLAIRE", "F'AUDREY TIF HAIR", "TIF COIFFURE", "DIAMAN'TIFF", "KREA-TIFS RIVIERA", "KREA-TIFS RIVIERA", "LA FEE DES TIFS", "RELOOK TIF", "LAME CREATIF", "DIMINU'TIFS", "CATH'TIFF", "ESTHE'TIF", "OBJEC'TIF", "LATIFA B", "LATIFA B", "LATIFA B", "CREATIF", "INFINIY TIFF", "ELOTIFF", "M'ACTIFF COIFFURE A DOMICILE", "M'ACTIFF COIFFURE A DOMICILE", "M'ACTIFF COIFFURE A DOMICILE", "ESPRIT CREA'TIF", "LE TIF BARBER DE CARO", "ATTRAC-TIFF", "L'HAIR CREA 'TIF VIRGINIE", "CAP'TIF 974", "BEA' TIFS", "SALON CREATIFS", "INSTAN'TIF", "INSTAN'TIF", "ESPRIT CREA'TIF", "CHLOE CREA'TIF", "CREA TIFS", "COCOTIF", "OD CREA'TIF", "INSTINC'TIF", "INSTINC'TIF", "LAETIF", "CATH TIFF", "CATH TIFF", "S'TIF COIFFURE A DOMICILE", "JENNY TIFS", "AUX SYMPA ' TIFS", "KREA'TIFS", "CREA'TIF", "BEAUTIFUL HAIR'S", "ISA TIFS", "BIO'TIF", "UN BRIN CREA'TIF", "TIFANY COIFFURE", "AINSI SOIT TIF '", "CREATIF", "LAETIF'COIFFURE", "LAETIF'COIFFURE", "PIERRO COUPTIF", "CAP'TIF", "CREA...TIF", "ABLA-TIFS", "COUPE' TIF", "INTUI'TIF", "T'CREATIF", "L'INFINITIF", "L'INDIGO TIFS", "NA'TIFS", "INFINI-TIFS", "BEAU ' TIFUL", "BRI TIFF", "INSTINC'TIF", "HOLIS'TIF", "STAR'TIF", "TIFS EN L HAIR", "DIRECTIF", "OBJECTIF PRESTIGE", "L' ESCALE DE TIF'", "TIFS EN L'HAIR", "COIFFURE LIBER'TIF BY FRANCOISE", "AD'TIF", "TIF MODE", "MAUDTIFF", "EI NATIF - SAVONS D'AURIERA", "TYF'N COUP TIFS", "BEAUTIFUL HAIR'S", "CREA'TIF JULIE", "IMAGINATIF", "MOTIFS", "POSI'TIFS", "HAM'N TES TIFS", "ELODIE EVOLU'TIFS", "EMI'TIF", "MISS COUP'TIFFS", "COIFFURE BY TIFFANY", "SO CREATIF'S", "LA BOITE A TIFS", "BEAUTIFUL HAIR", "CREA'TIF COIFFURE", "COIFFURE CREA'TIF", "DISTINC'TIF", "FAUDRA TIF HAIR", "CREA' TIF COIFFURE", "THE BEAUTIFULS MOMENTS", "TIFFANY BEAUTY", "ANA' TIFF", "COIFFURE CREATIF", "LE COCON DE TIFFANY", "ATTRACTIF", "ADDICT'TIF", "ADDIC'TIF COIFFURE", "NATURA'TIF", "EVOLU'TIF", "BEAUTIFUL BY NASS", "MO'TIFF", "PAIN'TIF COLOR", "CREA TIF", "BY TIFFANY", "ELEGANCECREATIF", "CREATIF", "SCREATIFFS", "LAETIF'", "SOLANGE CREA'TIF", "LEALY CREA'TIF", "MISTER'TIF", "FANNY'TIFS", "INFINI-TIF BY GONTRAN", "TIF & BRICO", "LE CISEAU SPORT'TIF", "TIF'ALIZEA HAIRCUT", "BRYH'TIFUL FAIRY", "LAETI'TIF", "FANNY TIFF", "TIF'ALINE", "BEAUTIFYHAIR", "TIFFANY SIGNATURE", "ESPACE CREATIF"]}}]}</script>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="1384" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1383;"><span id="cb19-1384"><a href="#cb19-1384" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">underlineTif</span>(x) {</span>
<span id="cb19-1385"><a href="#cb19-1385" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Use a regular expression to find all occurrences of "tif"</span></span>
<span id="cb19-1386"><a href="#cb19-1386" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> modx <span class="op">=</span> x<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/TIF/g</span><span class="op">,</span> match <span class="kw">=&gt;</span> </span>
<span id="cb19-1387"><a href="#cb19-1387" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`&lt;span style="text-transform: capitalize; border-bottom: solid 2px blue; margin-bottom: -2px;"&gt;</span><span class="sc">${</span>match<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span></span>
<span id="cb19-1388"><a href="#cb19-1388" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb19-1389"><a href="#cb19-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1390"><a href="#cb19-1390" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(modx)</span>
<span id="cb19-1391"><a href="#cb19-1391" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-1392"><a href="#cb19-1392" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Return the modified string wrapped in an HTML template</span></span>
<span id="cb19-1393"><a href="#cb19-1393" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">html</span><span class="vs">`</span><span class="sc">${</span>modx<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb19-1394"><a href="#cb19-1394" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<p>In a more interactive form, here’s a list of all the hairdressers who have the word <code>tif</code> in the name of their registered business in the official data:</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="1413" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1412;"><span id="cb20-1413"><a href="#cb20-1413" aria-hidden="true" tabindex="-1"></a>viewof coiffeursSearch <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">search</span>(</span>
<span id="cb20-1414"><a href="#cb20-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transpose</span>(coiffeurs)<span class="op">,</span></span>
<span id="cb20-1415"><a href="#cb20-1415" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">label</span><span class="op">:</span> <span class="st">"Nom du salon"</span>}</span>
<span id="cb20-1416"><a href="#cb20-1416" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="1421" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1420;"><span id="cb21-1421"><a href="#cb21-1421" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(coiffeursSearch<span class="op">,</span> {</span>
<span id="cb21-1422"><a href="#cb21-1422" aria-hidden="true" tabindex="-1"></a>  <span class="dt">columns</span><span class="op">:</span> [</span>
<span id="cb21-1423"><a href="#cb21-1423" aria-hidden="true" tabindex="-1"></a>    <span class="st">"siren"</span><span class="op">,</span></span>
<span id="cb21-1424"><a href="#cb21-1424" aria-hidden="true" tabindex="-1"></a>    <span class="st">"denominationUsuelleEtablissement"</span><span class="op">,</span></span>
<span id="cb21-1425"><a href="#cb21-1425" aria-hidden="true" tabindex="-1"></a>    <span class="st">"enseigne1Etablissement"</span></span>
<span id="cb21-1426"><a href="#cb21-1426" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb21-1427"><a href="#cb21-1427" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb21-1428"><a href="#cb21-1428" aria-hidden="true" tabindex="-1"></a>    <span class="dt">denominationUsuelleEtablissement</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">underlineTif</span>(x)<span class="op">,</span></span>
<span id="cb21-1429"><a href="#cb21-1429" aria-hidden="true" tabindex="-1"></a>    <span class="dt">enseigne1Etablissement</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">underlineTif</span>(x)</span>
<span id="cb21-1430"><a href="#cb21-1430" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-1431"><a href="#cb21-1431" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<p>Of course, to go further, it would be better to normalize the data more thoroughly, check that the information sought is not spread across multiple columns, and conduct visual inspections to detect hidden puns. But already, in just a few minutes, we have partial statistics on the phenomenon of punny hairdressers.</p>
</section>
<section id="the-social-security-number-and-the-issue-of-individual-identifiers-confidentiality" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="the-social-security-number-and-the-issue-of-individual-identifiers-confidentiality"><span class="header-section-number">5.3.3</span> The social security number and the issue of individual identifiers’ confidentiality</h3>
<p>For individuals, there exists a unique identifier that allows linking them across different data sources: the <a href="https://www.cnil.fr/fr/definition/nir-numero-dinscription-au-repertoire">NIR</a>, also known as the INSEE number or social security number.
This number is necessary for the administration to manage social benefits (health, retirement, family…). Beyond this function, which can be useful daily, this number is a unique individual identifier in the <a href="https://www.insee.fr/fr/metadonnees/definition/c1602">National Register of Physical Persons (RNIPP)</a>.</p>
<p>This identifier is mainly present in management databases related to payroll, social benefits, etc. However, unlike the Sirene number, it contains several sensitive pieces of information and is inherently linked to the sensitive issue of social security rights.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.ameli.fr/sites/default/files/styles/webp_ckeditor/public/thumbnails/image/infographie_assures-regle-identification-assures.gif.webp?itok=j2owVDrB" class="lightbox" data-gallery="quarto-lightbox-gallery-12" data-glightbox="description: .lightbox-desc-12" title="Social security number (Source: Améli)"><img src="https://www.ameli.fr/sites/default/files/styles/webp_ckeditor/public/thumbnails/image/infographie_assures-regle-identification-assures.gif.webp?itok=j2owVDrB" class="img-fluid figure-img" data-fig-width="80%" alt="Social security number (Source: Améli)"></a></p>
<figcaption>Social security number (Source: <a href="https://www.ameli.fr/assure/droits-demarches/principes/numero-securite-sociale">Améli</a>)</figcaption>
</figure>
</div>
<p>To address this problem, the <a href="https://www.insee.fr/fr/information/7635825?sommaire=7635842">non-significant statistical code (CSNS)</a> or hashed NIR, a non-identifying anonymous individual identifier, was recently implemented. The goal of this anonymized identifier is to reduce the dissemination of personal information that, although allowing civil servants and researchers to deterministically link numerous databases, provided analysts with non-essential information about the individuals in question.</p>
</section>
<section id="why-do-we-need-a-commune-code-when-we-already-have-its-name" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="why-do-we-need-a-commune-code-when-we-already-have-its-name"><span class="header-section-number">5.3.4</span> Why do we need a commune code when we already have its name?</h3>
<p>This exercise will take a step back to understand why we assumed above that the commune code was the key for joining data.</p>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3: Verification of Join Keys
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Let’s start by checking the dimensions of the <code>DataFrames</code> and the structure of some key variables.
In this case, the fundamental variables for linking our data are the communal variables.
Here, we have two geographical variables: a commune code and a commune name.</p>
<ol type="1">
<li><p>Check the dimensions of the <code>DataFrames</code>.</p></li>
<li><p>Identify in <code>filosofi</code> the commune names that correspond to multiple commune codes and select their codes. In other words, identify the <code>LIBGEO</code> where there are duplicate <code>CODGEO</code> and store them in a vector <code>x</code> (tip: be careful with the index of <code>x</code>).</p></li>
</ol>
<p>We temporarily focus on observations where the label involves more than two different commune codes.</p>
<ul>
<li><p><em>Question 3</em>. Look at these observations in <code>filosofi</code>.</p></li>
<li><p><em>Question 4</em>. To get a better view, reorder the obtained dataset alphabetically.</p></li>
<li><p><em>Question 5</em>. Determine the average size (variable number of people: <code>NBPERSMENFISC16</code>) and some descriptive statistics of this data. Compare it to the same statistics on the data where labels and commune codes coincide.</p></li>
<li><p><em>Question 6</em>. Check the major cities (more than 100,000 people) for the proportion of cities where the same name is associated with different commune codes.</p></li>
<li><p><em>Question 7</em>. Check in <code>filosofi</code> the cities where the label is equal to Montreuil. Also, check those that contain the term <em>‘Saint-Denis’</em>.</p></li>
</ul>
</div>
</div>
</div>
<p>This small exercise reassures us as the duplicated labels are actually the same commune names but in different departments. So, these are not duplicated observations. We can thus rely on the commune codes, which are unique.</p>
</section>
<section id="associating-different-sources-to-compute-carbon-footprints" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="associating-different-sources-to-compute-carbon-footprints"><span class="header-section-number">5.3.5</span> Associating different sources to compute carbon footprints</h3>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4: Calculate the carbon footprint per capita
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>First, we will calculate the carbon footprint of each commune.</p>
<ol type="1">
<li><p>Create a variable <code>emissions</code> that corresponds to the total emissions of a commune.</p></li>
<li><p>Perform a left join between the emissions data and the framing data<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p></li>
<li><p>Calculate the carbon footprint (total emissions / population).</p></li>
</ol>
<p>At this stage, we might want to move towards modeling to try to explain the determinants of the carbon footprint based on communal variables. However, for an inferential approach to be relevant, it is necessary to check some descriptive statistics beforehand.</p>
<ol start="4" type="1">
<li>Generate a histogram of the carbon footprint per commune in level and log.</li>
</ol>
<p>With a better understanding of our data, we are getting closer to inferential statistics. However, so far we have constructed univariate statistics and have not sought to understand the results by looking at the relationship with other variables. This brings us to bivariate statistics, especially correlation analysis. This work is important because any subsequent modeling will consist of refining the correlation analysis to account for cross-correlations between multiple factors. Here, we propose to do this analysis in a minimal way.</p>
<ol start="5" type="1">
<li>Look at the correlation between the framing variables and the carbon footprint. Do some variables seem to potentially influence the carbon footprint?</li>
</ol>
</div>
</div>
</div>
<p>At the end of question 5, the correlation graph is as follows:</p>
<div id="8cf6c885" class="cell" data-execution_count="71">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="02_pandas_suite_files/figure-html/cell-72-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="02_pandas_suite_files/figure-html/cell-72-output-1.png" width="773" height="412" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="formatting-descriptive-statistics-tables" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Formatting descriptive statistics tables</h1>
<p>A <code>Pandas</code> DataFrame is automatically formatted when viewed from a notebook as a minimally styled HTML table. This formatting is convenient for viewing data, a necessary task for data scientists, but it doesn’t go much beyond that.</p>
<p>In an exploratory phase, it can be useful to have a more complete table, including minimal visualizations, to better understand the data. In the final phase of a project, when communicating about it, having an attractive visualization is advantageous. The outputs of notebooks are not a satisfactory solution for these needs and require the medium of the notebook, which can deter some users.</p>
<p>Fortunately, the young package <a href="https://posit-dev.github.io/great-tables/get-started/"><code>great_tables</code></a> allows for the creation of tables programmatically that rival tedious manual productions in <code>Excel</code> and are difficult to replicate. This package is a <code>Python</code> port of the <code>GT</code> package. <code>great_tables</code> builds <em>HTML</em> tables, offering great formatting richness and excellent integration with <a href="https://quarto.org/"><code>Quarto</code></a>, the reproducible publishing tool developed by RStudio.</p>
<p>The following exercise will propose building a table with this package, step by step.</p>
<p>To focus on table construction, the necessary data preparations are provided directly. We will start from this dataset:</p>
<div id="efb96afc" class="cell" data-execution_count="72">
<div class="cell-output cell-output-display" data-execution_count="70">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index_x</th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">PPSOC16</th>
<th data-quarto-table-cell-role="th">PPFAM16</th>
<th data-quarto-table-cell-role="th">PPMINI16</th>
<th data-quarto-table-cell-role="th">PPLOGT16</th>
<th data-quarto-table-cell-role="th">PIMPOT16</th>
<th data-quarto-table-cell-role="th">D116</th>
<th data-quarto-table-cell-role="th">D916</th>
<th data-quarto-table-cell-role="th">RD16</th>
<th data-quarto-table-cell-role="th">dep_y</th>
<th data-quarto-table-cell-role="th">empreinte</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>01</td>
<td>7.196009</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>01</td>
<td>5.378273</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>...</td>
<td>6.9</td>
<td>2.8</td>
<td>2.1</td>
<td>2.0</td>
<td>-15.7</td>
<td>10457.083333</td>
<td>33880.555556</td>
<td>3.239962</td>
<td>01</td>
<td>4.446281</td>
</tr>
</tbody>
</table>

<p>3 rows × 49 columns</p>
</div>
</div>
</div>
</div>
<p>To ensure you are able to complete the next exercise, here is the dataframe required for it.</p>
<div id="f7545d19" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="f7545d19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="f7545d19-1"><a href="#f7545d19-1" aria-hidden="true" tabindex="-1"></a>emissions[<span class="st">"emissions"</span>] <span class="op">=</span> emissions.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="f7545d19-2"><a href="#f7545d19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="f7545d19-3"><a href="#f7545d19-3" aria-hidden="true" tabindex="-1"></a>emissions_merged <span class="op">=</span> emissions.reset_index().merge(</span>
<span id="f7545d19-4"><a href="#f7545d19-4" aria-hidden="true" tabindex="-1"></a>    filosofi, left_on<span class="op">=</span><span class="st">"INSEE commune"</span>, right_on<span class="op">=</span><span class="st">"CODGEO"</span></span>
<span id="f7545d19-5"><a href="#f7545d19-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="f7545d19-6"><a href="#f7545d19-6" aria-hidden="true" tabindex="-1"></a>emissions_merged[<span class="st">"empreinte"</span>] <span class="op">=</span> (</span>
<span id="f7545d19-7"><a href="#f7545d19-7" aria-hidden="true" tabindex="-1"></a>    emissions_merged[<span class="st">"emissions"</span>] <span class="op">/</span> emissions_merged[<span class="st">"NBPERSMENFISC16"</span>]</span>
<span id="f7545d19-8"><a href="#f7545d19-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="f7545d19-9"><a href="#f7545d19-9" aria-hidden="true" tabindex="-1"></a>emissions_merged[<span class="st">"empreinte"</span>] <span class="op">=</span> emissions_merged[<span class="st">"empreinte"</span>].astype(<span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="48863418" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="48863418"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="48863418-1"><a href="#48863418-1" aria-hidden="true" tabindex="-1"></a>emissions_table <span class="op">=</span> (</span>
<span id="48863418-2"><a href="#48863418-2" aria-hidden="true" tabindex="-1"></a>    emissions_merged.rename(</span>
<span id="48863418-3"><a href="#48863418-3" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>{<span class="st">"dep_y"</span>: <span class="st">"dep"</span>, <span class="st">"NBPERSMENFISC16"</span>: <span class="st">"population"</span>, <span class="st">"MED16"</span>: <span class="st">"revenu"</span>}</span>
<span id="48863418-4"><a href="#48863418-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="48863418-5"><a href="#48863418-5" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"dep"</span>)</span>
<span id="48863418-6"><a href="#48863418-6" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="48863418-7"><a href="#48863418-7" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"empreinte"</span>: <span class="st">"sum"</span>, <span class="st">"revenu"</span>: <span class="st">"median"</span>, <span class="st">"population"</span>: <span class="st">"sum"</span>}</span>
<span id="48863418-8"><a href="#48863418-8" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># pas vraiment le revenu médian</span></span>
<span id="48863418-9"><a href="#48863418-9" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="48863418-10"><a href="#48863418-10" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">"empreinte"</span>)</span>
<span id="48863418-11"><a href="#48863418-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this table, we will include horizontal bars, similar to the examples shown <a href="https://posit-dev.github.io/great-tables/examples/">here</a>. This is done by directly including the <em>HTML</em> code in the DataFrame column.</p>
<div id="484f4f4c" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="484f4f4c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="484f4f4c-1"><a href="#484f4f4c-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_bar(</span>
<span id="484f4f4c-2"><a href="#484f4f4c-2" aria-hidden="true" tabindex="-1"></a>    prop_fill: <span class="bu">float</span>, max_width: <span class="bu">int</span>, height: <span class="bu">int</span>, color: <span class="bu">str</span> <span class="op">=</span> <span class="st">"green"</span></span>
<span id="484f4f4c-3"><a href="#484f4f4c-3" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="484f4f4c-4"><a href="#484f4f4c-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Create divs to represent prop_fill as a bar."""</span></span>
<span id="484f4f4c-5"><a href="#484f4f4c-5" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="bu">round</span>(max_width <span class="op">*</span> prop_fill, <span class="dv">2</span>)</span>
<span id="484f4f4c-6"><a href="#484f4f4c-6" aria-hidden="true" tabindex="-1"></a>    px_width <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>width<span class="sc">}</span><span class="ss">px"</span></span>
<span id="484f4f4c-7"><a href="#484f4f4c-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"""</span><span class="ch">\</span></span>
<span id="484f4f4c-8"><a href="#484f4f4c-8" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div style="width: </span><span class="sc">{</span>max_width<span class="sc">}</span><span class="ss">px; background-color: lightgrey;"&gt;</span><span class="ch">\</span></span>
<span id="484f4f4c-9"><a href="#484f4f4c-9" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div style="height:</span><span class="sc">{</span>height<span class="sc">}</span><span class="ss">px;width:</span><span class="sc">{</span>px_width<span class="sc">}</span><span class="ss">;background-color:</span><span class="sc">{</span>color<span class="sc">}</span><span class="ss">;"&gt;&lt;/div&gt;</span><span class="ch">\</span></span>
<span id="484f4f4c-10"><a href="#484f4f4c-10" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span><span class="ch">\</span></span>
<span id="484f4f4c-11"><a href="#484f4f4c-11" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="484f4f4c-12"><a href="#484f4f4c-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="484f4f4c-13"><a href="#484f4f4c-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="484f4f4c-14"><a href="#484f4f4c-14" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> {<span class="st">"empreinte"</span>: <span class="st">"green"</span>, <span class="st">"revenu"</span>: <span class="st">"red"</span>, <span class="st">"population"</span>: <span class="st">"blue"</span>}</span>
<span id="484f4f4c-15"><a href="#484f4f4c-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="484f4f4c-16"><a href="#484f4f4c-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variable <span class="kw">in</span> [<span class="st">"empreinte"</span>, <span class="st">"revenu"</span>, <span class="st">"population"</span>]:</span>
<span id="484f4f4c-17"><a href="#484f4f4c-17" aria-hidden="true" tabindex="-1"></a>    emissions_table[<span class="ss">f"raw_perc_</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> (</span>
<span id="484f4f4c-18"><a href="#484f4f4c-18" aria-hidden="true" tabindex="-1"></a>        emissions_table[variable] <span class="op">/</span> emissions_table[variable].<span class="bu">max</span>()</span>
<span id="484f4f4c-19"><a href="#484f4f4c-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="484f4f4c-20"><a href="#484f4f4c-20" aria-hidden="true" tabindex="-1"></a>    emissions_table[<span class="ss">f"bar_</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> emissions_table[<span class="ss">f"raw_perc_</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">"</span>].<span class="bu">map</span>(</span>
<span id="484f4f4c-21"><a href="#484f4f4c-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: create_bar(x, max_width<span class="op">=</span><span class="dv">75</span>, height<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span>colors[variable])</span>
<span id="484f4f4c-22"><a href="#484f4f4c-22" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We keep only the 5 smallest carbon footprints and the five largest.</p>
<div id="7132b3a8" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="7132b3a8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="7132b3a8-1"><a href="#7132b3a8-1" aria-hidden="true" tabindex="-1"></a>emissions_min <span class="op">=</span> (</span>
<span id="7132b3a8-2"><a href="#7132b3a8-2" aria-hidden="true" tabindex="-1"></a>    emissions_table.head(<span class="dv">5</span>)</span>
<span id="7132b3a8-3"><a href="#7132b3a8-3" aria-hidden="true" tabindex="-1"></a>    .assign(grp<span class="op">=</span><span class="st">"5 départements les moins pollueurs"</span>)</span>
<span id="7132b3a8-4"><a href="#7132b3a8-4" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="7132b3a8-5"><a href="#7132b3a8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="7132b3a8-6"><a href="#7132b3a8-6" aria-hidden="true" tabindex="-1"></a>emissions_max <span class="op">=</span> (</span>
<span id="7132b3a8-7"><a href="#7132b3a8-7" aria-hidden="true" tabindex="-1"></a>    emissions_table.tail(<span class="dv">5</span>)</span>
<span id="7132b3a8-8"><a href="#7132b3a8-8" aria-hidden="true" tabindex="-1"></a>    .assign(grp<span class="op">=</span><span class="st">"5 départements les plus pollueurs"</span>)</span>
<span id="7132b3a8-9"><a href="#7132b3a8-9" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="7132b3a8-10"><a href="#7132b3a8-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="7132b3a8-11"><a href="#7132b3a8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="7132b3a8-12"><a href="#7132b3a8-12" aria-hidden="true" tabindex="-1"></a>emissions_table <span class="op">=</span> pd.concat([emissions_min, emissions_max])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, to use some practical functions for selecting columns based on patterns, we will convert the data to the <a href="https://pola.rs/"><code>Polars</code></a> format.</p>
<div id="450b1963" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="450b1963"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="450b1963-1"><a href="#450b1963-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="450b1963-2"><a href="#450b1963-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="450b1963-3"><a href="#450b1963-3" aria-hidden="true" tabindex="-1"></a>emissions_table <span class="op">=</span> pl.from_pandas(emissions_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 5: A Beautiful Descriptive Statistics Table (Open Exercise)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Using this base table</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>GT(emissions_table, groupname_col<span class="op">=</span><span class="st">"grp"</span>, rowname_col<span class="op">=</span><span class="st">"dep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>construct a table in the style of the one below.</p>
</div>
</div>
</div>
<div id="1d6b6468" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="1d6b6468"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="1d6b6468-1"><a href="#1d6b6468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start from here</span></span>
<span id="1d6b6468-2"><a href="#1d6b6468-2" aria-hidden="true" tabindex="-1"></a>GT(emissions_table, groupname_col<span class="op">=</span><span class="st">"grp"</span>, rowname_col<span class="op">=</span><span class="st">"dep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>
<div id="bvngwtamhp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#bvngwtamhp table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#bvngwtamhp thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#bvngwtamhp p { margin: 0; padding: 0; }
 #bvngwtamhp .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #bvngwtamhp .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #bvngwtamhp .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #bvngwtamhp .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #bvngwtamhp .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #bvngwtamhp .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #bvngwtamhp .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #bvngwtamhp .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #bvngwtamhp .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #bvngwtamhp .gt_column_spanner_outer:first-child { padding-left: 0; }
 #bvngwtamhp .gt_column_spanner_outer:last-child { padding-right: 0; }
 #bvngwtamhp .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #bvngwtamhp .gt_spanner_row { border-bottom-style: hidden; }
 #bvngwtamhp .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #bvngwtamhp .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #bvngwtamhp .gt_from_md> :first-child { margin-top: 0; }
 #bvngwtamhp .gt_from_md> :last-child { margin-bottom: 0; }
 #bvngwtamhp .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #bvngwtamhp .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #bvngwtamhp .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #bvngwtamhp .gt_row_group_first td { border-top-width: 2px; }
 #bvngwtamhp .gt_row_group_first th { border-top-width: 2px; }
 #bvngwtamhp .gt_striped { background-color: rgba(128,128,128,0.05); }
 #bvngwtamhp .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #bvngwtamhp .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #bvngwtamhp .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #bvngwtamhp .gt_left { text-align: left; }
 #bvngwtamhp .gt_center { text-align: center; }
 #bvngwtamhp .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #bvngwtamhp .gt_font_normal { font-weight: normal; }
 #bvngwtamhp .gt_font_bold { font-weight: bold; }
 #bvngwtamhp .gt_font_italic { font-style: italic; }
 #bvngwtamhp .gt_super { font-size: 65%; }
 #bvngwtamhp .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #bvngwtamhp .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="empreinte" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">empreinte</th>
<th id="revenu" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">revenu</th>
<th id="population" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">population</th>
<th id="raw_perc_empreinte" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">raw_perc_empreinte</th>
<th id="bar_empreinte" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bar_empreinte</th>
<th id="raw_perc_revenu" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">raw_perc_revenu</th>
<th id="bar_revenu" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bar_revenu</th>
<th id="raw_perc_population" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">raw_perc_population</th>
<th id="bar_population" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bar_population</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="10" class="gt_group_heading" data-quarto-table-cell-role="th">5 départements les moins pollueurs</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">75</td>
<td class="gt_row gt_right">184.7103295610044</td>
<td class="gt_row gt_right">30507.25</td>
<td class="gt_row gt_right">2074629.5</td>
<td class="gt_row gt_right">0.0010088939415239168</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.08px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:75.0px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.8290666738598547</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:62.18px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">92</td>
<td class="gt_row gt_right">414.43945557445903</td>
<td class="gt_row gt_right">28565.37037037037</td>
<td class="gt_row gt_right">1583682.0</td>
<td class="gt_row gt_right">0.0022636820412333665</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.17px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.9363469460659473</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:70.23px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.6328734688250227</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:47.47px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">93</td>
<td class="gt_row gt_right">463.375783649003</td>
<td class="gt_row gt_right">17269.63636363636</td>
<td class="gt_row gt_right">1586664.5</td>
<td class="gt_row gt_right">0.0025309738869691957</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.19px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.5660830249739442</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:42.46px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.6340653401229036</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:47.55px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">94</td>
<td class="gt_row gt_right">651.4230957960531</td>
<td class="gt_row gt_right">22431.25</td>
<td class="gt_row gt_right">1345977.0</td>
<td class="gt_row gt_right">0.0035580945379686127</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.27px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.7352760409410878</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:55.15px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.537881426289304</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:40.34px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">06</td>
<td class="gt_row gt_right">3412.4578448016878</td>
<td class="gt_row gt_right">21259.45</td>
<td class="gt_row gt_right">1106770.0</td>
<td class="gt_row gt_right">0.018638957840141405</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:1.4px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.69686549918462</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:52.26px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.4422891521728923</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:33.17px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="10" class="gt_group_heading" data-quarto-table-cell-role="th">5 départements les plus pollueurs</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">70</td>
<td class="gt_row gt_right">120801.03631184295</td>
<td class="gt_row gt_right">20047.305555555555</td>
<td class="gt_row gt_right">225876.5</td>
<td class="gt_row gt_right">0.6598192637871786</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:49.49px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.6571325031117375</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:49.28px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.09026511893237105</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:6.77px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">76</td>
<td class="gt_row gt_right">122166.44319426689</td>
<td class="gt_row gt_right">21045.833333333336</td>
<td class="gt_row gt_right">1208055.0</td>
<td class="gt_row gt_right">0.6672771614297552</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:50.05px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.6898633384960406</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:51.74px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.482764821713837</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:36.21px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">88</td>
<td class="gt_row gt_right">123129.82945046567</td>
<td class="gt_row gt_right">19928.35714285714</td>
<td class="gt_row gt_right">353370.0</td>
<td class="gt_row gt_right">0.6725392090885752</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:50.44px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.6532334819709131</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:48.99px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.14121427008622833</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:10.59px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">62</td>
<td class="gt_row gt_right">125859.88148645309</td>
<td class="gt_row gt_right">19668.888888888887</td>
<td class="gt_row gt_right">1439504.0</td>
<td class="gt_row gt_right">0.6874508437854484</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:51.56px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.6447283478153188</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:48.35px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.5752568317803041</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:43.14px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">80</td>
<td class="gt_row gt_right">183082.00887994491</td>
<td class="gt_row gt_right">20038.09523809524</td>
<td class="gt_row gt_right">535822.5</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:75.0px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">0.6568305972545949</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:49.26px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">0.21412622246732343</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:16.06px;background-color:blue;">

</div>
</div></td>
</tr>
</tbody>
</table>


</div>
        
</div>
</div>
</div>
<p>The table you should have :</p>
<div id="ea7696a4" class="cell" data-execution_count="81">
<div class="cell-output cell-output-display" data-execution_count="79">
<div>
<div id="lgcepnfamj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#lgcepnfamj table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#lgcepnfamj thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#lgcepnfamj p { margin: 0; padding: 0; }
 #lgcepnfamj .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #lgcepnfamj .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #lgcepnfamj .gt_title { color: #FFFFFF; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #lgcepnfamj .gt_subtitle { color: #FFFFFF; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #lgcepnfamj .gt_heading { background-color: #0c540c; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #lgcepnfamj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #lgcepnfamj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #lgcepnfamj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #lgcepnfamj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #lgcepnfamj .gt_column_spanner_outer:first-child { padding-left: 0; }
 #lgcepnfamj .gt_column_spanner_outer:last-child { padding-right: 0; }
 #lgcepnfamj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #lgcepnfamj .gt_spanner_row { border-bottom-style: hidden; }
 #lgcepnfamj .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #lgcepnfamj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #lgcepnfamj .gt_from_md> :first-child { margin-top: 0; }
 #lgcepnfamj .gt_from_md> :last-child { margin-bottom: 0; }
 #lgcepnfamj .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #lgcepnfamj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #lgcepnfamj .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #lgcepnfamj .gt_row_group_first td { border-top-width: 2px; }
 #lgcepnfamj .gt_row_group_first th { border-top-width: 2px; }
 #lgcepnfamj .gt_striped { background-color: rgba(128,128,128,0.05); }
 #lgcepnfamj .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #lgcepnfamj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #lgcepnfamj .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #lgcepnfamj .gt_left { text-align: left; }
 #lgcepnfamj .gt_center { text-align: center; }
 #lgcepnfamj .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #lgcepnfamj .gt_font_normal { font-weight: normal; }
 #lgcepnfamj .gt_font_bold { font-weight: bold; }
 #lgcepnfamj .gt_font_italic { font-style: italic; }
 #lgcepnfamj .gt_super { font-size: 65%; }
 #lgcepnfamj .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #lgcepnfamj .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="10" class="gt_heading gt_title gt_font_normal"><strong>Carbon Footprint</strong></th>
</tr>
<tr class="odd gt_heading">
<th colspan="10" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border"><em>Initial descriptive statistics to refine</em></th>
</tr>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="3" id="<strong>Footprint</strong>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Footprint</strong></span></th>
<th colspan="3" id="<strong>Median Income</strong>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Median Income</strong></span></th>
<th colspan="3" id="<strong>Population</strong>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Population</strong></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="<strong>Carbon Footprint</strong>" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><strong>Carbon Footprint</strong></th>
<th id="<em>(%)</em>*" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><em>(%)</em>*</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="<strong>Income</strong>" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><strong>Income</strong></th>
<th id="<em>(%)</em>*" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><em>(%)</em>*</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="<strong>Population</strong>" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><strong>Population</strong></th>
<th id="<em>(%)</em>*" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><em>(%)</em>*</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="10" class="gt_group_heading" data-quarto-table-cell-role="th">5 départements les moins pollueurs</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">75</td>
<td class="gt_row gt_right">18.47</td>
<td class="gt_row gt_right">0.1%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.08px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">30.5K</td>
<td class="gt_row gt_right">100.0%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:75.0px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">2.07M</td>
<td class="gt_row gt_right">82.9%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:62.18px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">92</td>
<td class="gt_row gt_right">41.44</td>
<td class="gt_row gt_right">0.2%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.17px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">28.6K</td>
<td class="gt_row gt_right">93.6%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:70.23px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">1.58M</td>
<td class="gt_row gt_right">63.3%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:47.47px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">93</td>
<td class="gt_row gt_right">46.34</td>
<td class="gt_row gt_right">0.3%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.19px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">17.3K</td>
<td class="gt_row gt_right">56.6%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:42.46px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">1.59M</td>
<td class="gt_row gt_right">63.4%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:47.55px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">94</td>
<td class="gt_row gt_right">65.14</td>
<td class="gt_row gt_right">0.4%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:0.27px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">22.4K</td>
<td class="gt_row gt_right">73.5%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:55.15px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">1.35M</td>
<td class="gt_row gt_right">53.8%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:40.34px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">06</td>
<td class="gt_row gt_right">341.25</td>
<td class="gt_row gt_right">1.9%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:1.4px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">21.3K</td>
<td class="gt_row gt_right">69.7%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:52.26px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">1.11M</td>
<td class="gt_row gt_right">44.2%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:33.17px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="10" class="gt_group_heading" data-quarto-table-cell-role="th">5 départements les plus pollueurs</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">70</td>
<td class="gt_row gt_right">12,080.10</td>
<td class="gt_row gt_right">66.0%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:49.49px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">20.0K</td>
<td class="gt_row gt_right">65.7%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:49.28px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">225.88K</td>
<td class="gt_row gt_right">9.0%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:6.77px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">76</td>
<td class="gt_row gt_right">12,216.64</td>
<td class="gt_row gt_right">66.7%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:50.05px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">21.0K</td>
<td class="gt_row gt_right">69.0%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:51.74px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">1.21M</td>
<td class="gt_row gt_right">48.3%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:36.21px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">88</td>
<td class="gt_row gt_right">12,312.98</td>
<td class="gt_row gt_right">67.3%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:50.44px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">19.9K</td>
<td class="gt_row gt_right">65.3%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:48.99px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">353.37K</td>
<td class="gt_row gt_right">14.1%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:10.59px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">62</td>
<td class="gt_row gt_right">12,585.99</td>
<td class="gt_row gt_right">68.7%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:51.56px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">19.7K</td>
<td class="gt_row gt_right">64.5%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:48.35px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">1.44M</td>
<td class="gt_row gt_right">57.5%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:43.14px;background-color:blue;">

</div>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">80</td>
<td class="gt_row gt_right">18,308.20</td>
<td class="gt_row gt_right">100.0%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:75.0px;background-color:green;">

</div>
</div></td>
<td class="gt_row gt_right">20.0K</td>
<td class="gt_row gt_right">65.7%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:49.26px;background-color:red;">

</div>
</div></td>
<td class="gt_row gt_right">535.82K</td>
<td class="gt_row gt_right">21.4%</td>
<td class="gt_row gt_left"><div style="width: 75px; background-color: lightgrey;">
<div style="height:20px;width:16.06px;background-color:blue;">

</div>
</div></td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="10" class="gt_sourcenote"><em>*<strong>Note</strong>: The median income presented here is an approximation of the department's median income</em>.</td>
</tr>
<tr class="odd">
<td colspan="10" class="gt_sourcenote"><em><strong>Reading</strong>: The <strong>(%)</strong> columns presented above are scaled to the maximum value of the variable</em></td>
</tr>
<tr class="even">
<td colspan="10" class="gt_sourcenote"><em><strong>Source</strong>: Calculations based on Ademe data</em></td>
</tr>
</tfoot>

</table>


</div>
        
</div>
</div>
</div>
<p>Thanks to this, we can already understand that our definition of the carbon footprint is certainly flawed. It seems unlikely that the inhabitants of the 77th department have a carbon footprint 500 times greater than that of intra-muros Paris. The main reason? We are not dealing with a concept of consumption emissions but production emissions, which penalizes industrial areas or areas with airports…</p>
<p>To learn more about constructing tables with <code>great_tables</code>, you can replicate this <a href="https://rgeo.linogaliana.fr/exercises/eval.html">exercise</a> on producing electoral tables that I proposed for an <code>R</code> course with <code>gt</code>, the equivalent of <code>great_tables</code> for <code>R</code>.</p>
</section>
<section id="pandas-towards-practice-and-beyond" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> <code>Pandas</code>: towards practice and beyond</h1>
<section id="pandas-in-a-chain-of-operations" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="pandas-in-a-chain-of-operations"><span class="header-section-number">7.1</span> <code>Pandas</code> in a chain of operations</h2>
<p>Generally, in a project, data cleaning will consist of a series of methods applied to a <code>DataFrame</code> or a <code>Series</code> when working exclusively on a single column. In other words, what is usually expected when working with <code>Pandas</code> is to have a chain that takes a <code>DataFrame</code> as input and outputs the same <code>DataFrame</code> enriched or an aggregated version of it.</p>
<p>This way of proceeding is at the heart of the <code>dplyr</code> syntax in <code>R</code> but is not necessarily native in <code>Pandas</code> depending on the operations you want to implement. Indeed, the natural way to update a dataframe in <code>Pandas</code> often involves syntax like:</p>
<div id="402fe244" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="402fe244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="402fe244-1"><a href="#402fe244-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="402fe244-2"><a href="#402fe244-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="402fe244-3"><a href="#402fe244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="402fe244-4"><a href="#402fe244-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="dv">8000</span>, <span class="dv">1000</span>], [<span class="dv">9500</span>, np.nan], [<span class="dv">5000</span>, <span class="dv">2000</span>]]</span>
<span id="402fe244-5"><a href="#402fe244-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">"salaire"</span>, <span class="st">"autre_info"</span>])</span>
<span id="402fe244-6"><a href="#402fe244-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"salaire_net"</span>] <span class="op">=</span> df[<span class="st">"salaire"</span>] <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <code>SQL</code> you could directly update your database with the new column:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, salaire<span class="op">*</span><span class="fl">0.8</span> <span class="kw">AS</span> salaire_net <span class="kw">FROM</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>tidyverse</code> ecosystem in <code>R</code>, the equivalent of <code>Pandas</code>, works according to the same logic as SQL table updates. Indeed, you would use the following command with <code>dplyr</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">salaire_net =</span> salaire<span class="sc">*</span><span class="fl">0.8</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Technically, you could do this with an <code>assign</code> in <code>Pandas</code>:</p>
<div id="e7ce1476" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="e7ce1476"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="e7ce1476" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="e7ce1476-1" class="code-annotation-target"><a href="#e7ce1476-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">"salaire_net"</span>, axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="e7ce1476-2"><a href="#e7ce1476-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(salaire_net<span class="op">=</span><span class="kw">lambda</span> s: s[<span class="st">"salaire"</span>] <span class="op">*</span> <span class="fl">0.8</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="e7ce1476" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="e7ce1476" data-code-lines="1" data-code-annotation="1">To delete the variable to start from the initial example</span>
</dd>
</dl>
</div>
</div>
<p>However, this <code>assign</code> syntax is not very natural. It requires passing a lambda function that expects a <code>DataFrame</code> as input where you would want a column. So, it is not really a readable and practical syntax.</p>
<p>It is nevertheless possible to chain operations on datasets using <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pipe.html">pipes</a>. These follow the same philosophy as <code>dplyr</code>, itself inspired by the Linux pipe. This approach will make the code more readable by defining functions that perform operations on one or more columns of a DataFrame. The first argument to the function is the <code>DataFrame</code>, the others are those controlling its behavior:</p>
<div id="b9ffd550" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="b9ffd550"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="b9ffd550-1"><a href="#b9ffd550-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcul_salaire_net(df: pd.DataFrame, col: <span class="bu">str</span>, taux: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.8</span>):</span>
<span id="b9ffd550-2"><a href="#b9ffd550-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"salaire_net"</span>] <span class="op">=</span> df[col] <span class="op">*</span> taux</span>
<span id="b9ffd550-3"><a href="#b9ffd550-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This transforms our production chain into:</p>
<div id="6f99367c" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="6f99367c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6f99367c-1"><a href="#6f99367c-1" aria-hidden="true" tabindex="-1"></a>(df.pipe(calcul_salaire_net, <span class="st">"salaire"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">salaire</th>
<th data-quarto-table-cell-role="th">autre_info</th>
<th data-quarto-table-cell-role="th">salaire_net</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8000</td>
<td>1000.0</td>
<td>6400.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>9500</td>
<td>NaN</td>
<td>7600.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5000</td>
<td>2000.0</td>
<td>4000.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="some-limitations-regarding-pandas-syntax" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="some-limitations-regarding-pandas-syntax"><span class="header-section-number">7.2</span> Some limitations regarding <code>Pandas</code> syntax</h2>
<p>There is a before and after <code>Pandas</code> in data analysis with <code>Python</code>. Without this incredibly practical package, Python, despite all its strengths, would have struggled to establish itself in the data analysis landscape. However, while <code>Pandas</code> offers a coherent syntax in many aspects, it is not perfect either. More recent data analysis paradigms in <code>Python</code> sometimes aim to correct these syntactical imperfections.</p>
<p>Among the most annoying points in everyday use is the need to regularly perform <code>reset_index</code> when building descriptive statistics. Indeed, it can be dangerous to keep indices that are not well controlled because, if we are not careful during the merge phases, they can be misused by <code>Pandas</code> to join data, leading to surprises.</p>
<p><code>Pandas</code> is extremely well-designed for restructuring data from long to wide format or vice versa. However, this is not the only way to restructure a dataset that we might want to implement. It often happens that we want to compare the value of an observation to that of a group to which it belongs. This is particularly useful in anomaly analysis, outlier detection, or fraud investigation. Natively, in <code>Pandas</code>, you need to build an aggregate statistic by group and then merge it back to the initial data using the group variable. This is somewhat tedious:</p>
<div id="e8c94d42" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="e8c94d42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e8c94d42-1"><a href="#e8c94d42-1" aria-hidden="true" tabindex="-1"></a>emissions_moyennes <span class="op">=</span> emissions.groupby(<span class="st">"dep"</span>).agg({<span class="st">"Agriculture"</span>: <span class="st">"mean"</span>}).reset_index()</span>
<span id="e8c94d42-2"><a href="#e8c94d42-2" aria-hidden="true" tabindex="-1"></a>emissions_enrichies <span class="op">=</span> emissions.merge(</span>
<span id="e8c94d42-3"><a href="#e8c94d42-3" aria-hidden="true" tabindex="-1"></a>    emissions_moyennes, on<span class="op">=</span><span class="st">"dep"</span>, suffixes<span class="op">=</span>[<span class="st">""</span>, <span class="st">"_moyenne_dep"</span>]</span>
<span id="e8c94d42-4"><a href="#e8c94d42-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="e8c94d42-5"><a href="#e8c94d42-5" aria-hidden="true" tabindex="-1"></a>emissions_enrichies[<span class="st">"relatives"</span>] <span class="op">=</span> (</span>
<span id="e8c94d42-6"><a href="#e8c94d42-6" aria-hidden="true" tabindex="-1"></a>    emissions_enrichies[<span class="st">"Agriculture"</span>] <span class="op">/</span> emissions_enrichies[<span class="st">"Agriculture_moyenne_dep"</span>]</span>
<span id="e8c94d42-7"><a href="#e8c94d42-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="e8c94d42-8"><a href="#e8c94d42-8" aria-hidden="true" tabindex="-1"></a>emissions_enrichies.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_left</th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
<th data-quarto-table-cell-role="th">Agriculture</th>
<th data-quarto-table-cell-role="th">Autres transports</th>
<th data-quarto-table-cell-role="th">Autres transports international</th>
<th data-quarto-table-cell-role="th">CO2 biomasse hors-total</th>
<th data-quarto-table-cell-role="th">Déchets</th>
<th data-quarto-table-cell-role="th">Energie</th>
<th data-quarto-table-cell-role="th">Industrie hors-énergie</th>
<th data-quarto-table-cell-role="th">Résidentiel</th>
<th data-quarto-table-cell-role="th">Routier</th>
<th data-quarto-table-cell-role="th">Tertiaire</th>
<th data-quarto-table-cell-role="th">dep</th>
<th data-quarto-table-cell-role="th">emissions</th>
<th data-quarto-table-cell-role="th">Agriculture_moyenne_dep</th>
<th data-quarto-table-cell-role="th">relatives</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>01001</td>
<td>L'ABERGEMENT-CLEMENCIAT</td>
<td>3711.425991</td>
<td>NaN</td>
<td>NaN</td>
<td>432.751835</td>
<td>101.430476</td>
<td>2.354558</td>
<td>6.911213</td>
<td>309.358195</td>
<td>793.156501</td>
<td>367.036172</td>
<td>01</td>
<td>11448.849883</td>
<td>1974.535382</td>
<td>1.879645</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>01002</td>
<td>L'ABERGEMENT-DE-VAREY</td>
<td>475.330205</td>
<td>NaN</td>
<td>NaN</td>
<td>140.741660</td>
<td>140.675439</td>
<td>2.354558</td>
<td>6.911213</td>
<td>104.866444</td>
<td>348.997893</td>
<td>112.934207</td>
<td>01</td>
<td>2667.623238</td>
<td>1974.535382</td>
<td>0.240730</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>01004</td>
<td>AMBERIEU-EN-BUGEY</td>
<td>499.043526</td>
<td>212.577908</td>
<td>NaN</td>
<td>10313.446515</td>
<td>5314.314445</td>
<td>998.332482</td>
<td>2930.354461</td>
<td>16616.822534</td>
<td>15642.420313</td>
<td>10732.376934</td>
<td>01</td>
<td>126523.378237</td>
<td>1974.535382</td>
<td>0.252740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>01005</td>
<td>AMBERIEUX-EN-DOMBES</td>
<td>1859.160954</td>
<td>NaN</td>
<td>NaN</td>
<td>1144.429311</td>
<td>216.217508</td>
<td>94.182310</td>
<td>276.448534</td>
<td>663.683146</td>
<td>1756.341319</td>
<td>782.404357</td>
<td>01</td>
<td>13591.734878</td>
<td>1974.535382</td>
<td>0.941569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>01006</td>
<td>AMBLEON</td>
<td>448.966808</td>
<td>NaN</td>
<td>NaN</td>
<td>77.033834</td>
<td>48.401549</td>
<td>NaN</td>
<td>NaN</td>
<td>43.714019</td>
<td>398.786800</td>
<td>51.681756</td>
<td>01</td>
<td>2145.169533</td>
<td>1974.535382</td>
<td>0.227378</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>In the <code>tidyverse</code>, this two-step operation could be done in a single step, which is more convenient:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>emissions <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dep) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">relatives =</span> Agriculture<span class="sc">/</span><span class="fu">mean</span>(Agriculture))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This isn’t too bad, but it does make <code>Pandas</code> processing chains longer and therefore increases the maintenance burden to keep them running over time.</p>
<p>More generally, <code>Pandas</code> processing chains can be quite verbose because it is often necessary to redefine the <code>DataFrame</code> rather than just the columns. For example, to filter rows and columns, you have to:</p>
<div id="2bc77c6a" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="2bc77c6a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="2bc77c6a-1"><a href="#2bc77c6a-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="2bc77c6a-2"><a href="#2bc77c6a-2" aria-hidden="true" tabindex="-1"></a>    emissions.loc[</span>
<span id="2bc77c6a-3"><a href="#2bc77c6a-3" aria-hidden="true" tabindex="-1"></a>        (emissions[<span class="st">"dep"</span>] <span class="op">==</span> <span class="st">"12"</span>) <span class="op">&amp;</span> (emissions[<span class="st">"Routier"</span>] <span class="op">&gt;</span> <span class="dv">500</span>),</span>
<span id="2bc77c6a-4"><a href="#2bc77c6a-4" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"INSEE commune"</span>, <span class="st">"Commune"</span>],</span>
<span id="2bc77c6a-5"><a href="#2bc77c6a-5" aria-hidden="true" tabindex="-1"></a>    ].head(<span class="dv">5</span>)</span>
<span id="2bc77c6a-6"><a href="#2bc77c6a-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4058</td>
<td>12001</td>
<td>AGEN-D'AVEYRON</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4059</td>
<td>12002</td>
<td>AGUESSAC</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4062</td>
<td>12006</td>
<td>ALRANCE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4063</td>
<td>12007</td>
<td>AMBEYRAC</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4064</td>
<td>12008</td>
<td>ANGLARS-SAINT-FELIX</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>In SQL, you could simply refer to the columns in the filter:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="ot">"INSEE commune"</span>, <span class="st">'Commune'</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> emissions </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dep<span class="op">==</span><span class="ot">"12"</span> <span class="kw">AND</span> Routier<span class="op">&gt;</span><span class="dv">500</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the <code>tidyverse</code> (R), you could also do this simply:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep<span class="sc">==</span><span class="st">"12"</span>, Routier<span class="sc">&gt;</span><span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">INSEE commune</span><span class="st">`</span>, <span class="st">`</span><span class="at">Commune</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="other-paradigms" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Other paradigms</h1>
<p>These two chapters have explored in depth the richness of the <code>Pandas</code> ecosystem, which is indispensable in the data scientist’s toolbox. Despite all the limitations we have mentioned, and the alternative solutions we will present, <code>Pandas</code> remains the central package of the data ecosystem with <code>Python</code>. In the following chapters, we will see its native integration with the <code>Scikit</code> ecosystem for machine learning or the extension of <code>Pandas</code> to spatial data with <code>GeoPandas</code>.</p>
<p>Other technical solutions that we will discuss here may be relevant if you want to handle large volumes of data or if you want to use alternative syntaxes.</p>
<p>The main alternatives to <code>Pandas</code> are <a href="https://pola.rs/"><code>Polars</code></a>, <a href="https://duckdb.org/"><code>DuckDB</code></a>, and <a href="https://spark.apache.org/docs/latest/api/python/index.html"><code>Spark</code></a>. There is also <a href="https://www.dask.org/"><code>Dask</code></a>, a library for parallelizing <code>Pandas</code> operations.</p>
<section id="polars-1" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="polars-1"><span class="header-section-number">8.1</span> <code>Polars</code></h2>
<p><code>Polars</code> is certainly the paradigm most inspired by <code>Pandas</code>, even in the choice of name. The first fundamental difference lies in the internal layers used. <code>Polars</code> relies on the <code>Rust</code> implementation of <code>Arrow</code>, whereas <code>Pandas</code> relies on <code>Numpy</code>, which results in performance loss. This allows <code>Polars</code> to be more efficient on large volumes of data, especially since many operations are parallelized and rely on lazy evaluation, a programming principle that optimizes queries for logical rather than defined execution order.</p>
<p>Another strength of <code>Polars</code> is its more coherent syntax, benefiting from over fifteen years of <code>Pandas</code> existence and almost a decade of <code>dplyr</code> (the data manipulation package within the <code>R</code> tidyverse paradigm). To take the previous example, there is no longer a need to force the reference to the DataFrame; in an execution chain, all subsequent references will be made with respect to the initial DataFrame.
²</p>
<div id="4cf880ce" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="4cf880ce"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="4cf880ce-1"><a href="#4cf880ce-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="4cf880ce-2"><a href="#4cf880ce-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="4cf880ce-3"><a href="#4cf880ce-3" aria-hidden="true" tabindex="-1"></a>emissions_polars <span class="op">=</span> pl.from_pandas(emissions)</span>
<span id="4cf880ce-4"><a href="#4cf880ce-4" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="4cf880ce-5"><a href="#4cf880ce-5" aria-hidden="true" tabindex="-1"></a>    emissions_polars.<span class="bu">filter</span>(pl.col(<span class="st">"dep"</span>) <span class="op">==</span> <span class="st">"12"</span>, pl.col(<span class="st">"Routier"</span>) <span class="op">&gt;</span> <span class="dv">500</span>)</span>
<span id="4cf880ce-6"><a href="#4cf880ce-6" aria-hidden="true" tabindex="-1"></a>    .select(<span class="st">"INSEE commune"</span>, <span class="st">"Commune"</span>)</span>
<span id="4cf880ce-7"><a href="#4cf880ce-7" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">5</span>)</span>
<span id="4cf880ce-8"><a href="#4cf880ce-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<div>
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 2)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">INSEE commune</th>
<th data-quarto-table-cell-role="th">Commune</th>
</tr>
<tr class="odd">
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"12001"</td>
<td>"AGEN-D'AVEYRON"</td>
</tr>
<tr class="even">
<td>"12002"</td>
<td>"AGUESSAC"</td>
</tr>
<tr class="odd">
<td>"12006"</td>
<td>"ALRANCE"</td>
</tr>
<tr class="even">
<td>"12007"</td>
<td>"AMBEYRAC"</td>
</tr>
<tr class="odd">
<td>"12008"</td>
<td>"ANGLARS-SAINT-FELIX"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>To learn about <code>Polars</code>, many online resources are available, including <a href="https://github.com/InseeFrLab/ssphub/blob/main/post/polars/polars-tuto.ipynb">this notebook</a> built for the public statistics data scientists network.</p>
</section>
<section id="duckdb-1" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="duckdb-1"><span class="header-section-number">8.2</span> <code>DuckDB</code></h2>
<p><code>DuckDB</code> is the newcomer in the data analysis ecosystem, pushing the limits of data processing with <code>Python</code> without resorting to big data tools like <code>Spark</code>. <code>DuckDB</code> epitomizes a new paradigm, the <a href="https://motherduck.com/blog/big-data-is-dead/">“Big data is dead”</a> paradigm, where large data volumes can be processed without imposing infrastructures.</p>
<p>Besides its great efficiency, as <code>DuckDB</code> can handle data volumes larger than the computer or server’s RAM, it offers the advantage of a uniform syntax across languages that call <code>DuckDB</code> (<code>Python</code>, <code>R</code>, <code>C++</code>, or <code>Javascript</code>). <code>DuckDB</code> favors SQL syntax for data processing with many pre-implemented functions to simplify certain data transformations (e.g., for <a href="https://duckdb.org/docs/sql/functions/char.html">text data</a>, <a href="https://duckdb.org/docs/sql/functions/time">time data</a>, etc.).</p>
<p>Compared to other SQL-based systems like <a href="https://www.postgresql.org/"><code>PostGreSQL</code></a>, <code>DuckDB</code> is very simple to install, as it is just a <code>Python</code> library, whereas many tools like <code>PostGreSQL</code> require an appropriate infrastructure.</p>
<p>To reuse the previous example, we can directly use the SQL code mentioned earlier.</p>
<div id="475eb648" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="475eb648"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="475eb648-1"><a href="#475eb648-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="475eb648-2"><a href="#475eb648-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="475eb648-3"><a href="#475eb648-3" aria-hidden="true" tabindex="-1"></a>duckdb.sql(</span>
<span id="475eb648-4"><a href="#475eb648-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="475eb648-5"><a href="#475eb648-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT "INSEE commune", "Commune"</span></span>
<span id="475eb648-6"><a href="#475eb648-6" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM emissions</span></span>
<span id="475eb648-7"><a href="#475eb648-7" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE dep=='12' AND Routier&gt;500</span></span>
<span id="475eb648-8"><a href="#475eb648-8" aria-hidden="true" tabindex="-1"></a><span class="st">  LIMIT 5</span></span>
<span id="475eb648-9"><a href="#475eb648-9" aria-hidden="true" tabindex="-1"></a><span class="st">  """</span></span>
<span id="475eb648-10"><a href="#475eb648-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>┌───────────────┬─────────────────────┐
│ INSEE commune │       Commune       │
│    varchar    │       varchar       │
├───────────────┼─────────────────────┤
│ 12001         │ AGEN-D'AVEYRON      │
│ 12002         │ AGUESSAC            │
│ 12006         │ ALRANCE             │
│ 12007         │ AMBEYRAC            │
│ 12008         │ ANGLARS-SAINT-FELIX │
└───────────────┴─────────────────────┘</code></pre>
</div>
</div>
<p>Here, the clause <code>FROM emissions</code> comes from the fact that we can directly execute SQL from a <code>Pandas</code> object via <code>DuckDB</code>. If we read directly in the query, it gets slightly more complex, but the logic remains the same.</p>
<div id="3e4363ff" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="3e4363ff"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="3e4363ff-1"><a href="#3e4363ff-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="3e4363ff-2"><a href="#3e4363ff-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="3e4363ff-3"><a href="#3e4363ff-3" aria-hidden="true" tabindex="-1"></a>duckdb.sql(</span>
<span id="3e4363ff-4"><a href="#3e4363ff-4" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"""</span></span>
<span id="3e4363ff-5"><a href="#3e4363ff-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  SELECT "INSEE commune", "Commune"</span></span>
<span id="3e4363ff-6"><a href="#3e4363ff-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  FROM read_csv_auto("</span><span class="sc">{</span>url<span class="sc">}</span><span class="ss">")</span></span>
<span id="3e4363ff-7"><a href="#3e4363ff-7" aria-hidden="true" tabindex="-1"></a><span class="ss">  WHERE</span></span>
<span id="3e4363ff-8"><a href="#3e4363ff-8" aria-hidden="true" tabindex="-1"></a><span class="ss">    substring("INSEE commune",1,2)=='12'</span></span>
<span id="3e4363ff-9"><a href="#3e4363ff-9" aria-hidden="true" tabindex="-1"></a><span class="ss">    AND</span></span>
<span id="3e4363ff-10"><a href="#3e4363ff-10" aria-hidden="true" tabindex="-1"></a><span class="ss">    Routier&gt;500</span></span>
<span id="3e4363ff-11"><a href="#3e4363ff-11" aria-hidden="true" tabindex="-1"></a><span class="ss">  LIMIT 5</span></span>
<span id="3e4363ff-12"><a href="#3e4363ff-12" aria-hidden="true" tabindex="-1"></a><span class="ss">  """</span></span>
<span id="3e4363ff-13"><a href="#3e4363ff-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>┌───────────────┬─────────────────────┐
│ INSEE commune │       Commune       │
│    varchar    │       varchar       │
├───────────────┼─────────────────────┤
│ 12001         │ AGEN-D'AVEYRON      │
│ 12002         │ AGUESSAC            │
│ 12006         │ ALRANCE             │
│ 12007         │ AMBEYRAC            │
│ 12008         │ ANGLARS-SAINT-FELIX │
└───────────────┴─────────────────────┘</code></pre>
</div>
</div>
<p>The rendering of the DataFrame is slightly different from <code>Pandas</code> because, like <code>Polars</code> and many large data processing systems, <code>DuckDB</code> relies on lazy evaluation and thus only displays a sample of data. <code>DuckDB</code> and <code>Polars</code> are also well integrated with each other. You can run SQL on a <code>Polars</code> object via <code>DuckDB</code> or apply <code>Polars</code> functions to an initially read <code>DuckDB</code> object.</p>
<p>One of the interests of <code>DuckDB</code> is its excellent integration with the <code>Parquet</code> ecosystem, the already mentioned data format that is becoming a standard in data sharing (for example, it is the cornerstone of data sharing on the HuggingFace platform). To learn more about <code>DuckDB</code> and discover its usefulness for reading data from the French population census, you can check out <a href="https://ssphub.netlify.app/post/parquetrp/">this blog post</a>.</p>
</section>
<section id="spark" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="spark"><span class="header-section-number">8.3</span> <code>Spark</code></h2>
<p><code>DuckDB</code> has pushed the boundaries of big data, which can be defined as the volume of data that can no longer be processed on a single machine without implementing a parallelization strategy.</p>
<p>Nevertheless, for very large data volumes, <code>Python</code> is well-equipped with the <a href="https://spark.apache.org/docs/latest/api/python/index.html"><code>PySpark</code></a> library. This is a Python API for the Spark language, a big data language based on Scala. This paradigm is built on the idea that <code>Python</code> users access it via clusters with many nodes to process data in parallel. The data will be read in blocks, processed in parallel depending on the number of parallel nodes. The <code>Spark</code> DataFrame API has a syntax close to previous paradigms with more complex engineering in the background related to native parallelization.</p>
</section>
<section id="informations-additionnelles" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="informations-additionnelles">Informations additionnelles</h2>
<details>
<summary>
<p><i class="fa-brands fa-python" aria-label="python"></i> environment files have been tested on.</p>
</summary>
<p>Latest built version: 2024-10-11</p>
<p>Python version used:</p>
<div id="d5ddeca4" class="cell" data-execution_count="95">
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>'3.11.6 | packaged by conda-forge | (main, Oct  3 2023, 10:40:35) [GCC 12.3.0]'</code></pre>
</div>
</div>
<div class="git-details">
<div class="pip-freeze">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">affine</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aiobotocore</td>
<td style="text-align: left;">2.12.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiohttp</td>
<td style="text-align: left;">3.9.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aioitertools</td>
<td style="text-align: left;">0.11.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aiosignal</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">alembic</td>
<td style="text-align: left;">1.13.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">altair</td>
<td style="text-align: left;">5.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">aniso8601</td>
<td style="text-align: left;">9.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annotated-types</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">appdirs</td>
<td style="text-align: left;">1.4.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">archspec</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">astroid</td>
<td style="text-align: left;">3.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">attrs</td>
<td style="text-align: left;">23.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">babel</td>
<td style="text-align: left;">2.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bcrypt</td>
<td style="text-align: left;">4.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beautifulsoup4</td>
<td style="text-align: left;">4.12.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">black</td>
<td style="text-align: left;">24.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blinker</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blis</td>
<td style="text-align: left;">0.7.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bokeh</td>
<td style="text-align: left;">3.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">boltons</td>
<td style="text-align: left;">23.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">boto3</td>
<td style="text-align: left;">1.34.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">botocore</td>
<td style="text-align: left;">1.34.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">branca</td>
<td style="text-align: left;">0.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brotli</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cachetools</td>
<td style="text-align: left;">5.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cartiflette</td>
<td style="text-align: left;">0.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cartopy</td>
<td style="text-align: left;">0.24.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">catalogue</td>
<td style="text-align: left;">2.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">cattrs</td>
<td style="text-align: left;">24.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">certifi</td>
<td style="text-align: left;">2024.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cffi</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">chromedriver-autoinstaller</td>
<td style="text-align: left;">0.6.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">click</td>
<td style="text-align: left;">8.1.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">click-plugins</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cligj</td>
<td style="text-align: left;">0.7.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloudpathlib</td>
<td style="text-align: left;">0.19.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">colorama</td>
<td style="text-align: left;">0.4.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comm</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">commonmark</td>
<td style="text-align: left;">0.9.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda</td>
<td style="text-align: left;">24.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda-libmamba-solver</td>
<td style="text-align: left;">24.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">conda-package-handling</td>
<td style="text-align: left;">2.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">conda_package_streaming</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">confection</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">contextily</td>
<td style="text-align: left;">1.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contourpy</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cryptography</td>
<td style="text-align: left;">42.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cycler</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cymem</td>
<td style="text-align: left;">2.0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cytoolz</td>
<td style="text-align: left;">0.12.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">dask</td>
<td style="text-align: left;">2024.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dask-expr</td>
<td style="text-align: left;">1.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">debugpy</td>
<td style="text-align: left;">1.8.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">decorator</td>
<td style="text-align: left;">5.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">dill</td>
<td style="text-align: left;">0.3.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">diskcache</td>
<td style="text-align: left;">5.6.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">distributed</td>
<td style="text-align: left;">2024.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distro</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">docker</td>
<td style="text-align: left;">7.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">duckdb</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">en-core-web-sm</td>
<td style="text-align: left;">3.7.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">entrypoints</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">et-xmlfile</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exceptiongroup</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">executing</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fastexcel</td>
<td style="text-align: left;">0.11.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">fastjsonschema</td>
<td style="text-align: left;">2.19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fiona</td>
<td style="text-align: left;">1.9.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">flake8</td>
<td style="text-align: left;">7.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flask</td>
<td style="text-align: left;">3.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">folium</td>
<td style="text-align: left;">0.16.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fontawesomefree</td>
<td style="text-align: left;">6.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fonttools</td>
<td style="text-align: left;">4.51.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fr-core-news-sm</td>
<td style="text-align: left;">3.7.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">frozenlist</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">funcy</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDAL</td>
<td style="text-align: left;">3.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">gensim</td>
<td style="text-align: left;">4.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geographiclib</td>
<td style="text-align: left;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopandas</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geoplot</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">geopy</td>
<td style="text-align: left;">2.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gitdb</td>
<td style="text-align: left;">4.0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GitPython</td>
<td style="text-align: left;">3.1.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">google-auth</td>
<td style="text-align: left;">2.29.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphene</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphql-core</td>
<td style="text-align: left;">3.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">graphql-relay</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">graphviz</td>
<td style="text-align: left;">0.20.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">great-tables</td>
<td style="text-align: left;">0.12.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">greenlet</td>
<td style="text-align: left;">3.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">gunicorn</td>
<td style="text-align: left;">21.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">h11</td>
<td style="text-align: left;">0.14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">0.5.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hvac</td>
<td style="text-align: left;">2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">idna</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">imageio</td>
<td style="text-align: left;">2.35.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">importlib_metadata</td>
<td style="text-align: left;">7.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">importlib_resources</td>
<td style="text-align: left;">6.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">inflate64</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipykernel</td>
<td style="text-align: left;">6.29.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">ipython</td>
<td style="text-align: left;">8.22.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ipywidgets</td>
<td style="text-align: left;">8.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">isort</td>
<td style="text-align: left;">5.13.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">itsdangerous</td>
<td style="text-align: left;">2.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">jedi</td>
<td style="text-align: left;">0.19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jinja2</td>
<td style="text-align: left;">3.1.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">jmespath</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">joblib</td>
<td style="text-align: left;">1.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonpatch</td>
<td style="text-align: left;">1.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonpointer</td>
<td style="text-align: left;">2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">jsonschema</td>
<td style="text-align: left;">4.21.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jsonschema-specifications</td>
<td style="text-align: left;">2023.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter-cache</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyter_client</td>
<td style="text-align: left;">8.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">jupyter_core</td>
<td style="text-align: left;">5.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jupyterlab_widgets</td>
<td style="text-align: left;">3.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">kaleido</td>
<td style="text-align: left;">0.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kiwisolver</td>
<td style="text-align: left;">1.4.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">kubernetes</td>
<td style="text-align: left;">29.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">langcodes</td>
<td style="text-align: left;">3.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">language_data</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lazy_loader</td>
<td style="text-align: left;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">libmambapy</td>
<td style="text-align: left;">1.5.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">llvmlite</td>
<td style="text-align: left;">0.42.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">locket</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;">5.3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">lz4</td>
<td style="text-align: left;">4.3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">1.3.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mamba</td>
<td style="text-align: left;">1.5.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mapclassify</td>
<td style="text-align: left;">2.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">marisa-trie</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Markdown</td>
<td style="text-align: left;">3.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">markdown-it-py</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MarkupSafe</td>
<td style="text-align: left;">2.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">matplotlib</td>
<td style="text-align: left;">3.8.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">matplotlib-inline</td>
<td style="text-align: left;">0.1.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">mccabe</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mdurl</td>
<td style="text-align: left;">0.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">menuinst</td>
<td style="text-align: left;">2.0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mercantile</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">mizani</td>
<td style="text-align: left;">0.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mlflow</td>
<td style="text-align: left;">2.11.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">mlflow-skinny</td>
<td style="text-align: left;">2.11.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">msgpack</td>
<td style="text-align: left;">1.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">multidict</td>
<td style="text-align: left;">6.0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">multivolumefile</td>
<td style="text-align: left;">0.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">munkres</td>
<td style="text-align: left;">1.1.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">murmurhash</td>
<td style="text-align: left;">1.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">mypy</td>
<td style="text-align: left;">1.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mypy-extensions</td>
<td style="text-align: left;">1.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">narwhals</td>
<td style="text-align: left;">1.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nbclient</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbformat</td>
<td style="text-align: left;">5.10.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nest_asyncio</td>
<td style="text-align: left;">1.6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">networkx</td>
<td style="text-align: left;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nltk</td>
<td style="text-align: left;">3.8.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numba</td>
<td style="text-align: left;">0.59.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numexpr</td>
<td style="text-align: left;">2.10.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numpy</td>
<td style="text-align: left;">1.26.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">oauthlib</td>
<td style="text-align: left;">3.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">opencv-python-headless</td>
<td style="text-align: left;">4.9.0.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">openpyxl</td>
<td style="text-align: left;">3.1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">outcome</td>
<td style="text-align: left;">1.3.0.post0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OWSLib</td>
<td style="text-align: left;">0.28.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">packaging</td>
<td style="text-align: left;">23.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pandas</td>
<td style="text-align: left;">2.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">paramiko</td>
<td style="text-align: left;">3.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parso</td>
<td style="text-align: left;">0.8.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">partd</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pathspec</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">patsy</td>
<td style="text-align: left;">0.5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pebble</td>
<td style="text-align: left;">5.0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">pexpect</td>
<td style="text-align: left;">4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pickleshare</td>
<td style="text-align: left;">0.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">pillow</td>
<td style="text-align: left;">10.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pip</td>
<td style="text-align: left;">24.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pkgutil_resolve_name</td>
<td style="text-align: left;">1.3.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">platformdirs</td>
<td style="text-align: left;">4.2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">5.19.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotnine</td>
<td style="text-align: left;">0.13.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pluggy</td>
<td style="text-align: left;">1.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polars</td>
<td style="text-align: left;">1.8.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">preshed</td>
<td style="text-align: left;">3.0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prometheus_client</td>
<td style="text-align: left;">0.20.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">prometheus-flask-exporter</td>
<td style="text-align: left;">0.23.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prompt-toolkit</td>
<td style="text-align: left;">3.0.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">protobuf</td>
<td style="text-align: left;">4.25.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">psutil</td>
<td style="text-align: left;">5.9.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">ptyprocess</td>
<td style="text-align: left;">0.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pure-eval</td>
<td style="text-align: left;">0.2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">py7zr</td>
<td style="text-align: left;">0.20.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyarrow</td>
<td style="text-align: left;">17.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyarrow-hotfix</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyasn1</td>
<td style="text-align: left;">0.5.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyasn1-modules</td>
<td style="text-align: left;">0.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pybcj</td>
<td style="text-align: left;">1.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycodestyle</td>
<td style="text-align: left;">2.11.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycosat</td>
<td style="text-align: left;">0.6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">pycparser</td>
<td style="text-align: left;">2.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pycryptodomex</td>
<td style="text-align: left;">3.21.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pydantic</td>
<td style="text-align: left;">2.9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pydantic_core</td>
<td style="text-align: left;">2.23.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyflakes</td>
<td style="text-align: left;">3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pygments</td>
<td style="text-align: left;">2.17.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyJWT</td>
<td style="text-align: left;">2.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyLDAvis</td>
<td style="text-align: left;">3.4.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pylint</td>
<td style="text-align: left;">3.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PyNaCl</td>
<td style="text-align: left;">1.5.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pynsee</td>
<td style="text-align: left;">0.1.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyogrio</td>
<td style="text-align: left;">0.10.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyOpenSSL</td>
<td style="text-align: left;">24.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyparsing</td>
<td style="text-align: left;">3.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyppmd</td>
<td style="text-align: left;">1.1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyproj</td>
<td style="text-align: left;">3.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyshp</td>
<td style="text-align: left;">2.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PySocks</td>
<td style="text-align: left;">1.7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-dateutil</td>
<td style="text-align: left;">2.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">python-dotenv</td>
<td style="text-align: left;">1.0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">python-magic</td>
<td style="text-align: left;">0.4.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pytz</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyu2f</td>
<td style="text-align: left;">0.1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pywaffle</td>
<td style="text-align: left;">1.1.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PyYAML</td>
<td style="text-align: left;">6.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pyzmq</td>
<td style="text-align: left;">25.1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">pyzstd</td>
<td style="text-align: left;">0.16.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">querystring-parser</td>
<td style="text-align: left;">1.2.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">rasterio</td>
<td style="text-align: left;">1.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">referencing</td>
<td style="text-align: left;">0.34.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">regex</td>
<td style="text-align: left;">2023.12.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests</td>
<td style="text-align: left;">2.31.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">requests-cache</td>
<td style="text-align: left;">1.2.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requests-oauthlib</td>
<td style="text-align: left;">2.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">retrying</td>
<td style="text-align: left;">1.3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rich</td>
<td style="text-align: left;">13.9.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">rpds-py</td>
<td style="text-align: left;">0.18.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rsa</td>
<td style="text-align: left;">4.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rtree</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ruamel.yaml</td>
<td style="text-align: left;">0.18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruamel.yaml.clib</td>
<td style="text-align: left;">0.2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s3fs</td>
<td style="text-align: left;">2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">s3transfer</td>
<td style="text-align: left;">0.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scikit-image</td>
<td style="text-align: left;">0.24.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">scikit-learn</td>
<td style="text-align: left;">1.4.1.post1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scipy</td>
<td style="text-align: left;">1.13.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">seaborn</td>
<td style="text-align: left;">0.13.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">selenium</td>
<td style="text-align: left;">4.25.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">setuptools</td>
<td style="text-align: left;">69.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shapely</td>
<td style="text-align: left;">2.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">shellingham</td>
<td style="text-align: left;">1.5.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">six</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">smart_open</td>
<td style="text-align: left;">7.0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smmap</td>
<td style="text-align: left;">5.0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sniffio</td>
<td style="text-align: left;">1.3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sortedcontainers</td>
<td style="text-align: left;">2.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">soupsieve</td>
<td style="text-align: left;">2.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy</td>
<td style="text-align: left;">3.7.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">spacy-legacy</td>
<td style="text-align: left;">3.0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spacy-loggers</td>
<td style="text-align: left;">1.0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">SQLAlchemy</td>
<td style="text-align: left;">2.0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sqlparse</td>
<td style="text-align: left;">0.4.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">srsly</td>
<td style="text-align: left;">2.4.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stack-data</td>
<td style="text-align: left;">0.6.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">statsmodels</td>
<td style="text-align: left;">0.14.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tabulate</td>
<td style="text-align: left;">0.9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tblib</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenacity</td>
<td style="text-align: left;">8.2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">texttable</td>
<td style="text-align: left;">1.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">thinc</td>
<td style="text-align: left;">8.2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">threadpoolctl</td>
<td style="text-align: left;">3.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tifffile</td>
<td style="text-align: left;">2024.9.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">tomli</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tomlkit</td>
<td style="text-align: left;">0.12.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">toolz</td>
<td style="text-align: left;">0.12.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">topojson</td>
<td style="text-align: left;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">tornado</td>
<td style="text-align: left;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tqdm</td>
<td style="text-align: left;">4.66.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">traitlets</td>
<td style="text-align: left;">5.14.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trio</td>
<td style="text-align: left;">0.26.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">trio-websocket</td>
<td style="text-align: left;">0.11.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">truststore</td>
<td style="text-align: left;">0.8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">typer</td>
<td style="text-align: left;">0.12.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">typing_extensions</td>
<td style="text-align: left;">4.11.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">tzdata</td>
<td style="text-align: left;">2024.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unidecode</td>
<td style="text-align: left;">1.3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">url-normalize</td>
<td style="text-align: left;">1.4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urllib3</td>
<td style="text-align: left;">1.26.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">wasabi</td>
<td style="text-align: left;">1.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">weasel</td>
<td style="text-align: left;">0.4.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">webdriver-manager</td>
<td style="text-align: left;">4.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">websocket-client</td>
<td style="text-align: left;">1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Werkzeug</td>
<td style="text-align: left;">3.0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">wheel</td>
<td style="text-align: left;">0.43.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widgetsnbextension</td>
<td style="text-align: left;">4.0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">wordcloud</td>
<td style="text-align: left;">1.9.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">wsproto</td>
<td style="text-align: left;">1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xgboost</td>
<td style="text-align: left;">2.0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">xlrd</td>
<td style="text-align: left;">2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">xyzservices</td>
<td style="text-align: left;">2024.4.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">yarl</td>
<td style="text-align: left;">1.9.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellowbrick</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">zict</td>
<td style="text-align: left;">3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zipp</td>
<td style="text-align: left;">3.17.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zstandard</td>
<td style="text-align: left;">0.22.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div></details>
<details>
<summary>
<p>View file history <i class="fa-brands fa-git-alt" aria-label="git-alt"></i></p>
</summary>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="2059" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2058;"><span id="cb31-2059"><a href="#cb31-2059" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Ce fichier a été modifié __</span><span class="sc">${</span>table_commit<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">__ fois depuis sa création le </span><span class="sc">${</span>creation_string<span class="sc">}</span><span class="vs"> (dernière modification le </span><span class="sc">${</span>last_modification_string<span class="sc">}</span><span class="vs">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb32" data-startfrom="2066" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2065;"><span id="cb32-2066"><a href="#cb32-2066" aria-hidden="true" tabindex="-1"></a>creation <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb32-2067"><a href="#cb32-2067" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb32-2068"><a href="#cb32-2068" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-2069"><a href="#cb32-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2070"><a href="#cb32-2070" aria-hidden="true" tabindex="-1"></a>last_modification <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb32-2071"><a href="#cb32-2071" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>))</span>
<span id="cb32-2072"><a href="#cb32-2072" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-2073"><a href="#cb32-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2074"><a href="#cb32-2074" aria-hidden="true" tabindex="-1"></a>creation_string <span class="op">=</span> creation<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb32-2075"><a href="#cb32-2075" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb32-2076"><a href="#cb32-2076" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb32-2077"><a href="#cb32-2077" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb32-2078"><a href="#cb32-2078" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-2079"><a href="#cb32-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2080"><a href="#cb32-2080" aria-hidden="true" tabindex="-1"></a>last_modification_string <span class="op">=</span> last_modification<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr"</span><span class="op">,</span> {</span>
<span id="cb32-2081"><a href="#cb32-2081" aria-hidden="true" tabindex="-1"></a>  <span class="st">"day"</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb32-2082"><a href="#cb32-2082" aria-hidden="true" tabindex="-1"></a>  <span class="st">"month"</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb32-2083"><a href="#cb32-2083" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span><span class="op">:</span> <span class="st">"numeric"</span></span>
<span id="cb32-2084"><a href="#cb32-2084" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="2090" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2089;"><span id="cb33-2090"><a href="#cb33-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_table<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb34" data-startfrom="2095" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2094;"><span id="cb34-2095"><a href="#cb34-2095" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>git_history_plot<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="expression">

</div>
</div>
</div>
<table class="commit-table" border="1">
<thead>
<tr>
<th>
SHA
</th>
<th>
Date
</th>
<th>
Author
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3b6301d">3b6301d</a>
</td>
<td>
2024-09-25 21:11:19
</td>
<td>
lgaliana
</td>
<td>
change order
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/127d17c">127d17c</a>
</td>
<td>
2024-09-25 19:24:01
</td>
<td>
lgaliana
</td>
<td>
formatting
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f243063">f243063</a>
</td>
<td>
2024-09-25 19:21:23
</td>
<td>
lgaliana
</td>
<td>
le bon chemin
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/3fc7b54">3fc7b54</a>
</td>
<td>
2024-09-25 19:11:23
</td>
<td>
lgaliana
</td>
<td>
build pipeline
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/6a00c51">6a00c51</a>
</td>
<td>
2024-09-25 17:28:46
</td>
<td>
Lino Galiana
</td>
<td>
Special callouts for vscode (#558)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/488780a">488780a</a>
</td>
<td>
2024-09-25 14:32:16
</td>
<td>
Lino Galiana
</td>
<td>
Change badge (#556)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/46f038a">46f038a</a>
</td>
<td>
2024-09-23 15:28:36
</td>
<td>
Lino Galiana
</td>
<td>
Mise à jour du premier chapitre sur les figures (#553)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/59f5803">59f5803</a>
</td>
<td>
2024-09-22 16:41:46
</td>
<td>
Lino Galiana
</td>
<td>
Update bike count source data for visualisation tutorial (#552)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/4404ec1">4404ec1</a>
</td>
<td>
2024-09-21 18:28:42
</td>
<td>
lgaliana
</td>
<td>
Back to eval true
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/72d44dd">72d44dd</a>
</td>
<td>
2024-09-21 12:50:38
</td>
<td>
lgaliana
</td>
<td>
Force build for pandas chapters
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/0908656">0908656</a>
</td>
<td>
2024-08-20 16:30:39
</td>
<td>
Lino Galiana
</td>
<td>
English sidebar (#542)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/5108922">5108922</a>
</td>
<td>
2024-08-08 18:43:37
</td>
<td>
Lino Galiana
</td>
<td>
Improve notebook generation and tests on PR (#536)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/f4367f7">f4367f7</a>
</td>
<td>
2024-08-08 11:44:37
</td>
<td>
Lino Galiana
</td>
<td>
Traduction chapitre suite Pandas avec un profile (#534)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/72f42bb">72f42bb</a>
</td>
<td>
2024-07-25 19:06:38
</td>
<td>
Lino Galiana
</td>
<td>
Language message on notebooks (#529)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/195dc9e">195dc9e</a>
</td>
<td>
2024-07-25 11:59:19
</td>
<td>
linogaliana
</td>
<td>
Switch language button
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/fe4edc9">fe4edc9</a>
</td>
<td>
2024-07-10 18:37:22
</td>
<td>
Lino Galiana
</td>
<td>
Second pandas chapter translated (#524)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/065b0ab">065b0ab</a>
</td>
<td>
2024-07-08 11:19:43
</td>
<td>
Lino Galiana
</td>
<td>
Nouveaux callout dans la partie manipulation (#513)
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c6ffbb6">c6ffbb6</a>
</td>
<td>
2024-05-08 07:38:24
</td>
<td>
lgaliana
</td>
<td>
Putting badges in advanced Pandas
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/c3873ed">c3873ed</a>
</td>
<td>
2024-05-07 12:19:12
</td>
<td>
lgaliana
</td>
<td>
Ajoute code commune
</td>
</tr>
<tr>
<td>
<a href="https://github.com/linogaliana/python-datascientist/commit/e0d615e">e0d615e</a>
</td>
<td>
2024-05-03 11:15:29
</td>
<td>
Lino Galiana
</td>
<td>
Restructure la partie Pandas (#497)
</td>
</tr>
</tbody>
</table>
</details>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb35" data-startfrom="2106" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2105;"><span id="cb35-2106"><a href="#cb35-2106" aria-hidden="true" tabindex="-1"></a>git_history_table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb35-2107"><a href="#cb35-2107" aria-hidden="true" tabindex="-1"></a>  table_commit<span class="op">,</span></span>
<span id="cb35-2108"><a href="#cb35-2108" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb35-2109"><a href="#cb35-2109" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb35-2110"><a href="#cb35-2110" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SHA</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`[</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>github_repo<span class="sc">}</span><span class="vs">/commit/</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb35-2111"><a href="#cb35-2111" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Description</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">replacePullRequestPattern</span>(x<span class="op">,</span> github_repo)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb35-2112"><a href="#cb35-2112" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*Date: x =&gt; x.toLocaleString("fr", {</span></span>
<span id="cb35-2113"><a href="#cb35-2113" aria-hidden="true" tabindex="-1"></a><span class="co">        "month": "numeric",</span></span>
<span id="cb35-2114"><a href="#cb35-2114" aria-hidden="true" tabindex="-1"></a><span class="co">        "day": "numeric",</span></span>
<span id="cb35-2115"><a href="#cb35-2115" aria-hidden="true" tabindex="-1"></a><span class="co">        "year": "numeric"</span></span>
<span id="cb35-2116"><a href="#cb35-2116" aria-hidden="true" tabindex="-1"></a><span class="co">        })</span></span>
<span id="cb35-2117"><a href="#cb35-2117" aria-hidden="true" tabindex="-1"></a><span class="co">      */</span></span>
<span id="cb35-2118"><a href="#cb35-2118" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-2119"><a href="#cb35-2119" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-2120"><a href="#cb35-2120" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb36" data-startfrom="2126" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2125;"><span id="cb36-2126"><a href="#cb36-2126" aria-hidden="true" tabindex="-1"></a>git_history_plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb36-2127"><a href="#cb36-2127" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb36-2128"><a href="#cb36-2128" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"royalblue"</span>})<span class="op">,</span></span>
<span id="cb36-2129"><a href="#cb36-2129" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb36-2130"><a href="#cb36-2130" aria-hidden="true" tabindex="-1"></a>          table_commit<span class="op">,</span></span>
<span id="cb36-2131"><a href="#cb36-2131" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">pointerX</span>({<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>}))<span class="op">,</span></span>
<span id="cb36-2132"><a href="#cb36-2132" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(table_commit<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">Date</span>)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"royalblue"</span>})</span>
<span id="cb36-2133"><a href="#cb36-2133" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb36-2134"><a href="#cb36-2134" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb37" data-startfrom="2140" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2139;"><span id="cb37-2140"><a href="#cb37-2140" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">replacePullRequestPattern</span>(inputString<span class="op">,</span> githubRepo) {</span>
<span id="cb37-2141"><a href="#cb37-2141" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use a regular expression to match the pattern #digit</span></span>
<span id="cb37-2142"><a href="#cb37-2142" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> pattern <span class="op">=</span> <span class="ss">/#</span><span class="sc">(\d+)</span><span class="ss">/g</span><span class="op">;</span></span>
<span id="cb37-2143"><a href="#cb37-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2144"><a href="#cb37-2144" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Replace the pattern with ${github_repo}/pull/#digit</span></span>
<span id="cb37-2145"><a href="#cb37-2145" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> replacedString <span class="op">=</span> inputString<span class="op">.</span><span class="fu">replace</span>(pattern<span class="op">,</span> <span class="st">'[#$1]('</span> <span class="op">+</span> githubRepo <span class="op">+</span> <span class="st">'/pull/$1)'</span>)<span class="op">;</span></span>
<span id="cb37-2146"><a href="#cb37-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2147"><a href="#cb37-2147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replacedString<span class="op">;</span></span>
<span id="cb37-2148"><a href="#cb37-2148" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb38" data-startfrom="2154" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2153;"><span id="cb38-2154"><a href="#cb38-2154" aria-hidden="true" tabindex="-1"></a>github_repo <span class="op">=</span> <span class="st">"https://github.com/linogaliana/python-datascientist"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb39" data-startfrom="2159" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2158;"><span id="cb39-2159"><a href="#cb39-2159" aria-hidden="true" tabindex="-1"></a>table_commit <span class="op">=</span> {</span>
<span id="cb39-2160"><a href="#cb39-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2161"><a href="#cb39-2161" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the HTML table by its class name</span></span>
<span id="cb39-2162"><a href="#cb39-2162" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> table <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb39-2163"><a href="#cb39-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2164"><a href="#cb39-2164" aria-hidden="true" tabindex="-1"></a><span class="co">// Check if the table exists</span></span>
<span id="cb39-2165"><a href="#cb39-2165" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (table) {</span>
<span id="cb39-2166"><a href="#cb39-2166" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialize an array to store the table data</span></span>
<span id="cb39-2167"><a href="#cb39-2167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dataArray <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb39-2168"><a href="#cb39-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2169"><a href="#cb39-2169" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract headers from the first row</span></span>
<span id="cb39-2170"><a href="#cb39-2170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> headers <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb39-2171"><a href="#cb39-2171" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb39-2172"><a href="#cb39-2172" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">.</span><span class="fu">push</span>(table<span class="op">.</span><span class="at">rows</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">cells</span>[i]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>())<span class="op">;</span></span>
<span id="cb39-2173"><a href="#cb39-2173" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-2174"><a href="#cb39-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2175"><a href="#cb39-2175" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Iterate through the rows, starting from the second row</span></span>
<span id="cb39-2176"><a href="#cb39-2176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> table<span class="op">.</span><span class="at">rows</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb39-2177"><a href="#cb39-2177" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> row <span class="op">=</span> table<span class="op">.</span><span class="at">rows</span>[i]<span class="op">;</span></span>
<span id="cb39-2178"><a href="#cb39-2178" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> rowData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb39-2179"><a href="#cb39-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2180"><a href="#cb39-2180" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Iterate through the cells in the row</span></span>
<span id="cb39-2181"><a href="#cb39-2181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> row<span class="op">.</span><span class="at">cells</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb39-2182"><a href="#cb39-2182" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Use headers as keys and cell content as values</span></span>
<span id="cb39-2183"><a href="#cb39-2183" aria-hidden="true" tabindex="-1"></a>            rowData[headers[j]] <span class="op">=</span> row<span class="op">.</span><span class="at">cells</span>[j]<span class="op">.</span><span class="at">textContent</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb39-2184"><a href="#cb39-2184" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb39-2185"><a href="#cb39-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2186"><a href="#cb39-2186" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Push the rowData object to the dataArray</span></span>
<span id="cb39-2187"><a href="#cb39-2187" aria-hidden="true" tabindex="-1"></a>        dataArray<span class="op">.</span><span class="fu">push</span>(rowData)<span class="op">;</span></span>
<span id="cb39-2188"><a href="#cb39-2188" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-2189"><a href="#cb39-2189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-2190"><a href="#cb39-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2191"><a href="#cb39-2191" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataArray</span>
<span id="cb39-2192"><a href="#cb39-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2193"><a href="#cb39-2193" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb40" data-startfrom="2199" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2198;"><span id="cb40-2199"><a href="#cb40-2199" aria-hidden="true" tabindex="-1"></a><span class="co">// Get the element with class 'git-details'</span></span>
<span id="cb40-2200"><a href="#cb40-2200" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb40-2201"><a href="#cb40-2201" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> gitDetails <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.commit-table'</span>)<span class="op">;</span></span>
<span id="cb40-2202"><a href="#cb40-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2203"><a href="#cb40-2203" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Check if the element exists</span></span>
<span id="cb40-2204"><a href="#cb40-2204" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (gitDetails) {</span>
<span id="cb40-2205"><a href="#cb40-2205" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Hide the element</span></span>
<span id="cb40-2206"><a href="#cb40-2206" aria-hidden="true" tabindex="-1"></a>      gitDetails<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb40-2207"><a href="#cb40-2207" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-2208"><a href="#cb40-2208" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-13" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb41" data-startfrom="2214" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2213;"><span id="cb41-2214"><a href="#cb41-2214" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.12/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Split-apply-combine (Source: <a href="https://unlhcc.github.io/r-novice-gapminder/16-plyr/">unlhcc.github.io</a>)</span>
<span class="glightbox-desc lightbox-desc-2">Wide and Long Data Formats (Source: <a href="https://r4ds.hadley.nz/"><em>R for Data Science</em></a>)</span>
<span class="glightbox-desc lightbox-desc-4">Illustration of the star schema (Source: <a href="https://www.databricks.com/wp-content/uploads/2022/04/star-schema-erd.png">Databricks</a>)</span>
<span class="glightbox-desc lightbox-desc-5">Joins</span>
<span class="glightbox-desc lightbox-desc-11">Geography of postal codes and municipalities in Aude (11)</span>
<span class="glightbox-desc lightbox-desc-12">Social security number (Source: <a href="https://www.ameli.fr/assure/droits-demarches/principes/numero-securite-sociale">Améli</a>)</span>
</div>
</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Ideally, it would be more coherent, for demographic data, to use the <a href="https://www.insee.fr/fr/information/2008354">legal populations</a>, from the census. However, this base is not yet natively integrated into the <code>pynsee</code> library that we will use in this chapter. An open exercise is proposed to construct population aggregates from anonymized individual census data (the <a href="https://www.insee.fr/fr/information/2383306">detailed files</a>).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Ideally, it would be necessary to ensure that this join does not introduce bias. Indeed, since our reference years are not necessarily identical, there may be a mismatch between our two sources. Since the exercise is already long, we will not go down this path. Interested readers can perform such an analysis as an additional exercise.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@book{galiana2023,
  author = {Galiana, Lino},
  title = {Python Pour La Data Science},
  date = {2023},
  url = {https://pythonds.linogaliana.fr/},
  doi = {10.5281/zenodo.8229676},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-galiana2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Galiana, Lino. 2023. <em>Python Pour La Data Science</em>. <a href="https://doi.org/10.5281/zenodo.8229676">https://doi.org/10.5281/zenodo.8229676</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIHVuZGVybGluZVRpZih4KSB7XG4gIC8vIFVzZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiB0byBmaW5kIGFsbCBvY2N1cnJlbmNlcyBvZiBcInRpZlwiXG4gIGNvbnN0IG1vZHggPSB4LnJlcGxhY2UoL1RJRi9nLCBtYXRjaCA9PiBcbiAgICBgPHNwYW4gc3R5bGU9XCJ0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTsgYm9yZGVyLWJvdHRvbTogc29saWQgMnB4IGJsdWU7IG1hcmdpbi1ib3R0b206IC0ycHg7XCI+JHttYXRjaH08L3NwYW4+YFxuICApO1xuXG4gIGNvbnNvbGUubG9nKG1vZHgpXG4gIFxuICAvLyBSZXR1cm4gdGhlIG1vZGlmaWVkIHN0cmluZyB3cmFwcGVkIGluIGFuIEhUTUwgdGVtcGxhdGVcbiAgcmV0dXJuIGh0bWxgJHttb2R4fWA7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY29pZmZldXJzU2VhcmNoID0gSW5wdXRzLnNlYXJjaChcbiAgdHJhbnNwb3NlKGNvaWZmZXVycyksXG4gIHtsYWJlbDogXCJOb20gZHUgc2Fsb25cIn1cbilcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IklucHV0cy50YWJsZShjb2lmZmV1cnNTZWFyY2gsIHtcbiAgY29sdW1uczogW1xuICAgIFwic2lyZW5cIixcbiAgICBcImRlbm9taW5hdGlvblVzdWVsbGVFdGFibGlzc2VtZW50XCIsXG4gICAgXCJlbnNlaWduZTFFdGFibGlzc2VtZW50XCJcbiAgXSxcbiAgZm9ybWF0OiB7XG4gICAgZGVub21pbmF0aW9uVXN1ZWxsZUV0YWJsaXNzZW1lbnQ6IHggPT4gdW5kZXJsaW5lVGlmKHgpLFxuICAgIGVuc2VpZ25lMUV0YWJsaXNzZW1lbnQ6IHggPT4gdW5kZXJsaW5lVGlmKHgpXG4gIH1cbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGBDZSBmaWNoaWVyIGEgw6l0w6kgbW9kaWZpw6kgX18ke3RhYmxlX2NvbW1pdC5sZW5ndGh9X18gZm9pcyBkZXB1aXMgc2EgY3LDqWF0aW9uIGxlICR7Y3JlYXRpb25fc3RyaW5nfSAoZGVybmnDqHJlIG1vZGlmaWNhdGlvbiBsZSAke2xhc3RfbW9kaWZpY2F0aW9uX3N0cmluZ30pYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY3JlYXRpb24gPSBkMy5taW4oXG4gIHRhYmxlX2NvbW1pdC5tYXAoZCA9PiBuZXcgRGF0ZShkLkRhdGUpKVxuKVxuXG5sYXN0X21vZGlmaWNhdGlvbiA9IGQzLm1heChcbiAgdGFibGVfY29tbWl0Lm1hcChkID0+IG5ldyBEYXRlKGQuRGF0ZSkpXG4pXG5cbmNyZWF0aW9uX3N0cmluZyA9IGNyZWF0aW9uLnRvTG9jYWxlU3RyaW5nKFwiZnJcIiwge1xuICBcImRheVwiOiBcIm51bWVyaWNcIixcbiAgXCJtb250aFwiOiBcImxvbmdcIixcbiAgXCJ5ZWFyXCI6IFwibnVtZXJpY1wiXG59KVxuXG5sYXN0X21vZGlmaWNhdGlvbl9zdHJpbmcgPSBsYXN0X21vZGlmaWNhdGlvbi50b0xvY2FsZVN0cmluZyhcImZyXCIsIHtcbiAgXCJkYXlcIjogXCJudW1lcmljXCIsXG4gIFwibW9udGhcIjogXCJsb25nXCIsXG4gIFwieWVhclwiOiBcIm51bWVyaWNcIlxufSlcblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Z2l0X2hpc3RvcnlfdGFibGV9PC9kaXY+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8ZGl2PiR7Z2l0X2hpc3RvcnlfcGxvdH08L2Rpdj5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJnaXRfaGlzdG9yeV90YWJsZSA9IElucHV0cy50YWJsZShcbiAgdGFibGVfY29tbWl0LFxuICB7XG4gICAgZm9ybWF0OiB7XG4gICAgICBTSEE6IHggPT4gbWRgWyR7eH1dKCR7Z2l0aHViX3JlcG99L2NvbW1pdC8ke3h9KWAsXG4gICAgICBEZXNjcmlwdGlvbjogeCA9PiBtZGAke3JlcGxhY2VQdWxsUmVxdWVzdFBhdHRlcm4oeCwgZ2l0aHViX3JlcG8pfWAsXG4gICAgICAvKkRhdGU6IHggPT4geC50b0xvY2FsZVN0cmluZyhcImZyXCIsIHtcbiAgICAgICAgXCJtb250aFwiOiBcIm51bWVyaWNcIixcbiAgICAgICAgXCJkYXlcIjogXCJudW1lcmljXCIsXG4gICAgICAgIFwieWVhclwiOiBcIm51bWVyaWNcIlxuICAgICAgICB9KVxuICAgICAgKi9cbiAgICB9XG4gIH1cbilcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdpdF9oaXN0b3J5X3Bsb3QgPSBQbG90LnBsb3Qoe1xuICBtYXJrczogW1xuICAgIFBsb3QucnVsZVkoWzBdLCB7c3Ryb2tlOiBcInJveWFsYmx1ZVwifSksXG4gICAgUGxvdC5kb3QoXG4gICAgICAgICAgdGFibGVfY29tbWl0LFxuICAgICAgICAgIFBsb3QucG9pbnRlclgoe3g6IChkKSA9PiBuZXcgRGF0ZShkLmRhdGUpLCB5OiAwLCBzdHJva2U6IFwicmVkXCJ9KSksXG4gICAgUGxvdC5kb3QodGFibGVfY29tbWl0LCB7eDogKGQpID0+IG5ldyBEYXRlKGQuRGF0ZSksIHk6IDAsIGZpbGw6IFwicm95YWxibHVlXCJ9KVxuICBdXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIHJlcGxhY2VQdWxsUmVxdWVzdFBhdHRlcm4oaW5wdXRTdHJpbmcsIGdpdGh1YlJlcG8pIHtcbiAgICAvLyBVc2UgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2ggdGhlIHBhdHRlcm4gI2RpZ2l0XG4gICAgdmFyIHBhdHRlcm4gPSAvIyhcXGQrKS9nO1xuXG4gICAgLy8gUmVwbGFjZSB0aGUgcGF0dGVybiB3aXRoICR7Z2l0aHViX3JlcG99L3B1bGwvI2RpZ2l0XG4gICAgdmFyIHJlcGxhY2VkU3RyaW5nID0gaW5wdXRTdHJpbmcucmVwbGFjZShwYXR0ZXJuLCAnWyMkMV0oJyArIGdpdGh1YlJlcG8gKyAnL3B1bGwvJDEpJyk7XG5cbiAgICByZXR1cm4gcmVwbGFjZWRTdHJpbmc7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2l0aHViX3JlcG8gPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9saW5vZ2FsaWFuYS9weXRob24tZGF0YXNjaWVudGlzdFwiXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidGFibGVfY29tbWl0ID0ge1xuXG4vLyBHZXQgdGhlIEhUTUwgdGFibGUgYnkgaXRzIGNsYXNzIG5hbWVcbnZhciB0YWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21taXQtdGFibGUnKTtcblxuLy8gQ2hlY2sgaWYgdGhlIHRhYmxlIGV4aXN0c1xuaWYgKHRhYmxlKSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBhbiBhcnJheSB0byBzdG9yZSB0aGUgdGFibGUgZGF0YVxuICAgIHZhciBkYXRhQXJyYXkgPSBbXTtcblxuICAgIC8vIEV4dHJhY3QgaGVhZGVycyBmcm9tIHRoZSBmaXJzdCByb3dcbiAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFibGUucm93c1swXS5jZWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgICBoZWFkZXJzLnB1c2godGFibGUucm93c1swXS5jZWxsc1tpXS50ZXh0Q29udGVudC50cmltKCkpO1xuICAgIH1cblxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgcm93cywgc3RhcnRpbmcgZnJvbSB0aGUgc2Vjb25kIHJvd1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGFibGUucm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcm93ID0gdGFibGUucm93c1tpXTtcbiAgICAgICAgdmFyIHJvd0RhdGEgPSB7fTtcblxuICAgICAgICAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIGNlbGxzIGluIHRoZSByb3dcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3cuY2VsbHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIC8vIFVzZSBoZWFkZXJzIGFzIGtleXMgYW5kIGNlbGwgY29udGVudCBhcyB2YWx1ZXNcbiAgICAgICAgICAgIHJvd0RhdGFbaGVhZGVyc1tqXV0gPSByb3cuY2VsbHNbal0udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUHVzaCB0aGUgcm93RGF0YSBvYmplY3QgdG8gdGhlIGRhdGFBcnJheVxuICAgICAgICBkYXRhQXJyYXkucHVzaChyb3dEYXRhKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZGF0YUFycmF5XG5cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbi8vIEdldCB0aGUgZWxlbWVudCB3aXRoIGNsYXNzICdnaXQtZGV0YWlscydcbntcbiAgdmFyIGdpdERldGFpbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWl0LXRhYmxlJyk7XG5cbiAgLy8gQ2hlY2sgaWYgdGhlIGVsZW1lbnQgZXhpc3RzXG4gIGlmIChnaXREZXRhaWxzKSB7XG4gICAgICAvLyBIaWRlIHRoZSBlbGVtZW50XG4gICAgICBnaXREZXRhaWxzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJQbG90ID0gcmVxdWlyZSgnQG9ic2VydmFibGVocS9wbG90QDAuNi4xMi9kaXN0L3Bsb3QudW1kLm1pbi5qcycpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2NvaWZmZXVyc1NlYXJjaCcpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../content/manipulation";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script type="application/vnd.jupyter.widget-state+json">
{"state":{"1fe37fc3edc54c22946da5a37ed25980":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"auto"}},"30a3e0b211ea4624854dfc22f1e3b706":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":"black","description_width":""}},"3e9d9c1552f7499b947bc9f6cbea4bd1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"","description":"","description_allow_html":false,"layout":"IPY_MODEL_c91c23df46e04e2eaa212a7ae0b9f397","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_447b23d099ad40fa83b28c3e58f9937c","tabbable":null,"tooltip":null,"value":100}},"447b23d099ad40fa83b28c3e58f9937c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":"black","description_width":""}},"7a239d756f1347bc83f3cfaf3d8750b2":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"","description":"","description_allow_html":false,"layout":"IPY_MODEL_1fe37fc3edc54c22946da5a37ed25980","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_30a3e0b211ea4624854dfc22f1e3b706","tabbable":null,"tooltip":null,"value":100}},"c91c23df46e04e2eaa212a7ae0b9f397":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"auto"}}},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pythonds\.linogaliana\.fr");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="linogaliana/python-datascientist" data-repo-id="MDEwOlJlcG9zaXRvcnkyODAxNjE2Nzc=" data-category="General" data-category-id="DIC_kwDOELLtjc4B-5TX" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/manipulation/02_pandas_intro.html" class="pagination-link" aria-label="Introduction to Pandas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction to Pandas</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/manipulation/03_geopandas_intro.html" class="pagination-link" aria-label="Introduction to spatial data with Geopandas">
        <span class="nav-page-text">Introduction to spatial data with Geopandas</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Python pour la <em>data science</em>, Lino Galiana.<br>
Licence <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i><br>
Code source disponible sur <a href="https://github.com/linogaliana/python-datascientist"><code>Github</code></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/linogaliana/python-datascientist/edit/master/content/manipulation/02_pandas_suite.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/linogaliana/python-datascientist/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Site construit avec <i class="fa-brands fa-python" aria-label="python"></i> et <a href="https://quarto.org/"><code>Quarto</code></a><br>
Inspiration pour la mise en forme du site <a href="https://www.andreashandel.com">ici</a><br>
<a href="https://github.com/linogaliana/python-datascientist">Code source disponible sur <i class="fa-brands fa-github" aria-label="github"></i> <code>GitHub</code></a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","loop":false,"descPosition":"bottom","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>