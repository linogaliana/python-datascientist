```{ojs}
apiroot = "https://data.geopf.fr/geocodage"
param1 = {
  const AdresseFormat = adresse.toLowerCase().replaceAll(" ", "+")
  const url = `q=${AdresseFormat}`
  return url
}
param2 = `postcode=${codePostal}`
```


```{ojs}
import {mj} from "@danielefadda/mathjax"
```


```{ojs}
url = {
  const AdresseFormat = adresse.toLowerCase().replaceAll(" ", "+")
  const url = `https://data.geopf.fr/geocodage/search/?q=${AdresseFormat}&postcode=${codePostal}`
  return url
}
```

```{ojs}
localisation = d3.json(url)
```

```{ojs}
defaultAdresse = "88 Avenue Verdier"
longitude = localisation.features[0].geometry.coordinates[0]
latitude = localisation.features[0].geometry.coordinates[1]
```

```{ojs}
map = {
  const container = html`<div style="height:300px;">`;
  yield container;
  const map = L.map(container).setView([latitude, longitude], 13);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "&copy; <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors"
  }).addTo(map);
  var marker = L.marker([latitude, longitude]).addTo(map);
  marker.bindPopup("<b>Trouv√© !</b>").openPopup();
  return map
}
```


```{ojs}
import {L} from "@observablehq/hello-leaflet"
```


```{python}
#| echo: false
#| label: error-authent-insee
error_request_no_token = requests.get(
    f"https://api.insee.fr/api-sirene/3.11/siren/",
    headers={"Accept": "application/json"}
).json()
ojs_define(error_request_no_token=error_request_no_token)
```