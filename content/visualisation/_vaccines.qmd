```{ojs}
viewof selectedDisease = Inputs.select(diseases, { label: "Select a Disease" })
```

```{ojs}
color_legend = legend({
  color,
  title: `${selectedDisease} cases per 100,000 people`,
  width: 360
})
```

```{ojs}
viewof replay = Inputs.button("Replay")
```

```{ojs}
animated_chart = addAnimation(
  addTooltips(
    Plot.plot({
      width,
      marks: [
        Plot.cell(
          diseaseData.filter((d) => d[2] !== null),
          {
            x: (d) => d[0],
            y: (d) => stateNames[d[1]],
            fill: (d) => (null !== d[2] ? d[2] : -100),
            fillOpacity: 0,
            inset: -0.4,
            title: (d) =>
              `${stateNames[d[1]]} ${d[0]} \n ${Math.floor(d[2])} cases / 100K`
          }
        ),
        Plot.ruleX([{ x: vaccine_introduced[selectedDisease] }], {
          x: "x",
          strokeWidth: 2
        }),
        Plot.text(
          [
            {
              x: vaccine_introduced[selectedDisease],
              text: "Vaccine Introduced"
            }
          ],
          {
            x: "x",
            text: "text",
            dy: -height / 2 + 30,
            textAnchor: "start",
            dx: 3
          }
        )
      ],
      color: {
        type: "sqrt",
        interpolate: d3.interpolatePuRd
      },
      x: {
        axis: "top",
        ticks: 5,
        tickFormat: (d) => (d % 5 === 0 ? d : "")
      },
      width,
      height: 800
    })
  ),
  { type: "rect", delay: 2, replay }
)
```

```{ojs}
diseases = data.map((d) => d.id)
```

```{ojs}
color = d3.scaleSequentialSqrt([0, d3.max(diseaseData, d => d[2])], d3.interpolatePuRd)
```

```{ojs}
// Based on a quick search
vaccine_introduced = ({
  measles: 1963,
  hepatitisA: 1995,
  mumps: 1971,
  pertussis: 1948,
  polio: 1955,
  rubella: 1969,
  smallpox: 1900
})
```

```{ojs}
diseaseInfo = data[diseases.indexOf(selectedDisease)]
```

```{ojs}
diseaseData = diseaseInfo.data.values.data
```

```{ojs}
import {addAnimation} from "@mkfreeman/plot-animation"
import {legend} from "@d3/color-legend"
import {addTooltips} from "@mkfreeman/plot-tooltip"
```


```{ojs}
import {data} from "@linogaliana/the-impact-of-vaccines"
```

```{ojs}
height = 800
```


```{ojs}
stateNames = [
  "Alaska",
  "Ala.",
  "Ark.",
  "Ariz.",
  "Calif.",
  "Colo.",
  "Conn.",
  "D.C.",
  "Del.",
  "Fla.",
  "Ga.",
  "Hawaii",
  "Iowa",
  "Idaho",
  "Ill.",
  "Ind.",
  "Kan.",
  "Ky.",
  "La.",
  "Mass.",
  "Md.",
  "Maine",
  "Mich.",
  "Minn.",
  "Mo.",
  "Miss.",
  "Mont.",
  "N.C.",
  "N.D.",
  "Neb.",
  "N.H.",
  "N.J.",
  "N.M",
  "Nev.",
  "N.Y.",
  "Ohio",
  "Okla.",
  "Ore.",
  "Pa.",
  "R.I.",
  "S.C.",
  "S.D.",
  "Tenn.",
  "Texas",
  "Utah",
  "Va.",
  "Vt.",
  "Wash.",
  "Wis.",
  "W.Va.",
  "Wyo."
]
```